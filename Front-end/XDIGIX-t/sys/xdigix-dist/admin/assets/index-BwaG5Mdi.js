var vD=Object.defineProperty;var H2=t=>{throw TypeError(t)};var ED=(t,e,n)=>e in t?vD(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var G2=(t,e,n)=>ED(t,typeof e!="symbol"?e+"":e,n),S1=(t,e,n)=>e.has(t)||H2("Cannot "+n);var Te=(t,e,n)=>(S1(t,e,"read from private field"),n?n.call(t):e.get(t)),Pn=(t,e,n)=>e.has(t)?H2("Cannot add the same private member more than once"):e instanceof WeakSet?e.add(t):e.set(t,n),nn=(t,e,n,r)=>(S1(t,e,"write to private field"),r?r.call(t,n):e.set(t,n),n),Is=(t,e,n)=>(S1(t,e,"access private method"),n);var Nm=(t,e,n,r)=>({set _(s){nn(t,e,s,n)},get _(){return Te(t,e,r)}});function Zw(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var Qd=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Jw(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var sC={exports:{}},fg={},iC={exports:{}},An={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Kf=Symbol.for("react.element"),bD=Symbol.for("react.portal"),ID=Symbol.for("react.fragment"),AD=Symbol.for("react.strict_mode"),TD=Symbol.for("react.profiler"),CD=Symbol.for("react.provider"),SD=Symbol.for("react.context"),ND=Symbol.for("react.forward_ref"),RD=Symbol.for("react.suspense"),PD=Symbol.for("react.memo"),kD=Symbol.for("react.lazy"),q2=Symbol.iterator;function DD(t){return t===null||typeof t!="object"?null:(t=q2&&t[q2]||t["@@iterator"],typeof t=="function"?t:null)}var aC={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},oC=Object.assign,lC={};function Rd(t,e,n){this.props=t,this.context=e,this.refs=lC,this.updater=n||aC}Rd.prototype.isReactComponent={};Rd.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Rd.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function cC(){}cC.prototype=Rd.prototype;function e_(t,e,n){this.props=t,this.context=e,this.refs=lC,this.updater=n||aC}var t_=e_.prototype=new cC;t_.constructor=e_;oC(t_,Rd.prototype);t_.isPureReactComponent=!0;var K2=Array.isArray,uC=Object.prototype.hasOwnProperty,n_={current:null},dC={key:!0,ref:!0,__self:!0,__source:!0};function hC(t,e,n){var r,s={},i=null,l=null;if(e!=null)for(r in e.ref!==void 0&&(l=e.ref),e.key!==void 0&&(i=""+e.key),e)uC.call(e,r)&&!dC.hasOwnProperty(r)&&(s[r]=e[r]);var h=arguments.length-2;if(h===1)s.children=n;else if(1<h){for(var p=Array(h),y=0;y<h;y++)p[y]=arguments[y+2];s.children=p}if(t&&t.defaultProps)for(r in h=t.defaultProps,h)s[r]===void 0&&(s[r]=h[r]);return{$$typeof:Kf,type:t,key:i,ref:l,props:s,_owner:n_.current}}function OD(t,e){return{$$typeof:Kf,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function r_(t){return typeof t=="object"&&t!==null&&t.$$typeof===Kf}function MD(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var X2=/\/+/g;function N1(t,e){return typeof t=="object"&&t!==null&&t.key!=null?MD(""+t.key):e.toString(36)}function lp(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var l=!1;if(t===null)l=!0;else switch(i){case"string":case"number":l=!0;break;case"object":switch(t.$$typeof){case Kf:case bD:l=!0}}if(l)return l=t,s=s(l),t=r===""?"."+N1(l,0):r,K2(s)?(n="",t!=null&&(n=t.replace(X2,"$&/")+"/"),lp(s,e,n,"",function(y){return y})):s!=null&&(r_(s)&&(s=OD(s,n+(!s.key||l&&l.key===s.key?"":(""+s.key).replace(X2,"$&/")+"/")+t)),e.push(s)),1;if(l=0,r=r===""?".":r+":",K2(t))for(var h=0;h<t.length;h++){i=t[h];var p=r+N1(i,h);l+=lp(i,e,n,p,s)}else if(p=DD(t),typeof p=="function")for(t=p.call(t),h=0;!(i=t.next()).done;)i=i.value,p=r+N1(i,h++),l+=lp(i,e,n,p,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return l}function Rm(t,e,n){if(t==null)return t;var r=[],s=0;return lp(t,r,"","",function(i){return e.call(n,i,s++)}),r}function LD(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Ws={current:null},cp={transition:null},jD={ReactCurrentDispatcher:Ws,ReactCurrentBatchConfig:cp,ReactCurrentOwner:n_};function fC(){throw Error("act(...) is not supported in production builds of React.")}An.Children={map:Rm,forEach:function(t,e,n){Rm(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Rm(t,function(){e++}),e},toArray:function(t){return Rm(t,function(e){return e})||[]},only:function(t){if(!r_(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};An.Component=Rd;An.Fragment=ID;An.Profiler=TD;An.PureComponent=e_;An.StrictMode=AD;An.Suspense=RD;An.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=jD;An.act=fC;An.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=oC({},t.props),s=t.key,i=t.ref,l=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,l=n_.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var h=t.type.defaultProps;for(p in e)uC.call(e,p)&&!dC.hasOwnProperty(p)&&(r[p]=e[p]===void 0&&h!==void 0?h[p]:e[p])}var p=arguments.length-2;if(p===1)r.children=n;else if(1<p){h=Array(p);for(var y=0;y<p;y++)h[y]=arguments[y+2];r.children=h}return{$$typeof:Kf,type:t.type,key:s,ref:i,props:r,_owner:l}};An.createContext=function(t){return t={$$typeof:SD,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:CD,_context:t},t.Consumer=t};An.createElement=hC;An.createFactory=function(t){var e=hC.bind(null,t);return e.type=t,e};An.createRef=function(){return{current:null}};An.forwardRef=function(t){return{$$typeof:ND,render:t}};An.isValidElement=r_;An.lazy=function(t){return{$$typeof:kD,_payload:{_status:-1,_result:t},_init:LD}};An.memo=function(t,e){return{$$typeof:PD,type:t,compare:e===void 0?null:e}};An.startTransition=function(t){var e=cp.transition;cp.transition={};try{t()}finally{cp.transition=e}};An.unstable_act=fC;An.useCallback=function(t,e){return Ws.current.useCallback(t,e)};An.useContext=function(t){return Ws.current.useContext(t)};An.useDebugValue=function(){};An.useDeferredValue=function(t){return Ws.current.useDeferredValue(t)};An.useEffect=function(t,e){return Ws.current.useEffect(t,e)};An.useId=function(){return Ws.current.useId()};An.useImperativeHandle=function(t,e,n){return Ws.current.useImperativeHandle(t,e,n)};An.useInsertionEffect=function(t,e){return Ws.current.useInsertionEffect(t,e)};An.useLayoutEffect=function(t,e){return Ws.current.useLayoutEffect(t,e)};An.useMemo=function(t,e){return Ws.current.useMemo(t,e)};An.useReducer=function(t,e,n){return Ws.current.useReducer(t,e,n)};An.useRef=function(t){return Ws.current.useRef(t)};An.useState=function(t){return Ws.current.useState(t)};An.useSyncExternalStore=function(t,e,n){return Ws.current.useSyncExternalStore(t,e,n)};An.useTransition=function(){return Ws.current.useTransition()};An.version="18.3.1";iC.exports=An;var q=iC.exports;const mC=Jw(q),FD=Zw({__proto__:null,default:mC},[q]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var VD=q,BD=Symbol.for("react.element"),UD=Symbol.for("react.fragment"),$D=Object.prototype.hasOwnProperty,zD=VD.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,WD={key:!0,ref:!0,__self:!0,__source:!0};function pC(t,e,n){var r,s={},i=null,l=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(l=e.ref);for(r in e)$D.call(e,r)&&!WD.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:BD,type:t,key:i,ref:l,props:s,_owner:zD.current}}fg.Fragment=UD;fg.jsx=pC;fg.jsxs=pC;sC.exports=fg;var d=sC.exports,Dy={},gC={exports:{}},Ri={},yC={exports:{}},xC={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(Ee,qe){var et=Ee.length;Ee.push(qe);e:for(;0<et;){var Lt=et-1>>>1,Qe=Ee[Lt];if(0<s(Qe,qe))Ee[Lt]=qe,Ee[et]=Qe,et=Lt;else break e}}function n(Ee){return Ee.length===0?null:Ee[0]}function r(Ee){if(Ee.length===0)return null;var qe=Ee[0],et=Ee.pop();if(et!==qe){Ee[0]=et;e:for(var Lt=0,Qe=Ee.length,rt=Qe>>>1;Lt<rt;){var pe=2*(Lt+1)-1,ve=Ee[pe],fe=pe+1,ke=Ee[fe];if(0>s(ve,et))fe<Qe&&0>s(ke,ve)?(Ee[Lt]=ke,Ee[fe]=et,Lt=fe):(Ee[Lt]=ve,Ee[pe]=et,Lt=pe);else if(fe<Qe&&0>s(ke,et))Ee[Lt]=ke,Ee[fe]=et,Lt=fe;else break e}}return qe}function s(Ee,qe){var et=Ee.sortIndex-qe.sortIndex;return et!==0?et:Ee.id-qe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var l=Date,h=l.now();t.unstable_now=function(){return l.now()-h}}var p=[],y=[],_=1,E=null,T=3,k=!1,L=!1,B=!1,H=typeof setTimeout=="function"?setTimeout:null,W=typeof clearTimeout=="function"?clearTimeout:null,M=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function U(Ee){for(var qe=n(y);qe!==null;){if(qe.callback===null)r(y);else if(qe.startTime<=Ee)r(y),qe.sortIndex=qe.expirationTime,e(p,qe);else break;qe=n(y)}}function $(Ee){if(B=!1,U(Ee),!L)if(n(p)!==null)L=!0,je(K);else{var qe=n(y);qe!==null&&We($,qe.startTime-Ee)}}function K(Ee,qe){L=!1,B&&(B=!1,W(C),C=-1),k=!0;var et=T;try{for(U(qe),E=n(p);E!==null&&(!(E.expirationTime>qe)||Ee&&!O());){var Lt=E.callback;if(typeof Lt=="function"){E.callback=null,T=E.priorityLevel;var Qe=Lt(E.expirationTime<=qe);qe=t.unstable_now(),typeof Qe=="function"?E.callback=Qe:E===n(p)&&r(p),U(qe)}else r(p);E=n(p)}if(E!==null)var rt=!0;else{var pe=n(y);pe!==null&&We($,pe.startTime-qe),rt=!1}return rt}finally{E=null,T=et,k=!1}}var Z=!1,A=null,C=-1,N=5,D=-1;function O(){return!(t.unstable_now()-D<N)}function F(){if(A!==null){var Ee=t.unstable_now();D=Ee;var qe=!0;try{qe=A(!0,Ee)}finally{qe?R():(Z=!1,A=null)}}else Z=!1}var R;if(typeof M=="function")R=function(){M(F)};else if(typeof MessageChannel<"u"){var ie=new MessageChannel,te=ie.port2;ie.port1.onmessage=F,R=function(){te.postMessage(null)}}else R=function(){H(F,0)};function je(Ee){A=Ee,Z||(Z=!0,R())}function We(Ee,qe){C=H(function(){Ee(t.unstable_now())},qe)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Ee){Ee.callback=null},t.unstable_continueExecution=function(){L||k||(L=!0,je(K))},t.unstable_forceFrameRate=function(Ee){0>Ee||125<Ee?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<Ee?Math.floor(1e3/Ee):5},t.unstable_getCurrentPriorityLevel=function(){return T},t.unstable_getFirstCallbackNode=function(){return n(p)},t.unstable_next=function(Ee){switch(T){case 1:case 2:case 3:var qe=3;break;default:qe=T}var et=T;T=qe;try{return Ee()}finally{T=et}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Ee,qe){switch(Ee){case 1:case 2:case 3:case 4:case 5:break;default:Ee=3}var et=T;T=Ee;try{return qe()}finally{T=et}},t.unstable_scheduleCallback=function(Ee,qe,et){var Lt=t.unstable_now();switch(typeof et=="object"&&et!==null?(et=et.delay,et=typeof et=="number"&&0<et?Lt+et:Lt):et=Lt,Ee){case 1:var Qe=-1;break;case 2:Qe=250;break;case 5:Qe=1073741823;break;case 4:Qe=1e4;break;default:Qe=5e3}return Qe=et+Qe,Ee={id:_++,callback:qe,priorityLevel:Ee,startTime:et,expirationTime:Qe,sortIndex:-1},et>Lt?(Ee.sortIndex=et,e(y,Ee),n(p)===null&&Ee===n(y)&&(B?(W(C),C=-1):B=!0,We($,et-Lt))):(Ee.sortIndex=Qe,e(p,Ee),L||k||(L=!0,je(K))),Ee},t.unstable_shouldYield=O,t.unstable_wrapCallback=function(Ee){var qe=T;return function(){var et=T;T=qe;try{return Ee.apply(this,arguments)}finally{T=et}}}})(xC);yC.exports=xC;var HD=yC.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var GD=q,Ni=HD;function Be(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var wC=new Set,Jh={};function Jc(t,e){ld(t,e),ld(t+"Capture",e)}function ld(t,e){for(Jh[t]=e,t=0;t<e.length;t++)wC.add(e[t])}var _o=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Oy=Object.prototype.hasOwnProperty,qD=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Q2={},Y2={};function KD(t){return Oy.call(Y2,t)?!0:Oy.call(Q2,t)?!1:qD.test(t)?Y2[t]=!0:(Q2[t]=!0,!1)}function XD(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function QD(t,e,n,r){if(e===null||typeof e>"u"||XD(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Hs(t,e,n,r,s,i,l){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=l}var _s={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){_s[t]=new Hs(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];_s[e]=new Hs(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){_s[t]=new Hs(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){_s[t]=new Hs(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){_s[t]=new Hs(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){_s[t]=new Hs(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){_s[t]=new Hs(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){_s[t]=new Hs(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){_s[t]=new Hs(t,5,!1,t.toLowerCase(),null,!1,!1)});var s_=/[\-:]([a-z])/g;function i_(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(s_,i_);_s[e]=new Hs(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(s_,i_);_s[e]=new Hs(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(s_,i_);_s[e]=new Hs(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){_s[t]=new Hs(t,1,!1,t.toLowerCase(),null,!1,!1)});_s.xlinkHref=new Hs("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){_s[t]=new Hs(t,1,!1,t.toLowerCase(),null,!0,!0)});function a_(t,e,n,r){var s=_s.hasOwnProperty(e)?_s[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(QD(e,n,s,r)&&(n=null),r||s===null?KD(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var Lo=GD.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Pm=Symbol.for("react.element"),Cu=Symbol.for("react.portal"),Su=Symbol.for("react.fragment"),o_=Symbol.for("react.strict_mode"),My=Symbol.for("react.profiler"),_C=Symbol.for("react.provider"),vC=Symbol.for("react.context"),l_=Symbol.for("react.forward_ref"),Ly=Symbol.for("react.suspense"),jy=Symbol.for("react.suspense_list"),c_=Symbol.for("react.memo"),Qo=Symbol.for("react.lazy"),EC=Symbol.for("react.offscreen"),Z2=Symbol.iterator;function Yd(t){return t===null||typeof t!="object"?null:(t=Z2&&t[Z2]||t["@@iterator"],typeof t=="function"?t:null)}var Cr=Object.assign,R1;function hh(t){if(R1===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);R1=e&&e[1]||""}return`
`+R1+t}var P1=!1;function k1(t,e){if(!t||P1)return"";P1=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(y){var r=y}Reflect.construct(t,[],e)}else{try{e.call()}catch(y){r=y}t.call(e.prototype)}else{try{throw Error()}catch(y){r=y}t()}}catch(y){if(y&&r&&typeof y.stack=="string"){for(var s=y.stack.split(`
`),i=r.stack.split(`
`),l=s.length-1,h=i.length-1;1<=l&&0<=h&&s[l]!==i[h];)h--;for(;1<=l&&0<=h;l--,h--)if(s[l]!==i[h]){if(l!==1||h!==1)do if(l--,h--,0>h||s[l]!==i[h]){var p=`
`+s[l].replace(" at new "," at ");return t.displayName&&p.includes("<anonymous>")&&(p=p.replace("<anonymous>",t.displayName)),p}while(1<=l&&0<=h);break}}}finally{P1=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?hh(t):""}function YD(t){switch(t.tag){case 5:return hh(t.type);case 16:return hh("Lazy");case 13:return hh("Suspense");case 19:return hh("SuspenseList");case 0:case 2:case 15:return t=k1(t.type,!1),t;case 11:return t=k1(t.type.render,!1),t;case 1:return t=k1(t.type,!0),t;default:return""}}function Fy(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Su:return"Fragment";case Cu:return"Portal";case My:return"Profiler";case o_:return"StrictMode";case Ly:return"Suspense";case jy:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case vC:return(t.displayName||"Context")+".Consumer";case _C:return(t._context.displayName||"Context")+".Provider";case l_:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case c_:return e=t.displayName||null,e!==null?e:Fy(t.type)||"Memo";case Qo:e=t._payload,t=t._init;try{return Fy(t(e))}catch{}}return null}function ZD(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Fy(e);case 8:return e===o_?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Pl(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function bC(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function JD(t){var e=bC(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(l){r=""+l,i.call(this,l)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(l){r=""+l},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function km(t){t._valueTracker||(t._valueTracker=JD(t))}function IC(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=bC(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function qp(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Vy(t,e){var n=e.checked;return Cr({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function J2(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Pl(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function AC(t,e){e=e.checked,e!=null&&a_(t,"checked",e,!1)}function By(t,e){AC(t,e);var n=Pl(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Uy(t,e.type,n):e.hasOwnProperty("defaultValue")&&Uy(t,e.type,Pl(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function eE(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Uy(t,e,n){(e!=="number"||qp(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var fh=Array.isArray;function $u(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Pl(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function $y(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Be(91));return Cr({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function tE(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(Be(92));if(fh(n)){if(1<n.length)throw Error(Be(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Pl(n)}}function TC(t,e){var n=Pl(e.value),r=Pl(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function nE(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function CC(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function zy(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?CC(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Dm,SC=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Dm=Dm||document.createElement("div"),Dm.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Dm.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function ef(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Ph={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},eO=["Webkit","ms","Moz","O"];Object.keys(Ph).forEach(function(t){eO.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Ph[e]=Ph[t]})});function NC(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Ph.hasOwnProperty(t)&&Ph[t]?(""+e).trim():e+"px"}function RC(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=NC(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var tO=Cr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Wy(t,e){if(e){if(tO[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Be(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Be(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Be(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Be(62))}}function Hy(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Gy=null;function u_(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var qy=null,zu=null,Wu=null;function rE(t){if(t=Yf(t)){if(typeof qy!="function")throw Error(Be(280));var e=t.stateNode;e&&(e=xg(e),qy(t.stateNode,t.type,e))}}function PC(t){zu?Wu?Wu.push(t):Wu=[t]:zu=t}function kC(){if(zu){var t=zu,e=Wu;if(Wu=zu=null,rE(t),e)for(t=0;t<e.length;t++)rE(e[t])}}function DC(t,e){return t(e)}function OC(){}var D1=!1;function MC(t,e,n){if(D1)return t(e,n);D1=!0;try{return DC(t,e,n)}finally{D1=!1,(zu!==null||Wu!==null)&&(OC(),kC())}}function tf(t,e){var n=t.stateNode;if(n===null)return null;var r=xg(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(Be(231,e,typeof n));return n}var Ky=!1;if(_o)try{var Zd={};Object.defineProperty(Zd,"passive",{get:function(){Ky=!0}}),window.addEventListener("test",Zd,Zd),window.removeEventListener("test",Zd,Zd)}catch{Ky=!1}function nO(t,e,n,r,s,i,l,h,p){var y=Array.prototype.slice.call(arguments,3);try{e.apply(n,y)}catch(_){this.onError(_)}}var kh=!1,Kp=null,Xp=!1,Xy=null,rO={onError:function(t){kh=!0,Kp=t}};function sO(t,e,n,r,s,i,l,h,p){kh=!1,Kp=null,nO.apply(rO,arguments)}function iO(t,e,n,r,s,i,l,h,p){if(sO.apply(this,arguments),kh){if(kh){var y=Kp;kh=!1,Kp=null}else throw Error(Be(198));Xp||(Xp=!0,Xy=y)}}function eu(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function LC(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function sE(t){if(eu(t)!==t)throw Error(Be(188))}function aO(t){var e=t.alternate;if(!e){if(e=eu(t),e===null)throw Error(Be(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return sE(s),t;if(i===r)return sE(s),e;i=i.sibling}throw Error(Be(188))}if(n.return!==r.return)n=s,r=i;else{for(var l=!1,h=s.child;h;){if(h===n){l=!0,n=s,r=i;break}if(h===r){l=!0,r=s,n=i;break}h=h.sibling}if(!l){for(h=i.child;h;){if(h===n){l=!0,n=i,r=s;break}if(h===r){l=!0,r=i,n=s;break}h=h.sibling}if(!l)throw Error(Be(189))}}if(n.alternate!==r)throw Error(Be(190))}if(n.tag!==3)throw Error(Be(188));return n.stateNode.current===n?t:e}function jC(t){return t=aO(t),t!==null?FC(t):null}function FC(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=FC(t);if(e!==null)return e;t=t.sibling}return null}var VC=Ni.unstable_scheduleCallback,iE=Ni.unstable_cancelCallback,oO=Ni.unstable_shouldYield,lO=Ni.unstable_requestPaint,Vr=Ni.unstable_now,cO=Ni.unstable_getCurrentPriorityLevel,d_=Ni.unstable_ImmediatePriority,BC=Ni.unstable_UserBlockingPriority,Qp=Ni.unstable_NormalPriority,uO=Ni.unstable_LowPriority,UC=Ni.unstable_IdlePriority,mg=null,Ra=null;function dO(t){if(Ra&&typeof Ra.onCommitFiberRoot=="function")try{Ra.onCommitFiberRoot(mg,t,void 0,(t.current.flags&128)===128)}catch{}}var aa=Math.clz32?Math.clz32:mO,hO=Math.log,fO=Math.LN2;function mO(t){return t>>>=0,t===0?32:31-(hO(t)/fO|0)|0}var Om=64,Mm=4194304;function mh(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Yp(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,l=n&268435455;if(l!==0){var h=l&~s;h!==0?r=mh(h):(i&=l,i!==0&&(r=mh(i)))}else l=n&~s,l!==0?r=mh(l):i!==0&&(r=mh(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-aa(e),s=1<<n,r|=t[n],e&=~s;return r}function pO(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function gO(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var l=31-aa(i),h=1<<l,p=s[l];p===-1?(!(h&n)||h&r)&&(s[l]=pO(h,e)):p<=e&&(t.expiredLanes|=h),i&=~h}}function Qy(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function $C(){var t=Om;return Om<<=1,!(Om&4194240)&&(Om=64),t}function O1(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Xf(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-aa(e),t[e]=n}function yO(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-aa(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function h_(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-aa(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var Qn=0;function zC(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var WC,f_,HC,GC,qC,Yy=!1,Lm=[],pl=null,gl=null,yl=null,nf=new Map,rf=new Map,Zo=[],xO="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function aE(t,e){switch(t){case"focusin":case"focusout":pl=null;break;case"dragenter":case"dragleave":gl=null;break;case"mouseover":case"mouseout":yl=null;break;case"pointerover":case"pointerout":nf.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":rf.delete(e.pointerId)}}function Jd(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=Yf(e),e!==null&&f_(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function wO(t,e,n,r,s){switch(e){case"focusin":return pl=Jd(pl,t,e,n,r,s),!0;case"dragenter":return gl=Jd(gl,t,e,n,r,s),!0;case"mouseover":return yl=Jd(yl,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return nf.set(i,Jd(nf.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,rf.set(i,Jd(rf.get(i)||null,t,e,n,r,s)),!0}return!1}function KC(t){var e=fc(t.target);if(e!==null){var n=eu(e);if(n!==null){if(e=n.tag,e===13){if(e=LC(n),e!==null){t.blockedOn=e,qC(t.priority,function(){HC(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function up(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Zy(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Gy=r,n.target.dispatchEvent(r),Gy=null}else return e=Yf(n),e!==null&&f_(e),t.blockedOn=n,!1;e.shift()}return!0}function oE(t,e,n){up(t)&&n.delete(e)}function _O(){Yy=!1,pl!==null&&up(pl)&&(pl=null),gl!==null&&up(gl)&&(gl=null),yl!==null&&up(yl)&&(yl=null),nf.forEach(oE),rf.forEach(oE)}function eh(t,e){t.blockedOn===e&&(t.blockedOn=null,Yy||(Yy=!0,Ni.unstable_scheduleCallback(Ni.unstable_NormalPriority,_O)))}function sf(t){function e(s){return eh(s,t)}if(0<Lm.length){eh(Lm[0],t);for(var n=1;n<Lm.length;n++){var r=Lm[n];r.blockedOn===t&&(r.blockedOn=null)}}for(pl!==null&&eh(pl,t),gl!==null&&eh(gl,t),yl!==null&&eh(yl,t),nf.forEach(e),rf.forEach(e),n=0;n<Zo.length;n++)r=Zo[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Zo.length&&(n=Zo[0],n.blockedOn===null);)KC(n),n.blockedOn===null&&Zo.shift()}var Hu=Lo.ReactCurrentBatchConfig,Zp=!0;function vO(t,e,n,r){var s=Qn,i=Hu.transition;Hu.transition=null;try{Qn=1,m_(t,e,n,r)}finally{Qn=s,Hu.transition=i}}function EO(t,e,n,r){var s=Qn,i=Hu.transition;Hu.transition=null;try{Qn=4,m_(t,e,n,r)}finally{Qn=s,Hu.transition=i}}function m_(t,e,n,r){if(Zp){var s=Zy(t,e,n,r);if(s===null)W1(t,e,r,Jp,n),aE(t,r);else if(wO(s,t,e,n,r))r.stopPropagation();else if(aE(t,r),e&4&&-1<xO.indexOf(t)){for(;s!==null;){var i=Yf(s);if(i!==null&&WC(i),i=Zy(t,e,n,r),i===null&&W1(t,e,r,Jp,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else W1(t,e,r,null,n)}}var Jp=null;function Zy(t,e,n,r){if(Jp=null,t=u_(r),t=fc(t),t!==null)if(e=eu(t),e===null)t=null;else if(n=e.tag,n===13){if(t=LC(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Jp=t,null}function XC(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(cO()){case d_:return 1;case BC:return 4;case Qp:case uO:return 16;case UC:return 536870912;default:return 16}default:return 16}}var ul=null,p_=null,dp=null;function QC(){if(dp)return dp;var t,e=p_,n=e.length,r,s="value"in ul?ul.value:ul.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var l=n-t;for(r=1;r<=l&&e[n-r]===s[i-r];r++);return dp=s.slice(t,1<r?1-r:void 0)}function hp(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function jm(){return!0}function lE(){return!1}function Pi(t){function e(n,r,s,i,l){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=l,this.currentTarget=null;for(var h in t)t.hasOwnProperty(h)&&(n=t[h],this[h]=n?n(i):i[h]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?jm:lE,this.isPropagationStopped=lE,this}return Cr(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=jm)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=jm)},persist:function(){},isPersistent:jm}),e}var Pd={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},g_=Pi(Pd),Qf=Cr({},Pd,{view:0,detail:0}),bO=Pi(Qf),M1,L1,th,pg=Cr({},Qf,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:y_,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==th&&(th&&t.type==="mousemove"?(M1=t.screenX-th.screenX,L1=t.screenY-th.screenY):L1=M1=0,th=t),M1)},movementY:function(t){return"movementY"in t?t.movementY:L1}}),cE=Pi(pg),IO=Cr({},pg,{dataTransfer:0}),AO=Pi(IO),TO=Cr({},Qf,{relatedTarget:0}),j1=Pi(TO),CO=Cr({},Pd,{animationName:0,elapsedTime:0,pseudoElement:0}),SO=Pi(CO),NO=Cr({},Pd,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),RO=Pi(NO),PO=Cr({},Pd,{data:0}),uE=Pi(PO),kO={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},DO={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},OO={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function MO(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=OO[t])?!!e[t]:!1}function y_(){return MO}var LO=Cr({},Qf,{key:function(t){if(t.key){var e=kO[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=hp(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?DO[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:y_,charCode:function(t){return t.type==="keypress"?hp(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?hp(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),jO=Pi(LO),FO=Cr({},pg,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),dE=Pi(FO),VO=Cr({},Qf,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:y_}),BO=Pi(VO),UO=Cr({},Pd,{propertyName:0,elapsedTime:0,pseudoElement:0}),$O=Pi(UO),zO=Cr({},pg,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),WO=Pi(zO),HO=[9,13,27,32],x_=_o&&"CompositionEvent"in window,Dh=null;_o&&"documentMode"in document&&(Dh=document.documentMode);var GO=_o&&"TextEvent"in window&&!Dh,YC=_o&&(!x_||Dh&&8<Dh&&11>=Dh),hE=" ",fE=!1;function ZC(t,e){switch(t){case"keyup":return HO.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function JC(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Nu=!1;function qO(t,e){switch(t){case"compositionend":return JC(e);case"keypress":return e.which!==32?null:(fE=!0,hE);case"textInput":return t=e.data,t===hE&&fE?null:t;default:return null}}function KO(t,e){if(Nu)return t==="compositionend"||!x_&&ZC(t,e)?(t=QC(),dp=p_=ul=null,Nu=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return YC&&e.locale!=="ko"?null:e.data;default:return null}}var XO={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function mE(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!XO[t.type]:e==="textarea"}function eS(t,e,n,r){PC(r),e=e0(e,"onChange"),0<e.length&&(n=new g_("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Oh=null,af=null;function QO(t){dS(t,0)}function gg(t){var e=ku(t);if(IC(e))return t}function YO(t,e){if(t==="change")return e}var tS=!1;if(_o){var F1;if(_o){var V1="oninput"in document;if(!V1){var pE=document.createElement("div");pE.setAttribute("oninput","return;"),V1=typeof pE.oninput=="function"}F1=V1}else F1=!1;tS=F1&&(!document.documentMode||9<document.documentMode)}function gE(){Oh&&(Oh.detachEvent("onpropertychange",nS),af=Oh=null)}function nS(t){if(t.propertyName==="value"&&gg(af)){var e=[];eS(e,af,t,u_(t)),MC(QO,e)}}function ZO(t,e,n){t==="focusin"?(gE(),Oh=e,af=n,Oh.attachEvent("onpropertychange",nS)):t==="focusout"&&gE()}function JO(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return gg(af)}function e5(t,e){if(t==="click")return gg(e)}function t5(t,e){if(t==="input"||t==="change")return gg(e)}function n5(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var ca=typeof Object.is=="function"?Object.is:n5;function of(t,e){if(ca(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Oy.call(e,s)||!ca(t[s],e[s]))return!1}return!0}function yE(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function xE(t,e){var n=yE(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=yE(n)}}function rS(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?rS(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function sS(){for(var t=window,e=qp();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=qp(t.document)}return e}function w_(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function r5(t){var e=sS(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&rS(n.ownerDocument.documentElement,n)){if(r!==null&&w_(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=xE(n,i);var l=xE(n,r);s&&l&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==l.node||t.focusOffset!==l.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(l.node,l.offset)):(e.setEnd(l.node,l.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var s5=_o&&"documentMode"in document&&11>=document.documentMode,Ru=null,Jy=null,Mh=null,ex=!1;function wE(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;ex||Ru==null||Ru!==qp(r)||(r=Ru,"selectionStart"in r&&w_(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Mh&&of(Mh,r)||(Mh=r,r=e0(Jy,"onSelect"),0<r.length&&(e=new g_("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Ru)))}function Fm(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Pu={animationend:Fm("Animation","AnimationEnd"),animationiteration:Fm("Animation","AnimationIteration"),animationstart:Fm("Animation","AnimationStart"),transitionend:Fm("Transition","TransitionEnd")},B1={},iS={};_o&&(iS=document.createElement("div").style,"AnimationEvent"in window||(delete Pu.animationend.animation,delete Pu.animationiteration.animation,delete Pu.animationstart.animation),"TransitionEvent"in window||delete Pu.transitionend.transition);function yg(t){if(B1[t])return B1[t];if(!Pu[t])return t;var e=Pu[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in iS)return B1[t]=e[n];return t}var aS=yg("animationend"),oS=yg("animationiteration"),lS=yg("animationstart"),cS=yg("transitionend"),uS=new Map,_E="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Bl(t,e){uS.set(t,e),Jc(e,[t])}for(var U1=0;U1<_E.length;U1++){var $1=_E[U1],i5=$1.toLowerCase(),a5=$1[0].toUpperCase()+$1.slice(1);Bl(i5,"on"+a5)}Bl(aS,"onAnimationEnd");Bl(oS,"onAnimationIteration");Bl(lS,"onAnimationStart");Bl("dblclick","onDoubleClick");Bl("focusin","onFocus");Bl("focusout","onBlur");Bl(cS,"onTransitionEnd");ld("onMouseEnter",["mouseout","mouseover"]);ld("onMouseLeave",["mouseout","mouseover"]);ld("onPointerEnter",["pointerout","pointerover"]);ld("onPointerLeave",["pointerout","pointerover"]);Jc("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Jc("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Jc("onBeforeInput",["compositionend","keypress","textInput","paste"]);Jc("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Jc("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Jc("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ph="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),o5=new Set("cancel close invalid load scroll toggle".split(" ").concat(ph));function vE(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,iO(r,e,void 0,t),t.currentTarget=null}function dS(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var l=r.length-1;0<=l;l--){var h=r[l],p=h.instance,y=h.currentTarget;if(h=h.listener,p!==i&&s.isPropagationStopped())break e;vE(s,h,y),i=p}else for(l=0;l<r.length;l++){if(h=r[l],p=h.instance,y=h.currentTarget,h=h.listener,p!==i&&s.isPropagationStopped())break e;vE(s,h,y),i=p}}}if(Xp)throw t=Xy,Xp=!1,Xy=null,t}function mr(t,e){var n=e[ix];n===void 0&&(n=e[ix]=new Set);var r=t+"__bubble";n.has(r)||(hS(e,t,2,!1),n.add(r))}function z1(t,e,n){var r=0;e&&(r|=4),hS(n,t,r,e)}var Vm="_reactListening"+Math.random().toString(36).slice(2);function lf(t){if(!t[Vm]){t[Vm]=!0,wC.forEach(function(n){n!=="selectionchange"&&(o5.has(n)||z1(n,!1,t),z1(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Vm]||(e[Vm]=!0,z1("selectionchange",!1,e))}}function hS(t,e,n,r){switch(XC(e)){case 1:var s=vO;break;case 4:s=EO;break;default:s=m_}n=s.bind(null,e,n,t),s=void 0,!Ky||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function W1(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var l=r.tag;if(l===3||l===4){var h=r.stateNode.containerInfo;if(h===s||h.nodeType===8&&h.parentNode===s)break;if(l===4)for(l=r.return;l!==null;){var p=l.tag;if((p===3||p===4)&&(p=l.stateNode.containerInfo,p===s||p.nodeType===8&&p.parentNode===s))return;l=l.return}for(;h!==null;){if(l=fc(h),l===null)return;if(p=l.tag,p===5||p===6){r=i=l;continue e}h=h.parentNode}}r=r.return}MC(function(){var y=i,_=u_(n),E=[];e:{var T=uS.get(t);if(T!==void 0){var k=g_,L=t;switch(t){case"keypress":if(hp(n)===0)break e;case"keydown":case"keyup":k=jO;break;case"focusin":L="focus",k=j1;break;case"focusout":L="blur",k=j1;break;case"beforeblur":case"afterblur":k=j1;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":k=cE;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":k=AO;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":k=BO;break;case aS:case oS:case lS:k=SO;break;case cS:k=$O;break;case"scroll":k=bO;break;case"wheel":k=WO;break;case"copy":case"cut":case"paste":k=RO;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":k=dE}var B=(e&4)!==0,H=!B&&t==="scroll",W=B?T!==null?T+"Capture":null:T;B=[];for(var M=y,U;M!==null;){U=M;var $=U.stateNode;if(U.tag===5&&$!==null&&(U=$,W!==null&&($=tf(M,W),$!=null&&B.push(cf(M,$,U)))),H)break;M=M.return}0<B.length&&(T=new k(T,L,null,n,_),E.push({event:T,listeners:B}))}}if(!(e&7)){e:{if(T=t==="mouseover"||t==="pointerover",k=t==="mouseout"||t==="pointerout",T&&n!==Gy&&(L=n.relatedTarget||n.fromElement)&&(fc(L)||L[vo]))break e;if((k||T)&&(T=_.window===_?_:(T=_.ownerDocument)?T.defaultView||T.parentWindow:window,k?(L=n.relatedTarget||n.toElement,k=y,L=L?fc(L):null,L!==null&&(H=eu(L),L!==H||L.tag!==5&&L.tag!==6)&&(L=null)):(k=null,L=y),k!==L)){if(B=cE,$="onMouseLeave",W="onMouseEnter",M="mouse",(t==="pointerout"||t==="pointerover")&&(B=dE,$="onPointerLeave",W="onPointerEnter",M="pointer"),H=k==null?T:ku(k),U=L==null?T:ku(L),T=new B($,M+"leave",k,n,_),T.target=H,T.relatedTarget=U,$=null,fc(_)===y&&(B=new B(W,M+"enter",L,n,_),B.target=U,B.relatedTarget=H,$=B),H=$,k&&L)t:{for(B=k,W=L,M=0,U=B;U;U=fu(U))M++;for(U=0,$=W;$;$=fu($))U++;for(;0<M-U;)B=fu(B),M--;for(;0<U-M;)W=fu(W),U--;for(;M--;){if(B===W||W!==null&&B===W.alternate)break t;B=fu(B),W=fu(W)}B=null}else B=null;k!==null&&EE(E,T,k,B,!1),L!==null&&H!==null&&EE(E,H,L,B,!0)}}e:{if(T=y?ku(y):window,k=T.nodeName&&T.nodeName.toLowerCase(),k==="select"||k==="input"&&T.type==="file")var K=YO;else if(mE(T))if(tS)K=t5;else{K=JO;var Z=ZO}else(k=T.nodeName)&&k.toLowerCase()==="input"&&(T.type==="checkbox"||T.type==="radio")&&(K=e5);if(K&&(K=K(t,y))){eS(E,K,n,_);break e}Z&&Z(t,T,y),t==="focusout"&&(Z=T._wrapperState)&&Z.controlled&&T.type==="number"&&Uy(T,"number",T.value)}switch(Z=y?ku(y):window,t){case"focusin":(mE(Z)||Z.contentEditable==="true")&&(Ru=Z,Jy=y,Mh=null);break;case"focusout":Mh=Jy=Ru=null;break;case"mousedown":ex=!0;break;case"contextmenu":case"mouseup":case"dragend":ex=!1,wE(E,n,_);break;case"selectionchange":if(s5)break;case"keydown":case"keyup":wE(E,n,_)}var A;if(x_)e:{switch(t){case"compositionstart":var C="onCompositionStart";break e;case"compositionend":C="onCompositionEnd";break e;case"compositionupdate":C="onCompositionUpdate";break e}C=void 0}else Nu?ZC(t,n)&&(C="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(C="onCompositionStart");C&&(YC&&n.locale!=="ko"&&(Nu||C!=="onCompositionStart"?C==="onCompositionEnd"&&Nu&&(A=QC()):(ul=_,p_="value"in ul?ul.value:ul.textContent,Nu=!0)),Z=e0(y,C),0<Z.length&&(C=new uE(C,t,null,n,_),E.push({event:C,listeners:Z}),A?C.data=A:(A=JC(n),A!==null&&(C.data=A)))),(A=GO?qO(t,n):KO(t,n))&&(y=e0(y,"onBeforeInput"),0<y.length&&(_=new uE("onBeforeInput","beforeinput",null,n,_),E.push({event:_,listeners:y}),_.data=A))}dS(E,e)})}function cf(t,e,n){return{instance:t,listener:e,currentTarget:n}}function e0(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=tf(t,n),i!=null&&r.unshift(cf(t,i,s)),i=tf(t,e),i!=null&&r.push(cf(t,i,s))),t=t.return}return r}function fu(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function EE(t,e,n,r,s){for(var i=e._reactName,l=[];n!==null&&n!==r;){var h=n,p=h.alternate,y=h.stateNode;if(p!==null&&p===r)break;h.tag===5&&y!==null&&(h=y,s?(p=tf(n,i),p!=null&&l.unshift(cf(n,p,h))):s||(p=tf(n,i),p!=null&&l.push(cf(n,p,h)))),n=n.return}l.length!==0&&t.push({event:e,listeners:l})}var l5=/\r\n?/g,c5=/\u0000|\uFFFD/g;function bE(t){return(typeof t=="string"?t:""+t).replace(l5,`
`).replace(c5,"")}function Bm(t,e,n){if(e=bE(e),bE(t)!==e&&n)throw Error(Be(425))}function t0(){}var tx=null,nx=null;function rx(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var sx=typeof setTimeout=="function"?setTimeout:void 0,u5=typeof clearTimeout=="function"?clearTimeout:void 0,IE=typeof Promise=="function"?Promise:void 0,d5=typeof queueMicrotask=="function"?queueMicrotask:typeof IE<"u"?function(t){return IE.resolve(null).then(t).catch(h5)}:sx;function h5(t){setTimeout(function(){throw t})}function H1(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),sf(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);sf(e)}function xl(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function AE(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var kd=Math.random().toString(36).slice(2),Ia="__reactFiber$"+kd,uf="__reactProps$"+kd,vo="__reactContainer$"+kd,ix="__reactEvents$"+kd,f5="__reactListeners$"+kd,m5="__reactHandles$"+kd;function fc(t){var e=t[Ia];if(e)return e;for(var n=t.parentNode;n;){if(e=n[vo]||n[Ia]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=AE(t);t!==null;){if(n=t[Ia])return n;t=AE(t)}return e}t=n,n=t.parentNode}return null}function Yf(t){return t=t[Ia]||t[vo],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function ku(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Be(33))}function xg(t){return t[uf]||null}var ax=[],Du=-1;function Ul(t){return{current:t}}function yr(t){0>Du||(t.current=ax[Du],ax[Du]=null,Du--)}function dr(t,e){Du++,ax[Du]=t.current,t.current=e}var kl={},Ds=Ul(kl),oi=Ul(!1),Dc=kl;function cd(t,e){var n=t.type.contextTypes;if(!n)return kl;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function li(t){return t=t.childContextTypes,t!=null}function n0(){yr(oi),yr(Ds)}function TE(t,e,n){if(Ds.current!==kl)throw Error(Be(168));dr(Ds,e),dr(oi,n)}function fS(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(Be(108,ZD(t)||"Unknown",s));return Cr({},n,r)}function r0(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||kl,Dc=Ds.current,dr(Ds,t),dr(oi,oi.current),!0}function CE(t,e,n){var r=t.stateNode;if(!r)throw Error(Be(169));n?(t=fS(t,e,Dc),r.__reactInternalMemoizedMergedChildContext=t,yr(oi),yr(Ds),dr(Ds,t)):yr(oi),dr(oi,n)}var so=null,wg=!1,G1=!1;function mS(t){so===null?so=[t]:so.push(t)}function p5(t){wg=!0,mS(t)}function $l(){if(!G1&&so!==null){G1=!0;var t=0,e=Qn;try{var n=so;for(Qn=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}so=null,wg=!1}catch(s){throw so!==null&&(so=so.slice(t+1)),VC(d_,$l),s}finally{Qn=e,G1=!1}}return null}var Ou=[],Mu=0,s0=null,i0=0,Li=[],ji=0,Oc=null,oo=1,lo="";function sc(t,e){Ou[Mu++]=i0,Ou[Mu++]=s0,s0=t,i0=e}function pS(t,e,n){Li[ji++]=oo,Li[ji++]=lo,Li[ji++]=Oc,Oc=t;var r=oo;t=lo;var s=32-aa(r)-1;r&=~(1<<s),n+=1;var i=32-aa(e)+s;if(30<i){var l=s-s%5;i=(r&(1<<l)-1).toString(32),r>>=l,s-=l,oo=1<<32-aa(e)+s|n<<s|r,lo=i+t}else oo=1<<i|n<<s|r,lo=t}function __(t){t.return!==null&&(sc(t,1),pS(t,1,0))}function v_(t){for(;t===s0;)s0=Ou[--Mu],Ou[Mu]=null,i0=Ou[--Mu],Ou[Mu]=null;for(;t===Oc;)Oc=Li[--ji],Li[ji]=null,lo=Li[--ji],Li[ji]=null,oo=Li[--ji],Li[ji]=null}var Ci=null,Ai=null,vr=!1,ra=null;function gS(t,e){var n=Vi(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function SE(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Ci=t,Ai=xl(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Ci=t,Ai=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Oc!==null?{id:oo,overflow:lo}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=Vi(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Ci=t,Ai=null,!0):!1;default:return!1}}function ox(t){return(t.mode&1)!==0&&(t.flags&128)===0}function lx(t){if(vr){var e=Ai;if(e){var n=e;if(!SE(t,e)){if(ox(t))throw Error(Be(418));e=xl(n.nextSibling);var r=Ci;e&&SE(t,e)?gS(r,n):(t.flags=t.flags&-4097|2,vr=!1,Ci=t)}}else{if(ox(t))throw Error(Be(418));t.flags=t.flags&-4097|2,vr=!1,Ci=t}}}function NE(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Ci=t}function Um(t){if(t!==Ci)return!1;if(!vr)return NE(t),vr=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!rx(t.type,t.memoizedProps)),e&&(e=Ai)){if(ox(t))throw yS(),Error(Be(418));for(;e;)gS(t,e),e=xl(e.nextSibling)}if(NE(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Be(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Ai=xl(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Ai=null}}else Ai=Ci?xl(t.stateNode.nextSibling):null;return!0}function yS(){for(var t=Ai;t;)t=xl(t.nextSibling)}function ud(){Ai=Ci=null,vr=!1}function E_(t){ra===null?ra=[t]:ra.push(t)}var g5=Lo.ReactCurrentBatchConfig;function nh(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Be(309));var r=n.stateNode}if(!r)throw Error(Be(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(l){var h=s.refs;l===null?delete h[i]:h[i]=l},e._stringRef=i,e)}if(typeof t!="string")throw Error(Be(284));if(!n._owner)throw Error(Be(290,t))}return t}function $m(t,e){throw t=Object.prototype.toString.call(e),Error(Be(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function RE(t){var e=t._init;return e(t._payload)}function xS(t){function e(W,M){if(t){var U=W.deletions;U===null?(W.deletions=[M],W.flags|=16):U.push(M)}}function n(W,M){if(!t)return null;for(;M!==null;)e(W,M),M=M.sibling;return null}function r(W,M){for(W=new Map;M!==null;)M.key!==null?W.set(M.key,M):W.set(M.index,M),M=M.sibling;return W}function s(W,M){return W=El(W,M),W.index=0,W.sibling=null,W}function i(W,M,U){return W.index=U,t?(U=W.alternate,U!==null?(U=U.index,U<M?(W.flags|=2,M):U):(W.flags|=2,M)):(W.flags|=1048576,M)}function l(W){return t&&W.alternate===null&&(W.flags|=2),W}function h(W,M,U,$){return M===null||M.tag!==6?(M=J1(U,W.mode,$),M.return=W,M):(M=s(M,U),M.return=W,M)}function p(W,M,U,$){var K=U.type;return K===Su?_(W,M,U.props.children,$,U.key):M!==null&&(M.elementType===K||typeof K=="object"&&K!==null&&K.$$typeof===Qo&&RE(K)===M.type)?($=s(M,U.props),$.ref=nh(W,M,U),$.return=W,$):($=wp(U.type,U.key,U.props,null,W.mode,$),$.ref=nh(W,M,U),$.return=W,$)}function y(W,M,U,$){return M===null||M.tag!==4||M.stateNode.containerInfo!==U.containerInfo||M.stateNode.implementation!==U.implementation?(M=ey(U,W.mode,$),M.return=W,M):(M=s(M,U.children||[]),M.return=W,M)}function _(W,M,U,$,K){return M===null||M.tag!==7?(M=Nc(U,W.mode,$,K),M.return=W,M):(M=s(M,U),M.return=W,M)}function E(W,M,U){if(typeof M=="string"&&M!==""||typeof M=="number")return M=J1(""+M,W.mode,U),M.return=W,M;if(typeof M=="object"&&M!==null){switch(M.$$typeof){case Pm:return U=wp(M.type,M.key,M.props,null,W.mode,U),U.ref=nh(W,null,M),U.return=W,U;case Cu:return M=ey(M,W.mode,U),M.return=W,M;case Qo:var $=M._init;return E(W,$(M._payload),U)}if(fh(M)||Yd(M))return M=Nc(M,W.mode,U,null),M.return=W,M;$m(W,M)}return null}function T(W,M,U,$){var K=M!==null?M.key:null;if(typeof U=="string"&&U!==""||typeof U=="number")return K!==null?null:h(W,M,""+U,$);if(typeof U=="object"&&U!==null){switch(U.$$typeof){case Pm:return U.key===K?p(W,M,U,$):null;case Cu:return U.key===K?y(W,M,U,$):null;case Qo:return K=U._init,T(W,M,K(U._payload),$)}if(fh(U)||Yd(U))return K!==null?null:_(W,M,U,$,null);$m(W,U)}return null}function k(W,M,U,$,K){if(typeof $=="string"&&$!==""||typeof $=="number")return W=W.get(U)||null,h(M,W,""+$,K);if(typeof $=="object"&&$!==null){switch($.$$typeof){case Pm:return W=W.get($.key===null?U:$.key)||null,p(M,W,$,K);case Cu:return W=W.get($.key===null?U:$.key)||null,y(M,W,$,K);case Qo:var Z=$._init;return k(W,M,U,Z($._payload),K)}if(fh($)||Yd($))return W=W.get(U)||null,_(M,W,$,K,null);$m(M,$)}return null}function L(W,M,U,$){for(var K=null,Z=null,A=M,C=M=0,N=null;A!==null&&C<U.length;C++){A.index>C?(N=A,A=null):N=A.sibling;var D=T(W,A,U[C],$);if(D===null){A===null&&(A=N);break}t&&A&&D.alternate===null&&e(W,A),M=i(D,M,C),Z===null?K=D:Z.sibling=D,Z=D,A=N}if(C===U.length)return n(W,A),vr&&sc(W,C),K;if(A===null){for(;C<U.length;C++)A=E(W,U[C],$),A!==null&&(M=i(A,M,C),Z===null?K=A:Z.sibling=A,Z=A);return vr&&sc(W,C),K}for(A=r(W,A);C<U.length;C++)N=k(A,W,C,U[C],$),N!==null&&(t&&N.alternate!==null&&A.delete(N.key===null?C:N.key),M=i(N,M,C),Z===null?K=N:Z.sibling=N,Z=N);return t&&A.forEach(function(O){return e(W,O)}),vr&&sc(W,C),K}function B(W,M,U,$){var K=Yd(U);if(typeof K!="function")throw Error(Be(150));if(U=K.call(U),U==null)throw Error(Be(151));for(var Z=K=null,A=M,C=M=0,N=null,D=U.next();A!==null&&!D.done;C++,D=U.next()){A.index>C?(N=A,A=null):N=A.sibling;var O=T(W,A,D.value,$);if(O===null){A===null&&(A=N);break}t&&A&&O.alternate===null&&e(W,A),M=i(O,M,C),Z===null?K=O:Z.sibling=O,Z=O,A=N}if(D.done)return n(W,A),vr&&sc(W,C),K;if(A===null){for(;!D.done;C++,D=U.next())D=E(W,D.value,$),D!==null&&(M=i(D,M,C),Z===null?K=D:Z.sibling=D,Z=D);return vr&&sc(W,C),K}for(A=r(W,A);!D.done;C++,D=U.next())D=k(A,W,C,D.value,$),D!==null&&(t&&D.alternate!==null&&A.delete(D.key===null?C:D.key),M=i(D,M,C),Z===null?K=D:Z.sibling=D,Z=D);return t&&A.forEach(function(F){return e(W,F)}),vr&&sc(W,C),K}function H(W,M,U,$){if(typeof U=="object"&&U!==null&&U.type===Su&&U.key===null&&(U=U.props.children),typeof U=="object"&&U!==null){switch(U.$$typeof){case Pm:e:{for(var K=U.key,Z=M;Z!==null;){if(Z.key===K){if(K=U.type,K===Su){if(Z.tag===7){n(W,Z.sibling),M=s(Z,U.props.children),M.return=W,W=M;break e}}else if(Z.elementType===K||typeof K=="object"&&K!==null&&K.$$typeof===Qo&&RE(K)===Z.type){n(W,Z.sibling),M=s(Z,U.props),M.ref=nh(W,Z,U),M.return=W,W=M;break e}n(W,Z);break}else e(W,Z);Z=Z.sibling}U.type===Su?(M=Nc(U.props.children,W.mode,$,U.key),M.return=W,W=M):($=wp(U.type,U.key,U.props,null,W.mode,$),$.ref=nh(W,M,U),$.return=W,W=$)}return l(W);case Cu:e:{for(Z=U.key;M!==null;){if(M.key===Z)if(M.tag===4&&M.stateNode.containerInfo===U.containerInfo&&M.stateNode.implementation===U.implementation){n(W,M.sibling),M=s(M,U.children||[]),M.return=W,W=M;break e}else{n(W,M);break}else e(W,M);M=M.sibling}M=ey(U,W.mode,$),M.return=W,W=M}return l(W);case Qo:return Z=U._init,H(W,M,Z(U._payload),$)}if(fh(U))return L(W,M,U,$);if(Yd(U))return B(W,M,U,$);$m(W,U)}return typeof U=="string"&&U!==""||typeof U=="number"?(U=""+U,M!==null&&M.tag===6?(n(W,M.sibling),M=s(M,U),M.return=W,W=M):(n(W,M),M=J1(U,W.mode,$),M.return=W,W=M),l(W)):n(W,M)}return H}var dd=xS(!0),wS=xS(!1),a0=Ul(null),o0=null,Lu=null,b_=null;function I_(){b_=Lu=o0=null}function A_(t){var e=a0.current;yr(a0),t._currentValue=e}function cx(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Gu(t,e){o0=t,b_=Lu=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(ai=!0),t.firstContext=null)}function Wi(t){var e=t._currentValue;if(b_!==t)if(t={context:t,memoizedValue:e,next:null},Lu===null){if(o0===null)throw Error(Be(308));Lu=t,o0.dependencies={lanes:0,firstContext:t}}else Lu=Lu.next=t;return e}var mc=null;function T_(t){mc===null?mc=[t]:mc.push(t)}function _S(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,T_(e)):(n.next=s.next,s.next=n),e.interleaved=n,Eo(t,r)}function Eo(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Yo=!1;function C_(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function vS(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function po(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function wl(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Un&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,Eo(t,n)}return s=r.interleaved,s===null?(e.next=e,T_(r)):(e.next=s.next,s.next=e),r.interleaved=e,Eo(t,n)}function fp(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,h_(t,n)}}function PE(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var l={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=l:i=i.next=l,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function l0(t,e,n,r){var s=t.updateQueue;Yo=!1;var i=s.firstBaseUpdate,l=s.lastBaseUpdate,h=s.shared.pending;if(h!==null){s.shared.pending=null;var p=h,y=p.next;p.next=null,l===null?i=y:l.next=y,l=p;var _=t.alternate;_!==null&&(_=_.updateQueue,h=_.lastBaseUpdate,h!==l&&(h===null?_.firstBaseUpdate=y:h.next=y,_.lastBaseUpdate=p))}if(i!==null){var E=s.baseState;l=0,_=y=p=null,h=i;do{var T=h.lane,k=h.eventTime;if((r&T)===T){_!==null&&(_=_.next={eventTime:k,lane:0,tag:h.tag,payload:h.payload,callback:h.callback,next:null});e:{var L=t,B=h;switch(T=e,k=n,B.tag){case 1:if(L=B.payload,typeof L=="function"){E=L.call(k,E,T);break e}E=L;break e;case 3:L.flags=L.flags&-65537|128;case 0:if(L=B.payload,T=typeof L=="function"?L.call(k,E,T):L,T==null)break e;E=Cr({},E,T);break e;case 2:Yo=!0}}h.callback!==null&&h.lane!==0&&(t.flags|=64,T=s.effects,T===null?s.effects=[h]:T.push(h))}else k={eventTime:k,lane:T,tag:h.tag,payload:h.payload,callback:h.callback,next:null},_===null?(y=_=k,p=E):_=_.next=k,l|=T;if(h=h.next,h===null){if(h=s.shared.pending,h===null)break;T=h,h=T.next,T.next=null,s.lastBaseUpdate=T,s.shared.pending=null}}while(!0);if(_===null&&(p=E),s.baseState=p,s.firstBaseUpdate=y,s.lastBaseUpdate=_,e=s.shared.interleaved,e!==null){s=e;do l|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);Lc|=l,t.lanes=l,t.memoizedState=E}}function kE(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(Be(191,s));s.call(r)}}}var Zf={},Pa=Ul(Zf),df=Ul(Zf),hf=Ul(Zf);function pc(t){if(t===Zf)throw Error(Be(174));return t}function S_(t,e){switch(dr(hf,e),dr(df,t),dr(Pa,Zf),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:zy(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=zy(e,t)}yr(Pa),dr(Pa,e)}function hd(){yr(Pa),yr(df),yr(hf)}function ES(t){pc(hf.current);var e=pc(Pa.current),n=zy(e,t.type);e!==n&&(dr(df,t),dr(Pa,n))}function N_(t){df.current===t&&(yr(Pa),yr(df))}var Ir=Ul(0);function c0(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var q1=[];function R_(){for(var t=0;t<q1.length;t++)q1[t]._workInProgressVersionPrimary=null;q1.length=0}var mp=Lo.ReactCurrentDispatcher,K1=Lo.ReactCurrentBatchConfig,Mc=0,Tr=null,Zr=null,is=null,u0=!1,Lh=!1,ff=0,y5=0;function As(){throw Error(Be(321))}function P_(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!ca(t[n],e[n]))return!1;return!0}function k_(t,e,n,r,s,i){if(Mc=i,Tr=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,mp.current=t===null||t.memoizedState===null?v5:E5,t=n(r,s),Lh){i=0;do{if(Lh=!1,ff=0,25<=i)throw Error(Be(301));i+=1,is=Zr=null,e.updateQueue=null,mp.current=b5,t=n(r,s)}while(Lh)}if(mp.current=d0,e=Zr!==null&&Zr.next!==null,Mc=0,is=Zr=Tr=null,u0=!1,e)throw Error(Be(300));return t}function D_(){var t=ff!==0;return ff=0,t}function _a(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return is===null?Tr.memoizedState=is=t:is=is.next=t,is}function Hi(){if(Zr===null){var t=Tr.alternate;t=t!==null?t.memoizedState:null}else t=Zr.next;var e=is===null?Tr.memoizedState:is.next;if(e!==null)is=e,Zr=t;else{if(t===null)throw Error(Be(310));Zr=t,t={memoizedState:Zr.memoizedState,baseState:Zr.baseState,baseQueue:Zr.baseQueue,queue:Zr.queue,next:null},is===null?Tr.memoizedState=is=t:is=is.next=t}return is}function mf(t,e){return typeof e=="function"?e(t):e}function X1(t){var e=Hi(),n=e.queue;if(n===null)throw Error(Be(311));n.lastRenderedReducer=t;var r=Zr,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var l=s.next;s.next=i.next,i.next=l}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var h=l=null,p=null,y=i;do{var _=y.lane;if((Mc&_)===_)p!==null&&(p=p.next={lane:0,action:y.action,hasEagerState:y.hasEagerState,eagerState:y.eagerState,next:null}),r=y.hasEagerState?y.eagerState:t(r,y.action);else{var E={lane:_,action:y.action,hasEagerState:y.hasEagerState,eagerState:y.eagerState,next:null};p===null?(h=p=E,l=r):p=p.next=E,Tr.lanes|=_,Lc|=_}y=y.next}while(y!==null&&y!==i);p===null?l=r:p.next=h,ca(r,e.memoizedState)||(ai=!0),e.memoizedState=r,e.baseState=l,e.baseQueue=p,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,Tr.lanes|=i,Lc|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Q1(t){var e=Hi(),n=e.queue;if(n===null)throw Error(Be(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var l=s=s.next;do i=t(i,l.action),l=l.next;while(l!==s);ca(i,e.memoizedState)||(ai=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function bS(){}function IS(t,e){var n=Tr,r=Hi(),s=e(),i=!ca(r.memoizedState,s);if(i&&(r.memoizedState=s,ai=!0),r=r.queue,O_(CS.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||is!==null&&is.memoizedState.tag&1){if(n.flags|=2048,pf(9,TS.bind(null,n,r,s,e),void 0,null),os===null)throw Error(Be(349));Mc&30||AS(n,e,s)}return s}function AS(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Tr.updateQueue,e===null?(e={lastEffect:null,stores:null},Tr.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function TS(t,e,n,r){e.value=n,e.getSnapshot=r,SS(e)&&NS(t)}function CS(t,e,n){return n(function(){SS(e)&&NS(t)})}function SS(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!ca(t,n)}catch{return!0}}function NS(t){var e=Eo(t,1);e!==null&&oa(e,t,1,-1)}function DE(t){var e=_a();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:mf,lastRenderedState:t},e.queue=t,t=t.dispatch=_5.bind(null,Tr,t),[e.memoizedState,t]}function pf(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Tr.updateQueue,e===null?(e={lastEffect:null,stores:null},Tr.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function RS(){return Hi().memoizedState}function pp(t,e,n,r){var s=_a();Tr.flags|=t,s.memoizedState=pf(1|e,n,void 0,r===void 0?null:r)}function _g(t,e,n,r){var s=Hi();r=r===void 0?null:r;var i=void 0;if(Zr!==null){var l=Zr.memoizedState;if(i=l.destroy,r!==null&&P_(r,l.deps)){s.memoizedState=pf(e,n,i,r);return}}Tr.flags|=t,s.memoizedState=pf(1|e,n,i,r)}function OE(t,e){return pp(8390656,8,t,e)}function O_(t,e){return _g(2048,8,t,e)}function PS(t,e){return _g(4,2,t,e)}function kS(t,e){return _g(4,4,t,e)}function DS(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function OS(t,e,n){return n=n!=null?n.concat([t]):null,_g(4,4,DS.bind(null,e,t),n)}function M_(){}function MS(t,e){var n=Hi();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&P_(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function LS(t,e){var n=Hi();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&P_(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function jS(t,e,n){return Mc&21?(ca(n,e)||(n=$C(),Tr.lanes|=n,Lc|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,ai=!0),t.memoizedState=n)}function x5(t,e){var n=Qn;Qn=n!==0&&4>n?n:4,t(!0);var r=K1.transition;K1.transition={};try{t(!1),e()}finally{Qn=n,K1.transition=r}}function FS(){return Hi().memoizedState}function w5(t,e,n){var r=vl(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},VS(t))BS(e,n);else if(n=_S(t,e,n,r),n!==null){var s=Us();oa(n,t,r,s),US(n,e,r)}}function _5(t,e,n){var r=vl(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(VS(t))BS(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var l=e.lastRenderedState,h=i(l,n);if(s.hasEagerState=!0,s.eagerState=h,ca(h,l)){var p=e.interleaved;p===null?(s.next=s,T_(e)):(s.next=p.next,p.next=s),e.interleaved=s;return}}catch{}finally{}n=_S(t,e,s,r),n!==null&&(s=Us(),oa(n,t,r,s),US(n,e,r))}}function VS(t){var e=t.alternate;return t===Tr||e!==null&&e===Tr}function BS(t,e){Lh=u0=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function US(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,h_(t,n)}}var d0={readContext:Wi,useCallback:As,useContext:As,useEffect:As,useImperativeHandle:As,useInsertionEffect:As,useLayoutEffect:As,useMemo:As,useReducer:As,useRef:As,useState:As,useDebugValue:As,useDeferredValue:As,useTransition:As,useMutableSource:As,useSyncExternalStore:As,useId:As,unstable_isNewReconciler:!1},v5={readContext:Wi,useCallback:function(t,e){return _a().memoizedState=[t,e===void 0?null:e],t},useContext:Wi,useEffect:OE,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,pp(4194308,4,DS.bind(null,e,t),n)},useLayoutEffect:function(t,e){return pp(4194308,4,t,e)},useInsertionEffect:function(t,e){return pp(4,2,t,e)},useMemo:function(t,e){var n=_a();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=_a();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=w5.bind(null,Tr,t),[r.memoizedState,t]},useRef:function(t){var e=_a();return t={current:t},e.memoizedState=t},useState:DE,useDebugValue:M_,useDeferredValue:function(t){return _a().memoizedState=t},useTransition:function(){var t=DE(!1),e=t[0];return t=x5.bind(null,t[1]),_a().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Tr,s=_a();if(vr){if(n===void 0)throw Error(Be(407));n=n()}else{if(n=e(),os===null)throw Error(Be(349));Mc&30||AS(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,OE(CS.bind(null,r,i,t),[t]),r.flags|=2048,pf(9,TS.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=_a(),e=os.identifierPrefix;if(vr){var n=lo,r=oo;n=(r&~(1<<32-aa(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=ff++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=y5++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},E5={readContext:Wi,useCallback:MS,useContext:Wi,useEffect:O_,useImperativeHandle:OS,useInsertionEffect:PS,useLayoutEffect:kS,useMemo:LS,useReducer:X1,useRef:RS,useState:function(){return X1(mf)},useDebugValue:M_,useDeferredValue:function(t){var e=Hi();return jS(e,Zr.memoizedState,t)},useTransition:function(){var t=X1(mf)[0],e=Hi().memoizedState;return[t,e]},useMutableSource:bS,useSyncExternalStore:IS,useId:FS,unstable_isNewReconciler:!1},b5={readContext:Wi,useCallback:MS,useContext:Wi,useEffect:O_,useImperativeHandle:OS,useInsertionEffect:PS,useLayoutEffect:kS,useMemo:LS,useReducer:Q1,useRef:RS,useState:function(){return Q1(mf)},useDebugValue:M_,useDeferredValue:function(t){var e=Hi();return Zr===null?e.memoizedState=t:jS(e,Zr.memoizedState,t)},useTransition:function(){var t=Q1(mf)[0],e=Hi().memoizedState;return[t,e]},useMutableSource:bS,useSyncExternalStore:IS,useId:FS,unstable_isNewReconciler:!1};function Yi(t,e){if(t&&t.defaultProps){e=Cr({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function ux(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Cr({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var vg={isMounted:function(t){return(t=t._reactInternals)?eu(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Us(),s=vl(t),i=po(r,s);i.payload=e,n!=null&&(i.callback=n),e=wl(t,i,s),e!==null&&(oa(e,t,s,r),fp(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Us(),s=vl(t),i=po(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=wl(t,i,s),e!==null&&(oa(e,t,s,r),fp(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Us(),r=vl(t),s=po(n,r);s.tag=2,e!=null&&(s.callback=e),e=wl(t,s,r),e!==null&&(oa(e,t,r,n),fp(e,t,r))}};function ME(t,e,n,r,s,i,l){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,l):e.prototype&&e.prototype.isPureReactComponent?!of(n,r)||!of(s,i):!0}function $S(t,e,n){var r=!1,s=kl,i=e.contextType;return typeof i=="object"&&i!==null?i=Wi(i):(s=li(e)?Dc:Ds.current,r=e.contextTypes,i=(r=r!=null)?cd(t,s):kl),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=vg,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function LE(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&vg.enqueueReplaceState(e,e.state,null)}function dx(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},C_(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=Wi(i):(i=li(e)?Dc:Ds.current,s.context=cd(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(ux(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&vg.enqueueReplaceState(s,s.state,null),l0(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function fd(t,e){try{var n="",r=e;do n+=YD(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function Y1(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function hx(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var I5=typeof WeakMap=="function"?WeakMap:Map;function zS(t,e,n){n=po(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){f0||(f0=!0,Ex=r),hx(t,e)},n}function WS(t,e,n){n=po(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){hx(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){hx(t,e),typeof r!="function"&&(_l===null?_l=new Set([this]):_l.add(this));var l=e.stack;this.componentDidCatch(e.value,{componentStack:l!==null?l:""})}),n}function jE(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new I5;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=F5.bind(null,t,e,n),e.then(t,t))}function FE(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function VE(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=po(-1,1),e.tag=2,wl(n,e,1))),n.lanes|=1),t)}var A5=Lo.ReactCurrentOwner,ai=!1;function Fs(t,e,n,r){e.child=t===null?wS(e,null,n,r):dd(e,t.child,n,r)}function BE(t,e,n,r,s){n=n.render;var i=e.ref;return Gu(e,s),r=k_(t,e,n,r,i,s),n=D_(),t!==null&&!ai?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,bo(t,e,s)):(vr&&n&&__(e),e.flags|=1,Fs(t,e,r,s),e.child)}function UE(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!z_(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,HS(t,e,i,r,s)):(t=wp(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var l=i.memoizedProps;if(n=n.compare,n=n!==null?n:of,n(l,r)&&t.ref===e.ref)return bo(t,e,s)}return e.flags|=1,t=El(i,r),t.ref=e.ref,t.return=e,e.child=t}function HS(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(of(i,r)&&t.ref===e.ref)if(ai=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(ai=!0);else return e.lanes=t.lanes,bo(t,e,s)}return fx(t,e,n,r,s)}function GS(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},dr(Fu,vi),vi|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,dr(Fu,vi),vi|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,dr(Fu,vi),vi|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,dr(Fu,vi),vi|=r;return Fs(t,e,s,n),e.child}function qS(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function fx(t,e,n,r,s){var i=li(n)?Dc:Ds.current;return i=cd(e,i),Gu(e,s),n=k_(t,e,n,r,i,s),r=D_(),t!==null&&!ai?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,bo(t,e,s)):(vr&&r&&__(e),e.flags|=1,Fs(t,e,n,s),e.child)}function $E(t,e,n,r,s){if(li(n)){var i=!0;r0(e)}else i=!1;if(Gu(e,s),e.stateNode===null)gp(t,e),$S(e,n,r),dx(e,n,r,s),r=!0;else if(t===null){var l=e.stateNode,h=e.memoizedProps;l.props=h;var p=l.context,y=n.contextType;typeof y=="object"&&y!==null?y=Wi(y):(y=li(n)?Dc:Ds.current,y=cd(e,y));var _=n.getDerivedStateFromProps,E=typeof _=="function"||typeof l.getSnapshotBeforeUpdate=="function";E||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(h!==r||p!==y)&&LE(e,l,r,y),Yo=!1;var T=e.memoizedState;l.state=T,l0(e,r,l,s),p=e.memoizedState,h!==r||T!==p||oi.current||Yo?(typeof _=="function"&&(ux(e,n,_,r),p=e.memoizedState),(h=Yo||ME(e,n,h,r,T,p,y))?(E||typeof l.UNSAFE_componentWillMount!="function"&&typeof l.componentWillMount!="function"||(typeof l.componentWillMount=="function"&&l.componentWillMount(),typeof l.UNSAFE_componentWillMount=="function"&&l.UNSAFE_componentWillMount()),typeof l.componentDidMount=="function"&&(e.flags|=4194308)):(typeof l.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=p),l.props=r,l.state=p,l.context=y,r=h):(typeof l.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{l=e.stateNode,vS(t,e),h=e.memoizedProps,y=e.type===e.elementType?h:Yi(e.type,h),l.props=y,E=e.pendingProps,T=l.context,p=n.contextType,typeof p=="object"&&p!==null?p=Wi(p):(p=li(n)?Dc:Ds.current,p=cd(e,p));var k=n.getDerivedStateFromProps;(_=typeof k=="function"||typeof l.getSnapshotBeforeUpdate=="function")||typeof l.UNSAFE_componentWillReceiveProps!="function"&&typeof l.componentWillReceiveProps!="function"||(h!==E||T!==p)&&LE(e,l,r,p),Yo=!1,T=e.memoizedState,l.state=T,l0(e,r,l,s);var L=e.memoizedState;h!==E||T!==L||oi.current||Yo?(typeof k=="function"&&(ux(e,n,k,r),L=e.memoizedState),(y=Yo||ME(e,n,y,r,T,L,p)||!1)?(_||typeof l.UNSAFE_componentWillUpdate!="function"&&typeof l.componentWillUpdate!="function"||(typeof l.componentWillUpdate=="function"&&l.componentWillUpdate(r,L,p),typeof l.UNSAFE_componentWillUpdate=="function"&&l.UNSAFE_componentWillUpdate(r,L,p)),typeof l.componentDidUpdate=="function"&&(e.flags|=4),typeof l.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof l.componentDidUpdate!="function"||h===t.memoizedProps&&T===t.memoizedState||(e.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||h===t.memoizedProps&&T===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=L),l.props=r,l.state=L,l.context=p,r=y):(typeof l.componentDidUpdate!="function"||h===t.memoizedProps&&T===t.memoizedState||(e.flags|=4),typeof l.getSnapshotBeforeUpdate!="function"||h===t.memoizedProps&&T===t.memoizedState||(e.flags|=1024),r=!1)}return mx(t,e,n,r,i,s)}function mx(t,e,n,r,s,i){qS(t,e);var l=(e.flags&128)!==0;if(!r&&!l)return s&&CE(e,n,!1),bo(t,e,i);r=e.stateNode,A5.current=e;var h=l&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&l?(e.child=dd(e,t.child,null,i),e.child=dd(e,null,h,i)):Fs(t,e,h,i),e.memoizedState=r.state,s&&CE(e,n,!0),e.child}function KS(t){var e=t.stateNode;e.pendingContext?TE(t,e.pendingContext,e.pendingContext!==e.context):e.context&&TE(t,e.context,!1),S_(t,e.containerInfo)}function zE(t,e,n,r,s){return ud(),E_(s),e.flags|=256,Fs(t,e,n,r),e.child}var px={dehydrated:null,treeContext:null,retryLane:0};function gx(t){return{baseLanes:t,cachePool:null,transitions:null}}function XS(t,e,n){var r=e.pendingProps,s=Ir.current,i=!1,l=(e.flags&128)!==0,h;if((h=l)||(h=t!==null&&t.memoizedState===null?!1:(s&2)!==0),h?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),dr(Ir,s&1),t===null)return lx(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(l=r.children,t=r.fallback,i?(r=e.mode,i=e.child,l={mode:"hidden",children:l},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=l):i=Ig(l,r,0,null),t=Nc(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=gx(n),e.memoizedState=px,t):L_(e,l));if(s=t.memoizedState,s!==null&&(h=s.dehydrated,h!==null))return T5(t,e,l,r,h,s,n);if(i){i=r.fallback,l=e.mode,s=t.child,h=s.sibling;var p={mode:"hidden",children:r.children};return!(l&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=p,e.deletions=null):(r=El(s,p),r.subtreeFlags=s.subtreeFlags&14680064),h!==null?i=El(h,i):(i=Nc(i,l,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,l=t.child.memoizedState,l=l===null?gx(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},i.memoizedState=l,i.childLanes=t.childLanes&~n,e.memoizedState=px,r}return i=t.child,t=i.sibling,r=El(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function L_(t,e){return e=Ig({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function zm(t,e,n,r){return r!==null&&E_(r),dd(e,t.child,null,n),t=L_(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function T5(t,e,n,r,s,i,l){if(n)return e.flags&256?(e.flags&=-257,r=Y1(Error(Be(422))),zm(t,e,l,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Ig({mode:"visible",children:r.children},s,0,null),i=Nc(i,s,l,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&dd(e,t.child,null,l),e.child.memoizedState=gx(l),e.memoizedState=px,i);if(!(e.mode&1))return zm(t,e,l,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var h=r.dgst;return r=h,i=Error(Be(419)),r=Y1(i,r,void 0),zm(t,e,l,r)}if(h=(l&t.childLanes)!==0,ai||h){if(r=os,r!==null){switch(l&-l){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|l)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,Eo(t,s),oa(r,t,s,-1))}return $_(),r=Y1(Error(Be(421))),zm(t,e,l,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=V5.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Ai=xl(s.nextSibling),Ci=e,vr=!0,ra=null,t!==null&&(Li[ji++]=oo,Li[ji++]=lo,Li[ji++]=Oc,oo=t.id,lo=t.overflow,Oc=e),e=L_(e,r.children),e.flags|=4096,e)}function WE(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),cx(t.return,e,n)}function Z1(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function QS(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(Fs(t,e,r.children,n),r=Ir.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&WE(t,n,e);else if(t.tag===19)WE(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(dr(Ir,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&c0(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),Z1(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&c0(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}Z1(e,!0,n,null,i);break;case"together":Z1(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function gp(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function bo(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Lc|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Be(153));if(e.child!==null){for(t=e.child,n=El(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=El(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function C5(t,e,n){switch(e.tag){case 3:KS(e),ud();break;case 5:ES(e);break;case 1:li(e.type)&&r0(e);break;case 4:S_(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;dr(a0,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(dr(Ir,Ir.current&1),e.flags|=128,null):n&e.child.childLanes?XS(t,e,n):(dr(Ir,Ir.current&1),t=bo(t,e,n),t!==null?t.sibling:null);dr(Ir,Ir.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return QS(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),dr(Ir,Ir.current),r)break;return null;case 22:case 23:return e.lanes=0,GS(t,e,n)}return bo(t,e,n)}var YS,yx,ZS,JS;YS=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};yx=function(){};ZS=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,pc(Pa.current);var i=null;switch(n){case"input":s=Vy(t,s),r=Vy(t,r),i=[];break;case"select":s=Cr({},s,{value:void 0}),r=Cr({},r,{value:void 0}),i=[];break;case"textarea":s=$y(t,s),r=$y(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=t0)}Wy(n,r);var l;n=null;for(y in s)if(!r.hasOwnProperty(y)&&s.hasOwnProperty(y)&&s[y]!=null)if(y==="style"){var h=s[y];for(l in h)h.hasOwnProperty(l)&&(n||(n={}),n[l]="")}else y!=="dangerouslySetInnerHTML"&&y!=="children"&&y!=="suppressContentEditableWarning"&&y!=="suppressHydrationWarning"&&y!=="autoFocus"&&(Jh.hasOwnProperty(y)?i||(i=[]):(i=i||[]).push(y,null));for(y in r){var p=r[y];if(h=s!=null?s[y]:void 0,r.hasOwnProperty(y)&&p!==h&&(p!=null||h!=null))if(y==="style")if(h){for(l in h)!h.hasOwnProperty(l)||p&&p.hasOwnProperty(l)||(n||(n={}),n[l]="");for(l in p)p.hasOwnProperty(l)&&h[l]!==p[l]&&(n||(n={}),n[l]=p[l])}else n||(i||(i=[]),i.push(y,n)),n=p;else y==="dangerouslySetInnerHTML"?(p=p?p.__html:void 0,h=h?h.__html:void 0,p!=null&&h!==p&&(i=i||[]).push(y,p)):y==="children"?typeof p!="string"&&typeof p!="number"||(i=i||[]).push(y,""+p):y!=="suppressContentEditableWarning"&&y!=="suppressHydrationWarning"&&(Jh.hasOwnProperty(y)?(p!=null&&y==="onScroll"&&mr("scroll",t),i||h===p||(i=[])):(i=i||[]).push(y,p))}n&&(i=i||[]).push("style",n);var y=i;(e.updateQueue=y)&&(e.flags|=4)}};JS=function(t,e,n,r){n!==r&&(e.flags|=4)};function rh(t,e){if(!vr)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Ts(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function S5(t,e,n){var r=e.pendingProps;switch(v_(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ts(e),null;case 1:return li(e.type)&&n0(),Ts(e),null;case 3:return r=e.stateNode,hd(),yr(oi),yr(Ds),R_(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Um(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,ra!==null&&(Ax(ra),ra=null))),yx(t,e),Ts(e),null;case 5:N_(e);var s=pc(hf.current);if(n=e.type,t!==null&&e.stateNode!=null)ZS(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(Be(166));return Ts(e),null}if(t=pc(Pa.current),Um(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[Ia]=e,r[uf]=i,t=(e.mode&1)!==0,n){case"dialog":mr("cancel",r),mr("close",r);break;case"iframe":case"object":case"embed":mr("load",r);break;case"video":case"audio":for(s=0;s<ph.length;s++)mr(ph[s],r);break;case"source":mr("error",r);break;case"img":case"image":case"link":mr("error",r),mr("load",r);break;case"details":mr("toggle",r);break;case"input":J2(r,i),mr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},mr("invalid",r);break;case"textarea":tE(r,i),mr("invalid",r)}Wy(n,i),s=null;for(var l in i)if(i.hasOwnProperty(l)){var h=i[l];l==="children"?typeof h=="string"?r.textContent!==h&&(i.suppressHydrationWarning!==!0&&Bm(r.textContent,h,t),s=["children",h]):typeof h=="number"&&r.textContent!==""+h&&(i.suppressHydrationWarning!==!0&&Bm(r.textContent,h,t),s=["children",""+h]):Jh.hasOwnProperty(l)&&h!=null&&l==="onScroll"&&mr("scroll",r)}switch(n){case"input":km(r),eE(r,i,!0);break;case"textarea":km(r),nE(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=t0)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{l=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=CC(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=l.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=l.createElement(n,{is:r.is}):(t=l.createElement(n),n==="select"&&(l=t,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):t=l.createElementNS(t,n),t[Ia]=e,t[uf]=r,YS(t,e,!1,!1),e.stateNode=t;e:{switch(l=Hy(n,r),n){case"dialog":mr("cancel",t),mr("close",t),s=r;break;case"iframe":case"object":case"embed":mr("load",t),s=r;break;case"video":case"audio":for(s=0;s<ph.length;s++)mr(ph[s],t);s=r;break;case"source":mr("error",t),s=r;break;case"img":case"image":case"link":mr("error",t),mr("load",t),s=r;break;case"details":mr("toggle",t),s=r;break;case"input":J2(t,r),s=Vy(t,r),mr("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=Cr({},r,{value:void 0}),mr("invalid",t);break;case"textarea":tE(t,r),s=$y(t,r),mr("invalid",t);break;default:s=r}Wy(n,s),h=s;for(i in h)if(h.hasOwnProperty(i)){var p=h[i];i==="style"?RC(t,p):i==="dangerouslySetInnerHTML"?(p=p?p.__html:void 0,p!=null&&SC(t,p)):i==="children"?typeof p=="string"?(n!=="textarea"||p!=="")&&ef(t,p):typeof p=="number"&&ef(t,""+p):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Jh.hasOwnProperty(i)?p!=null&&i==="onScroll"&&mr("scroll",t):p!=null&&a_(t,i,p,l))}switch(n){case"input":km(t),eE(t,r,!1);break;case"textarea":km(t),nE(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Pl(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?$u(t,!!r.multiple,i,!1):r.defaultValue!=null&&$u(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=t0)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Ts(e),null;case 6:if(t&&e.stateNode!=null)JS(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(Be(166));if(n=pc(hf.current),pc(Pa.current),Um(e)){if(r=e.stateNode,n=e.memoizedProps,r[Ia]=e,(i=r.nodeValue!==n)&&(t=Ci,t!==null))switch(t.tag){case 3:Bm(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Bm(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[Ia]=e,e.stateNode=r}return Ts(e),null;case 13:if(yr(Ir),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(vr&&Ai!==null&&e.mode&1&&!(e.flags&128))yS(),ud(),e.flags|=98560,i=!1;else if(i=Um(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(Be(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Be(317));i[Ia]=e}else ud(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ts(e),i=!1}else ra!==null&&(Ax(ra),ra=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Ir.current&1?Jr===0&&(Jr=3):$_())),e.updateQueue!==null&&(e.flags|=4),Ts(e),null);case 4:return hd(),yx(t,e),t===null&&lf(e.stateNode.containerInfo),Ts(e),null;case 10:return A_(e.type._context),Ts(e),null;case 17:return li(e.type)&&n0(),Ts(e),null;case 19:if(yr(Ir),i=e.memoizedState,i===null)return Ts(e),null;if(r=(e.flags&128)!==0,l=i.rendering,l===null)if(r)rh(i,!1);else{if(Jr!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(l=c0(t),l!==null){for(e.flags|=128,rh(i,!1),r=l.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,l=i.alternate,l===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=l.childLanes,i.lanes=l.lanes,i.child=l.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=l.memoizedProps,i.memoizedState=l.memoizedState,i.updateQueue=l.updateQueue,i.type=l.type,t=l.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return dr(Ir,Ir.current&1|2),e.child}t=t.sibling}i.tail!==null&&Vr()>md&&(e.flags|=128,r=!0,rh(i,!1),e.lanes=4194304)}else{if(!r)if(t=c0(l),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),rh(i,!0),i.tail===null&&i.tailMode==="hidden"&&!l.alternate&&!vr)return Ts(e),null}else 2*Vr()-i.renderingStartTime>md&&n!==1073741824&&(e.flags|=128,r=!0,rh(i,!1),e.lanes=4194304);i.isBackwards?(l.sibling=e.child,e.child=l):(n=i.last,n!==null?n.sibling=l:e.child=l,i.last=l)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Vr(),e.sibling=null,n=Ir.current,dr(Ir,r?n&1|2:n&1),e):(Ts(e),null);case 22:case 23:return U_(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?vi&1073741824&&(Ts(e),e.subtreeFlags&6&&(e.flags|=8192)):Ts(e),null;case 24:return null;case 25:return null}throw Error(Be(156,e.tag))}function N5(t,e){switch(v_(e),e.tag){case 1:return li(e.type)&&n0(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return hd(),yr(oi),yr(Ds),R_(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return N_(e),null;case 13:if(yr(Ir),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Be(340));ud()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return yr(Ir),null;case 4:return hd(),null;case 10:return A_(e.type._context),null;case 22:case 23:return U_(),null;case 24:return null;default:return null}}var Wm=!1,Ps=!1,R5=typeof WeakSet=="function"?WeakSet:Set,gt=null;function ju(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Dr(t,e,r)}else n.current=null}function xx(t,e,n){try{n()}catch(r){Dr(t,e,r)}}var HE=!1;function P5(t,e){if(tx=Zp,t=sS(),w_(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var l=0,h=-1,p=-1,y=0,_=0,E=t,T=null;t:for(;;){for(var k;E!==n||s!==0&&E.nodeType!==3||(h=l+s),E!==i||r!==0&&E.nodeType!==3||(p=l+r),E.nodeType===3&&(l+=E.nodeValue.length),(k=E.firstChild)!==null;)T=E,E=k;for(;;){if(E===t)break t;if(T===n&&++y===s&&(h=l),T===i&&++_===r&&(p=l),(k=E.nextSibling)!==null)break;E=T,T=E.parentNode}E=k}n=h===-1||p===-1?null:{start:h,end:p}}else n=null}n=n||{start:0,end:0}}else n=null;for(nx={focusedElem:t,selectionRange:n},Zp=!1,gt=e;gt!==null;)if(e=gt,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,gt=t;else for(;gt!==null;){e=gt;try{var L=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(L!==null){var B=L.memoizedProps,H=L.memoizedState,W=e.stateNode,M=W.getSnapshotBeforeUpdate(e.elementType===e.type?B:Yi(e.type,B),H);W.__reactInternalSnapshotBeforeUpdate=M}break;case 3:var U=e.stateNode.containerInfo;U.nodeType===1?U.textContent="":U.nodeType===9&&U.documentElement&&U.removeChild(U.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Be(163))}}catch($){Dr(e,e.return,$)}if(t=e.sibling,t!==null){t.return=e.return,gt=t;break}gt=e.return}return L=HE,HE=!1,L}function jh(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&xx(e,n,i)}s=s.next}while(s!==r)}}function Eg(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function wx(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function eN(t){var e=t.alternate;e!==null&&(t.alternate=null,eN(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Ia],delete e[uf],delete e[ix],delete e[f5],delete e[m5])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function tN(t){return t.tag===5||t.tag===3||t.tag===4}function GE(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||tN(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function _x(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=t0));else if(r!==4&&(t=t.child,t!==null))for(_x(t,e,n),t=t.sibling;t!==null;)_x(t,e,n),t=t.sibling}function vx(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(vx(t,e,n),t=t.sibling;t!==null;)vx(t,e,n),t=t.sibling}var ps=null,ta=!1;function Wo(t,e,n){for(n=n.child;n!==null;)nN(t,e,n),n=n.sibling}function nN(t,e,n){if(Ra&&typeof Ra.onCommitFiberUnmount=="function")try{Ra.onCommitFiberUnmount(mg,n)}catch{}switch(n.tag){case 5:Ps||ju(n,e);case 6:var r=ps,s=ta;ps=null,Wo(t,e,n),ps=r,ta=s,ps!==null&&(ta?(t=ps,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):ps.removeChild(n.stateNode));break;case 18:ps!==null&&(ta?(t=ps,n=n.stateNode,t.nodeType===8?H1(t.parentNode,n):t.nodeType===1&&H1(t,n),sf(t)):H1(ps,n.stateNode));break;case 4:r=ps,s=ta,ps=n.stateNode.containerInfo,ta=!0,Wo(t,e,n),ps=r,ta=s;break;case 0:case 11:case 14:case 15:if(!Ps&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,l=i.destroy;i=i.tag,l!==void 0&&(i&2||i&4)&&xx(n,e,l),s=s.next}while(s!==r)}Wo(t,e,n);break;case 1:if(!Ps&&(ju(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(h){Dr(n,e,h)}Wo(t,e,n);break;case 21:Wo(t,e,n);break;case 22:n.mode&1?(Ps=(r=Ps)||n.memoizedState!==null,Wo(t,e,n),Ps=r):Wo(t,e,n);break;default:Wo(t,e,n)}}function qE(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new R5),e.forEach(function(r){var s=B5.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Qi(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,l=e,h=l;e:for(;h!==null;){switch(h.tag){case 5:ps=h.stateNode,ta=!1;break e;case 3:ps=h.stateNode.containerInfo,ta=!0;break e;case 4:ps=h.stateNode.containerInfo,ta=!0;break e}h=h.return}if(ps===null)throw Error(Be(160));nN(i,l,s),ps=null,ta=!1;var p=s.alternate;p!==null&&(p.return=null),s.return=null}catch(y){Dr(s,e,y)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)rN(e,t),e=e.sibling}function rN(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Qi(e,t),wa(t),r&4){try{jh(3,t,t.return),Eg(3,t)}catch(B){Dr(t,t.return,B)}try{jh(5,t,t.return)}catch(B){Dr(t,t.return,B)}}break;case 1:Qi(e,t),wa(t),r&512&&n!==null&&ju(n,n.return);break;case 5:if(Qi(e,t),wa(t),r&512&&n!==null&&ju(n,n.return),t.flags&32){var s=t.stateNode;try{ef(s,"")}catch(B){Dr(t,t.return,B)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,l=n!==null?n.memoizedProps:i,h=t.type,p=t.updateQueue;if(t.updateQueue=null,p!==null)try{h==="input"&&i.type==="radio"&&i.name!=null&&AC(s,i),Hy(h,l);var y=Hy(h,i);for(l=0;l<p.length;l+=2){var _=p[l],E=p[l+1];_==="style"?RC(s,E):_==="dangerouslySetInnerHTML"?SC(s,E):_==="children"?ef(s,E):a_(s,_,E,y)}switch(h){case"input":By(s,i);break;case"textarea":TC(s,i);break;case"select":var T=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var k=i.value;k!=null?$u(s,!!i.multiple,k,!1):T!==!!i.multiple&&(i.defaultValue!=null?$u(s,!!i.multiple,i.defaultValue,!0):$u(s,!!i.multiple,i.multiple?[]:"",!1))}s[uf]=i}catch(B){Dr(t,t.return,B)}}break;case 6:if(Qi(e,t),wa(t),r&4){if(t.stateNode===null)throw Error(Be(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(B){Dr(t,t.return,B)}}break;case 3:if(Qi(e,t),wa(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{sf(e.containerInfo)}catch(B){Dr(t,t.return,B)}break;case 4:Qi(e,t),wa(t);break;case 13:Qi(e,t),wa(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(V_=Vr())),r&4&&qE(t);break;case 22:if(_=n!==null&&n.memoizedState!==null,t.mode&1?(Ps=(y=Ps)||_,Qi(e,t),Ps=y):Qi(e,t),wa(t),r&8192){if(y=t.memoizedState!==null,(t.stateNode.isHidden=y)&&!_&&t.mode&1)for(gt=t,_=t.child;_!==null;){for(E=gt=_;gt!==null;){switch(T=gt,k=T.child,T.tag){case 0:case 11:case 14:case 15:jh(4,T,T.return);break;case 1:ju(T,T.return);var L=T.stateNode;if(typeof L.componentWillUnmount=="function"){r=T,n=T.return;try{e=r,L.props=e.memoizedProps,L.state=e.memoizedState,L.componentWillUnmount()}catch(B){Dr(r,n,B)}}break;case 5:ju(T,T.return);break;case 22:if(T.memoizedState!==null){XE(E);continue}}k!==null?(k.return=T,gt=k):XE(E)}_=_.sibling}e:for(_=null,E=t;;){if(E.tag===5){if(_===null){_=E;try{s=E.stateNode,y?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(h=E.stateNode,p=E.memoizedProps.style,l=p!=null&&p.hasOwnProperty("display")?p.display:null,h.style.display=NC("display",l))}catch(B){Dr(t,t.return,B)}}}else if(E.tag===6){if(_===null)try{E.stateNode.nodeValue=y?"":E.memoizedProps}catch(B){Dr(t,t.return,B)}}else if((E.tag!==22&&E.tag!==23||E.memoizedState===null||E===t)&&E.child!==null){E.child.return=E,E=E.child;continue}if(E===t)break e;for(;E.sibling===null;){if(E.return===null||E.return===t)break e;_===E&&(_=null),E=E.return}_===E&&(_=null),E.sibling.return=E.return,E=E.sibling}}break;case 19:Qi(e,t),wa(t),r&4&&qE(t);break;case 21:break;default:Qi(e,t),wa(t)}}function wa(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(tN(n)){var r=n;break e}n=n.return}throw Error(Be(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(ef(s,""),r.flags&=-33);var i=GE(t);vx(t,i,s);break;case 3:case 4:var l=r.stateNode.containerInfo,h=GE(t);_x(t,h,l);break;default:throw Error(Be(161))}}catch(p){Dr(t,t.return,p)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function k5(t,e,n){gt=t,sN(t)}function sN(t,e,n){for(var r=(t.mode&1)!==0;gt!==null;){var s=gt,i=s.child;if(s.tag===22&&r){var l=s.memoizedState!==null||Wm;if(!l){var h=s.alternate,p=h!==null&&h.memoizedState!==null||Ps;h=Wm;var y=Ps;if(Wm=l,(Ps=p)&&!y)for(gt=s;gt!==null;)l=gt,p=l.child,l.tag===22&&l.memoizedState!==null?QE(s):p!==null?(p.return=l,gt=p):QE(s);for(;i!==null;)gt=i,sN(i),i=i.sibling;gt=s,Wm=h,Ps=y}KE(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,gt=i):KE(t)}}function KE(t){for(;gt!==null;){var e=gt;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Ps||Eg(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!Ps)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:Yi(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&kE(e,i,r);break;case 3:var l=e.updateQueue;if(l!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}kE(e,l,n)}break;case 5:var h=e.stateNode;if(n===null&&e.flags&4){n=h;var p=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":p.autoFocus&&n.focus();break;case"img":p.src&&(n.src=p.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var y=e.alternate;if(y!==null){var _=y.memoizedState;if(_!==null){var E=_.dehydrated;E!==null&&sf(E)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Be(163))}Ps||e.flags&512&&wx(e)}catch(T){Dr(e,e.return,T)}}if(e===t){gt=null;break}if(n=e.sibling,n!==null){n.return=e.return,gt=n;break}gt=e.return}}function XE(t){for(;gt!==null;){var e=gt;if(e===t){gt=null;break}var n=e.sibling;if(n!==null){n.return=e.return,gt=n;break}gt=e.return}}function QE(t){for(;gt!==null;){var e=gt;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Eg(4,e)}catch(p){Dr(e,n,p)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(p){Dr(e,s,p)}}var i=e.return;try{wx(e)}catch(p){Dr(e,i,p)}break;case 5:var l=e.return;try{wx(e)}catch(p){Dr(e,l,p)}}}catch(p){Dr(e,e.return,p)}if(e===t){gt=null;break}var h=e.sibling;if(h!==null){h.return=e.return,gt=h;break}gt=e.return}}var D5=Math.ceil,h0=Lo.ReactCurrentDispatcher,j_=Lo.ReactCurrentOwner,$i=Lo.ReactCurrentBatchConfig,Un=0,os=null,qr=null,xs=0,vi=0,Fu=Ul(0),Jr=0,gf=null,Lc=0,bg=0,F_=0,Fh=null,ni=null,V_=0,md=1/0,ro=null,f0=!1,Ex=null,_l=null,Hm=!1,dl=null,m0=0,Vh=0,bx=null,yp=-1,xp=0;function Us(){return Un&6?Vr():yp!==-1?yp:yp=Vr()}function vl(t){return t.mode&1?Un&2&&xs!==0?xs&-xs:g5.transition!==null?(xp===0&&(xp=$C()),xp):(t=Qn,t!==0||(t=window.event,t=t===void 0?16:XC(t.type)),t):1}function oa(t,e,n,r){if(50<Vh)throw Vh=0,bx=null,Error(Be(185));Xf(t,n,r),(!(Un&2)||t!==os)&&(t===os&&(!(Un&2)&&(bg|=n),Jr===4&&Jo(t,xs)),ci(t,r),n===1&&Un===0&&!(e.mode&1)&&(md=Vr()+500,wg&&$l()))}function ci(t,e){var n=t.callbackNode;gO(t,e);var r=Yp(t,t===os?xs:0);if(r===0)n!==null&&iE(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&iE(n),e===1)t.tag===0?p5(YE.bind(null,t)):mS(YE.bind(null,t)),d5(function(){!(Un&6)&&$l()}),n=null;else{switch(zC(r)){case 1:n=d_;break;case 4:n=BC;break;case 16:n=Qp;break;case 536870912:n=UC;break;default:n=Qp}n=hN(n,iN.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function iN(t,e){if(yp=-1,xp=0,Un&6)throw Error(Be(327));var n=t.callbackNode;if(qu()&&t.callbackNode!==n)return null;var r=Yp(t,t===os?xs:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=p0(t,r);else{e=r;var s=Un;Un|=2;var i=oN();(os!==t||xs!==e)&&(ro=null,md=Vr()+500,Sc(t,e));do try{L5();break}catch(h){aN(t,h)}while(!0);I_(),h0.current=i,Un=s,qr!==null?e=0:(os=null,xs=0,e=Jr)}if(e!==0){if(e===2&&(s=Qy(t),s!==0&&(r=s,e=Ix(t,s))),e===1)throw n=gf,Sc(t,0),Jo(t,r),ci(t,Vr()),n;if(e===6)Jo(t,r);else{if(s=t.current.alternate,!(r&30)&&!O5(s)&&(e=p0(t,r),e===2&&(i=Qy(t),i!==0&&(r=i,e=Ix(t,i))),e===1))throw n=gf,Sc(t,0),Jo(t,r),ci(t,Vr()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(Be(345));case 2:ic(t,ni,ro);break;case 3:if(Jo(t,r),(r&130023424)===r&&(e=V_+500-Vr(),10<e)){if(Yp(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){Us(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=sx(ic.bind(null,t,ni,ro),e);break}ic(t,ni,ro);break;case 4:if(Jo(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var l=31-aa(r);i=1<<l,l=e[l],l>s&&(s=l),r&=~i}if(r=s,r=Vr()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*D5(r/1960))-r,10<r){t.timeoutHandle=sx(ic.bind(null,t,ni,ro),r);break}ic(t,ni,ro);break;case 5:ic(t,ni,ro);break;default:throw Error(Be(329))}}}return ci(t,Vr()),t.callbackNode===n?iN.bind(null,t):null}function Ix(t,e){var n=Fh;return t.current.memoizedState.isDehydrated&&(Sc(t,e).flags|=256),t=p0(t,e),t!==2&&(e=ni,ni=n,e!==null&&Ax(e)),t}function Ax(t){ni===null?ni=t:ni.push.apply(ni,t)}function O5(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!ca(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Jo(t,e){for(e&=~F_,e&=~bg,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-aa(e),r=1<<n;t[n]=-1,e&=~r}}function YE(t){if(Un&6)throw Error(Be(327));qu();var e=Yp(t,0);if(!(e&1))return ci(t,Vr()),null;var n=p0(t,e);if(t.tag!==0&&n===2){var r=Qy(t);r!==0&&(e=r,n=Ix(t,r))}if(n===1)throw n=gf,Sc(t,0),Jo(t,e),ci(t,Vr()),n;if(n===6)throw Error(Be(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ic(t,ni,ro),ci(t,Vr()),null}function B_(t,e){var n=Un;Un|=1;try{return t(e)}finally{Un=n,Un===0&&(md=Vr()+500,wg&&$l())}}function jc(t){dl!==null&&dl.tag===0&&!(Un&6)&&qu();var e=Un;Un|=1;var n=$i.transition,r=Qn;try{if($i.transition=null,Qn=1,t)return t()}finally{Qn=r,$i.transition=n,Un=e,!(Un&6)&&$l()}}function U_(){vi=Fu.current,yr(Fu)}function Sc(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,u5(n)),qr!==null)for(n=qr.return;n!==null;){var r=n;switch(v_(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&n0();break;case 3:hd(),yr(oi),yr(Ds),R_();break;case 5:N_(r);break;case 4:hd();break;case 13:yr(Ir);break;case 19:yr(Ir);break;case 10:A_(r.type._context);break;case 22:case 23:U_()}n=n.return}if(os=t,qr=t=El(t.current,null),xs=vi=e,Jr=0,gf=null,F_=bg=Lc=0,ni=Fh=null,mc!==null){for(e=0;e<mc.length;e++)if(n=mc[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var l=i.next;i.next=s,r.next=l}n.pending=r}mc=null}return t}function aN(t,e){do{var n=qr;try{if(I_(),mp.current=d0,u0){for(var r=Tr.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}u0=!1}if(Mc=0,is=Zr=Tr=null,Lh=!1,ff=0,j_.current=null,n===null||n.return===null){Jr=1,gf=e,qr=null;break}e:{var i=t,l=n.return,h=n,p=e;if(e=xs,h.flags|=32768,p!==null&&typeof p=="object"&&typeof p.then=="function"){var y=p,_=h,E=_.tag;if(!(_.mode&1)&&(E===0||E===11||E===15)){var T=_.alternate;T?(_.updateQueue=T.updateQueue,_.memoizedState=T.memoizedState,_.lanes=T.lanes):(_.updateQueue=null,_.memoizedState=null)}var k=FE(l);if(k!==null){k.flags&=-257,VE(k,l,h,i,e),k.mode&1&&jE(i,y,e),e=k,p=y;var L=e.updateQueue;if(L===null){var B=new Set;B.add(p),e.updateQueue=B}else L.add(p);break e}else{if(!(e&1)){jE(i,y,e),$_();break e}p=Error(Be(426))}}else if(vr&&h.mode&1){var H=FE(l);if(H!==null){!(H.flags&65536)&&(H.flags|=256),VE(H,l,h,i,e),E_(fd(p,h));break e}}i=p=fd(p,h),Jr!==4&&(Jr=2),Fh===null?Fh=[i]:Fh.push(i),i=l;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var W=zS(i,p,e);PE(i,W);break e;case 1:h=p;var M=i.type,U=i.stateNode;if(!(i.flags&128)&&(typeof M.getDerivedStateFromError=="function"||U!==null&&typeof U.componentDidCatch=="function"&&(_l===null||!_l.has(U)))){i.flags|=65536,e&=-e,i.lanes|=e;var $=WS(i,h,e);PE(i,$);break e}}i=i.return}while(i!==null)}cN(n)}catch(K){e=K,qr===n&&n!==null&&(qr=n=n.return);continue}break}while(!0)}function oN(){var t=h0.current;return h0.current=d0,t===null?d0:t}function $_(){(Jr===0||Jr===3||Jr===2)&&(Jr=4),os===null||!(Lc&268435455)&&!(bg&268435455)||Jo(os,xs)}function p0(t,e){var n=Un;Un|=2;var r=oN();(os!==t||xs!==e)&&(ro=null,Sc(t,e));do try{M5();break}catch(s){aN(t,s)}while(!0);if(I_(),Un=n,h0.current=r,qr!==null)throw Error(Be(261));return os=null,xs=0,Jr}function M5(){for(;qr!==null;)lN(qr)}function L5(){for(;qr!==null&&!oO();)lN(qr)}function lN(t){var e=dN(t.alternate,t,vi);t.memoizedProps=t.pendingProps,e===null?cN(t):qr=e,j_.current=null}function cN(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=N5(n,e),n!==null){n.flags&=32767,qr=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Jr=6,qr=null;return}}else if(n=S5(n,e,vi),n!==null){qr=n;return}if(e=e.sibling,e!==null){qr=e;return}qr=e=t}while(e!==null);Jr===0&&(Jr=5)}function ic(t,e,n){var r=Qn,s=$i.transition;try{$i.transition=null,Qn=1,j5(t,e,n,r)}finally{$i.transition=s,Qn=r}return null}function j5(t,e,n,r){do qu();while(dl!==null);if(Un&6)throw Error(Be(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(Be(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(yO(t,i),t===os&&(qr=os=null,xs=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Hm||(Hm=!0,hN(Qp,function(){return qu(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=$i.transition,$i.transition=null;var l=Qn;Qn=1;var h=Un;Un|=4,j_.current=null,P5(t,n),rN(n,t),r5(nx),Zp=!!tx,nx=tx=null,t.current=n,k5(n),lO(),Un=h,Qn=l,$i.transition=i}else t.current=n;if(Hm&&(Hm=!1,dl=t,m0=s),i=t.pendingLanes,i===0&&(_l=null),dO(n.stateNode),ci(t,Vr()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(f0)throw f0=!1,t=Ex,Ex=null,t;return m0&1&&t.tag!==0&&qu(),i=t.pendingLanes,i&1?t===bx?Vh++:(Vh=0,bx=t):Vh=0,$l(),null}function qu(){if(dl!==null){var t=zC(m0),e=$i.transition,n=Qn;try{if($i.transition=null,Qn=16>t?16:t,dl===null)var r=!1;else{if(t=dl,dl=null,m0=0,Un&6)throw Error(Be(331));var s=Un;for(Un|=4,gt=t.current;gt!==null;){var i=gt,l=i.child;if(gt.flags&16){var h=i.deletions;if(h!==null){for(var p=0;p<h.length;p++){var y=h[p];for(gt=y;gt!==null;){var _=gt;switch(_.tag){case 0:case 11:case 15:jh(8,_,i)}var E=_.child;if(E!==null)E.return=_,gt=E;else for(;gt!==null;){_=gt;var T=_.sibling,k=_.return;if(eN(_),_===y){gt=null;break}if(T!==null){T.return=k,gt=T;break}gt=k}}}var L=i.alternate;if(L!==null){var B=L.child;if(B!==null){L.child=null;do{var H=B.sibling;B.sibling=null,B=H}while(B!==null)}}gt=i}}if(i.subtreeFlags&2064&&l!==null)l.return=i,gt=l;else e:for(;gt!==null;){if(i=gt,i.flags&2048)switch(i.tag){case 0:case 11:case 15:jh(9,i,i.return)}var W=i.sibling;if(W!==null){W.return=i.return,gt=W;break e}gt=i.return}}var M=t.current;for(gt=M;gt!==null;){l=gt;var U=l.child;if(l.subtreeFlags&2064&&U!==null)U.return=l,gt=U;else e:for(l=M;gt!==null;){if(h=gt,h.flags&2048)try{switch(h.tag){case 0:case 11:case 15:Eg(9,h)}}catch(K){Dr(h,h.return,K)}if(h===l){gt=null;break e}var $=h.sibling;if($!==null){$.return=h.return,gt=$;break e}gt=h.return}}if(Un=s,$l(),Ra&&typeof Ra.onPostCommitFiberRoot=="function")try{Ra.onPostCommitFiberRoot(mg,t)}catch{}r=!0}return r}finally{Qn=n,$i.transition=e}}return!1}function ZE(t,e,n){e=fd(n,e),e=zS(t,e,1),t=wl(t,e,1),e=Us(),t!==null&&(Xf(t,1,e),ci(t,e))}function Dr(t,e,n){if(t.tag===3)ZE(t,t,n);else for(;e!==null;){if(e.tag===3){ZE(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(_l===null||!_l.has(r))){t=fd(n,t),t=WS(e,t,1),e=wl(e,t,1),t=Us(),e!==null&&(Xf(e,1,t),ci(e,t));break}}e=e.return}}function F5(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Us(),t.pingedLanes|=t.suspendedLanes&n,os===t&&(xs&n)===n&&(Jr===4||Jr===3&&(xs&130023424)===xs&&500>Vr()-V_?Sc(t,0):F_|=n),ci(t,e)}function uN(t,e){e===0&&(t.mode&1?(e=Mm,Mm<<=1,!(Mm&130023424)&&(Mm=4194304)):e=1);var n=Us();t=Eo(t,e),t!==null&&(Xf(t,e,n),ci(t,n))}function V5(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),uN(t,n)}function B5(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(Be(314))}r!==null&&r.delete(e),uN(t,n)}var dN;dN=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||oi.current)ai=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return ai=!1,C5(t,e,n);ai=!!(t.flags&131072)}else ai=!1,vr&&e.flags&1048576&&pS(e,i0,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;gp(t,e),t=e.pendingProps;var s=cd(e,Ds.current);Gu(e,n),s=k_(null,e,r,t,s,n);var i=D_();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,li(r)?(i=!0,r0(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,C_(e),s.updater=vg,e.stateNode=s,s._reactInternals=e,dx(e,r,t,n),e=mx(null,e,r,!0,i,n)):(e.tag=0,vr&&i&&__(e),Fs(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(gp(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=$5(r),t=Yi(r,t),s){case 0:e=fx(null,e,r,t,n);break e;case 1:e=$E(null,e,r,t,n);break e;case 11:e=BE(null,e,r,t,n);break e;case 14:e=UE(null,e,r,Yi(r.type,t),n);break e}throw Error(Be(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Yi(r,s),fx(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Yi(r,s),$E(t,e,r,s,n);case 3:e:{if(KS(e),t===null)throw Error(Be(387));r=e.pendingProps,i=e.memoizedState,s=i.element,vS(t,e),l0(e,r,null,n);var l=e.memoizedState;if(r=l.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:l.cache,pendingSuspenseBoundaries:l.pendingSuspenseBoundaries,transitions:l.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=fd(Error(Be(423)),e),e=zE(t,e,r,n,s);break e}else if(r!==s){s=fd(Error(Be(424)),e),e=zE(t,e,r,n,s);break e}else for(Ai=xl(e.stateNode.containerInfo.firstChild),Ci=e,vr=!0,ra=null,n=wS(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(ud(),r===s){e=bo(t,e,n);break e}Fs(t,e,r,n)}e=e.child}return e;case 5:return ES(e),t===null&&lx(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,l=s.children,rx(r,s)?l=null:i!==null&&rx(r,i)&&(e.flags|=32),qS(t,e),Fs(t,e,l,n),e.child;case 6:return t===null&&lx(e),null;case 13:return XS(t,e,n);case 4:return S_(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=dd(e,null,r,n):Fs(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Yi(r,s),BE(t,e,r,s,n);case 7:return Fs(t,e,e.pendingProps,n),e.child;case 8:return Fs(t,e,e.pendingProps.children,n),e.child;case 12:return Fs(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,l=s.value,dr(a0,r._currentValue),r._currentValue=l,i!==null)if(ca(i.value,l)){if(i.children===s.children&&!oi.current){e=bo(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var h=i.dependencies;if(h!==null){l=i.child;for(var p=h.firstContext;p!==null;){if(p.context===r){if(i.tag===1){p=po(-1,n&-n),p.tag=2;var y=i.updateQueue;if(y!==null){y=y.shared;var _=y.pending;_===null?p.next=p:(p.next=_.next,_.next=p),y.pending=p}}i.lanes|=n,p=i.alternate,p!==null&&(p.lanes|=n),cx(i.return,n,e),h.lanes|=n;break}p=p.next}}else if(i.tag===10)l=i.type===e.type?null:i.child;else if(i.tag===18){if(l=i.return,l===null)throw Error(Be(341));l.lanes|=n,h=l.alternate,h!==null&&(h.lanes|=n),cx(l,n,e),l=i.sibling}else l=i.child;if(l!==null)l.return=i;else for(l=i;l!==null;){if(l===e){l=null;break}if(i=l.sibling,i!==null){i.return=l.return,l=i;break}l=l.return}i=l}Fs(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Gu(e,n),s=Wi(s),r=r(s),e.flags|=1,Fs(t,e,r,n),e.child;case 14:return r=e.type,s=Yi(r,e.pendingProps),s=Yi(r.type,s),UE(t,e,r,s,n);case 15:return HS(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Yi(r,s),gp(t,e),e.tag=1,li(r)?(t=!0,r0(e)):t=!1,Gu(e,n),$S(e,r,s),dx(e,r,s,n),mx(null,e,r,!0,t,n);case 19:return QS(t,e,n);case 22:return GS(t,e,n)}throw Error(Be(156,e.tag))};function hN(t,e){return VC(t,e)}function U5(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Vi(t,e,n,r){return new U5(t,e,n,r)}function z_(t){return t=t.prototype,!(!t||!t.isReactComponent)}function $5(t){if(typeof t=="function")return z_(t)?1:0;if(t!=null){if(t=t.$$typeof,t===l_)return 11;if(t===c_)return 14}return 2}function El(t,e){var n=t.alternate;return n===null?(n=Vi(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function wp(t,e,n,r,s,i){var l=2;if(r=t,typeof t=="function")z_(t)&&(l=1);else if(typeof t=="string")l=5;else e:switch(t){case Su:return Nc(n.children,s,i,e);case o_:l=8,s|=8;break;case My:return t=Vi(12,n,e,s|2),t.elementType=My,t.lanes=i,t;case Ly:return t=Vi(13,n,e,s),t.elementType=Ly,t.lanes=i,t;case jy:return t=Vi(19,n,e,s),t.elementType=jy,t.lanes=i,t;case EC:return Ig(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case _C:l=10;break e;case vC:l=9;break e;case l_:l=11;break e;case c_:l=14;break e;case Qo:l=16,r=null;break e}throw Error(Be(130,t==null?t:typeof t,""))}return e=Vi(l,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function Nc(t,e,n,r){return t=Vi(7,t,r,e),t.lanes=n,t}function Ig(t,e,n,r){return t=Vi(22,t,r,e),t.elementType=EC,t.lanes=n,t.stateNode={isHidden:!1},t}function J1(t,e,n){return t=Vi(6,t,null,e),t.lanes=n,t}function ey(t,e,n){return e=Vi(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function z5(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=O1(0),this.expirationTimes=O1(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=O1(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function W_(t,e,n,r,s,i,l,h,p){return t=new z5(t,e,n,h,p),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Vi(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},C_(i),t}function W5(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Cu,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function fN(t){if(!t)return kl;t=t._reactInternals;e:{if(eu(t)!==t||t.tag!==1)throw Error(Be(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(li(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Be(171))}if(t.tag===1){var n=t.type;if(li(n))return fS(t,n,e)}return e}function mN(t,e,n,r,s,i,l,h,p){return t=W_(n,r,!0,t,s,i,l,h,p),t.context=fN(null),n=t.current,r=Us(),s=vl(n),i=po(r,s),i.callback=e??null,wl(n,i,s),t.current.lanes=s,Xf(t,s,r),ci(t,r),t}function Ag(t,e,n,r){var s=e.current,i=Us(),l=vl(s);return n=fN(n),e.context===null?e.context=n:e.pendingContext=n,e=po(i,l),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=wl(s,e,l),t!==null&&(oa(t,s,l,i),fp(t,s,l)),l}function g0(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function JE(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function H_(t,e){JE(t,e),(t=t.alternate)&&JE(t,e)}function H5(){return null}var pN=typeof reportError=="function"?reportError:function(t){console.error(t)};function G_(t){this._internalRoot=t}Tg.prototype.render=G_.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Be(409));Ag(t,e,null,null)};Tg.prototype.unmount=G_.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;jc(function(){Ag(null,t,null,null)}),e[vo]=null}};function Tg(t){this._internalRoot=t}Tg.prototype.unstable_scheduleHydration=function(t){if(t){var e=GC();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Zo.length&&e!==0&&e<Zo[n].priority;n++);Zo.splice(n,0,t),n===0&&KC(t)}};function q_(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Cg(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function eb(){}function G5(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var y=g0(l);i.call(y)}}var l=mN(e,r,t,0,null,!1,!1,"",eb);return t._reactRootContainer=l,t[vo]=l.current,lf(t.nodeType===8?t.parentNode:t),jc(),l}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var h=r;r=function(){var y=g0(p);h.call(y)}}var p=W_(t,0,!1,null,null,!1,!1,"",eb);return t._reactRootContainer=p,t[vo]=p.current,lf(t.nodeType===8?t.parentNode:t),jc(function(){Ag(e,p,n,r)}),p}function Sg(t,e,n,r,s){var i=n._reactRootContainer;if(i){var l=i;if(typeof s=="function"){var h=s;s=function(){var p=g0(l);h.call(p)}}Ag(e,l,t,s)}else l=G5(n,e,t,s,r);return g0(l)}WC=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=mh(e.pendingLanes);n!==0&&(h_(e,n|1),ci(e,Vr()),!(Un&6)&&(md=Vr()+500,$l()))}break;case 13:jc(function(){var r=Eo(t,1);if(r!==null){var s=Us();oa(r,t,1,s)}}),H_(t,1)}};f_=function(t){if(t.tag===13){var e=Eo(t,134217728);if(e!==null){var n=Us();oa(e,t,134217728,n)}H_(t,134217728)}};HC=function(t){if(t.tag===13){var e=vl(t),n=Eo(t,e);if(n!==null){var r=Us();oa(n,t,e,r)}H_(t,e)}};GC=function(){return Qn};qC=function(t,e){var n=Qn;try{return Qn=t,e()}finally{Qn=n}};qy=function(t,e,n){switch(e){case"input":if(By(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=xg(r);if(!s)throw Error(Be(90));IC(r),By(r,s)}}}break;case"textarea":TC(t,n);break;case"select":e=n.value,e!=null&&$u(t,!!n.multiple,e,!1)}};DC=B_;OC=jc;var q5={usingClientEntryPoint:!1,Events:[Yf,ku,xg,PC,kC,B_]},sh={findFiberByHostInstance:fc,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},K5={bundleType:sh.bundleType,version:sh.version,rendererPackageName:sh.rendererPackageName,rendererConfig:sh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Lo.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=jC(t),t===null?null:t.stateNode},findFiberByHostInstance:sh.findFiberByHostInstance||H5,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Gm=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Gm.isDisabled&&Gm.supportsFiber)try{mg=Gm.inject(K5),Ra=Gm}catch{}}Ri.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=q5;Ri.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!q_(e))throw Error(Be(200));return W5(t,e,null,n)};Ri.createRoot=function(t,e){if(!q_(t))throw Error(Be(299));var n=!1,r="",s=pN;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=W_(t,1,!1,null,null,n,!1,r,s),t[vo]=e.current,lf(t.nodeType===8?t.parentNode:t),new G_(e)};Ri.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Be(188)):(t=Object.keys(t).join(","),Error(Be(268,t)));return t=jC(e),t=t===null?null:t.stateNode,t};Ri.flushSync=function(t){return jc(t)};Ri.hydrate=function(t,e,n){if(!Cg(e))throw Error(Be(200));return Sg(null,t,e,!0,n)};Ri.hydrateRoot=function(t,e,n){if(!q_(t))throw Error(Be(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",l=pN;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(l=n.onRecoverableError)),e=mN(e,null,t,1,n??null,s,!1,i,l),t[vo]=e.current,lf(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Tg(e)};Ri.render=function(t,e,n){if(!Cg(e))throw Error(Be(200));return Sg(null,t,e,!1,n)};Ri.unmountComponentAtNode=function(t){if(!Cg(t))throw Error(Be(40));return t._reactRootContainer?(jc(function(){Sg(null,null,t,!1,function(){t._reactRootContainer=null,t[vo]=null})}),!0):!1};Ri.unstable_batchedUpdates=B_;Ri.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Cg(n))throw Error(Be(200));if(t==null||t._reactInternals===void 0)throw Error(Be(38));return Sg(t,e,n,!1,r)};Ri.version="18.3.1-next-f1338f8080-20240426";function gN(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(gN)}catch(t){console.error(t)}}gN(),gC.exports=Ri;var K_=gC.exports;const X5=Jw(K_),Q5=Zw({__proto__:null,default:X5},[K_]);var tb=K_;Dy.createRoot=tb.createRoot,Dy.hydrateRoot=tb.hydrateRoot;/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _r(){return _r=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},_r.apply(this,arguments)}var Gr;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Gr||(Gr={}));const nb="popstate";function Y5(t){t===void 0&&(t={});function e(r,s){let{pathname:i,search:l,hash:h}=r.location;return yf("",{pathname:i,search:l,hash:h},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:Vc(s)}return J5(e,n,null,t)}function _n(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Fc(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function Z5(){return Math.random().toString(36).substr(2,8)}function rb(t,e){return{usr:t.state,key:t.key,idx:e}}function yf(t,e,n,r){return n===void 0&&(n=null),_r({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?zl(e):e,{state:n,key:e&&e.key||r||Z5()})}function Vc(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function zl(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function J5(t,e,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:i=!1}=r,l=s.history,h=Gr.Pop,p=null,y=_();y==null&&(y=0,l.replaceState(_r({},l.state,{idx:y}),""));function _(){return(l.state||{idx:null}).idx}function E(){h=Gr.Pop;let H=_(),W=H==null?null:H-y;y=H,p&&p({action:h,location:B.location,delta:W})}function T(H,W){h=Gr.Push;let M=yf(B.location,H,W);y=_()+1;let U=rb(M,y),$=B.createHref(M);try{l.pushState(U,"",$)}catch(K){if(K instanceof DOMException&&K.name==="DataCloneError")throw K;s.location.assign($)}i&&p&&p({action:h,location:B.location,delta:1})}function k(H,W){h=Gr.Replace;let M=yf(B.location,H,W);y=_();let U=rb(M,y),$=B.createHref(M);l.replaceState(U,"",$),i&&p&&p({action:h,location:B.location,delta:0})}function L(H){let W=s.location.origin!=="null"?s.location.origin:s.location.href,M=typeof H=="string"?H:Vc(H);return M=M.replace(/ $/,"%20"),_n(W,"No window.location.(origin|href) available to create URL for href: "+M),new URL(M,W)}let B={get action(){return h},get location(){return t(s,l)},listen(H){if(p)throw new Error("A history only accepts one active listener");return s.addEventListener(nb,E),p=H,()=>{s.removeEventListener(nb,E),p=null}},createHref(H){return e(s,H)},createURL:L,encodeLocation(H){let W=L(H);return{pathname:W.pathname,search:W.search,hash:W.hash}},push:T,replace:k,go(H){return l.go(H)}};return B}var Kn;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(Kn||(Kn={}));const e6=new Set(["lazy","caseSensitive","path","id","index","children"]);function t6(t){return t.index===!0}function y0(t,e,n,r){return n===void 0&&(n=[]),r===void 0&&(r={}),t.map((s,i)=>{let l=[...n,String(i)],h=typeof s.id=="string"?s.id:l.join("-");if(_n(s.index!==!0||!s.children,"Cannot specify children on an index route"),_n(!r[h],'Found a route id collision on id "'+h+`".  Route id's must be globally unique within Data Router usages`),t6(s)){let p=_r({},s,e(s),{id:h});return r[h]=p,p}else{let p=_r({},s,e(s),{id:h,children:void 0});return r[h]=p,s.children&&(p.children=y0(s.children,e,l,r)),p}})}function uc(t,e,n){return n===void 0&&(n="/"),_p(t,e,n,!1)}function _p(t,e,n,r){let s=typeof e=="string"?zl(e):e,i=Io(s.pathname||"/",n);if(i==null)return null;let l=yN(t);r6(l);let h=null;for(let p=0;h==null&&p<l.length;++p){let y=m6(i);h=h6(l[p],y,r)}return h}function n6(t,e){let{route:n,pathname:r,params:s}=t;return{id:n.id,pathname:r,params:s,data:e[n.id],handle:n.handle}}function yN(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(i,l,h)=>{let p={relativePath:h===void 0?i.path||"":h,caseSensitive:i.caseSensitive===!0,childrenIndex:l,route:i};p.relativePath.startsWith("/")&&(_n(p.relativePath.startsWith(r),'Absolute route path "'+p.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),p.relativePath=p.relativePath.slice(r.length));let y=go([r,p.relativePath]),_=n.concat(p);i.children&&i.children.length>0&&(_n(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+y+'".')),yN(i.children,e,_,y)),!(i.path==null&&!i.index)&&e.push({path:y,score:u6(y,i.index),routesMeta:_})};return t.forEach((i,l)=>{var h;if(i.path===""||!((h=i.path)!=null&&h.includes("?")))s(i,l);else for(let p of xN(i.path))s(i,l,p)}),e}function xN(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let l=xN(r.join("/")),h=[];return h.push(...l.map(p=>p===""?i:[i,p].join("/"))),s&&h.push(...l),h.map(p=>t.startsWith("/")&&p===""?"/":p)}function r6(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:d6(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const s6=/^:[\w-]+$/,i6=3,a6=2,o6=1,l6=10,c6=-2,sb=t=>t==="*";function u6(t,e){let n=t.split("/"),r=n.length;return n.some(sb)&&(r+=c6),e&&(r+=a6),n.filter(s=>!sb(s)).reduce((s,i)=>s+(s6.test(i)?i6:i===""?o6:l6),r)}function d6(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function h6(t,e,n){n===void 0&&(n=!1);let{routesMeta:r}=t,s={},i="/",l=[];for(let h=0;h<r.length;++h){let p=r[h],y=h===r.length-1,_=i==="/"?e:e.slice(i.length)||"/",E=x0({path:p.relativePath,caseSensitive:p.caseSensitive,end:y},_),T=p.route;if(!E&&y&&n&&!r[r.length-1].route.index&&(E=x0({path:p.relativePath,caseSensitive:p.caseSensitive,end:!1},_)),!E)return null;Object.assign(s,E.params),l.push({params:s,pathname:go([i,E.pathname]),pathnameBase:x6(go([i,E.pathnameBase])),route:T}),E.pathnameBase!=="/"&&(i=go([i,E.pathnameBase]))}return l}function x0(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=f6(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],l=i.replace(/(.)\/+$/,"$1"),h=s.slice(1);return{params:r.reduce((y,_,E)=>{let{paramName:T,isOptional:k}=_;if(T==="*"){let B=h[E]||"";l=i.slice(0,i.length-B.length).replace(/(.)\/+$/,"$1")}const L=h[E];return k&&!L?y[T]=void 0:y[T]=(L||"").replace(/%2F/g,"/"),y},{}),pathname:i,pathnameBase:l,pattern:t}}function f6(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),Fc(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(l,h,p)=>(r.push({paramName:h,isOptional:p!=null}),p?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function m6(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Fc(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function Io(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}const p6=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,g6=t=>p6.test(t);function y6(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?zl(t):t,i;if(n)if(g6(n))i=n;else{if(n.includes("//")){let l=n;n=n.replace(/\/\/+/g,"/"),Fc(!1,"Pathnames cannot have embedded double slashes - normalizing "+(l+" -> "+n))}n.startsWith("/")?i=ib(n.substring(1),"/"):i=ib(n,e)}else i=e;return{pathname:i,search:w6(r),hash:_6(s)}}function ib(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function ty(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function wN(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function Ng(t,e){let n=wN(t);return e?n.map((r,s)=>s===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function Rg(t,e,n,r){r===void 0&&(r=!1);let s;typeof t=="string"?s=zl(t):(s=_r({},t),_n(!s.pathname||!s.pathname.includes("?"),ty("?","pathname","search",s)),_n(!s.pathname||!s.pathname.includes("#"),ty("#","pathname","hash",s)),_n(!s.search||!s.search.includes("#"),ty("#","search","hash",s)));let i=t===""||s.pathname==="",l=i?"/":s.pathname,h;if(l==null)h=n;else{let E=e.length-1;if(!r&&l.startsWith("..")){let T=l.split("/");for(;T[0]==="..";)T.shift(),E-=1;s.pathname=T.join("/")}h=E>=0?e[E]:"/"}let p=y6(s,h),y=l&&l!=="/"&&l.endsWith("/"),_=(i||l===".")&&n.endsWith("/");return!p.pathname.endsWith("/")&&(y||_)&&(p.pathname+="/"),p}const go=t=>t.join("/").replace(/\/\/+/g,"/"),x6=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),w6=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,_6=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;class w0{constructor(e,n,r,s){s===void 0&&(s=!1),this.status=e,this.statusText=n||"",this.internal=s,r instanceof Error?(this.data=r.toString(),this.error=r):this.data=r}}function xf(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const _N=["post","put","patch","delete"],v6=new Set(_N),E6=["get",..._N],b6=new Set(E6),I6=new Set([301,302,303,307,308]),A6=new Set([307,308]),ny={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},T6={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},ih={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},X_=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,C6=t=>({hasErrorBoundary:!!t.hasErrorBoundary}),vN="remix-router-transitions";function S6(t){const e=t.window?t.window:typeof window<"u"?window:void 0,n=typeof e<"u"&&typeof e.document<"u"&&typeof e.document.createElement<"u",r=!n;_n(t.routes.length>0,"You must provide a non-empty routes array to createRouter");let s;if(t.mapRouteProperties)s=t.mapRouteProperties;else if(t.detectErrorBoundary){let ee=t.detectErrorBoundary;s=J=>({hasErrorBoundary:ee(J)})}else s=C6;let i={},l=y0(t.routes,s,void 0,i),h,p=t.basename||"/",y=t.dataStrategy||k6,_=t.patchRoutesOnNavigation,E=_r({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1,v7_skipActionErrorRevalidation:!1},t.future),T=null,k=new Set,L=null,B=null,H=null,W=t.hydrationData!=null,M=uc(l,t.history.location,p),U=!1,$=null;if(M==null&&!_){let ee=ti(404,{pathname:t.history.location.pathname}),{matches:J,route:oe}=gb(l);M=J,$={[oe.id]:ee}}M&&!t.hydrationData&&Bt(M,l,t.history.location.pathname).active&&(M=null);let K;if(M)if(M.some(ee=>ee.route.lazy))K=!1;else if(!M.some(ee=>ee.route.loader))K=!0;else if(E.v7_partialHydration){let ee=t.hydrationData?t.hydrationData.loaderData:null,J=t.hydrationData?t.hydrationData.errors:null;if(J){let oe=M.findIndex(_e=>J[_e.route.id]!==void 0);K=M.slice(0,oe+1).every(_e=>!Cx(_e.route,ee,J))}else K=M.every(oe=>!Cx(oe.route,ee,J))}else K=t.hydrationData!=null;else if(K=!1,M=[],E.v7_partialHydration){let ee=Bt(null,l,t.history.location.pathname);ee.active&&ee.matches&&(U=!0,M=ee.matches)}let Z,A={historyAction:t.history.action,location:t.history.location,matches:M,initialized:K,navigation:ny,restoreScrollPosition:t.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:t.hydrationData&&t.hydrationData.loaderData||{},actionData:t.hydrationData&&t.hydrationData.actionData||null,errors:t.hydrationData&&t.hydrationData.errors||$,fetchers:new Map,blockers:new Map},C=Gr.Pop,N=!1,D,O=!1,F=new Map,R=null,ie=!1,te=!1,je=[],We=new Set,Ee=new Map,qe=0,et=-1,Lt=new Map,Qe=new Set,rt=new Map,pe=new Map,ve=new Set,fe=new Map,ke=new Map,Ve;function Vt(){if(T=t.history.listen(ee=>{let{action:J,location:oe,delta:_e}=ee;if(Ve){Ve(),Ve=void 0;return}Fc(ke.size===0||_e!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let Se=Ie({currentLocation:A.location,nextLocation:oe,historyAction:J});if(Se&&_e!=null){let $e=new Promise(ge=>{Ve=ge});t.history.go(_e*-1),ce(Se,{state:"blocked",location:oe,proceed(){ce(Se,{state:"proceeding",proceed:void 0,reset:void 0,location:oe}),$e.then(()=>t.history.go(_e))},reset(){let ge=new Map(A.blockers);ge.set(Se,ih),xe({blockers:ge})}});return}return Ge(J,oe)}),n){G6(e,F);let ee=()=>q6(e,F);e.addEventListener("pagehide",ee),R=()=>e.removeEventListener("pagehide",ee)}return A.initialized||Ge(Gr.Pop,A.location,{initialHydration:!0}),Z}function qt(){T&&T(),R&&R(),k.clear(),D&&D.abort(),A.fetchers.forEach((ee,J)=>Xt(J)),A.blockers.forEach((ee,J)=>bt(J))}function yt(ee){return k.add(ee),()=>k.delete(ee)}function xe(ee,J){J===void 0&&(J={}),A=_r({},A,ee);let oe=[],_e=[];E.v7_fetcherPersist&&A.fetchers.forEach((Se,$e)=>{Se.state==="idle"&&(ve.has($e)?_e.push($e):oe.push($e))}),ve.forEach(Se=>{!A.fetchers.has(Se)&&!Ee.has(Se)&&_e.push(Se)}),[...k].forEach(Se=>Se(A,{deletedFetchers:_e,viewTransitionOpts:J.viewTransitionOpts,flushSync:J.flushSync===!0})),E.v7_fetcherPersist?(oe.forEach(Se=>A.fetchers.delete(Se)),_e.forEach(Se=>Xt(Se))):_e.forEach(Se=>ve.delete(Se))}function se(ee,J,oe){var _e,Se;let{flushSync:$e}=oe===void 0?{}:oe,ge=A.actionData!=null&&A.navigation.formMethod!=null&&na(A.navigation.formMethod)&&A.navigation.state==="loading"&&((_e=ee.state)==null?void 0:_e._isRedirect)!==!0,Ye;J.actionData?Object.keys(J.actionData).length>0?Ye=J.actionData:Ye=null:ge?Ye=A.actionData:Ye=null;let Ze=J.loaderData?mb(A.loaderData,J.loaderData,J.matches||[],J.errors):A.loaderData,Fe=A.blockers;Fe.size>0&&(Fe=new Map(Fe),Fe.forEach((St,lt)=>Fe.set(lt,ih)));let Je=N===!0||A.navigation.formMethod!=null&&na(A.navigation.formMethod)&&((Se=ee.state)==null?void 0:Se._isRedirect)!==!0;h&&(l=h,h=void 0),ie||C===Gr.Pop||(C===Gr.Push?t.history.push(ee,ee.state):C===Gr.Replace&&t.history.replace(ee,ee.state));let Ct;if(C===Gr.Pop){let St=F.get(A.location.pathname);St&&St.has(ee.pathname)?Ct={currentLocation:A.location,nextLocation:ee}:F.has(ee.pathname)&&(Ct={currentLocation:ee,nextLocation:A.location})}else if(O){let St=F.get(A.location.pathname);St?St.add(ee.pathname):(St=new Set([ee.pathname]),F.set(A.location.pathname,St)),Ct={currentLocation:A.location,nextLocation:ee}}xe(_r({},J,{actionData:Ye,loaderData:Ze,historyAction:C,location:ee,initialized:!0,navigation:ny,revalidation:"idle",restoreScrollPosition:wn(ee,J.matches||A.matches),preventScrollReset:Je,blockers:Fe}),{viewTransitionOpts:Ct,flushSync:$e===!0}),C=Gr.Pop,N=!1,O=!1,ie=!1,te=!1,je=[]}async function De(ee,J){if(typeof ee=="number"){t.history.go(ee);return}let oe=Tx(A.location,A.matches,p,E.v7_prependBasename,ee,E.v7_relativeSplatPath,J==null?void 0:J.fromRouteId,J==null?void 0:J.relative),{path:_e,submission:Se,error:$e}=ab(E.v7_normalizeFormMethod,!1,oe,J),ge=A.location,Ye=yf(A.location,_e,J&&J.state);Ye=_r({},Ye,t.history.encodeLocation(Ye));let Ze=J&&J.replace!=null?J.replace:void 0,Fe=Gr.Push;Ze===!0?Fe=Gr.Replace:Ze===!1||Se!=null&&na(Se.formMethod)&&Se.formAction===A.location.pathname+A.location.search&&(Fe=Gr.Replace);let Je=J&&"preventScrollReset"in J?J.preventScrollReset===!0:void 0,Ct=(J&&J.flushSync)===!0,St=Ie({currentLocation:ge,nextLocation:Ye,historyAction:Fe});if(St){ce(St,{state:"blocked",location:Ye,proceed(){ce(St,{state:"proceeding",proceed:void 0,reset:void 0,location:Ye}),De(ee,J)},reset(){let lt=new Map(A.blockers);lt.set(St,ih),xe({blockers:lt})}});return}return await Ge(Fe,Ye,{submission:Se,pendingError:$e,preventScrollReset:Je,replace:J&&J.replace,enableViewTransition:J&&J.viewTransition,flushSync:Ct})}function Oe(){if(ot(),xe({revalidation:"loading"}),A.navigation.state!=="submitting"){if(A.navigation.state==="idle"){Ge(A.historyAction,A.location,{startUninterruptedRevalidation:!0});return}Ge(C||A.historyAction,A.navigation.location,{overrideNavigation:A.navigation,enableViewTransition:O===!0})}}async function Ge(ee,J,oe){D&&D.abort(),D=null,C=ee,ie=(oe&&oe.startUninterruptedRevalidation)===!0,un(A.location,A.matches),N=(oe&&oe.preventScrollReset)===!0,O=(oe&&oe.enableViewTransition)===!0;let _e=h||l,Se=oe&&oe.overrideNavigation,$e=oe!=null&&oe.initialHydration&&A.matches&&A.matches.length>0&&!U?A.matches:uc(_e,J,p),ge=(oe&&oe.flushSync)===!0;if($e&&A.initialized&&!te&&F6(A.location,J)&&!(oe&&oe.submission&&na(oe.submission.formMethod))){se(J,{matches:$e},{flushSync:ge});return}let Ye=Bt($e,_e,J.pathname);if(Ye.active&&Ye.matches&&($e=Ye.matches),!$e){let{error:xt,notFoundMatches:Wt,route:Pt}=be(J.pathname);se(J,{matches:Wt,loaderData:{},errors:{[Pt.id]:xt}},{flushSync:ge});return}D=new AbortController;let Ze=mu(t.history,J,D.signal,oe&&oe.submission),Fe;if(oe&&oe.pendingError)Fe=[dc($e).route.id,{type:Kn.error,error:oe.pendingError}];else if(oe&&oe.submission&&na(oe.submission.formMethod)){let xt=await ht(Ze,J,oe.submission,$e,Ye.active,{replace:oe.replace,flushSync:ge});if(xt.shortCircuited)return;if(xt.pendingActionResult){let[Wt,Pt]=xt.pendingActionResult;if(Ei(Pt)&&xf(Pt.error)&&Pt.error.status===404){D=null,se(J,{matches:xt.matches,loaderData:{},errors:{[Wt]:Pt.error}});return}}$e=xt.matches||$e,Fe=xt.pendingActionResult,Se=ry(J,oe.submission),ge=!1,Ye.active=!1,Ze=mu(t.history,Ze.url,Ze.signal)}let{shortCircuited:Je,matches:Ct,loaderData:St,errors:lt}=await Et(Ze,J,$e,Ye.active,Se,oe&&oe.submission,oe&&oe.fetcherSubmission,oe&&oe.replace,oe&&oe.initialHydration===!0,ge,Fe);Je||(D=null,se(J,_r({matches:Ct||$e},pb(Fe),{loaderData:St,errors:lt})))}async function ht(ee,J,oe,_e,Se,$e){$e===void 0&&($e={}),ot();let ge=W6(J,oe);if(xe({navigation:ge},{flushSync:$e.flushSync===!0}),Se){let Fe=await Ht(_e,J.pathname,ee.signal);if(Fe.type==="aborted")return{shortCircuited:!0};if(Fe.type==="error"){let Je=dc(Fe.partialMatches).route.id;return{matches:Fe.partialMatches,pendingActionResult:[Je,{type:Kn.error,error:Fe.error}]}}else if(Fe.matches)_e=Fe.matches;else{let{notFoundMatches:Je,error:Ct,route:St}=be(J.pathname);return{matches:Je,pendingActionResult:[St.id,{type:Kn.error,error:Ct}]}}}let Ye,Ze=gh(_e,J);if(!Ze.route.action&&!Ze.route.lazy)Ye={type:Kn.error,error:ti(405,{method:ee.method,pathname:J.pathname,routeId:Ze.route.id})};else if(Ye=(await dn("action",A,ee,[Ze],_e,null))[Ze.route.id],ee.signal.aborted)return{shortCircuited:!0};if(gc(Ye)){let Fe;return $e&&$e.replace!=null?Fe=$e.replace:Fe=db(Ye.response.headers.get("Location"),new URL(ee.url),p)===A.location.pathname+A.location.search,await Ke(ee,Ye,!0,{submission:oe,replace:Fe}),{shortCircuited:!0}}if(hl(Ye))throw ti(400,{type:"defer-action"});if(Ei(Ye)){let Fe=dc(_e,Ze.route.id);return($e&&$e.replace)!==!0&&(C=Gr.Push),{matches:_e,pendingActionResult:[Fe.route.id,Ye]}}return{matches:_e,pendingActionResult:[Ze.route.id,Ye]}}async function Et(ee,J,oe,_e,Se,$e,ge,Ye,Ze,Fe,Je){let Ct=Se||ry(J,$e),St=$e||ge||xb(Ct),lt=!ie&&(!E.v7_partialHydration||!Ze);if(_e){if(lt){let ct=st(Je);xe(_r({navigation:Ct},ct!==void 0?{actionData:ct}:{}),{flushSync:Fe})}let en=await Ht(oe,J.pathname,ee.signal);if(en.type==="aborted")return{shortCircuited:!0};if(en.type==="error"){let ct=dc(en.partialMatches).route.id;return{matches:en.partialMatches,loaderData:{},errors:{[ct]:en.error}}}else if(en.matches)oe=en.matches;else{let{error:ct,notFoundMatches:It,route:Ut}=be(J.pathname);return{matches:It,loaderData:{},errors:{[Ut.id]:ct}}}}let xt=h||l,[Wt,Pt]=lb(t.history,A,oe,St,J,E.v7_partialHydration&&Ze===!0,E.v7_skipActionErrorRevalidation,te,je,We,ve,rt,Qe,xt,p,Je);if(Ce(en=>!(oe&&oe.some(ct=>ct.route.id===en))||Wt&&Wt.some(ct=>ct.route.id===en)),et=++qe,Wt.length===0&&Pt.length===0){let en=Tt();return se(J,_r({matches:oe,loaderData:{},errors:Je&&Ei(Je[1])?{[Je[0]]:Je[1].error}:null},pb(Je),en?{fetchers:new Map(A.fetchers)}:{}),{flushSync:Fe}),{shortCircuited:!0}}if(lt){let en={};if(!_e){en.navigation=Ct;let ct=st(Je);ct!==void 0&&(en.actionData=ct)}Pt.length>0&&(en.fetchers=me(Pt)),xe(en,{flushSync:Fe})}Pt.forEach(en=>{Mt(en.key),en.controller&&Ee.set(en.key,en.controller)});let bn=()=>Pt.forEach(en=>Mt(en.key));D&&D.signal.addEventListener("abort",bn);let{loaderResults:hn,fetcherResults:Er}=await tt(A,oe,Wt,Pt,ee);if(ee.signal.aborted)return{shortCircuited:!0};D&&D.signal.removeEventListener("abort",bn),Pt.forEach(en=>Ee.delete(en.key));let vn=qm(hn);if(vn)return await Ke(ee,vn.result,!0,{replace:Ye}),{shortCircuited:!0};if(vn=qm(Er),vn)return Qe.add(vn.key),await Ke(ee,vn.result,!0,{replace:Ye}),{shortCircuited:!0};let{loaderData:Qr,errors:Ae}=fb(A,oe,hn,Je,Pt,Er,fe);fe.forEach((en,ct)=>{en.subscribe(It=>{(It||en.done)&&fe.delete(ct)})}),E.v7_partialHydration&&Ze&&A.errors&&(Ae=_r({},A.errors,Ae));let jn=Tt(),Gt=Rt(et),Jn=jn||Gt||Pt.length>0;return _r({matches:oe,loaderData:Qr,errors:Ae},Jn?{fetchers:new Map(A.fetchers)}:{})}function st(ee){if(ee&&!Ei(ee[1]))return{[ee[0]]:ee[1].data};if(A.actionData)return Object.keys(A.actionData).length===0?null:A.actionData}function me(ee){return ee.forEach(J=>{let oe=A.fetchers.get(J.key),_e=ah(void 0,oe?oe.data:void 0);A.fetchers.set(J.key,_e)}),new Map(A.fetchers)}function ae(ee,J,oe,_e){if(r)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");Mt(ee);let Se=(_e&&_e.flushSync)===!0,$e=h||l,ge=Tx(A.location,A.matches,p,E.v7_prependBasename,oe,E.v7_relativeSplatPath,J,_e==null?void 0:_e.relative),Ye=uc($e,ge,p),Ze=Bt(Ye,$e,ge);if(Ze.active&&Ze.matches&&(Ye=Ze.matches),!Ye){Kt(ee,J,ti(404,{pathname:ge}),{flushSync:Se});return}let{path:Fe,submission:Je,error:Ct}=ab(E.v7_normalizeFormMethod,!0,ge,_e);if(Ct){Kt(ee,J,Ct,{flushSync:Se});return}let St=gh(Ye,Fe),lt=(_e&&_e.preventScrollReset)===!0;if(Je&&na(Je.formMethod)){ft(ee,J,Fe,St,Ye,Ze.active,Se,lt,Je);return}rt.set(ee,{routeId:J,path:Fe}),At(ee,J,Fe,St,Ye,Ze.active,Se,lt,Je)}async function ft(ee,J,oe,_e,Se,$e,ge,Ye,Ze){ot(),rt.delete(ee);function Fe(pn){if(!pn.route.action&&!pn.route.lazy){let hr=ti(405,{method:Ze.formMethod,pathname:oe,routeId:J});return Kt(ee,J,hr,{flushSync:ge}),!0}return!1}if(!$e&&Fe(_e))return;let Je=A.fetchers.get(ee);jt(ee,H6(Ze,Je),{flushSync:ge});let Ct=new AbortController,St=mu(t.history,oe,Ct.signal,Ze);if($e){let pn=await Ht(Se,new URL(St.url).pathname,St.signal,ee);if(pn.type==="aborted")return;if(pn.type==="error"){Kt(ee,J,pn.error,{flushSync:ge});return}else if(pn.matches){if(Se=pn.matches,_e=gh(Se,oe),Fe(_e))return}else{Kt(ee,J,ti(404,{pathname:oe}),{flushSync:ge});return}}Ee.set(ee,Ct);let lt=qe,Wt=(await dn("action",A,St,[_e],Se,ee))[_e.route.id];if(St.signal.aborted){Ee.get(ee)===Ct&&Ee.delete(ee);return}if(E.v7_fetcherPersist&&ve.has(ee)){if(gc(Wt)||Ei(Wt)){jt(ee,Ko(void 0));return}}else{if(gc(Wt))if(Ee.delete(ee),et>lt){jt(ee,Ko(void 0));return}else return Qe.add(ee),jt(ee,ah(Ze)),Ke(St,Wt,!1,{fetcherSubmission:Ze,preventScrollReset:Ye});if(Ei(Wt)){Kt(ee,J,Wt.error);return}}if(hl(Wt))throw ti(400,{type:"defer-action"});let Pt=A.navigation.location||A.location,bn=mu(t.history,Pt,Ct.signal),hn=h||l,Er=A.navigation.state!=="idle"?uc(hn,A.navigation.location,p):A.matches;_n(Er,"Didn't find any matches after fetcher action");let vn=++qe;Lt.set(ee,vn);let Qr=ah(Ze,Wt.data);A.fetchers.set(ee,Qr);let[Ae,jn]=lb(t.history,A,Er,Ze,Pt,!1,E.v7_skipActionErrorRevalidation,te,je,We,ve,rt,Qe,hn,p,[_e.route.id,Wt]);jn.filter(pn=>pn.key!==ee).forEach(pn=>{let hr=pn.key,qs=A.fetchers.get(hr),Hn=ah(void 0,qs?qs.data:void 0);A.fetchers.set(hr,Hn),Mt(hr),pn.controller&&Ee.set(hr,pn.controller)}),xe({fetchers:new Map(A.fetchers)});let Gt=()=>jn.forEach(pn=>Mt(pn.key));Ct.signal.addEventListener("abort",Gt);let{loaderResults:Jn,fetcherResults:en}=await tt(A,Er,Ae,jn,bn);if(Ct.signal.aborted)return;Ct.signal.removeEventListener("abort",Gt),Lt.delete(ee),Ee.delete(ee),jn.forEach(pn=>Ee.delete(pn.key));let ct=qm(Jn);if(ct)return Ke(bn,ct.result,!1,{preventScrollReset:Ye});if(ct=qm(en),ct)return Qe.add(ct.key),Ke(bn,ct.result,!1,{preventScrollReset:Ye});let{loaderData:It,errors:Ut}=fb(A,Er,Jn,void 0,jn,en,fe);if(A.fetchers.has(ee)){let pn=Ko(Wt.data);A.fetchers.set(ee,pn)}Rt(vn),A.navigation.state==="loading"&&vn>et?(_n(C,"Expected pending action"),D&&D.abort(),se(A.navigation.location,{matches:Er,loaderData:It,errors:Ut,fetchers:new Map(A.fetchers)})):(xe({errors:Ut,loaderData:mb(A.loaderData,It,Er,Ut),fetchers:new Map(A.fetchers)}),te=!1)}async function At(ee,J,oe,_e,Se,$e,ge,Ye,Ze){let Fe=A.fetchers.get(ee);jt(ee,ah(Ze,Fe?Fe.data:void 0),{flushSync:ge});let Je=new AbortController,Ct=mu(t.history,oe,Je.signal);if($e){let Wt=await Ht(Se,new URL(Ct.url).pathname,Ct.signal,ee);if(Wt.type==="aborted")return;if(Wt.type==="error"){Kt(ee,J,Wt.error,{flushSync:ge});return}else if(Wt.matches)Se=Wt.matches,_e=gh(Se,oe);else{Kt(ee,J,ti(404,{pathname:oe}),{flushSync:ge});return}}Ee.set(ee,Je);let St=qe,xt=(await dn("loader",A,Ct,[_e],Se,ee))[_e.route.id];if(hl(xt)&&(xt=await Q_(xt,Ct.signal,!0)||xt),Ee.get(ee)===Je&&Ee.delete(ee),!Ct.signal.aborted){if(ve.has(ee)){jt(ee,Ko(void 0));return}if(gc(xt))if(et>St){jt(ee,Ko(void 0));return}else{Qe.add(ee),await Ke(Ct,xt,!1,{preventScrollReset:Ye});return}if(Ei(xt)){Kt(ee,J,xt.error);return}_n(!hl(xt),"Unhandled fetcher deferred data"),jt(ee,Ko(xt.data))}}async function Ke(ee,J,oe,_e){let{submission:Se,fetcherSubmission:$e,preventScrollReset:ge,replace:Ye}=_e===void 0?{}:_e;J.response.headers.has("X-Remix-Revalidate")&&(te=!0);let Ze=J.response.headers.get("Location");_n(Ze,"Expected a Location header on the redirect Response"),Ze=db(Ze,new URL(ee.url),p);let Fe=yf(A.location,Ze,{_isRedirect:!0});if(n){let Wt=!1;if(J.response.headers.has("X-Remix-Reload-Document"))Wt=!0;else if(X_.test(Ze)){const Pt=t.history.createURL(Ze);Wt=Pt.origin!==e.location.origin||Io(Pt.pathname,p)==null}if(Wt){Ye?e.location.replace(Ze):e.location.assign(Ze);return}}D=null;let Je=Ye===!0||J.response.headers.has("X-Remix-Replace")?Gr.Replace:Gr.Push,{formMethod:Ct,formAction:St,formEncType:lt}=A.navigation;!Se&&!$e&&Ct&&St&&lt&&(Se=xb(A.navigation));let xt=Se||$e;if(A6.has(J.response.status)&&xt&&na(xt.formMethod))await Ge(Je,Fe,{submission:_r({},xt,{formAction:Ze}),preventScrollReset:ge||N,enableViewTransition:oe?O:void 0});else{let Wt=ry(Fe,Se);await Ge(Je,Fe,{overrideNavigation:Wt,fetcherSubmission:$e,preventScrollReset:ge||N,enableViewTransition:oe?O:void 0})}}async function dn(ee,J,oe,_e,Se,$e){let ge,Ye={};try{ge=await D6(y,ee,J,oe,_e,Se,$e,i,s)}catch(Ze){return _e.forEach(Fe=>{Ye[Fe.route.id]={type:Kn.error,error:Ze}}),Ye}for(let[Ze,Fe]of Object.entries(ge))if(V6(Fe)){let Je=Fe.result;Ye[Ze]={type:Kn.redirect,response:L6(Je,oe,Ze,Se,p,E.v7_relativeSplatPath)}}else Ye[Ze]=await M6(Fe);return Ye}async function tt(ee,J,oe,_e,Se){let $e=ee.matches,ge=dn("loader",ee,Se,oe,J,null),Ye=Promise.all(_e.map(async Je=>{if(Je.matches&&Je.match&&Je.controller){let St=(await dn("loader",ee,mu(t.history,Je.path,Je.controller.signal),[Je.match],Je.matches,Je.key))[Je.match.route.id];return{[Je.key]:St}}else return Promise.resolve({[Je.key]:{type:Kn.error,error:ti(404,{pathname:Je.path})}})})),Ze=await ge,Fe=(await Ye).reduce((Je,Ct)=>Object.assign(Je,Ct),{});return await Promise.all([$6(J,Ze,Se.signal,$e,ee.loaderData),z6(J,Fe,_e)]),{loaderResults:Ze,fetcherResults:Fe}}function ot(){te=!0,je.push(...Ce()),rt.forEach((ee,J)=>{Ee.has(J)&&We.add(J),Mt(J)})}function jt(ee,J,oe){oe===void 0&&(oe={}),A.fetchers.set(ee,J),xe({fetchers:new Map(A.fetchers)},{flushSync:(oe&&oe.flushSync)===!0})}function Kt(ee,J,oe,_e){_e===void 0&&(_e={});let Se=dc(A.matches,J);Xt(ee),xe({errors:{[Se.route.id]:oe},fetchers:new Map(A.fetchers)},{flushSync:(_e&&_e.flushSync)===!0})}function ar(ee){return pe.set(ee,(pe.get(ee)||0)+1),ve.has(ee)&&ve.delete(ee),A.fetchers.get(ee)||T6}function Xt(ee){let J=A.fetchers.get(ee);Ee.has(ee)&&!(J&&J.state==="loading"&&Lt.has(ee))&&Mt(ee),rt.delete(ee),Lt.delete(ee),Qe.delete(ee),E.v7_fetcherPersist&&ve.delete(ee),We.delete(ee),A.fetchers.delete(ee)}function xn(ee){let J=(pe.get(ee)||0)-1;J<=0?(pe.delete(ee),ve.add(ee),E.v7_fetcherPersist||Xt(ee)):pe.set(ee,J),xe({fetchers:new Map(A.fetchers)})}function Mt(ee){let J=Ee.get(ee);J&&(J.abort(),Ee.delete(ee))}function we(ee){for(let J of ee){let oe=ar(J),_e=Ko(oe.data);A.fetchers.set(J,_e)}}function Tt(){let ee=[],J=!1;for(let oe of Qe){let _e=A.fetchers.get(oe);_n(_e,"Expected fetcher: "+oe),_e.state==="loading"&&(Qe.delete(oe),ee.push(oe),J=!0)}return we(ee),J}function Rt(ee){let J=[];for(let[oe,_e]of Lt)if(_e<ee){let Se=A.fetchers.get(oe);_n(Se,"Expected fetcher: "+oe),Se.state==="loading"&&(Mt(oe),Lt.delete(oe),J.push(oe))}return we(J),J.length>0}function wt(ee,J){let oe=A.blockers.get(ee)||ih;return ke.get(ee)!==J&&ke.set(ee,J),oe}function bt(ee){A.blockers.delete(ee),ke.delete(ee)}function ce(ee,J){let oe=A.blockers.get(ee)||ih;_n(oe.state==="unblocked"&&J.state==="blocked"||oe.state==="blocked"&&J.state==="blocked"||oe.state==="blocked"&&J.state==="proceeding"||oe.state==="blocked"&&J.state==="unblocked"||oe.state==="proceeding"&&J.state==="unblocked","Invalid blocker state transition: "+oe.state+" -> "+J.state);let _e=new Map(A.blockers);_e.set(ee,J),xe({blockers:_e})}function Ie(ee){let{currentLocation:J,nextLocation:oe,historyAction:_e}=ee;if(ke.size===0)return;ke.size>1&&Fc(!1,"A router only supports one blocker at a time");let Se=Array.from(ke.entries()),[$e,ge]=Se[Se.length-1],Ye=A.blockers.get($e);if(!(Ye&&Ye.state==="proceeding")&&ge({currentLocation:J,nextLocation:oe,historyAction:_e}))return $e}function be(ee){let J=ti(404,{pathname:ee}),oe=h||l,{matches:_e,route:Se}=gb(oe);return Ce(),{notFoundMatches:_e,route:Se,error:J}}function Ce(ee){let J=[];return fe.forEach((oe,_e)=>{(!ee||ee(_e))&&(oe.cancel(),J.push(_e),fe.delete(_e))}),J}function it(ee,J,oe){if(L=ee,H=J,B=oe||null,!W&&A.navigation===ny){W=!0;let _e=wn(A.location,A.matches);_e!=null&&xe({restoreScrollPosition:_e})}return()=>{L=null,H=null,B=null}}function He(ee,J){return B&&B(ee,J.map(_e=>n6(_e,A.loaderData)))||ee.key}function un(ee,J){if(L&&H){let oe=He(ee,J);L[oe]=H()}}function wn(ee,J){if(L){let oe=He(ee,J),_e=L[oe];if(typeof _e=="number")return _e}return null}function Bt(ee,J,oe){if(_)if(ee){if(Object.keys(ee[0].params).length>0)return{active:!0,matches:_p(J,oe,p,!0)}}else return{active:!0,matches:_p(J,oe,p,!0)||[]};return{active:!1,matches:null}}async function Ht(ee,J,oe,_e){if(!_)return{type:"success",matches:ee};let Se=ee;for(;;){let $e=h==null,ge=h||l,Ye=i;try{await _({signal:oe,path:J,matches:Se,fetcherKey:_e,patch:(Je,Ct)=>{oe.aborted||ub(Je,Ct,ge,Ye,s)}})}catch(Je){return{type:"error",error:Je,partialMatches:Se}}finally{$e&&!oe.aborted&&(l=[...l])}if(oe.aborted)return{type:"aborted"};let Ze=uc(ge,J,p);if(Ze)return{type:"success",matches:Ze};let Fe=_p(ge,J,p,!0);if(!Fe||Se.length===Fe.length&&Se.every((Je,Ct)=>Je.route.id===Fe[Ct].route.id))return{type:"success",matches:null};Se=Fe}}function Rn(ee){i={},h=y0(ee,s,void 0,i)}function nt(ee,J){let oe=h==null;ub(ee,J,h||l,i,s),oe&&(l=[...l],xe({}))}return Z={get basename(){return p},get future(){return E},get state(){return A},get routes(){return l},get window(){return e},initialize:Vt,subscribe:yt,enableScrollRestoration:it,navigate:De,fetch:ae,revalidate:Oe,createHref:ee=>t.history.createHref(ee),encodeLocation:ee=>t.history.encodeLocation(ee),getFetcher:ar,deleteFetcher:xn,dispose:qt,getBlocker:wt,deleteBlocker:bt,patchRoutes:nt,_internalFetchControllers:Ee,_internalActiveDeferreds:fe,_internalSetRoutes:Rn},Z}function N6(t){return t!=null&&("formData"in t&&t.formData!=null||"body"in t&&t.body!==void 0)}function Tx(t,e,n,r,s,i,l,h){let p,y;if(l){p=[];for(let E of e)if(p.push(E),E.route.id===l){y=E;break}}else p=e,y=e[e.length-1];let _=Rg(s||".",Ng(p,i),Io(t.pathname,n)||t.pathname,h==="path");if(s==null&&(_.search=t.search,_.hash=t.hash),(s==null||s===""||s===".")&&y){let E=Y_(_.search);if(y.route.index&&!E)_.search=_.search?_.search.replace(/^\?/,"?index&"):"?index";else if(!y.route.index&&E){let T=new URLSearchParams(_.search),k=T.getAll("index");T.delete("index"),k.filter(B=>B).forEach(B=>T.append("index",B));let L=T.toString();_.search=L?"?"+L:""}}return r&&n!=="/"&&(_.pathname=_.pathname==="/"?n:go([n,_.pathname])),Vc(_)}function ab(t,e,n,r){if(!r||!N6(r))return{path:n};if(r.formMethod&&!U6(r.formMethod))return{path:n,error:ti(405,{method:r.formMethod})};let s=()=>({path:n,error:ti(400,{type:"invalid-body"})}),i=r.formMethod||"get",l=t?i.toUpperCase():i.toLowerCase(),h=IN(n);if(r.body!==void 0){if(r.formEncType==="text/plain"){if(!na(l))return s();let T=typeof r.body=="string"?r.body:r.body instanceof FormData||r.body instanceof URLSearchParams?Array.from(r.body.entries()).reduce((k,L)=>{let[B,H]=L;return""+k+B+"="+H+`
`},""):String(r.body);return{path:n,submission:{formMethod:l,formAction:h,formEncType:r.formEncType,formData:void 0,json:void 0,text:T}}}else if(r.formEncType==="application/json"){if(!na(l))return s();try{let T=typeof r.body=="string"?JSON.parse(r.body):r.body;return{path:n,submission:{formMethod:l,formAction:h,formEncType:r.formEncType,formData:void 0,json:T,text:void 0}}}catch{return s()}}}_n(typeof FormData=="function","FormData is not available in this environment");let p,y;if(r.formData)p=Sx(r.formData),y=r.formData;else if(r.body instanceof FormData)p=Sx(r.body),y=r.body;else if(r.body instanceof URLSearchParams)p=r.body,y=hb(p);else if(r.body==null)p=new URLSearchParams,y=new FormData;else try{p=new URLSearchParams(r.body),y=hb(p)}catch{return s()}let _={formMethod:l,formAction:h,formEncType:r&&r.formEncType||"application/x-www-form-urlencoded",formData:y,json:void 0,text:void 0};if(na(_.formMethod))return{path:n,submission:_};let E=zl(n);return e&&E.search&&Y_(E.search)&&p.append("index",""),E.search="?"+p,{path:Vc(E),submission:_}}function ob(t,e,n){n===void 0&&(n=!1);let r=t.findIndex(s=>s.route.id===e);return r>=0?t.slice(0,n?r+1:r):t}function lb(t,e,n,r,s,i,l,h,p,y,_,E,T,k,L,B){let H=B?Ei(B[1])?B[1].error:B[1].data:void 0,W=t.createURL(e.location),M=t.createURL(s),U=n;i&&e.errors?U=ob(n,Object.keys(e.errors)[0],!0):B&&Ei(B[1])&&(U=ob(n,B[0]));let $=B?B[1].statusCode:void 0,K=l&&$&&$>=400,Z=U.filter((C,N)=>{let{route:D}=C;if(D.lazy)return!0;if(D.loader==null)return!1;if(i)return Cx(D,e.loaderData,e.errors);if(R6(e.loaderData,e.matches[N],C)||p.some(R=>R===C.route.id))return!0;let O=e.matches[N],F=C;return cb(C,_r({currentUrl:W,currentParams:O.params,nextUrl:M,nextParams:F.params},r,{actionResult:H,actionStatus:$,defaultShouldRevalidate:K?!1:h||W.pathname+W.search===M.pathname+M.search||W.search!==M.search||EN(O,F)}))}),A=[];return E.forEach((C,N)=>{if(i||!n.some(ie=>ie.route.id===C.routeId)||_.has(N))return;let D=uc(k,C.path,L);if(!D){A.push({key:N,routeId:C.routeId,path:C.path,matches:null,match:null,controller:null});return}let O=e.fetchers.get(N),F=gh(D,C.path),R=!1;T.has(N)?R=!1:y.has(N)?(y.delete(N),R=!0):O&&O.state!=="idle"&&O.data===void 0?R=h:R=cb(F,_r({currentUrl:W,currentParams:e.matches[e.matches.length-1].params,nextUrl:M,nextParams:n[n.length-1].params},r,{actionResult:H,actionStatus:$,defaultShouldRevalidate:K?!1:h})),R&&A.push({key:N,routeId:C.routeId,path:C.path,matches:D,match:F,controller:new AbortController})}),[Z,A]}function Cx(t,e,n){if(t.lazy)return!0;if(!t.loader)return!1;let r=e!=null&&e[t.id]!==void 0,s=n!=null&&n[t.id]!==void 0;return!r&&s?!1:typeof t.loader=="function"&&t.loader.hydrate===!0?!0:!r&&!s}function R6(t,e,n){let r=!e||n.route.id!==e.route.id,s=t[n.route.id]===void 0;return r||s}function EN(t,e){let n=t.route.path;return t.pathname!==e.pathname||n!=null&&n.endsWith("*")&&t.params["*"]!==e.params["*"]}function cb(t,e){if(t.route.shouldRevalidate){let n=t.route.shouldRevalidate(e);if(typeof n=="boolean")return n}return e.defaultShouldRevalidate}function ub(t,e,n,r,s){var i;let l;if(t){let y=r[t];_n(y,"No route found to patch children into: routeId = "+t),y.children||(y.children=[]),l=y.children}else l=n;let h=e.filter(y=>!l.some(_=>bN(y,_))),p=y0(h,s,[t||"_","patch",String(((i=l)==null?void 0:i.length)||"0")],r);l.push(...p)}function bN(t,e){return"id"in t&&"id"in e&&t.id===e.id?!0:t.index===e.index&&t.path===e.path&&t.caseSensitive===e.caseSensitive?(!t.children||t.children.length===0)&&(!e.children||e.children.length===0)?!0:t.children.every((n,r)=>{var s;return(s=e.children)==null?void 0:s.some(i=>bN(n,i))}):!1}async function P6(t,e,n){if(!t.lazy)return;let r=await t.lazy();if(!t.lazy)return;let s=n[t.id];_n(s,"No route found in manifest");let i={};for(let l in r){let p=s[l]!==void 0&&l!=="hasErrorBoundary";Fc(!p,'Route "'+s.id+'" has a static property "'+l+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+l+'" will be ignored.')),!p&&!e6.has(l)&&(i[l]=r[l])}Object.assign(s,i),Object.assign(s,_r({},e(s),{lazy:void 0}))}async function k6(t){let{matches:e}=t,n=e.filter(s=>s.shouldLoad);return(await Promise.all(n.map(s=>s.resolve()))).reduce((s,i,l)=>Object.assign(s,{[n[l].route.id]:i}),{})}async function D6(t,e,n,r,s,i,l,h,p,y){let _=i.map(k=>k.route.lazy?P6(k.route,p,h):void 0),E=i.map((k,L)=>{let B=_[L],H=s.some(M=>M.route.id===k.route.id);return _r({},k,{shouldLoad:H,resolve:async M=>(M&&r.method==="GET"&&(k.route.lazy||k.route.loader)&&(H=!0),H?O6(e,r,k,B,M,y):Promise.resolve({type:Kn.data,result:void 0}))})}),T=await t({matches:E,request:r,params:i[0].params,fetcherKey:l,context:y});try{await Promise.all(_)}catch{}return T}async function O6(t,e,n,r,s,i){let l,h,p=y=>{let _,E=new Promise((L,B)=>_=B);h=()=>_(),e.signal.addEventListener("abort",h);let T=L=>typeof y!="function"?Promise.reject(new Error("You cannot call the handler for a route which defines a boolean "+('"'+t+'" [routeId: '+n.route.id+"]"))):y({request:e,params:n.params,context:i},...L!==void 0?[L]:[]),k=(async()=>{try{return{type:"data",result:await(s?s(B=>T(B)):T())}}catch(L){return{type:"error",result:L}}})();return Promise.race([k,E])};try{let y=n.route[t];if(r)if(y){let _,[E]=await Promise.all([p(y).catch(T=>{_=T}),r]);if(_!==void 0)throw _;l=E}else if(await r,y=n.route[t],y)l=await p(y);else if(t==="action"){let _=new URL(e.url),E=_.pathname+_.search;throw ti(405,{method:e.method,pathname:E,routeId:n.route.id})}else return{type:Kn.data,result:void 0};else if(y)l=await p(y);else{let _=new URL(e.url),E=_.pathname+_.search;throw ti(404,{pathname:E})}_n(l.result!==void 0,"You defined "+(t==="action"?"an action":"a loader")+" for route "+('"'+n.route.id+"\" but didn't return anything from your `"+t+"` ")+"function. Please return a value or `null`.")}catch(y){return{type:Kn.error,result:y}}finally{h&&e.signal.removeEventListener("abort",h)}return l}async function M6(t){let{result:e,type:n}=t;if(AN(e)){let E;try{let T=e.headers.get("Content-Type");T&&/\bapplication\/json\b/.test(T)?e.body==null?E=null:E=await e.json():E=await e.text()}catch(T){return{type:Kn.error,error:T}}return n===Kn.error?{type:Kn.error,error:new w0(e.status,e.statusText,E),statusCode:e.status,headers:e.headers}:{type:Kn.data,data:E,statusCode:e.status,headers:e.headers}}if(n===Kn.error){if(yb(e)){var r,s;if(e.data instanceof Error){var i,l;return{type:Kn.error,error:e.data,statusCode:(i=e.init)==null?void 0:i.status,headers:(l=e.init)!=null&&l.headers?new Headers(e.init.headers):void 0}}return{type:Kn.error,error:new w0(((r=e.init)==null?void 0:r.status)||500,void 0,e.data),statusCode:xf(e)?e.status:void 0,headers:(s=e.init)!=null&&s.headers?new Headers(e.init.headers):void 0}}return{type:Kn.error,error:e,statusCode:xf(e)?e.status:void 0}}if(B6(e)){var h,p;return{type:Kn.deferred,deferredData:e,statusCode:(h=e.init)==null?void 0:h.status,headers:((p=e.init)==null?void 0:p.headers)&&new Headers(e.init.headers)}}if(yb(e)){var y,_;return{type:Kn.data,data:e.data,statusCode:(y=e.init)==null?void 0:y.status,headers:(_=e.init)!=null&&_.headers?new Headers(e.init.headers):void 0}}return{type:Kn.data,data:e}}function L6(t,e,n,r,s,i){let l=t.headers.get("Location");if(_n(l,"Redirects returned/thrown from loaders/actions must have a Location header"),!X_.test(l)){let h=r.slice(0,r.findIndex(p=>p.route.id===n)+1);l=Tx(new URL(e.url),h,s,!0,l,i),t.headers.set("Location",l)}return t}function db(t,e,n){if(X_.test(t)){let r=t,s=r.startsWith("//")?new URL(e.protocol+r):new URL(r),i=Io(s.pathname,n)!=null;if(s.origin===e.origin&&i)return s.pathname+s.search+s.hash}return t}function mu(t,e,n,r){let s=t.createURL(IN(e)).toString(),i={signal:n};if(r&&na(r.formMethod)){let{formMethod:l,formEncType:h}=r;i.method=l.toUpperCase(),h==="application/json"?(i.headers=new Headers({"Content-Type":h}),i.body=JSON.stringify(r.json)):h==="text/plain"?i.body=r.text:h==="application/x-www-form-urlencoded"&&r.formData?i.body=Sx(r.formData):i.body=r.formData}return new Request(s,i)}function Sx(t){let e=new URLSearchParams;for(let[n,r]of t.entries())e.append(n,typeof r=="string"?r:r.name);return e}function hb(t){let e=new FormData;for(let[n,r]of t.entries())e.append(n,r);return e}function j6(t,e,n,r,s){let i={},l=null,h,p=!1,y={},_=n&&Ei(n[1])?n[1].error:void 0;return t.forEach(E=>{if(!(E.route.id in e))return;let T=E.route.id,k=e[T];if(_n(!gc(k),"Cannot handle redirect results in processLoaderData"),Ei(k)){let L=k.error;_!==void 0&&(L=_,_=void 0),l=l||{};{let B=dc(t,T);l[B.route.id]==null&&(l[B.route.id]=L)}i[T]=void 0,p||(p=!0,h=xf(k.error)?k.error.status:500),k.headers&&(y[T]=k.headers)}else hl(k)?(r.set(T,k.deferredData),i[T]=k.deferredData.data,k.statusCode!=null&&k.statusCode!==200&&!p&&(h=k.statusCode),k.headers&&(y[T]=k.headers)):(i[T]=k.data,k.statusCode&&k.statusCode!==200&&!p&&(h=k.statusCode),k.headers&&(y[T]=k.headers))}),_!==void 0&&n&&(l={[n[0]]:_},i[n[0]]=void 0),{loaderData:i,errors:l,statusCode:h||200,loaderHeaders:y}}function fb(t,e,n,r,s,i,l){let{loaderData:h,errors:p}=j6(e,n,r,l);return s.forEach(y=>{let{key:_,match:E,controller:T}=y,k=i[_];if(_n(k,"Did not find corresponding fetcher result"),!(T&&T.signal.aborted))if(Ei(k)){let L=dc(t.matches,E==null?void 0:E.route.id);p&&p[L.route.id]||(p=_r({},p,{[L.route.id]:k.error})),t.fetchers.delete(_)}else if(gc(k))_n(!1,"Unhandled fetcher revalidation redirect");else if(hl(k))_n(!1,"Unhandled fetcher deferred data");else{let L=Ko(k.data);t.fetchers.set(_,L)}}),{loaderData:h,errors:p}}function mb(t,e,n,r){let s=_r({},e);for(let i of n){let l=i.route.id;if(e.hasOwnProperty(l)?e[l]!==void 0&&(s[l]=e[l]):t[l]!==void 0&&i.route.loader&&(s[l]=t[l]),r&&r.hasOwnProperty(l))break}return s}function pb(t){return t?Ei(t[1])?{actionData:{}}:{actionData:{[t[0]]:t[1].data}}:{}}function dc(t,e){return(e?t.slice(0,t.findIndex(r=>r.route.id===e)+1):[...t]).reverse().find(r=>r.route.hasErrorBoundary===!0)||t[0]}function gb(t){let e=t.length===1?t[0]:t.find(n=>n.index||!n.path||n.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function ti(t,e){let{pathname:n,routeId:r,method:s,type:i,message:l}=e===void 0?{}:e,h="Unknown Server Error",p="Unknown @remix-run/router error";return t===400?(h="Bad Request",s&&n&&r?p="You made a "+s+' request to "'+n+'" but '+('did not provide a `loader` for route "'+r+'", ')+"so there is no way to handle the request.":i==="defer-action"?p="defer() is not supported in actions":i==="invalid-body"&&(p="Unable to encode submission body")):t===403?(h="Forbidden",p='Route "'+r+'" does not match URL "'+n+'"'):t===404?(h="Not Found",p='No route matches URL "'+n+'"'):t===405&&(h="Method Not Allowed",s&&n&&r?p="You made a "+s.toUpperCase()+' request to "'+n+'" but '+('did not provide an `action` for route "'+r+'", ')+"so there is no way to handle the request.":s&&(p='Invalid request method "'+s.toUpperCase()+'"')),new w0(t||500,h,new Error(p),!0)}function qm(t){let e=Object.entries(t);for(let n=e.length-1;n>=0;n--){let[r,s]=e[n];if(gc(s))return{key:r,result:s}}}function IN(t){let e=typeof t=="string"?zl(t):t;return Vc(_r({},e,{hash:""}))}function F6(t,e){return t.pathname!==e.pathname||t.search!==e.search?!1:t.hash===""?e.hash!=="":t.hash===e.hash?!0:e.hash!==""}function V6(t){return AN(t.result)&&I6.has(t.result.status)}function hl(t){return t.type===Kn.deferred}function Ei(t){return t.type===Kn.error}function gc(t){return(t&&t.type)===Kn.redirect}function yb(t){return typeof t=="object"&&t!=null&&"type"in t&&"data"in t&&"init"in t&&t.type==="DataWithResponseInit"}function B6(t){let e=t;return e&&typeof e=="object"&&typeof e.data=="object"&&typeof e.subscribe=="function"&&typeof e.cancel=="function"&&typeof e.resolveData=="function"}function AN(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.headers=="object"&&typeof t.body<"u"}function U6(t){return b6.has(t.toLowerCase())}function na(t){return v6.has(t.toLowerCase())}async function $6(t,e,n,r,s){let i=Object.entries(e);for(let l=0;l<i.length;l++){let[h,p]=i[l],y=t.find(T=>(T==null?void 0:T.route.id)===h);if(!y)continue;let _=r.find(T=>T.route.id===y.route.id),E=_!=null&&!EN(_,y)&&(s&&s[y.route.id])!==void 0;hl(p)&&E&&await Q_(p,n,!1).then(T=>{T&&(e[h]=T)})}}async function z6(t,e,n){for(let r=0;r<n.length;r++){let{key:s,routeId:i,controller:l}=n[r],h=e[s];t.find(y=>(y==null?void 0:y.route.id)===i)&&hl(h)&&(_n(l,"Expected an AbortController for revalidating fetcher deferred result"),await Q_(h,l.signal,!0).then(y=>{y&&(e[s]=y)}))}}async function Q_(t,e,n){if(n===void 0&&(n=!1),!await t.deferredData.resolveData(e)){if(n)try{return{type:Kn.data,data:t.deferredData.unwrappedData}}catch(s){return{type:Kn.error,error:s}}return{type:Kn.data,data:t.deferredData.data}}}function Y_(t){return new URLSearchParams(t).getAll("index").some(e=>e==="")}function gh(t,e){let n=typeof e=="string"?zl(e).search:e.search;if(t[t.length-1].route.index&&Y_(n||""))return t[t.length-1];let r=wN(t);return r[r.length-1]}function xb(t){let{formMethod:e,formAction:n,formEncType:r,text:s,formData:i,json:l}=t;if(!(!e||!n||!r)){if(s!=null)return{formMethod:e,formAction:n,formEncType:r,formData:void 0,json:void 0,text:s};if(i!=null)return{formMethod:e,formAction:n,formEncType:r,formData:i,json:void 0,text:void 0};if(l!==void 0)return{formMethod:e,formAction:n,formEncType:r,formData:void 0,json:l,text:void 0}}}function ry(t,e){return e?{state:"loading",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}:{state:"loading",location:t,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function W6(t,e){return{state:"submitting",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}}function ah(t,e){return t?{state:"loading",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function H6(t,e){return{state:"submitting",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e?e.data:void 0}}function Ko(t){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function G6(t,e){try{let n=t.sessionStorage.getItem(vN);if(n){let r=JSON.parse(n);for(let[s,i]of Object.entries(r||{}))i&&Array.isArray(i)&&e.set(s,new Set(i||[]))}}catch{}}function q6(t,e){if(e.size>0){let n={};for(let[r,s]of e)n[r]=[...s];try{t.sessionStorage.setItem(vN,JSON.stringify(n))}catch(r){Fc(!1,"Failed to save applied view transitions in sessionStorage ("+r+").")}}}/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function _0(){return _0=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},_0.apply(this,arguments)}const Jf=q.createContext(null),Z_=q.createContext(null),jo=q.createContext(null),J_=q.createContext(null),Fo=q.createContext({outlet:null,matches:[],isDataRoute:!1}),TN=q.createContext(null);function K6(t,e){let{relative:n}=e===void 0?{}:e;Dd()||_n(!1);let{basename:r,navigator:s}=q.useContext(jo),{hash:i,pathname:l,search:h}=Pg(t,{relative:n}),p=l;return r!=="/"&&(p=l==="/"?r:go([r,l])),s.createHref({pathname:p,search:h,hash:i})}function Dd(){return q.useContext(J_)!=null}function tu(){return Dd()||_n(!1),q.useContext(J_).location}function CN(t){q.useContext(jo).static||q.useLayoutEffect(t)}function Vo(){let{isDataRoute:t}=q.useContext(Fo);return t?lM():X6()}function X6(){Dd()||_n(!1);let t=q.useContext(Jf),{basename:e,future:n,navigator:r}=q.useContext(jo),{matches:s}=q.useContext(Fo),{pathname:i}=tu(),l=JSON.stringify(Ng(s,n.v7_relativeSplatPath)),h=q.useRef(!1);return CN(()=>{h.current=!0}),q.useCallback(function(y,_){if(_===void 0&&(_={}),!h.current)return;if(typeof y=="number"){r.go(y);return}let E=Rg(y,JSON.parse(l),i,_.relative==="path");t==null&&e!=="/"&&(E.pathname=E.pathname==="/"?e:go([e,E.pathname])),(_.replace?r.replace:r.push)(E,_.state,_)},[e,r,l,i,t])}const Q6=q.createContext(null);function Y6(t){let e=q.useContext(Fo).outlet;return e&&q.createElement(Q6.Provider,{value:t},e)}function Pg(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=q.useContext(jo),{matches:s}=q.useContext(Fo),{pathname:i}=tu(),l=JSON.stringify(Ng(s,r.v7_relativeSplatPath));return q.useMemo(()=>Rg(t,JSON.parse(l),i,n==="path"),[t,l,i,n])}function Z6(t,e,n,r){Dd()||_n(!1);let{navigator:s}=q.useContext(jo),{matches:i}=q.useContext(Fo),l=i[i.length-1],h=l?l.params:{};l&&l.pathname;let p=l?l.pathnameBase:"/";l&&l.route;let y=tu(),_;_=y;let E=_.pathname||"/",T=E;if(p!=="/"){let B=p.replace(/^\//,"").split("/");T="/"+E.replace(/^\//,"").split("/").slice(B.length).join("/")}let k=uc(t,{pathname:T});return rM(k&&k.map(B=>Object.assign({},B,{params:Object.assign({},h,B.params),pathname:go([p,s.encodeLocation?s.encodeLocation(B.pathname).pathname:B.pathname]),pathnameBase:B.pathnameBase==="/"?p:go([p,s.encodeLocation?s.encodeLocation(B.pathnameBase).pathname:B.pathnameBase])})),i,n,r)}function J6(){let t=oM(),e=xf(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return q.createElement(q.Fragment,null,q.createElement("h2",null,"Unexpected Application Error!"),q.createElement("h3",{style:{fontStyle:"italic"}},e),n?q.createElement("pre",{style:s},n):null,null)}const eM=q.createElement(J6,null);class tM extends q.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?q.createElement(Fo.Provider,{value:this.props.routeContext},q.createElement(TN.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function nM(t){let{routeContext:e,match:n,children:r}=t,s=q.useContext(Jf);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),q.createElement(Fo.Provider,{value:e},r)}function rM(t,e,n,r){var s;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var i;if(!n)return null;if(n.errors)t=n.matches;else if((i=r)!=null&&i.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let l=t,h=(s=n)==null?void 0:s.errors;if(h!=null){let _=l.findIndex(E=>E.route.id&&(h==null?void 0:h[E.route.id])!==void 0);_>=0||_n(!1),l=l.slice(0,Math.min(l.length,_+1))}let p=!1,y=-1;if(n&&r&&r.v7_partialHydration)for(let _=0;_<l.length;_++){let E=l[_];if((E.route.HydrateFallback||E.route.hydrateFallbackElement)&&(y=_),E.route.id){let{loaderData:T,errors:k}=n,L=E.route.loader&&T[E.route.id]===void 0&&(!k||k[E.route.id]===void 0);if(E.route.lazy||L){p=!0,y>=0?l=l.slice(0,y+1):l=[l[0]];break}}}return l.reduceRight((_,E,T)=>{let k,L=!1,B=null,H=null;n&&(k=h&&E.route.id?h[E.route.id]:void 0,B=E.route.errorElement||eM,p&&(y<0&&T===0?(cM("route-fallback"),L=!0,H=null):y===T&&(L=!0,H=E.route.hydrateFallbackElement||null)));let W=e.concat(l.slice(0,T+1)),M=()=>{let U;return k?U=B:L?U=H:E.route.Component?U=q.createElement(E.route.Component,null):E.route.element?U=E.route.element:U=_,q.createElement(nM,{match:E,routeContext:{outlet:_,matches:W,isDataRoute:n!=null},children:U})};return n&&(E.route.ErrorBoundary||E.route.errorElement||T===0)?q.createElement(tM,{location:n.location,revalidation:n.revalidation,component:B,error:k,children:M(),routeContext:{outlet:null,matches:W,isDataRoute:!0}}):M()},null)}var SN=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(SN||{}),NN=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(NN||{});function sM(t){let e=q.useContext(Jf);return e||_n(!1),e}function iM(t){let e=q.useContext(Z_);return e||_n(!1),e}function aM(t){let e=q.useContext(Fo);return e||_n(!1),e}function RN(t){let e=aM(),n=e.matches[e.matches.length-1];return n.route.id||_n(!1),n.route.id}function oM(){var t;let e=q.useContext(TN),n=iM(),r=RN();return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function lM(){let{router:t}=sM(SN.UseNavigateStable),e=RN(NN.UseNavigateStable),n=q.useRef(!1);return CN(()=>{n.current=!0}),q.useCallback(function(s,i){i===void 0&&(i={}),n.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,_0({fromRouteId:e},i)))},[t,e])}const wb={};function cM(t,e,n){wb[t]||(wb[t]=!0)}function uM(t,e){t==null||t.v7_startTransition,(t==null?void 0:t.v7_relativeSplatPath)===void 0&&(!e||e.v7_relativeSplatPath),e&&(e.v7_fetcherPersist,e.v7_normalizeFormMethod,e.v7_partialHydration,e.v7_skipActionErrorRevalidation)}function wf(t){let{to:e,replace:n,state:r,relative:s}=t;Dd()||_n(!1);let{future:i,static:l}=q.useContext(jo),{matches:h}=q.useContext(Fo),{pathname:p}=tu(),y=Vo(),_=Rg(e,Ng(h,i.v7_relativeSplatPath),p,s==="path"),E=JSON.stringify(_);return q.useEffect(()=>y(JSON.parse(E),{replace:n,state:r,relative:s}),[y,E,s,n,r]),null}function dM(t){return Y6(t.context)}function hM(t){let{basename:e="/",children:n=null,location:r,navigationType:s=Gr.Pop,navigator:i,static:l=!1,future:h}=t;Dd()&&_n(!1);let p=e.replace(/^\/*/,"/"),y=q.useMemo(()=>({basename:p,navigator:i,static:l,future:_0({v7_relativeSplatPath:!1},h)}),[p,h,i,l]);typeof r=="string"&&(r=zl(r));let{pathname:_="/",search:E="",hash:T="",state:k=null,key:L="default"}=r,B=q.useMemo(()=>{let H=Io(_,p);return H==null?null:{location:{pathname:H,search:E,hash:T,state:k,key:L},navigationType:s}},[p,_,E,T,k,L,s]);return B==null?null:q.createElement(jo.Provider,{value:y},q.createElement(J_.Provider,{children:n,value:B}))}new Promise(()=>{});function fM(t){let e={hasErrorBoundary:t.ErrorBoundary!=null||t.errorElement!=null};return t.Component&&Object.assign(e,{element:q.createElement(t.Component),Component:void 0}),t.HydrateFallback&&Object.assign(e,{hydrateFallbackElement:q.createElement(t.HydrateFallback),HydrateFallback:void 0}),t.ErrorBoundary&&Object.assign(e,{errorElement:q.createElement(t.ErrorBoundary),ErrorBoundary:void 0}),e}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function pd(){return pd=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},pd.apply(this,arguments)}function PN(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,i;for(i=0;i<r.length;i++)s=r[i],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}function mM(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function pM(t,e){return t.button===0&&(!e||e==="_self")&&!mM(t)}function Nx(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let r=t[n];return e.concat(Array.isArray(r)?r.map(s=>[n,s]):[[n,r]])},[]))}function gM(t,e){let n=Nx(t);return e&&e.forEach((r,s)=>{n.has(s)||e.getAll(s).forEach(i=>{n.append(s,i)})}),n}const yM=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],xM=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],wM="6";try{window.__reactRouterVersion=wM}catch{}function _M(t,e){return S6({basename:e==null?void 0:e.basename,future:pd({},e==null?void 0:e.future,{v7_prependBasename:!0}),history:Y5({window:e==null?void 0:e.window}),hydrationData:(e==null?void 0:e.hydrationData)||vM(),routes:t,mapRouteProperties:fM,dataStrategy:e==null?void 0:e.dataStrategy,patchRoutesOnNavigation:e==null?void 0:e.patchRoutesOnNavigation,window:e==null?void 0:e.window}).initialize()}function vM(){var t;let e=(t=window)==null?void 0:t.__staticRouterHydrationData;return e&&e.errors&&(e=pd({},e,{errors:EM(e.errors)})),e}function EM(t){if(!t)return null;let e=Object.entries(t),n={};for(let[r,s]of e)if(s&&s.__type==="RouteErrorResponse")n[r]=new w0(s.status,s.statusText,s.data,s.internal===!0);else if(s&&s.__type==="Error"){if(s.__subType){let i=window[s.__subType];if(typeof i=="function")try{let l=new i(s.message);l.stack="",n[r]=l}catch{}}if(n[r]==null){let i=new Error(s.message);i.stack="",n[r]=i}}else n[r]=s;return n}const kN=q.createContext({isTransitioning:!1}),bM=q.createContext(new Map),IM="startTransition",_b=FD[IM],AM="flushSync",vb=Q5[AM];function TM(t){_b?_b(t):t()}function oh(t){vb?vb(t):t()}let CM=class{constructor(){this.status="pending",this.promise=new Promise((e,n)=>{this.resolve=r=>{this.status==="pending"&&(this.status="resolved",e(r))},this.reject=r=>{this.status==="pending"&&(this.status="rejected",n(r))}})}};function SM(t){let{fallbackElement:e,router:n,future:r}=t,[s,i]=q.useState(n.state),[l,h]=q.useState(),[p,y]=q.useState({isTransitioning:!1}),[_,E]=q.useState(),[T,k]=q.useState(),[L,B]=q.useState(),H=q.useRef(new Map),{v7_startTransition:W}=r||{},M=q.useCallback(C=>{W?TM(C):C()},[W]),U=q.useCallback((C,N)=>{let{deletedFetchers:D,flushSync:O,viewTransitionOpts:F}=N;C.fetchers.forEach((ie,te)=>{ie.data!==void 0&&H.current.set(te,ie.data)}),D.forEach(ie=>H.current.delete(ie));let R=n.window==null||n.window.document==null||typeof n.window.document.startViewTransition!="function";if(!F||R){O?oh(()=>i(C)):M(()=>i(C));return}if(O){oh(()=>{T&&(_&&_.resolve(),T.skipTransition()),y({isTransitioning:!0,flushSync:!0,currentLocation:F.currentLocation,nextLocation:F.nextLocation})});let ie=n.window.document.startViewTransition(()=>{oh(()=>i(C))});ie.finished.finally(()=>{oh(()=>{E(void 0),k(void 0),h(void 0),y({isTransitioning:!1})})}),oh(()=>k(ie));return}T?(_&&_.resolve(),T.skipTransition(),B({state:C,currentLocation:F.currentLocation,nextLocation:F.nextLocation})):(h(C),y({isTransitioning:!0,flushSync:!1,currentLocation:F.currentLocation,nextLocation:F.nextLocation}))},[n.window,T,_,H,M]);q.useLayoutEffect(()=>n.subscribe(U),[n,U]),q.useEffect(()=>{p.isTransitioning&&!p.flushSync&&E(new CM)},[p]),q.useEffect(()=>{if(_&&l&&n.window){let C=l,N=_.promise,D=n.window.document.startViewTransition(async()=>{M(()=>i(C)),await N});D.finished.finally(()=>{E(void 0),k(void 0),h(void 0),y({isTransitioning:!1})}),k(D)}},[M,l,_,n.window]),q.useEffect(()=>{_&&l&&s.location.key===l.location.key&&_.resolve()},[_,T,s.location,l]),q.useEffect(()=>{!p.isTransitioning&&L&&(h(L.state),y({isTransitioning:!0,flushSync:!1,currentLocation:L.currentLocation,nextLocation:L.nextLocation}),B(void 0))},[p.isTransitioning,L]),q.useEffect(()=>{},[]);let $=q.useMemo(()=>({createHref:n.createHref,encodeLocation:n.encodeLocation,go:C=>n.navigate(C),push:(C,N,D)=>n.navigate(C,{state:N,preventScrollReset:D==null?void 0:D.preventScrollReset}),replace:(C,N,D)=>n.navigate(C,{replace:!0,state:N,preventScrollReset:D==null?void 0:D.preventScrollReset})}),[n]),K=n.basename||"/",Z=q.useMemo(()=>({router:n,navigator:$,static:!1,basename:K}),[n,$,K]),A=q.useMemo(()=>({v7_relativeSplatPath:n.future.v7_relativeSplatPath}),[n.future.v7_relativeSplatPath]);return q.useEffect(()=>uM(r,n.future),[r,n.future]),q.createElement(q.Fragment,null,q.createElement(Jf.Provider,{value:Z},q.createElement(Z_.Provider,{value:s},q.createElement(bM.Provider,{value:H.current},q.createElement(kN.Provider,{value:p},q.createElement(hM,{basename:K,location:s.location,navigationType:s.historyAction,navigator:$,future:A},s.initialized||n.future.v7_partialHydration?q.createElement(NM,{routes:n.routes,future:n.future,state:s}):e))))),null)}const NM=q.memo(RM);function RM(t){let{routes:e,future:n,state:r}=t;return Z6(e,void 0,r,n)}const PM=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",kM=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,DM=q.forwardRef(function(e,n){let{onClick:r,relative:s,reloadDocument:i,replace:l,state:h,target:p,to:y,preventScrollReset:_,viewTransition:E}=e,T=PN(e,yM),{basename:k}=q.useContext(jo),L,B=!1;if(typeof y=="string"&&kM.test(y)&&(L=y,PM))try{let U=new URL(window.location.href),$=y.startsWith("//")?new URL(U.protocol+y):new URL(y),K=Io($.pathname,k);$.origin===U.origin&&K!=null?y=K+$.search+$.hash:B=!0}catch{}let H=K6(y,{relative:s}),W=LM(y,{replace:l,state:h,target:p,preventScrollReset:_,relative:s,viewTransition:E});function M(U){r&&r(U),U.defaultPrevented||W(U)}return q.createElement("a",pd({},T,{href:L||H,onClick:B||i?r:M,ref:n,target:p}))}),OM=q.forwardRef(function(e,n){let{"aria-current":r="page",caseSensitive:s=!1,className:i="",end:l=!1,style:h,to:p,viewTransition:y,children:_}=e,E=PN(e,xM),T=Pg(p,{relative:E.relative}),k=tu(),L=q.useContext(Z_),{navigator:B,basename:H}=q.useContext(jo),W=L!=null&&FM(T)&&y===!0,M=B.encodeLocation?B.encodeLocation(T).pathname:T.pathname,U=k.pathname,$=L&&L.navigation&&L.navigation.location?L.navigation.location.pathname:null;s||(U=U.toLowerCase(),$=$?$.toLowerCase():null,M=M.toLowerCase()),$&&H&&($=Io($,H)||$);const K=M!=="/"&&M.endsWith("/")?M.length-1:M.length;let Z=U===M||!l&&U.startsWith(M)&&U.charAt(K)==="/",A=$!=null&&($===M||!l&&$.startsWith(M)&&$.charAt(M.length)==="/"),C={isActive:Z,isPending:A,isTransitioning:W},N=Z?r:void 0,D;typeof i=="function"?D=i(C):D=[i,Z?"active":null,A?"pending":null,W?"transitioning":null].filter(Boolean).join(" ");let O=typeof h=="function"?h(C):h;return q.createElement(DM,pd({},E,{"aria-current":N,className:D,ref:n,style:O,to:p,viewTransition:y}),typeof _=="function"?_(C):_)});var Rx;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(Rx||(Rx={}));var Eb;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(Eb||(Eb={}));function MM(t){let e=q.useContext(Jf);return e||_n(!1),e}function LM(t,e){let{target:n,replace:r,state:s,preventScrollReset:i,relative:l,viewTransition:h}=e===void 0?{}:e,p=Vo(),y=tu(),_=Pg(t,{relative:l});return q.useCallback(E=>{if(pM(E,n)){E.preventDefault();let T=r!==void 0?r:Vc(y)===Vc(_);p(t,{replace:T,state:s,preventScrollReset:i,relative:l,viewTransition:h})}},[y,p,_,r,s,n,t,i,l,h])}function jM(t){let e=q.useRef(Nx(t)),n=q.useRef(!1),r=tu(),s=q.useMemo(()=>gM(r.search,n.current?null:e.current),[r.search]),i=Vo(),l=q.useCallback((h,p)=>{const y=Nx(typeof h=="function"?h(s):h);n.current=!0,i("?"+y,p)},[i,s]);return[s,l]}function FM(t,e){e===void 0&&(e={});let n=q.useContext(kN);n==null&&_n(!1);let{basename:r}=MM(Rx.useViewTransitionState),s=Pg(t,{relative:e.relative});if(!n.isTransitioning)return!1;let i=Io(n.currentLocation.pathname,r)||n.currentLocation.pathname,l=Io(n.nextLocation.pathname,r)||n.nextLocation.pathname;return x0(s.pathname,l)!=null||x0(s.pathname,i)!=null}var kg=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},VM={setTimeout:(t,e)=>setTimeout(t,e),clearTimeout:t=>clearTimeout(t),setInterval:(t,e)=>setInterval(t,e),clearInterval:t=>clearInterval(t)},sl,Yw,XT,BM=(XT=class{constructor(){Pn(this,sl,VM);Pn(this,Yw,!1)}setTimeoutProvider(t){nn(this,sl,t)}setTimeout(t,e){return Te(this,sl).setTimeout(t,e)}clearTimeout(t){Te(this,sl).clearTimeout(t)}setInterval(t,e){return Te(this,sl).setInterval(t,e)}clearInterval(t){Te(this,sl).clearInterval(t)}},sl=new WeakMap,Yw=new WeakMap,XT),Px=new BM;function UM(t){setTimeout(t,0)}var Dg=typeof window>"u"||"Deno"in globalThis;function Zi(){}function $M(t,e){return typeof t=="function"?t(e):t}function zM(t){return typeof t=="number"&&t>=0&&t!==1/0}function WM(t,e){return Math.max(t+(e||0)-Date.now(),0)}function kx(t,e){return typeof t=="function"?t(e):t}function HM(t,e){return typeof t=="function"?t(e):t}function bb(t,e){const{type:n="all",exact:r,fetchStatus:s,predicate:i,queryKey:l,stale:h}=t;if(l){if(r){if(e.queryHash!==ev(l,e.options))return!1}else if(!vf(e.queryKey,l))return!1}if(n!=="all"){const p=e.isActive();if(n==="active"&&!p||n==="inactive"&&p)return!1}return!(typeof h=="boolean"&&e.isStale()!==h||s&&s!==e.state.fetchStatus||i&&!i(e))}function Ib(t,e){const{exact:n,status:r,predicate:s,mutationKey:i}=t;if(i){if(!e.options.mutationKey)return!1;if(n){if(_f(e.options.mutationKey)!==_f(i))return!1}else if(!vf(e.options.mutationKey,i))return!1}return!(r&&e.state.status!==r||s&&!s(e))}function ev(t,e){return((e==null?void 0:e.queryKeyHashFn)||_f)(t)}function _f(t){return JSON.stringify(t,(e,n)=>Dx(n)?Object.keys(n).sort().reduce((r,s)=>(r[s]=n[s],r),{}):n)}function vf(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?Object.keys(e).every(n=>vf(t[n],e[n])):!1}var GM=Object.prototype.hasOwnProperty;function DN(t,e){if(t===e)return t;const n=Ab(t)&&Ab(e);if(!n&&!(Dx(t)&&Dx(e)))return e;const s=(n?t:Object.keys(t)).length,i=n?e:Object.keys(e),l=i.length,h=n?new Array(l):{};let p=0;for(let y=0;y<l;y++){const _=n?y:i[y],E=t[_],T=e[_];if(E===T){h[_]=E,(n?y<s:GM.call(t,_))&&p++;continue}if(E===null||T===null||typeof E!="object"||typeof T!="object"){h[_]=T;continue}const k=DN(E,T);h[_]=k,k===E&&p++}return s===l&&p===s?t:h}function Ab(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function Dx(t){if(!Tb(t))return!1;const e=t.constructor;if(e===void 0)return!0;const n=e.prototype;return!(!Tb(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function Tb(t){return Object.prototype.toString.call(t)==="[object Object]"}function qM(t){return new Promise(e=>{Px.setTimeout(e,t)})}function KM(t,e,n){return typeof n.structuralSharing=="function"?n.structuralSharing(t,e):n.structuralSharing!==!1?DN(t,e):e}function XM(t,e,n=0){const r=[...t,e];return n&&r.length>n?r.slice(1):r}function QM(t,e,n=0){const r=[e,...t];return n&&r.length>n?r.slice(0,-1):r}var tv=Symbol();function ON(t,e){return!t.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!t.queryFn||t.queryFn===tv?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}var Ec,il,ed,QT,YM=(QT=class extends kg{constructor(){super();Pn(this,Ec);Pn(this,il);Pn(this,ed);nn(this,ed,e=>{if(!Dg&&window.addEventListener){const n=()=>e();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){Te(this,il)||this.setEventListener(Te(this,ed))}onUnsubscribe(){var e;this.hasListeners()||((e=Te(this,il))==null||e.call(this),nn(this,il,void 0))}setEventListener(e){var n;nn(this,ed,e),(n=Te(this,il))==null||n.call(this),nn(this,il,e(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(e){Te(this,Ec)!==e&&(nn(this,Ec,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(n=>{n(e)})}isFocused(){var e;return typeof Te(this,Ec)=="boolean"?Te(this,Ec):((e=globalThis.document)==null?void 0:e.visibilityState)!=="hidden"}},Ec=new WeakMap,il=new WeakMap,ed=new WeakMap,QT),MN=new YM;function ZM(){let t,e;const n=new Promise((s,i)=>{t=s,e=i});n.status="pending",n.catch(()=>{});function r(s){Object.assign(n,s),delete n.resolve,delete n.reject}return n.resolve=s=>{r({status:"fulfilled",value:s}),t(s)},n.reject=s=>{r({status:"rejected",reason:s}),e(s)},n}var JM=UM;function e8(){let t=[],e=0,n=h=>{h()},r=h=>{h()},s=JM;const i=h=>{e?t.push(h):s(()=>{n(h)})},l=()=>{const h=t;t=[],h.length&&s(()=>{r(()=>{h.forEach(p=>{n(p)})})})};return{batch:h=>{let p;e++;try{p=h()}finally{e--,e||l()}return p},batchCalls:h=>(...p)=>{i(()=>{h(...p)})},schedule:i,setNotifyFunction:h=>{n=h},setBatchNotifyFunction:h=>{r=h},setScheduler:h=>{s=h}}}var Vs=e8(),td,al,nd,YT,t8=(YT=class extends kg{constructor(){super();Pn(this,td,!0);Pn(this,al);Pn(this,nd);nn(this,nd,e=>{if(!Dg&&window.addEventListener){const n=()=>e(!0),r=()=>e(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",r)}}})}onSubscribe(){Te(this,al)||this.setEventListener(Te(this,nd))}onUnsubscribe(){var e;this.hasListeners()||((e=Te(this,al))==null||e.call(this),nn(this,al,void 0))}setEventListener(e){var n;nn(this,nd,e),(n=Te(this,al))==null||n.call(this),nn(this,al,e(this.setOnline.bind(this)))}setOnline(e){Te(this,td)!==e&&(nn(this,td,e),this.listeners.forEach(r=>{r(e)}))}isOnline(){return Te(this,td)}},td=new WeakMap,al=new WeakMap,nd=new WeakMap,YT),v0=new t8;function n8(t){return Math.min(1e3*2**t,3e4)}function LN(t){return(t??"online")==="online"?v0.isOnline():!0}var Ox=class extends Error{constructor(t){super("CancelledError"),this.revert=t==null?void 0:t.revert,this.silent=t==null?void 0:t.silent}};function jN(t){let e=!1,n=0,r;const s=ZM(),i=()=>s.status!=="pending",l=B=>{var H;if(!i()){const W=new Ox(B);T(W),(H=t.onCancel)==null||H.call(t,W)}},h=()=>{e=!0},p=()=>{e=!1},y=()=>MN.isFocused()&&(t.networkMode==="always"||v0.isOnline())&&t.canRun(),_=()=>LN(t.networkMode)&&t.canRun(),E=B=>{i()||(r==null||r(),s.resolve(B))},T=B=>{i()||(r==null||r(),s.reject(B))},k=()=>new Promise(B=>{var H;r=W=>{(i()||y())&&B(W)},(H=t.onPause)==null||H.call(t)}).then(()=>{var B;r=void 0,i()||(B=t.onContinue)==null||B.call(t)}),L=()=>{if(i())return;let B;const H=n===0?t.initialPromise:void 0;try{B=H??t.fn()}catch(W){B=Promise.reject(W)}Promise.resolve(B).then(E).catch(W=>{var Z;if(i())return;const M=t.retry??(Dg?0:3),U=t.retryDelay??n8,$=typeof U=="function"?U(n,W):U,K=M===!0||typeof M=="number"&&n<M||typeof M=="function"&&M(n,W);if(e||!K){T(W);return}n++,(Z=t.onFail)==null||Z.call(t,n,W),qM($).then(()=>y()?void 0:k()).then(()=>{e?T(W):L()})})};return{promise:s,status:()=>s.status,cancel:l,continue:()=>(r==null||r(),s),cancelRetry:h,continueRetry:p,canStart:_,start:()=>(_()?L():k().then(L),s)}}var bc,ZT,FN=(ZT=class{constructor(){Pn(this,bc)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),zM(this.gcTime)&&nn(this,bc,Px.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(Dg?1/0:5*60*1e3))}clearGcTimeout(){Te(this,bc)&&(Px.clearTimeout(Te(this,bc)),nn(this,bc,void 0))}},bc=new WeakMap,ZT),Ic,rd,Mi,Ac,ns,Hf,Tc,Ji,eo,JT,r8=(JT=class extends FN{constructor(n){super();Pn(this,Ji);Pn(this,Ic);Pn(this,rd);Pn(this,Mi);Pn(this,Ac);Pn(this,ns);Pn(this,Hf);Pn(this,Tc);nn(this,Tc,!1),nn(this,Hf,n.defaultOptions),this.setOptions(n.options),this.observers=[],nn(this,Ac,n.client),nn(this,Mi,Te(this,Ac).getQueryCache()),this.queryKey=n.queryKey,this.queryHash=n.queryHash,nn(this,Ic,Sb(this.options)),this.state=n.state??Te(this,Ic),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var n;return(n=Te(this,ns))==null?void 0:n.promise}setOptions(n){if(this.options={...Te(this,Hf),...n},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const r=Sb(this.options);r.data!==void 0&&(this.setState(Cb(r.data,r.dataUpdatedAt)),nn(this,Ic,r))}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&Te(this,Mi).remove(this)}setData(n,r){const s=KM(this.state.data,n,this.options);return Is(this,Ji,eo).call(this,{data:s,type:"success",dataUpdatedAt:r==null?void 0:r.updatedAt,manual:r==null?void 0:r.manual}),s}setState(n,r){Is(this,Ji,eo).call(this,{type:"setState",state:n,setStateOptions:r})}cancel(n){var s,i;const r=(s=Te(this,ns))==null?void 0:s.promise;return(i=Te(this,ns))==null||i.cancel(n),r?r.then(Zi).catch(Zi):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(Te(this,Ic))}isActive(){return this.observers.some(n=>HM(n.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===tv||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(n=>kx(n.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(n=>n.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(n=0){return this.state.data===void 0?!0:n==="static"?!1:this.state.isInvalidated?!0:!WM(this.state.dataUpdatedAt,n)}onFocus(){var r;const n=this.observers.find(s=>s.shouldFetchOnWindowFocus());n==null||n.refetch({cancelRefetch:!1}),(r=Te(this,ns))==null||r.continue()}onOnline(){var r;const n=this.observers.find(s=>s.shouldFetchOnReconnect());n==null||n.refetch({cancelRefetch:!1}),(r=Te(this,ns))==null||r.continue()}addObserver(n){this.observers.includes(n)||(this.observers.push(n),this.clearGcTimeout(),Te(this,Mi).notify({type:"observerAdded",query:this,observer:n}))}removeObserver(n){this.observers.includes(n)&&(this.observers=this.observers.filter(r=>r!==n),this.observers.length||(Te(this,ns)&&(Te(this,Tc)?Te(this,ns).cancel({revert:!0}):Te(this,ns).cancelRetry()),this.scheduleGc()),Te(this,Mi).notify({type:"observerRemoved",query:this,observer:n}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||Is(this,Ji,eo).call(this,{type:"invalidate"})}async fetch(n,r){var y,_,E,T,k,L,B,H,W,M,U,$;if(this.state.fetchStatus!=="idle"&&((y=Te(this,ns))==null?void 0:y.status())!=="rejected"){if(this.state.data!==void 0&&(r!=null&&r.cancelRefetch))this.cancel({silent:!0});else if(Te(this,ns))return Te(this,ns).continueRetry(),Te(this,ns).promise}if(n&&this.setOptions(n),!this.options.queryFn){const K=this.observers.find(Z=>Z.options.queryFn);K&&this.setOptions(K.options)}const s=new AbortController,i=K=>{Object.defineProperty(K,"signal",{enumerable:!0,get:()=>(nn(this,Tc,!0),s.signal)})},l=()=>{const K=ON(this.options,r),A=(()=>{const C={client:Te(this,Ac),queryKey:this.queryKey,meta:this.meta};return i(C),C})();return nn(this,Tc,!1),this.options.persister?this.options.persister(K,A,this):K(A)},p=(()=>{const K={fetchOptions:r,options:this.options,queryKey:this.queryKey,client:Te(this,Ac),state:this.state,fetchFn:l};return i(K),K})();(_=this.options.behavior)==null||_.onFetch(p,this),nn(this,rd,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((E=p.fetchOptions)==null?void 0:E.meta))&&Is(this,Ji,eo).call(this,{type:"fetch",meta:(T=p.fetchOptions)==null?void 0:T.meta}),nn(this,ns,jN({initialPromise:r==null?void 0:r.initialPromise,fn:p.fetchFn,onCancel:K=>{K instanceof Ox&&K.revert&&this.setState({...Te(this,rd),fetchStatus:"idle"}),s.abort()},onFail:(K,Z)=>{Is(this,Ji,eo).call(this,{type:"failed",failureCount:K,error:Z})},onPause:()=>{Is(this,Ji,eo).call(this,{type:"pause"})},onContinue:()=>{Is(this,Ji,eo).call(this,{type:"continue"})},retry:p.options.retry,retryDelay:p.options.retryDelay,networkMode:p.options.networkMode,canRun:()=>!0}));try{const K=await Te(this,ns).start();if(K===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(K),(L=(k=Te(this,Mi).config).onSuccess)==null||L.call(k,K,this),(H=(B=Te(this,Mi).config).onSettled)==null||H.call(B,K,this.state.error,this),K}catch(K){if(K instanceof Ox){if(K.silent)return Te(this,ns).promise;if(K.revert){if(this.state.data===void 0)throw K;return this.state.data}}throw Is(this,Ji,eo).call(this,{type:"error",error:K}),(M=(W=Te(this,Mi).config).onError)==null||M.call(W,K,this),($=(U=Te(this,Mi).config).onSettled)==null||$.call(U,this.state.data,K,this),K}finally{this.scheduleGc()}}},Ic=new WeakMap,rd=new WeakMap,Mi=new WeakMap,Ac=new WeakMap,ns=new WeakMap,Hf=new WeakMap,Tc=new WeakMap,Ji=new WeakSet,eo=function(n){const r=s=>{switch(n.type){case"failed":return{...s,fetchFailureCount:n.failureCount,fetchFailureReason:n.error};case"pause":return{...s,fetchStatus:"paused"};case"continue":return{...s,fetchStatus:"fetching"};case"fetch":return{...s,...s8(s.data,this.options),fetchMeta:n.meta??null};case"success":const i={...s,...Cb(n.data,n.dataUpdatedAt),dataUpdateCount:s.dataUpdateCount+1,...!n.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return nn(this,rd,n.manual?i:void 0),i;case"error":const l=n.error;return{...s,error:l,errorUpdateCount:s.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:s.fetchFailureCount+1,fetchFailureReason:l,fetchStatus:"idle",status:"error"};case"invalidate":return{...s,isInvalidated:!0};case"setState":return{...s,...n.state}}};this.state=r(this.state),Vs.batch(()=>{this.observers.forEach(s=>{s.onQueryUpdate()}),Te(this,Mi).notify({query:this,type:"updated",action:n})})},JT);function s8(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:LN(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function Cb(t,e){return{data:t,dataUpdatedAt:e??Date.now(),error:null,isInvalidated:!1,status:"success"}}function Sb(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,n=e!==void 0,r=n?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:n?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}function Nb(t){return{onFetch:(e,n)=>{var _,E,T,k,L;const r=e.options,s=(T=(E=(_=e.fetchOptions)==null?void 0:_.meta)==null?void 0:E.fetchMore)==null?void 0:T.direction,i=((k=e.state.data)==null?void 0:k.pages)||[],l=((L=e.state.data)==null?void 0:L.pageParams)||[];let h={pages:[],pageParams:[]},p=0;const y=async()=>{let B=!1;const H=U=>{Object.defineProperty(U,"signal",{enumerable:!0,get:()=>(e.signal.aborted?B=!0:e.signal.addEventListener("abort",()=>{B=!0}),e.signal)})},W=ON(e.options,e.fetchOptions),M=async(U,$,K)=>{if(B)return Promise.reject();if($==null&&U.pages.length)return Promise.resolve(U);const A=(()=>{const O={client:e.client,queryKey:e.queryKey,pageParam:$,direction:K?"backward":"forward",meta:e.options.meta};return H(O),O})(),C=await W(A),{maxPages:N}=e.options,D=K?QM:XM;return{pages:D(U.pages,C,N),pageParams:D(U.pageParams,$,N)}};if(s&&i.length){const U=s==="backward",$=U?i8:Rb,K={pages:i,pageParams:l},Z=$(r,K);h=await M(K,Z,U)}else{const U=t??i.length;do{const $=p===0?l[0]??r.initialPageParam:Rb(r,h);if(p>0&&$==null)break;h=await M(h,$),p++}while(p<U)}return h};e.options.persister?e.fetchFn=()=>{var B,H;return(H=(B=e.options).persister)==null?void 0:H.call(B,y,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},n)}:e.fetchFn=y}}}function Rb(t,{pages:e,pageParams:n}){const r=e.length-1;return e.length>0?t.getNextPageParam(e[r],e,n[r],n):void 0}function i8(t,{pages:e,pageParams:n}){var r;return e.length>0?(r=t.getPreviousPageParam)==null?void 0:r.call(t,e[0],e,n[0],n):void 0}var Gf,va,js,Cc,Ea,Xo,eC,a8=(eC=class extends FN{constructor(n){super();Pn(this,Ea);Pn(this,Gf);Pn(this,va);Pn(this,js);Pn(this,Cc);nn(this,Gf,n.client),this.mutationId=n.mutationId,nn(this,js,n.mutationCache),nn(this,va,[]),this.state=n.state||o8(),this.setOptions(n.options),this.scheduleGc()}setOptions(n){this.options=n,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(n){Te(this,va).includes(n)||(Te(this,va).push(n),this.clearGcTimeout(),Te(this,js).notify({type:"observerAdded",mutation:this,observer:n}))}removeObserver(n){nn(this,va,Te(this,va).filter(r=>r!==n)),this.scheduleGc(),Te(this,js).notify({type:"observerRemoved",mutation:this,observer:n})}optionalRemove(){Te(this,va).length||(this.state.status==="pending"?this.scheduleGc():Te(this,js).remove(this))}continue(){var n;return((n=Te(this,Cc))==null?void 0:n.continue())??this.execute(this.state.variables)}async execute(n){var h,p,y,_,E,T,k,L,B,H,W,M,U,$,K,Z,A,C,N,D;const r=()=>{Is(this,Ea,Xo).call(this,{type:"continue"})},s={client:Te(this,Gf),meta:this.options.meta,mutationKey:this.options.mutationKey};nn(this,Cc,jN({fn:()=>this.options.mutationFn?this.options.mutationFn(n,s):Promise.reject(new Error("No mutationFn found")),onFail:(O,F)=>{Is(this,Ea,Xo).call(this,{type:"failed",failureCount:O,error:F})},onPause:()=>{Is(this,Ea,Xo).call(this,{type:"pause"})},onContinue:r,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>Te(this,js).canRun(this)}));const i=this.state.status==="pending",l=!Te(this,Cc).canStart();try{if(i)r();else{Is(this,Ea,Xo).call(this,{type:"pending",variables:n,isPaused:l}),await((p=(h=Te(this,js).config).onMutate)==null?void 0:p.call(h,n,this,s));const F=await((_=(y=this.options).onMutate)==null?void 0:_.call(y,n,s));F!==this.state.context&&Is(this,Ea,Xo).call(this,{type:"pending",context:F,variables:n,isPaused:l})}const O=await Te(this,Cc).start();return await((T=(E=Te(this,js).config).onSuccess)==null?void 0:T.call(E,O,n,this.state.context,this,s)),await((L=(k=this.options).onSuccess)==null?void 0:L.call(k,O,n,this.state.context,s)),await((H=(B=Te(this,js).config).onSettled)==null?void 0:H.call(B,O,null,this.state.variables,this.state.context,this,s)),await((M=(W=this.options).onSettled)==null?void 0:M.call(W,O,null,n,this.state.context,s)),Is(this,Ea,Xo).call(this,{type:"success",data:O}),O}catch(O){try{throw await(($=(U=Te(this,js).config).onError)==null?void 0:$.call(U,O,n,this.state.context,this,s)),await((Z=(K=this.options).onError)==null?void 0:Z.call(K,O,n,this.state.context,s)),await((C=(A=Te(this,js).config).onSettled)==null?void 0:C.call(A,void 0,O,this.state.variables,this.state.context,this,s)),await((D=(N=this.options).onSettled)==null?void 0:D.call(N,void 0,O,n,this.state.context,s)),O}finally{Is(this,Ea,Xo).call(this,{type:"error",error:O})}}finally{Te(this,js).runNext(this)}}},Gf=new WeakMap,va=new WeakMap,js=new WeakMap,Cc=new WeakMap,Ea=new WeakSet,Xo=function(n){const r=s=>{switch(n.type){case"failed":return{...s,failureCount:n.failureCount,failureReason:n.error};case"pause":return{...s,isPaused:!0};case"continue":return{...s,isPaused:!1};case"pending":return{...s,context:n.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:n.isPaused,status:"pending",variables:n.variables,submittedAt:Date.now()};case"success":return{...s,data:n.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...s,data:void 0,error:n.error,failureCount:s.failureCount+1,failureReason:n.error,isPaused:!1,status:"error"}}};this.state=r(this.state),Vs.batch(()=>{Te(this,va).forEach(s=>{s.onMutationUpdate(n)}),Te(this,js).notify({mutation:this,type:"updated",action:n})})},eC);function o8(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var io,ea,qf,tC,l8=(tC=class extends kg{constructor(e={}){super();Pn(this,io);Pn(this,ea);Pn(this,qf);this.config=e,nn(this,io,new Set),nn(this,ea,new Map),nn(this,qf,0)}build(e,n,r){const s=new a8({client:e,mutationCache:this,mutationId:++Nm(this,qf)._,options:e.defaultMutationOptions(n),state:r});return this.add(s),s}add(e){Te(this,io).add(e);const n=Km(e);if(typeof n=="string"){const r=Te(this,ea).get(n);r?r.push(e):Te(this,ea).set(n,[e])}this.notify({type:"added",mutation:e})}remove(e){if(Te(this,io).delete(e)){const n=Km(e);if(typeof n=="string"){const r=Te(this,ea).get(n);if(r)if(r.length>1){const s=r.indexOf(e);s!==-1&&r.splice(s,1)}else r[0]===e&&Te(this,ea).delete(n)}}this.notify({type:"removed",mutation:e})}canRun(e){const n=Km(e);if(typeof n=="string"){const r=Te(this,ea).get(n),s=r==null?void 0:r.find(i=>i.state.status==="pending");return!s||s===e}else return!0}runNext(e){var r;const n=Km(e);if(typeof n=="string"){const s=(r=Te(this,ea).get(n))==null?void 0:r.find(i=>i!==e&&i.state.isPaused);return(s==null?void 0:s.continue())??Promise.resolve()}else return Promise.resolve()}clear(){Vs.batch(()=>{Te(this,io).forEach(e=>{this.notify({type:"removed",mutation:e})}),Te(this,io).clear(),Te(this,ea).clear()})}getAll(){return Array.from(Te(this,io))}find(e){const n={exact:!0,...e};return this.getAll().find(r=>Ib(n,r))}findAll(e={}){return this.getAll().filter(n=>Ib(e,n))}notify(e){Vs.batch(()=>{this.listeners.forEach(n=>{n(e)})})}resumePausedMutations(){const e=this.getAll().filter(n=>n.state.isPaused);return Vs.batch(()=>Promise.all(e.map(n=>n.continue().catch(Zi))))}},io=new WeakMap,ea=new WeakMap,qf=new WeakMap,tC);function Km(t){var e;return(e=t.options.scope)==null?void 0:e.id}var ba,nC,c8=(nC=class extends kg{constructor(e={}){super();Pn(this,ba);this.config=e,nn(this,ba,new Map)}build(e,n,r){const s=n.queryKey,i=n.queryHash??ev(s,n);let l=this.get(i);return l||(l=new r8({client:e,queryKey:s,queryHash:i,options:e.defaultQueryOptions(n),state:r,defaultOptions:e.getQueryDefaults(s)}),this.add(l)),l}add(e){Te(this,ba).has(e.queryHash)||(Te(this,ba).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const n=Te(this,ba).get(e.queryHash);n&&(e.destroy(),n===e&&Te(this,ba).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){Vs.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return Te(this,ba).get(e)}getAll(){return[...Te(this,ba).values()]}find(e){const n={exact:!0,...e};return this.getAll().find(r=>bb(n,r))}findAll(e={}){const n=this.getAll();return Object.keys(e).length>0?n.filter(r=>bb(e,r)):n}notify(e){Vs.batch(()=>{this.listeners.forEach(n=>{n(e)})})}onFocus(){Vs.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){Vs.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},ba=new WeakMap,nC),Pr,ol,ll,sd,id,cl,ad,od,rC,u8=(rC=class{constructor(t={}){Pn(this,Pr);Pn(this,ol);Pn(this,ll);Pn(this,sd);Pn(this,id);Pn(this,cl);Pn(this,ad);Pn(this,od);nn(this,Pr,t.queryCache||new c8),nn(this,ol,t.mutationCache||new l8),nn(this,ll,t.defaultOptions||{}),nn(this,sd,new Map),nn(this,id,new Map),nn(this,cl,0)}mount(){Nm(this,cl)._++,Te(this,cl)===1&&(nn(this,ad,MN.subscribe(async t=>{t&&(await this.resumePausedMutations(),Te(this,Pr).onFocus())})),nn(this,od,v0.subscribe(async t=>{t&&(await this.resumePausedMutations(),Te(this,Pr).onOnline())})))}unmount(){var t,e;Nm(this,cl)._--,Te(this,cl)===0&&((t=Te(this,ad))==null||t.call(this),nn(this,ad,void 0),(e=Te(this,od))==null||e.call(this),nn(this,od,void 0))}isFetching(t){return Te(this,Pr).findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return Te(this,ol).findAll({...t,status:"pending"}).length}getQueryData(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=Te(this,Pr).get(e.queryHash))==null?void 0:n.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),n=Te(this,Pr).build(this,e),r=n.state.data;return r===void 0?this.fetchQuery(t):(t.revalidateIfStale&&n.isStaleByTime(kx(e.staleTime,n))&&this.prefetchQuery(e),Promise.resolve(r))}getQueriesData(t){return Te(this,Pr).findAll(t).map(({queryKey:e,state:n})=>{const r=n.data;return[e,r]})}setQueryData(t,e,n){const r=this.defaultQueryOptions({queryKey:t}),s=Te(this,Pr).get(r.queryHash),i=s==null?void 0:s.state.data,l=$M(e,i);if(l!==void 0)return Te(this,Pr).build(this,r).setData(l,{...n,manual:!0})}setQueriesData(t,e,n){return Vs.batch(()=>Te(this,Pr).findAll(t).map(({queryKey:r})=>[r,this.setQueryData(r,e,n)]))}getQueryState(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=Te(this,Pr).get(e.queryHash))==null?void 0:n.state}removeQueries(t){const e=Te(this,Pr);Vs.batch(()=>{e.findAll(t).forEach(n=>{e.remove(n)})})}resetQueries(t,e){const n=Te(this,Pr);return Vs.batch(()=>(n.findAll(t).forEach(r=>{r.reset()}),this.refetchQueries({type:"active",...t},e)))}cancelQueries(t,e={}){const n={revert:!0,...e},r=Vs.batch(()=>Te(this,Pr).findAll(t).map(s=>s.cancel(n)));return Promise.all(r).then(Zi).catch(Zi)}invalidateQueries(t,e={}){return Vs.batch(()=>(Te(this,Pr).findAll(t).forEach(n=>{n.invalidate()}),(t==null?void 0:t.refetchType)==="none"?Promise.resolve():this.refetchQueries({...t,type:(t==null?void 0:t.refetchType)??(t==null?void 0:t.type)??"active"},e)))}refetchQueries(t,e={}){const n={...e,cancelRefetch:e.cancelRefetch??!0},r=Vs.batch(()=>Te(this,Pr).findAll(t).filter(s=>!s.isDisabled()&&!s.isStatic()).map(s=>{let i=s.fetch(void 0,n);return n.throwOnError||(i=i.catch(Zi)),s.state.fetchStatus==="paused"?Promise.resolve():i}));return Promise.all(r).then(Zi)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const n=Te(this,Pr).build(this,e);return n.isStaleByTime(kx(e.staleTime,n))?n.fetch(e):Promise.resolve(n.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(Zi).catch(Zi)}fetchInfiniteQuery(t){return t.behavior=Nb(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(Zi).catch(Zi)}ensureInfiniteQueryData(t){return t.behavior=Nb(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return v0.isOnline()?Te(this,ol).resumePausedMutations():Promise.resolve()}getQueryCache(){return Te(this,Pr)}getMutationCache(){return Te(this,ol)}getDefaultOptions(){return Te(this,ll)}setDefaultOptions(t){nn(this,ll,t)}setQueryDefaults(t,e){Te(this,sd).set(_f(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...Te(this,sd).values()],n={};return e.forEach(r=>{vf(t,r.queryKey)&&Object.assign(n,r.defaultOptions)}),n}setMutationDefaults(t,e){Te(this,id).set(_f(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...Te(this,id).values()],n={};return e.forEach(r=>{vf(t,r.mutationKey)&&Object.assign(n,r.defaultOptions)}),n}defaultQueryOptions(t){if(t._defaulted)return t;const e={...Te(this,ll).queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=ev(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===tv&&(e.enabled=!1),e}defaultMutationOptions(t){return t!=null&&t._defaulted?t:{...Te(this,ll).mutations,...(t==null?void 0:t.mutationKey)&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){Te(this,Pr).clear(),Te(this,ol).clear()}},Pr=new WeakMap,ol=new WeakMap,ll=new WeakMap,sd=new WeakMap,id=new WeakMap,cl=new WeakMap,ad=new WeakMap,od=new WeakMap,rC),d8=q.createContext(void 0),h8=({client:t,children:e})=>(q.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),d.jsx(d8.Provider,{value:t,children:e})),Pb={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VN=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},f8=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],l=t[n++],h=t[n++],p=((s&7)<<18|(i&63)<<12|(l&63)<<6|h&63)-65536;e[r++]=String.fromCharCode(55296+(p>>10)),e[r++]=String.fromCharCode(56320+(p&1023))}else{const i=t[n++],l=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|l&63)}}return e.join("")},BN={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],l=s+1<t.length,h=l?t[s+1]:0,p=s+2<t.length,y=p?t[s+2]:0,_=i>>2,E=(i&3)<<4|h>>4;let T=(h&15)<<2|y>>6,k=y&63;p||(k=64,l||(T=64)),r.push(n[_],n[E],n[T],n[k])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(VN(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):f8(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],h=s<t.length?n[t.charAt(s)]:0;++s;const y=s<t.length?n[t.charAt(s)]:64;++s;const E=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||h==null||y==null||E==null)throw new m8;const T=i<<2|h>>4;if(r.push(T),y!==64){const k=h<<4&240|y>>2;if(r.push(k),E!==64){const L=y<<6&192|E;r.push(L)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};let m8=class extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}};const p8=function(t){const e=VN(t);return BN.encodeByteArray(e,!0)},E0=function(t){return p8(t).replace(/\./g,"")},UN=function(t){try{return BN.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function g8(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y8=()=>g8().__FIREBASE_DEFAULTS__,x8=()=>{if(typeof process>"u"||typeof Pb>"u")return;const t=Pb.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},w8=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&UN(t[1]);return e&&JSON.parse(e)},Og=()=>{try{return y8()||x8()||w8()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},$N=t=>{var e,n;return(n=(e=Og())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},zN=t=>{const e=$N(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},WN=()=>{var t;return(t=Og())===null||t===void 0?void 0:t.config},HN=t=>{var e;return(e=Og())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let _8=class{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GN(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const l=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[E0(JSON.stringify(n)),E0(JSON.stringify(l)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Os(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function v8(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Os())}function E8(){var t;const e=(t=Og())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function b8(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function I8(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function A8(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function T8(){const t=Os();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function C8(){return!E8()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function S8(){try{return typeof indexedDB=="object"}catch{return!1}}function N8(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R8="FirebaseError";let $a=class qN extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=R8,Object.setPrototypeOf(this,qN.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,em.prototype.create)}},em=class{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],l=i?P8(i,r):"Error",h=`${this.serviceName}: ${l} (${s}).`;return new $a(s,h,r)}};function P8(t,e){return t.replace(k8,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const k8=/\{\$([^}]+)}/g;function D8(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function b0(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],l=e[s];if(kb(i)&&kb(l)){if(!b0(i,l))return!1}else if(i!==l)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function kb(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tm(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function yh(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function xh(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function O8(t,e){const n=new M8(t,e);return n.subscribe.bind(n)}let M8=class{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");L8(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=sy),s.error===void 0&&(s.error=sy),s.complete===void 0&&(s.complete=sy);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}};function L8(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function sy(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function es(t){return t&&t._delegate?t._delegate:t}let Dl=class{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ac="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let j8=class{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new _8;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(V8(e))try{this.getOrInitializeService({instanceIdentifier:ac})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=ac){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=ac){return this.instances.has(e)}getOptions(e=ac){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,l]of this.instancesDeferred.entries()){const h=this.normalizeInstanceIdentifier(i);r===h&&l.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const l=this.instances.get(s);return l&&e(l,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:F8(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=ac){return this.component?this.component.multipleInstances?e:ac:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}};function F8(t){return t===ac?void 0:t}function V8(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let B8=class{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new j8(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var kn;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(kn||(kn={}));const U8={debug:kn.DEBUG,verbose:kn.VERBOSE,info:kn.INFO,warn:kn.WARN,error:kn.ERROR,silent:kn.SILENT},$8=kn.INFO,z8={[kn.DEBUG]:"log",[kn.VERBOSE]:"log",[kn.INFO]:"info",[kn.WARN]:"warn",[kn.ERROR]:"error"},W8=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=z8[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};let nv=class{constructor(e){this.name=e,this._logLevel=$8,this._logHandler=W8,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in kn))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?U8[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,kn.DEBUG,...e),this._logHandler(this,kn.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,kn.VERBOSE,...e),this._logHandler(this,kn.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,kn.INFO,...e),this._logHandler(this,kn.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,kn.WARN,...e),this._logHandler(this,kn.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,kn.ERROR,...e),this._logHandler(this,kn.ERROR,...e)}};const H8=(t,e)=>e.some(n=>t instanceof n);let Db,Ob;function G8(){return Db||(Db=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function q8(){return Ob||(Ob=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const KN=new WeakMap,Mx=new WeakMap,XN=new WeakMap,iy=new WeakMap,rv=new WeakMap;function K8(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",l)},i=()=>{n(bl(t.result)),s()},l=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",l)});return e.then(n=>{n instanceof IDBCursor&&KN.set(n,t)}).catch(()=>{}),rv.set(e,t),e}function X8(t){if(Mx.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",l),t.removeEventListener("abort",l)},i=()=>{n(),s()},l=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",l),t.addEventListener("abort",l)});Mx.set(t,e)}let Lx={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Mx.get(t);if(e==="objectStoreNames")return t.objectStoreNames||XN.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return bl(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Q8(t){Lx=t(Lx)}function Y8(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(ay(this),e,...n);return XN.set(r,e.sort?e.sort():[e]),bl(r)}:q8().includes(t)?function(...e){return t.apply(ay(this),e),bl(KN.get(this))}:function(...e){return bl(t.apply(ay(this),e))}}function Z8(t){return typeof t=="function"?Y8(t):(t instanceof IDBTransaction&&X8(t),H8(t,G8())?new Proxy(t,Lx):t)}function bl(t){if(t instanceof IDBRequest)return K8(t);if(iy.has(t))return iy.get(t);const e=Z8(t);return e!==t&&(iy.set(t,e),rv.set(e,t)),e}const ay=t=>rv.get(t);function J8(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const l=indexedDB.open(t,e),h=bl(l);return r&&l.addEventListener("upgradeneeded",p=>{r(bl(l.result),p.oldVersion,p.newVersion,bl(l.transaction),p)}),n&&l.addEventListener("blocked",p=>n(p.oldVersion,p.newVersion,p)),h.then(p=>{i&&p.addEventListener("close",()=>i()),s&&p.addEventListener("versionchange",y=>s(y.oldVersion,y.newVersion,y))}).catch(()=>{}),h}const eL=["get","getKey","getAll","getAllKeys","count"],tL=["put","add","delete","clear"],oy=new Map;function Mb(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(oy.get(e))return oy.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=tL.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||eL.includes(n)))return;const i=async function(l,...h){const p=this.transaction(l,s?"readwrite":"readonly");let y=p.store;return r&&(y=y.index(h.shift())),(await Promise.all([y[n](...h),s&&p.done]))[0]};return oy.set(e,i),i}Q8(t=>({...t,get:(e,n,r)=>Mb(e,n)||t.get(e,n,r),has:(e,n)=>!!Mb(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nL=class{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(rL(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}};function rL(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const jx="@firebase/app",Lb="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ao=new nv("@firebase/app"),sL="@firebase/app-compat",iL="@firebase/analytics-compat",aL="@firebase/analytics",oL="@firebase/app-check-compat",lL="@firebase/app-check",cL="@firebase/auth",uL="@firebase/auth-compat",dL="@firebase/database",hL="@firebase/data-connect",fL="@firebase/database-compat",mL="@firebase/functions",pL="@firebase/functions-compat",gL="@firebase/installations",yL="@firebase/installations-compat",xL="@firebase/messaging",wL="@firebase/messaging-compat",_L="@firebase/performance",vL="@firebase/performance-compat",EL="@firebase/remote-config",bL="@firebase/remote-config-compat",IL="@firebase/storage",AL="@firebase/storage-compat",TL="@firebase/firestore",CL="@firebase/vertexai-preview",SL="@firebase/firestore-compat",NL="firebase",RL="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fx="[DEFAULT]",PL={[jx]:"fire-core",[sL]:"fire-core-compat",[aL]:"fire-analytics",[iL]:"fire-analytics-compat",[lL]:"fire-app-check",[oL]:"fire-app-check-compat",[cL]:"fire-auth",[uL]:"fire-auth-compat",[dL]:"fire-rtdb",[hL]:"fire-data-connect",[fL]:"fire-rtdb-compat",[mL]:"fire-fn",[pL]:"fire-fn-compat",[gL]:"fire-iid",[yL]:"fire-iid-compat",[xL]:"fire-fcm",[wL]:"fire-fcm-compat",[_L]:"fire-perf",[vL]:"fire-perf-compat",[EL]:"fire-rc",[bL]:"fire-rc-compat",[IL]:"fire-gcs",[AL]:"fire-gcs-compat",[TL]:"fire-fst",[SL]:"fire-fst-compat",[CL]:"fire-vertex","fire-js":"fire-js",[NL]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ef=new Map,kL=new Map,Vx=new Map;function jb(t,e){try{t.container.addComponent(e)}catch(n){Ao.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Bc(t){const e=t.name;if(Vx.has(e))return Ao.debug(`There were multiple attempts to register component ${e}.`),!1;Vx.set(e,t);for(const n of Ef.values())jb(n,t);for(const n of kL.values())jb(n,t);return!0}function Mg(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Aa(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DL={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Il=new em("app","Firebase",DL);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let OL=class{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Dl("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Il.create("app-deleted",{appName:this._name})}};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nu=RL;function QN(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Fx,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw Il.create("bad-app-name",{appName:String(s)});if(n||(n=WN()),!n)throw Il.create("no-options");const i=Ef.get(s);if(i){if(b0(n,i.options)&&b0(r,i.config))return i;throw Il.create("duplicate-app",{appName:s})}const l=new B8(s);for(const p of Vx.values())l.addComponent(p);const h=new OL(n,r,l);return Ef.set(s,h),h}function sv(t=Fx){const e=Ef.get(t);if(!e&&t===Fx&&WN())return QN();if(!e)throw Il.create("no-app",{appName:t});return e}function Fb(){return Array.from(Ef.values())}function ka(t,e,n){var r;let s=(r=PL[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),l=e.match(/\s|\//);if(i||l){const h=[`Unable to register library "${s}" with version "${e}":`];i&&h.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&l&&h.push("and"),l&&h.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ao.warn(h.join(" "));return}Bc(new Dl(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ML="firebase-heartbeat-database",LL=1,bf="firebase-heartbeat-store";let ly=null;function YN(){return ly||(ly=J8(ML,LL,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(bf)}catch(n){console.warn(n)}}}}).catch(t=>{throw Il.create("idb-open",{originalErrorMessage:t.message})})),ly}async function jL(t){try{const n=(await YN()).transaction(bf),r=await n.objectStore(bf).get(ZN(t));return await n.done,r}catch(e){if(e instanceof $a)Ao.warn(e.message);else{const n=Il.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Ao.warn(n.message)}}}async function Vb(t,e){try{const r=(await YN()).transaction(bf,"readwrite");await r.objectStore(bf).put(e,ZN(t)),await r.done}catch(n){if(n instanceof $a)Ao.warn(n.message);else{const r=Il.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Ao.warn(r.message)}}}function ZN(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const FL=1024,VL=30*24*60*60*1e3;let BL=class{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new $L(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=Bb();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(l=>l.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(l=>{const h=new Date(l.date).valueOf();return Date.now()-h<=VL}),this._storage.overwrite(this._heartbeatsCache))}catch(r){Ao.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=Bb(),{heartbeatsToSend:r,unsentEntries:s}=UL(this._heartbeatsCache.heartbeats),i=E0(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return Ao.warn(n),""}}};function Bb(){return new Date().toISOString().substring(0,10)}function UL(t,e=FL){const n=[];let r=t.slice();for(const s of t){const i=n.find(l=>l.agent===s.agent);if(i){if(i.dates.push(s.date),Ub(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),Ub(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}let $L=class{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return S8()?N8().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await jL(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Vb(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Vb(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}};function Ub(t){return E0(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zL(t){Bc(new Dl("platform-logger",e=>new nL(e),"PRIVATE")),Bc(new Dl("heartbeat",e=>new BL(e),"PRIVATE")),ka(jx,Lb,t),ka(jx,Lb,"esm2017"),ka("fire-js","")}zL("");function iv(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function JN(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const WL=JN,eR=new em("auth","Firebase",JN());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const I0=new nv("@firebase/auth");function HL(t,...e){I0.logLevel<=kn.WARN&&I0.warn(`Auth (${nu}): ${t}`,...e)}function vp(t,...e){I0.logLevel<=kn.ERROR&&I0.error(`Auth (${nu}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ua(t,...e){throw av(t,...e)}function Da(t,...e){return av(t,...e)}function tR(t,e,n){const r=Object.assign(Object.assign({},WL()),{[e]:n});return new em("auth","Firebase",r).create(e,{appName:t.name})}function yo(t){return tR(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function av(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return eR.create(t,...e)}function Jt(t,e,...n){if(!t)throw av(e,...n)}function co(t){const e="INTERNAL ASSERTION FAILED: "+t;throw vp(e),new Error(e)}function To(t,e){t||co(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bx(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function GL(){return $b()==="http:"||$b()==="https:"}function $b(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qL(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(GL()||I8()||"connection"in navigator)?navigator.onLine:!0}function KL(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nm=class{constructor(e,n){this.shortDelay=e,this.longDelay=n,To(n>e,"Short delay should be less than long delay!"),this.isMobile=v8()||A8()}get(){return qL()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ov(t,e){To(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let nR=class{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;co("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;co("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;co("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const XL={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QL=new nm(3e4,6e4);function Bo(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function Uo(t,e,n,r,s={}){return rR(t,s,async()=>{let i={},l={};r&&(e==="GET"?l=r:i={body:JSON.stringify(r)});const h=tm(Object.assign({key:t.config.apiKey},l)).slice(1),p=await t._getAdditionalHeaders();p["Content-Type"]="application/json",t.languageCode&&(p["X-Firebase-Locale"]=t.languageCode);const y=Object.assign({method:e,headers:p},i);return b8()||(y.referrerPolicy="no-referrer"),nR.fetch()(sR(t,t.config.apiHost,n,h),y)})}async function rR(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},XL),e);try{const s=new ZL(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const l=await i.json();if("needConfirmation"in l)throw Xm(t,"account-exists-with-different-credential",l);if(i.ok&&!("errorMessage"in l))return l;{const h=i.ok?l.errorMessage:l.error.message,[p,y]=h.split(" : ");if(p==="FEDERATED_USER_ID_ALREADY_LINKED")throw Xm(t,"credential-already-in-use",l);if(p==="EMAIL_EXISTS")throw Xm(t,"email-already-in-use",l);if(p==="USER_DISABLED")throw Xm(t,"user-disabled",l);const _=r[p]||p.toLowerCase().replace(/[_\s]+/g,"-");if(y)throw tR(t,_,y);ua(t,_)}}catch(s){if(s instanceof $a)throw s;ua(t,"network-request-failed",{message:String(s)})}}async function rm(t,e,n,r,s={}){const i=await Uo(t,e,n,r,s);return"mfaPendingCredential"in i&&ua(t,"multi-factor-auth-required",{_serverResponse:i}),i}function sR(t,e,n,r){const s=`${e}${n}?${r}`;return t.config.emulator?ov(t.config,s):`${t.config.apiScheme}://${s}`}function YL(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}let ZL=class{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Da(this.auth,"network-request-failed")),QL.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}};function Xm(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=Da(t,e,r);return s.customData._tokenResponse=n,s}function zb(t){return t!==void 0&&t.enterprise!==void 0}class JL{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return YL(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}}async function ej(t,e){return Uo(t,"GET","/v2/recaptchaConfig",Bo(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function tj(t,e){return Uo(t,"POST","/v1/accounts:delete",e)}async function iR(t,e){return Uo(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bh(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function nj(t,e=!1){const n=es(t),r=await n.getIdToken(e),s=lv(r);Jt(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,l=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:Bh(cy(s.auth_time)),issuedAtTime:Bh(cy(s.iat)),expirationTime:Bh(cy(s.exp)),signInProvider:l||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function cy(t){return Number(t)*1e3}function lv(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return vp("JWT malformed, contained fewer than 3 sections"),null;try{const s=UN(n);return s?JSON.parse(s):(vp("Failed to decode base64 JWT payload"),null)}catch(s){return vp("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function Wb(t){const e=lv(t);return Jt(e,"internal-error"),Jt(typeof e.exp<"u","internal-error"),Jt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function If(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof $a&&rj(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function rj({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let sj=class{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ux=class{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Bh(this.lastLoginAt),this.creationTime=Bh(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function A0(t){var e;const n=t.auth,r=await t.getIdToken(),s=await If(t,iR(n,{idToken:r}));Jt(s==null?void 0:s.users.length,n,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const l=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?aR(i.providerUserInfo):[],h=aj(t.providerData,l),p=t.isAnonymous,y=!(t.email&&i.passwordHash)&&!(h!=null&&h.length),_=p?y:!1,E={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:h,metadata:new Ux(i.createdAt,i.lastLoginAt),isAnonymous:_};Object.assign(t,E)}async function ij(t){const e=es(t);await A0(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function aj(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function aR(t){return t.map(e=>{var{providerId:n}=e,r=iv(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oj(t,e){const n=await rR(t,{},async()=>{const r=tm({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,l=sR(t,s,"/v1/token",`key=${i}`),h=await t._getAdditionalHeaders();return h["Content-Type"]="application/x-www-form-urlencoded",nR.fetch()(l,{method:"POST",headers:h,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function lj(t,e){return Uo(t,"POST","/v2/accounts:revokeToken",Bo(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let uy=class $x{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Jt(e.idToken,"internal-error"),Jt(typeof e.idToken<"u","internal-error"),Jt(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):Wb(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Jt(e.length!==0,"internal-error");const n=Wb(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Jt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await oj(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,l=new $x;return r&&(Jt(typeof r=="string","internal-error",{appName:e}),l.refreshToken=r),s&&(Jt(typeof s=="string","internal-error",{appName:e}),l.accessToken=s),i&&(Jt(typeof i=="number","internal-error",{appName:e}),l.expirationTime=i),l}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new $x,this.toJSON())}_performRefresh(){return co("not implemented")}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ho(t,e){Jt(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}let T0=class wh{constructor(e){var{uid:n,auth:r,stsTokenManager:s}=e,i=iv(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new sj(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Ux(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await If(this,this.stsTokenManager.getToken(this.auth,e));return Jt(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return nj(this,e)}reload(){return ij(this)}_assign(e){this!==e&&(Jt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new wh(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){Jt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await A0(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Aa(this.auth.app))return Promise.reject(yo(this.auth));const e=await this.getIdToken();return await If(this,tj(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,s,i,l,h,p,y,_;const E=(r=n.displayName)!==null&&r!==void 0?r:void 0,T=(s=n.email)!==null&&s!==void 0?s:void 0,k=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,L=(l=n.photoURL)!==null&&l!==void 0?l:void 0,B=(h=n.tenantId)!==null&&h!==void 0?h:void 0,H=(p=n._redirectEventId)!==null&&p!==void 0?p:void 0,W=(y=n.createdAt)!==null&&y!==void 0?y:void 0,M=(_=n.lastLoginAt)!==null&&_!==void 0?_:void 0,{uid:U,emailVerified:$,isAnonymous:K,providerData:Z,stsTokenManager:A}=n;Jt(U&&A,e,"internal-error");const C=uy.fromJSON(this.name,A);Jt(typeof U=="string",e,"internal-error"),Ho(E,e.name),Ho(T,e.name),Jt(typeof $=="boolean",e,"internal-error"),Jt(typeof K=="boolean",e,"internal-error"),Ho(k,e.name),Ho(L,e.name),Ho(B,e.name),Ho(H,e.name),Ho(W,e.name),Ho(M,e.name);const N=new wh({uid:U,auth:e,email:T,emailVerified:$,displayName:E,isAnonymous:K,photoURL:L,phoneNumber:k,tenantId:B,stsTokenManager:C,createdAt:W,lastLoginAt:M});return Z&&Array.isArray(Z)&&(N.providerData=Z.map(D=>Object.assign({},D))),H&&(N._redirectEventId=H),N}static async _fromIdTokenResponse(e,n,r=!1){const s=new uy;s.updateFromServerResponse(n);const i=new wh({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await A0(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];Jt(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?aR(s.providerUserInfo):[],l=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),h=new uy;h.updateFromIdToken(r);const p=new wh({uid:s.localId,auth:e,stsTokenManager:h,isAnonymous:l}),y={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new Ux(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(p,y),p}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hb=new Map;function uo(t){To(t instanceof Function,"Expected a class definition");let e=Hb.get(t);return e?(To(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,Hb.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let oR=class{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}};oR.type="NONE";const Gb=oR;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ep(t,e,n){return`firebase:${t}:${e}:${n}`}let qb=class bp{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Ep(this.userKey,s.apiKey,i),this.fullPersistenceKey=Ep("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?T0._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new bp(uo(Gb),e,r);const s=(await Promise.all(n.map(async y=>{if(await y._isAvailable())return y}))).filter(y=>y);let i=s[0]||uo(Gb);const l=Ep(r,e.config.apiKey,e.name);let h=null;for(const y of n)try{const _=await y._get(l);if(_){const E=T0._fromJSON(e,_);y!==i&&(h=E),i=y;break}}catch{}const p=s.filter(y=>y._shouldAllowMigration);return!i._shouldAllowMigration||!p.length?new bp(i,e,r):(i=p[0],h&&await i._set(l,h.toJSON()),await Promise.all(n.map(async y=>{if(y!==i)try{await y._remove(l)}catch{}})),new bp(i,e,r))}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kb(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(dR(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(lR(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(fR(e))return"Blackberry";if(mR(e))return"Webos";if(cR(e))return"Safari";if((e.includes("chrome/")||uR(e))&&!e.includes("edge/"))return"Chrome";if(hR(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function lR(t=Os()){return/firefox\//i.test(t)}function cR(t=Os()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function uR(t=Os()){return/crios\//i.test(t)}function dR(t=Os()){return/iemobile/i.test(t)}function hR(t=Os()){return/android/i.test(t)}function fR(t=Os()){return/blackberry/i.test(t)}function mR(t=Os()){return/webos/i.test(t)}function cv(t=Os()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function cj(t=Os()){var e;return cv(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function uj(){return T8()&&document.documentMode===10}function pR(t=Os()){return cv(t)||hR(t)||mR(t)||fR(t)||/windows phone/i.test(t)||dR(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gR(t,e=[]){let n;switch(t){case"Browser":n=Kb(Os());break;case"Worker":n=`${Kb(Os())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${nu}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let dj=class{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((l,h)=>{try{const p=e(i);l(p)}catch(p){h(p)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}};/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hj(t,e={}){return Uo(t,"GET","/v2/passwordPolicy",Bo(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fj=6;let mj=class{constructor(e){var n,r,s,i;const l=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=l.minPasswordLength)!==null&&n!==void 0?n:fj,l.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=l.maxPasswordLength),l.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=l.containsLowercaseCharacter),l.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=l.containsUppercaseCharacter),l.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=l.containsNumericCharacter),l.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=l.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,s,i,l,h;const p={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,p),this.validatePasswordCharacterOptions(e,p),p.isValid&&(p.isValid=(n=p.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),p.isValid&&(p.isValid=(r=p.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),p.isValid&&(p.isValid=(s=p.containsLowercaseLetter)!==null&&s!==void 0?s:!0),p.isValid&&(p.isValid=(i=p.containsUppercaseLetter)!==null&&i!==void 0?i:!0),p.isValid&&(p.isValid=(l=p.containsNumericCharacter)!==null&&l!==void 0?l:!0),p.isValid&&(p.isValid=(h=p.containsNonAlphanumericCharacter)!==null&&h!==void 0?h:!0),p}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let pj=class{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Xb(this),this.idTokenSubscription=new Xb(this),this.beforeStateQueue=new dj(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=eR,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=uo(n)),this._initializationPromise=this.queue(async()=>{var r,s;if(!this._deleted&&(this.persistenceManager=await qb.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await iR(this,{idToken:e}),r=await T0._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(Aa(this.app)){const l=this.app.settings.authIdToken;return l?new Promise(h=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(l).then(h,h))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const l=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,h=s==null?void 0:s._redirectEventId,p=await this.tryRedirectSignIn(e);(!l||l===h)&&(p!=null&&p.user)&&(s=p.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(l){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(l))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return Jt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await A0(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=KL()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Aa(this.app))return Promise.reject(yo(this));const n=e?es(e):null;return n&&Jt(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Jt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Aa(this.app)?Promise.reject(yo(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Aa(this.app)?Promise.reject(yo(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(uo(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await hj(this),n=new mj(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new em("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await lj(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&uo(e)||this._popupRedirectResolver;Jt(n,this,"argument-error"),this.redirectPersistenceManager=await qb.create(this,[uo(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let l=!1;const h=this._isInitialized?Promise.resolve():this._initializationPromise;if(Jt(h,this,"internal-error"),h.then(()=>{l||i(this.currentUser)}),typeof n=="function"){const p=e.addObserver(n,r,s);return()=>{l=!0,p()}}else{const p=e.addObserver(n);return()=>{l=!0,p()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Jt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=gR(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(n["X-Firebase-AppCheck"]=s),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&HL(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}};function Wl(t){return es(t)}let Xb=class{constructor(e){this.auth=e,this.observer=null,this.addObserver=O8(n=>this.observer=n)}get next(){return Jt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Lg={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function gj(t){Lg=t}function yR(t){return Lg.loadJS(t)}function yj(){return Lg.recaptchaEnterpriseScript}function xj(){return Lg.gapiScript}function wj(t){return`__${t}${Math.floor(Math.random()*1e6)}`}const _j="recaptcha-enterprise",vj="NO_RECAPTCHA";class Ej{constructor(e){this.type=_j,this.auth=Wl(e)}async verify(e="verify",n=!1){async function r(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(l,h)=>{ej(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(p=>{if(p.recaptchaKey===void 0)h(new Error("recaptcha Enterprise site key undefined"));else{const y=new JL(p);return i.tenantId==null?i._agentRecaptchaConfig=y:i._tenantRecaptchaConfigs[i.tenantId]=y,l(y.siteKey)}}).catch(p=>{h(p)})})}function s(i,l,h){const p=window.grecaptcha;zb(p)?p.enterprise.ready(()=>{p.enterprise.execute(i,{action:e}).then(y=>{l(y)}).catch(()=>{l(vj)})}):h(Error("No reCAPTCHA enterprise script loaded."))}return new Promise((i,l)=>{r(this.auth).then(h=>{if(!n&&zb(window.grecaptcha))s(h,i,l);else{if(typeof window>"u"){l(new Error("RecaptchaVerifier is only supported in browser"));return}let p=yj();p.length!==0&&(p+=h),yR(p).then(()=>{s(h,i,l)}).catch(y=>{l(y)})}}).catch(h=>{l(h)})})}}async function Qb(t,e,n,r=!1){const s=new Ej(t);let i;try{i=await s.verify(n)}catch{i=await s.verify(n,!0)}const l=Object.assign({},e);return r?Object.assign(l,{captchaResp:i}):Object.assign(l,{captchaResponse:i}),Object.assign(l,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(l,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),l}async function C0(t,e,n,r){var s;if(!((s=t._getRecaptchaConfig())===null||s===void 0)&&s.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await Qb(t,e,n,n==="getOobCode");return r(t,i)}else return r(t,e).catch(async i=>{if(i.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const l=await Qb(t,e,n,n==="getOobCode");return r(t,l)}else return Promise.reject(i)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bj(t,e){const n=Mg(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(b0(i,e??{}))return s;ua(s,"already-initialized")}return n.initialize({options:e})}function Ij(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(uo);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function Aj(t,e,n){const r=Wl(t);Jt(r._canInitEmulator,r,"emulator-config-failed"),Jt(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=xR(e),{host:l,port:h}=Tj(e),p=h===null?"":`:${h}`;r.config.emulator={url:`${i}//${l}${p}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:l,port:h,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),Cj()}function xR(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function Tj(t){const e=xR(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:Yb(r.substr(i.length+1))}}else{const[i,l]=r.split(":");return{host:i,port:Yb(l)}}}function Yb(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function Cj(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let uv=class{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return co("not implemented")}_getIdTokenResponse(e){return co("not implemented")}_linkToIdToken(e,n){return co("not implemented")}_getReauthenticationResolver(e){return co("not implemented")}};async function Sj(t,e){return Uo(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Nj(t,e){return rm(t,"POST","/v1/accounts:signInWithPassword",Bo(t,e))}async function Rj(t,e){return Uo(t,"POST","/v1/accounts:sendOobCode",Bo(t,e))}async function Pj(t,e){return Rj(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kj(t,e){return rm(t,"POST","/v1/accounts:signInWithEmailLink",Bo(t,e))}async function Dj(t,e){return rm(t,"POST","/v1/accounts:signInWithEmailLink",Bo(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Af extends uv{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new Af(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new Af(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return C0(e,n,"signInWithPassword",Nj);case"emailLink":return kj(e,{email:this._email,oobCode:this._password});default:ua(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return C0(e,r,"signUpPassword",Sj);case"emailLink":return Dj(e,{idToken:n,email:this._email,oobCode:this._password});default:ua(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ku(t,e){return rm(t,"POST","/v1/accounts:signInWithIdp",Bo(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oj="http://localhost";let jg=class zx extends uv{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new zx(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):ua("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=n,i=iv(n,["providerId","signInMethod"]);if(!r||!s)return null;const l=new zx(r,s);return l.idToken=i.idToken||void 0,l.accessToken=i.accessToken||void 0,l.secret=i.secret,l.nonce=i.nonce,l.pendingToken=i.pendingToken||null,l}_getIdTokenResponse(e){const n=this.buildRequest();return Ku(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Ku(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Ku(e,n)}buildRequest(){const e={requestUri:Oj,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=tm(n)}return e}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mj(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function Lj(t){const e=yh(xh(t)).link,n=e?yh(xh(e)).deep_link_id:null,r=yh(xh(t)).deep_link_id;return(r?yh(xh(r)).link:null)||r||n||e||t}class dv{constructor(e){var n,r,s,i,l,h;const p=yh(xh(e)),y=(n=p.apiKey)!==null&&n!==void 0?n:null,_=(r=p.oobCode)!==null&&r!==void 0?r:null,E=Mj((s=p.mode)!==null&&s!==void 0?s:null);Jt(y&&_&&E,"argument-error"),this.apiKey=y,this.operation=E,this.code=_,this.continueUrl=(i=p.continueUrl)!==null&&i!==void 0?i:null,this.languageCode=(l=p.languageCode)!==null&&l!==void 0?l:null,this.tenantId=(h=p.tenantId)!==null&&h!==void 0?h:null}static parseLink(e){const n=Lj(e);try{return new dv(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Od{constructor(){this.providerId=Od.PROVIDER_ID}static credential(e,n){return Af._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=dv.parseLink(n);return Jt(r,"argument-error"),Af._fromEmailAndCode(e,r.code,r.tenantId)}}Od.PROVIDER_ID="password";Od.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Od.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wR=class{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let sm=class extends wR{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let _R=class gu extends sm{constructor(){super("facebook.com")}static credential(e){return jg._fromParams({providerId:gu.PROVIDER_ID,signInMethod:gu.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return gu.credentialFromTaggedObject(e)}static credentialFromError(e){return gu.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return gu.credential(e.oauthAccessToken)}catch{return null}}};_R.FACEBOOK_SIGN_IN_METHOD="facebook.com";_R.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let vR=class yu extends sm{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return jg._fromParams({providerId:yu.PROVIDER_ID,signInMethod:yu.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return yu.credentialFromTaggedObject(e)}static credentialFromError(e){return yu.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return yu.credential(n,r)}catch{return null}}};vR.GOOGLE_SIGN_IN_METHOD="google.com";vR.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ER=class xu extends sm{constructor(){super("github.com")}static credential(e){return jg._fromParams({providerId:xu.PROVIDER_ID,signInMethod:xu.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return xu.credentialFromTaggedObject(e)}static credentialFromError(e){return xu.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return xu.credential(e.oauthAccessToken)}catch{return null}}};ER.GITHUB_SIGN_IN_METHOD="github.com";ER.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let bR=class wu extends sm{constructor(){super("twitter.com")}static credential(e,n){return jg._fromParams({providerId:wu.PROVIDER_ID,signInMethod:wu.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return wu.credentialFromTaggedObject(e)}static credentialFromError(e){return wu.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return wu.credential(n,r)}catch{return null}}};bR.TWITTER_SIGN_IN_METHOD="twitter.com";bR.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function jj(t,e){return rm(t,"POST","/v1/accounts:signUp",Bo(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Fg=class Wx{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await T0._fromIdTokenResponse(e,r,s),l=Zb(r);return new Wx({user:i,providerId:l,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=Zb(r);return new Wx({user:e,providerId:s,_tokenResponse:r,operationType:n})}};function Zb(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Fj=class Hx extends $a{constructor(e,n,r,s){var i;super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,Hx.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new Hx(e,n,r,s)}};function IR(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?Fj._fromErrorAndOperation(t,i,e,r):i})}async function Vj(t,e,n=!1){const r=await If(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Fg._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bj(t,e,n=!1){const{auth:r}=t;if(Aa(r.app))return Promise.reject(yo(r));const s="reauthenticate";try{const i=await If(t,IR(r,s,e,t),n);Jt(i.idToken,r,"internal-error");const l=lv(i.idToken);Jt(l,r,"internal-error");const{sub:h}=l;return Jt(t.uid===h,r,"user-mismatch"),Fg._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&ua(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function AR(t,e,n=!1){if(Aa(t.app))return Promise.reject(yo(t));const r="signIn",s=await IR(t,r,e),i=await Fg._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}async function Uj(t,e){return AR(Wl(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function TR(t){const e=Wl(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function $j(t,e,n){const r=Wl(t);await C0(r,{requestType:"PASSWORD_RESET",email:e,clientType:"CLIENT_TYPE_WEB"},"getOobCode",Pj)}async function zj(t,e,n){if(Aa(t.app))return Promise.reject(yo(t));const r=Wl(t),l=await C0(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",jj).catch(p=>{throw p.code==="auth/password-does-not-meet-requirements"&&TR(t),p}),h=await Fg._fromIdTokenResponse(r,"signIn",l);return await r._updateCurrentUser(h.user),h}function Wj(t,e,n){return Aa(t.app)?Promise.reject(yo(t)):Uj(es(t),Od.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&TR(t),r})}function Hj(t,e,n,r){return es(t).onIdTokenChanged(e,n,r)}function Gj(t,e,n){return es(t).beforeAuthStateChanged(e,n)}function qj(t,e,n,r){return es(t).onAuthStateChanged(e,n,r)}function Ip(t){return es(t).signOut()}const S0="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let CR=class{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(S0,"1"),this.storage.removeItem(S0),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kj=1e3,Xj=10;let SR=class extends CR{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=pR(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((l,h,p)=>{this.notifyListeners(l,p)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const l=this.storage.getItem(r);!n&&this.localCache[r]===l||this.notifyListeners(r,l)},i=this.storage.getItem(r);uj()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,Xj):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},Kj)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}};SR.type="LOCAL";const Qj=SR;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let NR=class extends CR{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}};NR.type="SESSION";const RR=NR;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Yj(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let PR=class kR{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new kR(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,l=this.handlersMap[s];if(!(l!=null&&l.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const h=Array.from(l).map(async y=>y(n.origin,i)),p=await Yj(h);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:p})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}};PR.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hv(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Zj=class{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,l;return new Promise((h,p)=>{const y=hv("",20);s.port1.start();const _=setTimeout(()=>{p(new Error("unsupported_event"))},r);l={messageChannel:s,onMessage(E){const T=E;if(T.data.eventId===y)switch(T.data.status){case"ack":clearTimeout(_),i=setTimeout(()=>{p(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),h(T.data.response);break;default:clearTimeout(_),clearTimeout(i),p(new Error("invalid_response"));break}}},this.handlers.add(l),s.port1.addEventListener("message",l.onMessage),this.target.postMessage({eventType:e,eventId:y,data:n},[s.port2])}).finally(()=>{l&&this.removeMessageHandler(l)})}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oa(){return window}function Jj(t){Oa().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DR(){return typeof Oa().WorkerGlobalScope<"u"&&typeof Oa().importScripts=="function"}async function e9(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function t9(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function n9(){return DR()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OR="firebaseLocalStorageDb",r9=1,N0="firebaseLocalStorage",MR="fbase_key";let im=class{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}};function Vg(t,e){return t.transaction([N0],e?"readwrite":"readonly").objectStore(N0)}function s9(){const t=indexedDB.deleteDatabase(OR);return new im(t).toPromise()}function Gx(){const t=indexedDB.open(OR,r9);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(N0,{keyPath:MR})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(N0)?e(r):(r.close(),await s9(),e(await Gx()))})})}async function Jb(t,e,n){const r=Vg(t,!0).put({[MR]:e,value:n});return new im(r).toPromise()}async function i9(t,e){const n=Vg(t,!1).get(e),r=await new im(n).toPromise();return r===void 0?null:r.value}function eI(t,e){const n=Vg(t,!0).delete(e);return new im(n).toPromise()}const a9=800,o9=3;let LR=class{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Gx(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>o9)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return DR()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=PR._getInstance(n9()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await e9(),!this.activeServiceWorker)return;this.sender=new Zj(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||t9()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Gx();return await Jb(e,S0,"1"),await eI(e,S0),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>Jb(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>i9(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>eI(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=Vg(s,!1).getAll();return new im(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),a9)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}};LR.type="LOCAL";const l9=LR;new nm(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c9(t,e){return e?uo(e):(Jt(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let fv=class extends uv{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ku(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Ku(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Ku(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}};function u9(t){return AR(t.auth,new fv(t),t.bypassAuthState)}function d9(t){const{auth:e,user:n}=t;return Jt(n,e,"internal-error"),Bj(n,new fv(t),t.bypassAuthState)}async function h9(t){const{auth:e,user:n}=t;return Jt(n,e,"internal-error"),Vj(n,new fv(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let jR=class{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:l,type:h}=e;if(l){this.reject(l);return}const p={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(h)(p))}catch(y){this.reject(y)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return u9;case"linkViaPopup":case"linkViaRedirect":return h9;case"reauthViaPopup":case"reauthViaRedirect":return d9;default:ua(this.auth,"internal-error")}}resolve(e){To(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){To(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const f9=new nm(2e3,1e4);let m9=class _h extends jR{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,_h.currentPopupAction&&_h.currentPopupAction.cancel(),_h.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Jt(e,this.auth,"internal-error"),e}async onExecution(){To(this.filter.length===1,"Popup operations only handle one event");const e=hv();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Da(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Da(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,_h.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Da(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,f9.get())};e()}};m9.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const p9="pendingRedirect",Ap=new Map;let g9=class extends jR{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Ap.get(this.auth._key());if(!e){try{const r=await y9(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Ap.set(this.auth._key(),e)}return this.bypassAuthState||Ap.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}};async function y9(t,e){const n=_9(e),r=w9(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function x9(t,e){Ap.set(t._key(),e)}function w9(t){return uo(t._redirectPersistence)}function _9(t){return Ep(p9,t.config.apiKey,t.name)}async function v9(t,e,n=!1){if(Aa(t.app))return Promise.reject(yo(t));const r=Wl(t),s=c9(r,e),l=await new g9(r,s,n).execute();return l&&!n&&(delete l.user._redirectEventId,await r._persistUserIfCurrent(l.user),await r._setRedirectUser(null,e)),l}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E9=10*60*1e3;let b9=class{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!I9(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!FR(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(Da(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=E9&&this.cachedEventUids.clear(),this.cachedEventUids.has(tI(e))}saveEventToCache(e){this.cachedEventUids.add(tI(e)),this.lastProcessedEventTime=Date.now()}};function tI(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function FR({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function I9(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return FR(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function A9(t,e={}){return Uo(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const T9=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,C9=/^https?/;async function S9(t){if(t.config.emulator)return;const{authorizedDomains:e}=await A9(t);for(const n of e)try{if(N9(n))return}catch{}ua(t,"unauthorized-domain")}function N9(t){const e=Bx(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const l=new URL(t);return l.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&l.hostname===r}if(!C9.test(n))return!1;if(T9.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R9=new nm(3e4,6e4);function nI(){const t=Oa().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function P9(t){return new Promise((e,n)=>{var r,s,i;function l(){nI(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{nI(),n(Da(t,"network-request-failed"))},timeout:R9.get()})}if(!((s=(r=Oa().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=Oa().gapi)===null||i===void 0)&&i.load)l();else{const h=wj("iframefcb");return Oa()[h]=()=>{gapi.load?l():n(Da(t,"network-request-failed"))},yR(`${xj()}?onload=${h}`).catch(p=>n(p))}}).catch(e=>{throw Tp=null,e})}let Tp=null;function k9(t){return Tp=Tp||P9(t),Tp}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D9=new nm(5e3,15e3),O9="__/auth/iframe",M9="emulator/auth/iframe",L9={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},j9=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function F9(t){const e=t.config;Jt(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?ov(e,M9):`https://${t.config.authDomain}/${O9}`,r={apiKey:e.apiKey,appName:t.name,v:nu},s=j9.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${tm(r).slice(1)}`}async function V9(t){const e=await k9(t),n=Oa().gapi;return Jt(n,t,"internal-error"),e.open({where:document.body,url:F9(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:L9,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const l=Da(t,"network-request-failed"),h=Oa().setTimeout(()=>{i(l)},D9.get());function p(){Oa().clearTimeout(h),s(r)}r.ping(p).then(p,()=>{i(l)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B9={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},U9=500,$9=600,z9="_blank",W9="http://localhost";let rI=class{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}};function H9(t,e,n,r=U9,s=$9){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),l=Math.max((window.screen.availWidth-r)/2,0).toString();let h="";const p=Object.assign(Object.assign({},B9),{width:r.toString(),height:s.toString(),top:i,left:l}),y=Os().toLowerCase();n&&(h=uR(y)?z9:n),lR(y)&&(e=e||W9,p.scrollbars="yes");const _=Object.entries(p).reduce((T,[k,L])=>`${T}${k}=${L},`,"");if(cj(y)&&h!=="_self")return G9(e||"",h),new rI(null);const E=window.open(e||"",h,_);Jt(E,t,"popup-blocked");try{E.focus()}catch{}return new rI(E)}function G9(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const q9="__/auth/handler",K9="emulator/auth/handler",X9=encodeURIComponent("fac");async function sI(t,e,n,r,s,i){Jt(t.config.authDomain,t,"auth-domain-config-required"),Jt(t.config.apiKey,t,"invalid-api-key");const l={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:nu,eventId:s};if(e instanceof wR){e.setDefaultLanguage(t.languageCode),l.providerId=e.providerId||"",D8(e.getCustomParameters())||(l.customParameters=JSON.stringify(e.getCustomParameters()));for(const[_,E]of Object.entries({}))l[_]=E}if(e instanceof sm){const _=e.getScopes().filter(E=>E!=="");_.length>0&&(l.scopes=_.join(","))}t.tenantId&&(l.tid=t.tenantId);const h=l;for(const _ of Object.keys(h))h[_]===void 0&&delete h[_];const p=await t._getAppCheckToken(),y=p?`#${X9}=${encodeURIComponent(p)}`:"";return`${Q9(t)}?${tm(h).slice(1)}${y}`}function Q9({config:t}){return t.emulator?ov(t,K9):`https://${t.authDomain}/${q9}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dy="webStorageSupport";let Y9=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=RR,this._completeRedirectFn=v9,this._overrideRedirectResult=x9}async _openPopup(e,n,r,s){var i;To((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const l=await sI(e,n,r,Bx(),s);return H9(e,l,hv())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await sI(e,n,r,Bx(),s);return Jj(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(To(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await V9(e),r=new b9(e);return n.register("authEvent",s=>(Jt(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(dy,{type:dy},s=>{var i;const l=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[dy];l!==void 0&&n(!!l),ua(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=S9(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return pR()||cR()||cv()}};const Z9=Y9;var iI="@firebase/auth",aI="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let J9=class{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Jt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eF(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function tF(t){Bc(new Dl("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:l,authDomain:h}=r.options;Jt(l&&!l.includes(":"),"invalid-api-key",{appName:r.name});const p={apiKey:l,authDomain:h,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:gR(t)},y=new pj(r,s,i,p);return Ij(y,n),y},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Bc(new Dl("auth-internal",e=>{const n=Wl(e.getProvider("auth").getImmediate());return(r=>new J9(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),ka(iI,aI,eF(t)),ka(iI,aI,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nF=5*60,rF=HN("authIdTokenMaxAge")||nF;let oI=null;const sF=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>rF)return;const s=n==null?void 0:n.token;oI!==s&&(oI=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function iF(t=sv()){const e=Mg(t,"auth");if(e.isInitialized())return e.getImmediate();const n=bj(t,{popupRedirectResolver:Z9,persistence:[l9,Qj,RR]}),r=HN("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const l=sF(i.toString());Gj(n,l,()=>l(n.currentUser)),Hj(n,h=>l(h))}}const s=$N("auth");return s&&Aj(n,`http://${s}`),n}function aF(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}gj({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=Da("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",aF().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});tF("Browser");var oF="firebase",lF="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ka(oF,lF,"app");var lI=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Rc,VR;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(A,C){function N(){}N.prototype=C.prototype,A.D=C.prototype,A.prototype=new N,A.prototype.constructor=A,A.C=function(D,O,F){for(var R=Array(arguments.length-2),ie=2;ie<arguments.length;ie++)R[ie-2]=arguments[ie];return C.prototype[O].apply(D,R)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(A,C,N){N||(N=0);var D=Array(16);if(typeof C=="string")for(var O=0;16>O;++O)D[O]=C.charCodeAt(N++)|C.charCodeAt(N++)<<8|C.charCodeAt(N++)<<16|C.charCodeAt(N++)<<24;else for(O=0;16>O;++O)D[O]=C[N++]|C[N++]<<8|C[N++]<<16|C[N++]<<24;C=A.g[0],N=A.g[1],O=A.g[2];var F=A.g[3],R=C+(F^N&(O^F))+D[0]+3614090360&4294967295;C=N+(R<<7&4294967295|R>>>25),R=F+(O^C&(N^O))+D[1]+3905402710&4294967295,F=C+(R<<12&4294967295|R>>>20),R=O+(N^F&(C^N))+D[2]+606105819&4294967295,O=F+(R<<17&4294967295|R>>>15),R=N+(C^O&(F^C))+D[3]+3250441966&4294967295,N=O+(R<<22&4294967295|R>>>10),R=C+(F^N&(O^F))+D[4]+4118548399&4294967295,C=N+(R<<7&4294967295|R>>>25),R=F+(O^C&(N^O))+D[5]+1200080426&4294967295,F=C+(R<<12&4294967295|R>>>20),R=O+(N^F&(C^N))+D[6]+2821735955&4294967295,O=F+(R<<17&4294967295|R>>>15),R=N+(C^O&(F^C))+D[7]+4249261313&4294967295,N=O+(R<<22&4294967295|R>>>10),R=C+(F^N&(O^F))+D[8]+1770035416&4294967295,C=N+(R<<7&4294967295|R>>>25),R=F+(O^C&(N^O))+D[9]+2336552879&4294967295,F=C+(R<<12&4294967295|R>>>20),R=O+(N^F&(C^N))+D[10]+4294925233&4294967295,O=F+(R<<17&4294967295|R>>>15),R=N+(C^O&(F^C))+D[11]+2304563134&4294967295,N=O+(R<<22&4294967295|R>>>10),R=C+(F^N&(O^F))+D[12]+1804603682&4294967295,C=N+(R<<7&4294967295|R>>>25),R=F+(O^C&(N^O))+D[13]+4254626195&4294967295,F=C+(R<<12&4294967295|R>>>20),R=O+(N^F&(C^N))+D[14]+2792965006&4294967295,O=F+(R<<17&4294967295|R>>>15),R=N+(C^O&(F^C))+D[15]+1236535329&4294967295,N=O+(R<<22&4294967295|R>>>10),R=C+(O^F&(N^O))+D[1]+4129170786&4294967295,C=N+(R<<5&4294967295|R>>>27),R=F+(N^O&(C^N))+D[6]+3225465664&4294967295,F=C+(R<<9&4294967295|R>>>23),R=O+(C^N&(F^C))+D[11]+643717713&4294967295,O=F+(R<<14&4294967295|R>>>18),R=N+(F^C&(O^F))+D[0]+3921069994&4294967295,N=O+(R<<20&4294967295|R>>>12),R=C+(O^F&(N^O))+D[5]+3593408605&4294967295,C=N+(R<<5&4294967295|R>>>27),R=F+(N^O&(C^N))+D[10]+38016083&4294967295,F=C+(R<<9&4294967295|R>>>23),R=O+(C^N&(F^C))+D[15]+3634488961&4294967295,O=F+(R<<14&4294967295|R>>>18),R=N+(F^C&(O^F))+D[4]+3889429448&4294967295,N=O+(R<<20&4294967295|R>>>12),R=C+(O^F&(N^O))+D[9]+568446438&4294967295,C=N+(R<<5&4294967295|R>>>27),R=F+(N^O&(C^N))+D[14]+3275163606&4294967295,F=C+(R<<9&4294967295|R>>>23),R=O+(C^N&(F^C))+D[3]+4107603335&4294967295,O=F+(R<<14&4294967295|R>>>18),R=N+(F^C&(O^F))+D[8]+1163531501&4294967295,N=O+(R<<20&4294967295|R>>>12),R=C+(O^F&(N^O))+D[13]+2850285829&4294967295,C=N+(R<<5&4294967295|R>>>27),R=F+(N^O&(C^N))+D[2]+4243563512&4294967295,F=C+(R<<9&4294967295|R>>>23),R=O+(C^N&(F^C))+D[7]+1735328473&4294967295,O=F+(R<<14&4294967295|R>>>18),R=N+(F^C&(O^F))+D[12]+2368359562&4294967295,N=O+(R<<20&4294967295|R>>>12),R=C+(N^O^F)+D[5]+4294588738&4294967295,C=N+(R<<4&4294967295|R>>>28),R=F+(C^N^O)+D[8]+2272392833&4294967295,F=C+(R<<11&4294967295|R>>>21),R=O+(F^C^N)+D[11]+1839030562&4294967295,O=F+(R<<16&4294967295|R>>>16),R=N+(O^F^C)+D[14]+4259657740&4294967295,N=O+(R<<23&4294967295|R>>>9),R=C+(N^O^F)+D[1]+2763975236&4294967295,C=N+(R<<4&4294967295|R>>>28),R=F+(C^N^O)+D[4]+1272893353&4294967295,F=C+(R<<11&4294967295|R>>>21),R=O+(F^C^N)+D[7]+4139469664&4294967295,O=F+(R<<16&4294967295|R>>>16),R=N+(O^F^C)+D[10]+3200236656&4294967295,N=O+(R<<23&4294967295|R>>>9),R=C+(N^O^F)+D[13]+681279174&4294967295,C=N+(R<<4&4294967295|R>>>28),R=F+(C^N^O)+D[0]+3936430074&4294967295,F=C+(R<<11&4294967295|R>>>21),R=O+(F^C^N)+D[3]+3572445317&4294967295,O=F+(R<<16&4294967295|R>>>16),R=N+(O^F^C)+D[6]+76029189&4294967295,N=O+(R<<23&4294967295|R>>>9),R=C+(N^O^F)+D[9]+3654602809&4294967295,C=N+(R<<4&4294967295|R>>>28),R=F+(C^N^O)+D[12]+3873151461&4294967295,F=C+(R<<11&4294967295|R>>>21),R=O+(F^C^N)+D[15]+530742520&4294967295,O=F+(R<<16&4294967295|R>>>16),R=N+(O^F^C)+D[2]+3299628645&4294967295,N=O+(R<<23&4294967295|R>>>9),R=C+(O^(N|~F))+D[0]+4096336452&4294967295,C=N+(R<<6&4294967295|R>>>26),R=F+(N^(C|~O))+D[7]+1126891415&4294967295,F=C+(R<<10&4294967295|R>>>22),R=O+(C^(F|~N))+D[14]+2878612391&4294967295,O=F+(R<<15&4294967295|R>>>17),R=N+(F^(O|~C))+D[5]+4237533241&4294967295,N=O+(R<<21&4294967295|R>>>11),R=C+(O^(N|~F))+D[12]+1700485571&4294967295,C=N+(R<<6&4294967295|R>>>26),R=F+(N^(C|~O))+D[3]+2399980690&4294967295,F=C+(R<<10&4294967295|R>>>22),R=O+(C^(F|~N))+D[10]+4293915773&4294967295,O=F+(R<<15&4294967295|R>>>17),R=N+(F^(O|~C))+D[1]+2240044497&4294967295,N=O+(R<<21&4294967295|R>>>11),R=C+(O^(N|~F))+D[8]+1873313359&4294967295,C=N+(R<<6&4294967295|R>>>26),R=F+(N^(C|~O))+D[15]+4264355552&4294967295,F=C+(R<<10&4294967295|R>>>22),R=O+(C^(F|~N))+D[6]+2734768916&4294967295,O=F+(R<<15&4294967295|R>>>17),R=N+(F^(O|~C))+D[13]+1309151649&4294967295,N=O+(R<<21&4294967295|R>>>11),R=C+(O^(N|~F))+D[4]+4149444226&4294967295,C=N+(R<<6&4294967295|R>>>26),R=F+(N^(C|~O))+D[11]+3174756917&4294967295,F=C+(R<<10&4294967295|R>>>22),R=O+(C^(F|~N))+D[2]+718787259&4294967295,O=F+(R<<15&4294967295|R>>>17),R=N+(F^(O|~C))+D[9]+3951481745&4294967295,A.g[0]=A.g[0]+C&4294967295,A.g[1]=A.g[1]+(O+(R<<21&4294967295|R>>>11))&4294967295,A.g[2]=A.g[2]+O&4294967295,A.g[3]=A.g[3]+F&4294967295}r.prototype.u=function(A,C){C===void 0&&(C=A.length);for(var N=C-this.blockSize,D=this.B,O=this.h,F=0;F<C;){if(O==0)for(;F<=N;)s(this,A,F),F+=this.blockSize;if(typeof A=="string"){for(;F<C;)if(D[O++]=A.charCodeAt(F++),O==this.blockSize){s(this,D),O=0;break}}else for(;F<C;)if(D[O++]=A[F++],O==this.blockSize){s(this,D),O=0;break}}this.h=O,this.o+=C},r.prototype.v=function(){var A=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);A[0]=128;for(var C=1;C<A.length-8;++C)A[C]=0;var N=8*this.o;for(C=A.length-8;C<A.length;++C)A[C]=N&255,N/=256;for(this.u(A),A=Array(16),C=N=0;4>C;++C)for(var D=0;32>D;D+=8)A[N++]=this.g[C]>>>D&255;return A};function i(A,C){var N=h;return Object.prototype.hasOwnProperty.call(N,A)?N[A]:N[A]=C(A)}function l(A,C){this.h=C;for(var N=[],D=!0,O=A.length-1;0<=O;O--){var F=A[O]|0;D&&F==C||(N[O]=F,D=!1)}this.g=N}var h={};function p(A){return-128<=A&&128>A?i(A,function(C){return new l([C|0],0>C?-1:0)}):new l([A|0],0>A?-1:0)}function y(A){if(isNaN(A)||!isFinite(A))return E;if(0>A)return H(y(-A));for(var C=[],N=1,D=0;A>=N;D++)C[D]=A/N|0,N*=4294967296;return new l(C,0)}function _(A,C){if(A.length==0)throw Error("number format error: empty string");if(C=C||10,2>C||36<C)throw Error("radix out of range: "+C);if(A.charAt(0)=="-")return H(_(A.substring(1),C));if(0<=A.indexOf("-"))throw Error('number format error: interior "-" character');for(var N=y(Math.pow(C,8)),D=E,O=0;O<A.length;O+=8){var F=Math.min(8,A.length-O),R=parseInt(A.substring(O,O+F),C);8>F?(F=y(Math.pow(C,F)),D=D.j(F).add(y(R))):(D=D.j(N),D=D.add(y(R)))}return D}var E=p(0),T=p(1),k=p(16777216);t=l.prototype,t.m=function(){if(B(this))return-H(this).m();for(var A=0,C=1,N=0;N<this.g.length;N++){var D=this.i(N);A+=(0<=D?D:4294967296+D)*C,C*=4294967296}return A},t.toString=function(A){if(A=A||10,2>A||36<A)throw Error("radix out of range: "+A);if(L(this))return"0";if(B(this))return"-"+H(this).toString(A);for(var C=y(Math.pow(A,6)),N=this,D="";;){var O=$(N,C).g;N=W(N,O.j(C));var F=((0<N.g.length?N.g[0]:N.h)>>>0).toString(A);if(N=O,L(N))return F+D;for(;6>F.length;)F="0"+F;D=F+D}},t.i=function(A){return 0>A?0:A<this.g.length?this.g[A]:this.h};function L(A){if(A.h!=0)return!1;for(var C=0;C<A.g.length;C++)if(A.g[C]!=0)return!1;return!0}function B(A){return A.h==-1}t.l=function(A){return A=W(this,A),B(A)?-1:L(A)?0:1};function H(A){for(var C=A.g.length,N=[],D=0;D<C;D++)N[D]=~A.g[D];return new l(N,~A.h).add(T)}t.abs=function(){return B(this)?H(this):this},t.add=function(A){for(var C=Math.max(this.g.length,A.g.length),N=[],D=0,O=0;O<=C;O++){var F=D+(this.i(O)&65535)+(A.i(O)&65535),R=(F>>>16)+(this.i(O)>>>16)+(A.i(O)>>>16);D=R>>>16,F&=65535,R&=65535,N[O]=R<<16|F}return new l(N,N[N.length-1]&-2147483648?-1:0)};function W(A,C){return A.add(H(C))}t.j=function(A){if(L(this)||L(A))return E;if(B(this))return B(A)?H(this).j(H(A)):H(H(this).j(A));if(B(A))return H(this.j(H(A)));if(0>this.l(k)&&0>A.l(k))return y(this.m()*A.m());for(var C=this.g.length+A.g.length,N=[],D=0;D<2*C;D++)N[D]=0;for(D=0;D<this.g.length;D++)for(var O=0;O<A.g.length;O++){var F=this.i(D)>>>16,R=this.i(D)&65535,ie=A.i(O)>>>16,te=A.i(O)&65535;N[2*D+2*O]+=R*te,M(N,2*D+2*O),N[2*D+2*O+1]+=F*te,M(N,2*D+2*O+1),N[2*D+2*O+1]+=R*ie,M(N,2*D+2*O+1),N[2*D+2*O+2]+=F*ie,M(N,2*D+2*O+2)}for(D=0;D<C;D++)N[D]=N[2*D+1]<<16|N[2*D];for(D=C;D<2*C;D++)N[D]=0;return new l(N,0)};function M(A,C){for(;(A[C]&65535)!=A[C];)A[C+1]+=A[C]>>>16,A[C]&=65535,C++}function U(A,C){this.g=A,this.h=C}function $(A,C){if(L(C))throw Error("division by zero");if(L(A))return new U(E,E);if(B(A))return C=$(H(A),C),new U(H(C.g),H(C.h));if(B(C))return C=$(A,H(C)),new U(H(C.g),C.h);if(30<A.g.length){if(B(A)||B(C))throw Error("slowDivide_ only works with positive integers.");for(var N=T,D=C;0>=D.l(A);)N=K(N),D=K(D);var O=Z(N,1),F=Z(D,1);for(D=Z(D,2),N=Z(N,2);!L(D);){var R=F.add(D);0>=R.l(A)&&(O=O.add(N),F=R),D=Z(D,1),N=Z(N,1)}return C=W(A,O.j(C)),new U(O,C)}for(O=E;0<=A.l(C);){for(N=Math.max(1,Math.floor(A.m()/C.m())),D=Math.ceil(Math.log(N)/Math.LN2),D=48>=D?1:Math.pow(2,D-48),F=y(N),R=F.j(C);B(R)||0<R.l(A);)N-=D,F=y(N),R=F.j(C);L(F)&&(F=T),O=O.add(F),A=W(A,R)}return new U(O,A)}t.A=function(A){return $(this,A).h},t.and=function(A){for(var C=Math.max(this.g.length,A.g.length),N=[],D=0;D<C;D++)N[D]=this.i(D)&A.i(D);return new l(N,this.h&A.h)},t.or=function(A){for(var C=Math.max(this.g.length,A.g.length),N=[],D=0;D<C;D++)N[D]=this.i(D)|A.i(D);return new l(N,this.h|A.h)},t.xor=function(A){for(var C=Math.max(this.g.length,A.g.length),N=[],D=0;D<C;D++)N[D]=this.i(D)^A.i(D);return new l(N,this.h^A.h)};function K(A){for(var C=A.g.length+1,N=[],D=0;D<C;D++)N[D]=A.i(D)<<1|A.i(D-1)>>>31;return new l(N,A.h)}function Z(A,C){var N=C>>5;C%=32;for(var D=A.g.length-N,O=[],F=0;F<D;F++)O[F]=0<C?A.i(F+N)>>>C|A.i(F+N+1)<<32-C:A.i(F+N);return new l(O,A.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,VR=r,l.prototype.add=l.prototype.add,l.prototype.multiply=l.prototype.j,l.prototype.modulo=l.prototype.A,l.prototype.compare=l.prototype.l,l.prototype.toNumber=l.prototype.m,l.prototype.toString=l.prototype.toString,l.prototype.getBits=l.prototype.i,l.fromNumber=y,l.fromString=_,Rc=l}).apply(typeof lI<"u"?lI:typeof self<"u"?self:typeof window<"u"?window:{});var Qm=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var BR,vh,UR,Cp,qx,$R,zR,WR;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(c,x,v){return c==Array.prototype||c==Object.prototype||(c[x]=v.value),c};function n(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof Qm=="object"&&Qm];for(var x=0;x<c.length;++x){var v=c[x];if(v&&v.Math==Math)return v}throw Error("Cannot find global object")}var r=n(this);function s(c,x){if(x)e:{var v=r;c=c.split(".");for(var S=0;S<c.length-1;S++){var G=c[S];if(!(G in v))break e;v=v[G]}c=c[c.length-1],S=v[c],x=x(S),x!=S&&x!=null&&e(v,c,{configurable:!0,writable:!0,value:x})}}function i(c,x){c instanceof String&&(c+="");var v=0,S=!1,G={next:function(){if(!S&&v<c.length){var Q=v++;return{value:x(Q,c[Q]),done:!1}}return S=!0,{done:!0,value:void 0}}};return G[Symbol.iterator]=function(){return G},G}s("Array.prototype.values",function(c){return c||function(){return i(this,function(x,v){return v})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var l=l||{},h=this||self;function p(c){var x=typeof c;return x=x!="object"?x:c?Array.isArray(c)?"array":x:"null",x=="array"||x=="object"&&typeof c.length=="number"}function y(c){var x=typeof c;return x=="object"&&c!=null||x=="function"}function _(c,x,v){return c.call.apply(c.bind,arguments)}function E(c,x,v){if(!c)throw Error();if(2<arguments.length){var S=Array.prototype.slice.call(arguments,2);return function(){var G=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(G,S),c.apply(x,G)}}return function(){return c.apply(x,arguments)}}function T(c,x,v){return T=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?_:E,T.apply(null,arguments)}function k(c,x){var v=Array.prototype.slice.call(arguments,1);return function(){var S=v.slice();return S.push.apply(S,arguments),c.apply(this,S)}}function L(c,x){function v(){}v.prototype=x.prototype,c.aa=x.prototype,c.prototype=new v,c.prototype.constructor=c,c.Qb=function(S,G,Q){for(var ue=Array(arguments.length-2),Ot=2;Ot<arguments.length;Ot++)ue[Ot-2]=arguments[Ot];return x.prototype[G].apply(S,ue)}}function B(c){const x=c.length;if(0<x){const v=Array(x);for(let S=0;S<x;S++)v[S]=c[S];return v}return[]}function H(c,x){for(let v=1;v<arguments.length;v++){const S=arguments[v];if(p(S)){const G=c.length||0,Q=S.length||0;c.length=G+Q;for(let ue=0;ue<Q;ue++)c[G+ue]=S[ue]}else c.push(S)}}class W{constructor(x,v){this.i=x,this.j=v,this.h=0,this.g=null}get(){let x;return 0<this.h?(this.h--,x=this.g,this.g=x.next,x.next=null):x=this.i(),x}}function M(c){return/^[\s\xa0]*$/.test(c)}function U(){var c=h.navigator;return c&&(c=c.userAgent)?c:""}function $(c){return $[" "](c),c}$[" "]=function(){};var K=U().indexOf("Gecko")!=-1&&!(U().toLowerCase().indexOf("webkit")!=-1&&U().indexOf("Edge")==-1)&&!(U().indexOf("Trident")!=-1||U().indexOf("MSIE")!=-1)&&U().indexOf("Edge")==-1;function Z(c,x,v){for(const S in c)x.call(v,c[S],S,c)}function A(c,x){for(const v in c)x.call(void 0,c[v],v,c)}function C(c){const x={};for(const v in c)x[v]=c[v];return x}const N="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function D(c,x){let v,S;for(let G=1;G<arguments.length;G++){S=arguments[G];for(v in S)c[v]=S[v];for(let Q=0;Q<N.length;Q++)v=N[Q],Object.prototype.hasOwnProperty.call(S,v)&&(c[v]=S[v])}}function O(c){var x=1;c=c.split(":");const v=[];for(;0<x&&c.length;)v.push(c.shift()),x--;return c.length&&v.push(c.join(":")),v}function F(c){h.setTimeout(()=>{throw c},0)}function R(){var c=qe;let x=null;return c.g&&(x=c.g,c.g=c.g.next,c.g||(c.h=null),x.next=null),x}class ie{constructor(){this.h=this.g=null}add(x,v){const S=te.get();S.set(x,v),this.h?this.h.next=S:this.g=S,this.h=S}}var te=new W(()=>new je,c=>c.reset());class je{constructor(){this.next=this.g=this.h=null}set(x,v){this.h=x,this.g=v,this.next=null}reset(){this.next=this.g=this.h=null}}let We,Ee=!1,qe=new ie,et=()=>{const c=h.Promise.resolve(void 0);We=()=>{c.then(Lt)}};var Lt=()=>{for(var c;c=R();){try{c.h.call(c.g)}catch(v){F(v)}var x=te;x.j(c),100>x.h&&(x.h++,c.next=x.g,x.g=c)}Ee=!1};function Qe(){this.s=this.s,this.C=this.C}Qe.prototype.s=!1,Qe.prototype.ma=function(){this.s||(this.s=!0,this.N())},Qe.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function rt(c,x){this.type=c,this.g=this.target=x,this.defaultPrevented=!1}rt.prototype.h=function(){this.defaultPrevented=!0};var pe=function(){if(!h.addEventListener||!Object.defineProperty)return!1;var c=!1,x=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const v=()=>{};h.addEventListener("test",v,x),h.removeEventListener("test",v,x)}catch{}return c}();function ve(c,x){if(rt.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c){var v=this.type=c.type,S=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;if(this.target=c.target||c.srcElement,this.g=x,x=c.relatedTarget){if(K){e:{try{$(x.nodeName);var G=!0;break e}catch{}G=!1}G||(x=null)}}else v=="mouseover"?x=c.fromElement:v=="mouseout"&&(x=c.toElement);this.relatedTarget=x,S?(this.clientX=S.clientX!==void 0?S.clientX:S.pageX,this.clientY=S.clientY!==void 0?S.clientY:S.pageY,this.screenX=S.screenX||0,this.screenY=S.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=typeof c.pointerType=="string"?c.pointerType:fe[c.pointerType]||"",this.state=c.state,this.i=c,c.defaultPrevented&&ve.aa.h.call(this)}}L(ve,rt);var fe={2:"touch",3:"pen",4:"mouse"};ve.prototype.h=function(){ve.aa.h.call(this);var c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var ke="closure_listenable_"+(1e6*Math.random()|0),Ve=0;function Vt(c,x,v,S,G){this.listener=c,this.proxy=null,this.src=x,this.type=v,this.capture=!!S,this.ha=G,this.key=++Ve,this.da=this.fa=!1}function qt(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function yt(c){this.src=c,this.g={},this.h=0}yt.prototype.add=function(c,x,v,S,G){var Q=c.toString();c=this.g[Q],c||(c=this.g[Q]=[],this.h++);var ue=se(c,x,S,G);return-1<ue?(x=c[ue],v||(x.fa=!1)):(x=new Vt(x,this.src,Q,!!S,G),x.fa=v,c.push(x)),x};function xe(c,x){var v=x.type;if(v in c.g){var S=c.g[v],G=Array.prototype.indexOf.call(S,x,void 0),Q;(Q=0<=G)&&Array.prototype.splice.call(S,G,1),Q&&(qt(x),c.g[v].length==0&&(delete c.g[v],c.h--))}}function se(c,x,v,S){for(var G=0;G<c.length;++G){var Q=c[G];if(!Q.da&&Q.listener==x&&Q.capture==!!v&&Q.ha==S)return G}return-1}var De="closure_lm_"+(1e6*Math.random()|0),Oe={};function Ge(c,x,v,S,G){if(Array.isArray(x)){for(var Q=0;Q<x.length;Q++)Ge(c,x[Q],v,S,G);return null}return v=dn(v),c&&c[ke]?c.K(x,v,y(S)?!!S.capture:!1,G):ht(c,x,v,!1,S,G)}function ht(c,x,v,S,G,Q){if(!x)throw Error("Invalid event type");var ue=y(G)?!!G.capture:!!G,Ot=At(c);if(Ot||(c[De]=Ot=new yt(c)),v=Ot.add(x,v,S,ue,Q),v.proxy)return v;if(S=Et(),v.proxy=S,S.src=c,S.listener=v,c.addEventListener)pe||(G=ue),G===void 0&&(G=!1),c.addEventListener(x.toString(),S,G);else if(c.attachEvent)c.attachEvent(ae(x.toString()),S);else if(c.addListener&&c.removeListener)c.addListener(S);else throw Error("addEventListener and attachEvent are unavailable.");return v}function Et(){function c(v){return x.call(c.src,c.listener,v)}const x=ft;return c}function st(c,x,v,S,G){if(Array.isArray(x))for(var Q=0;Q<x.length;Q++)st(c,x[Q],v,S,G);else S=y(S)?!!S.capture:!!S,v=dn(v),c&&c[ke]?(c=c.i,x=String(x).toString(),x in c.g&&(Q=c.g[x],v=se(Q,v,S,G),-1<v&&(qt(Q[v]),Array.prototype.splice.call(Q,v,1),Q.length==0&&(delete c.g[x],c.h--)))):c&&(c=At(c))&&(x=c.g[x.toString()],c=-1,x&&(c=se(x,v,S,G)),(v=-1<c?x[c]:null)&&me(v))}function me(c){if(typeof c!="number"&&c&&!c.da){var x=c.src;if(x&&x[ke])xe(x.i,c);else{var v=c.type,S=c.proxy;x.removeEventListener?x.removeEventListener(v,S,c.capture):x.detachEvent?x.detachEvent(ae(v),S):x.addListener&&x.removeListener&&x.removeListener(S),(v=At(x))?(xe(v,c),v.h==0&&(v.src=null,x[De]=null)):qt(c)}}}function ae(c){return c in Oe?Oe[c]:Oe[c]="on"+c}function ft(c,x){if(c.da)c=!0;else{x=new ve(x,this);var v=c.listener,S=c.ha||c.src;c.fa&&me(c),c=v.call(S,x)}return c}function At(c){return c=c[De],c instanceof yt?c:null}var Ke="__closure_events_fn_"+(1e9*Math.random()>>>0);function dn(c){return typeof c=="function"?c:(c[Ke]||(c[Ke]=function(x){return c.handleEvent(x)}),c[Ke])}function tt(){Qe.call(this),this.i=new yt(this),this.M=this,this.F=null}L(tt,Qe),tt.prototype[ke]=!0,tt.prototype.removeEventListener=function(c,x,v,S){st(this,c,x,v,S)};function ot(c,x){var v,S=c.F;if(S)for(v=[];S;S=S.F)v.push(S);if(c=c.M,S=x.type||x,typeof x=="string")x=new rt(x,c);else if(x instanceof rt)x.target=x.target||c;else{var G=x;x=new rt(S,c),D(x,G)}if(G=!0,v)for(var Q=v.length-1;0<=Q;Q--){var ue=x.g=v[Q];G=jt(ue,S,!0,x)&&G}if(ue=x.g=c,G=jt(ue,S,!0,x)&&G,G=jt(ue,S,!1,x)&&G,v)for(Q=0;Q<v.length;Q++)ue=x.g=v[Q],G=jt(ue,S,!1,x)&&G}tt.prototype.N=function(){if(tt.aa.N.call(this),this.i){var c=this.i,x;for(x in c.g){for(var v=c.g[x],S=0;S<v.length;S++)qt(v[S]);delete c.g[x],c.h--}}this.F=null},tt.prototype.K=function(c,x,v,S){return this.i.add(String(c),x,!1,v,S)},tt.prototype.L=function(c,x,v,S){return this.i.add(String(c),x,!0,v,S)};function jt(c,x,v,S){if(x=c.i.g[String(x)],!x)return!0;x=x.concat();for(var G=!0,Q=0;Q<x.length;++Q){var ue=x[Q];if(ue&&!ue.da&&ue.capture==v){var Ot=ue.listener,gn=ue.ha||ue.src;ue.fa&&xe(c.i,ue),G=Ot.call(gn,S)!==!1&&G}}return G&&!S.defaultPrevented}function Kt(c,x,v){if(typeof c=="function")v&&(c=T(c,v));else if(c&&typeof c.handleEvent=="function")c=T(c.handleEvent,c);else throw Error("Invalid listener argument");return 2147483647<Number(x)?-1:h.setTimeout(c,x||0)}function ar(c){c.g=Kt(()=>{c.g=null,c.i&&(c.i=!1,ar(c))},c.l);const x=c.h;c.h=null,c.m.apply(null,x)}class Xt extends Qe{constructor(x,v){super(),this.m=x,this.l=v,this.h=null,this.i=!1,this.g=null}j(x){this.h=arguments,this.g?this.i=!0:ar(this)}N(){super.N(),this.g&&(h.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function xn(c){Qe.call(this),this.h=c,this.g={}}L(xn,Qe);var Mt=[];function we(c){Z(c.g,function(x,v){this.g.hasOwnProperty(v)&&me(x)},c),c.g={}}xn.prototype.N=function(){xn.aa.N.call(this),we(this)},xn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Tt=h.JSON.stringify,Rt=h.JSON.parse,wt=class{stringify(c){return h.JSON.stringify(c,void 0)}parse(c){return h.JSON.parse(c,void 0)}};function bt(){}bt.prototype.h=null;function ce(c){return c.h||(c.h=c.i())}function Ie(){}var be={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ce(){rt.call(this,"d")}L(Ce,rt);function it(){rt.call(this,"c")}L(it,rt);var He={},un=null;function wn(){return un=un||new tt}He.La="serverreachability";function Bt(c){rt.call(this,He.La,c)}L(Bt,rt);function Ht(c){const x=wn();ot(x,new Bt(x))}He.STAT_EVENT="statevent";function Rn(c,x){rt.call(this,He.STAT_EVENT,c),this.stat=x}L(Rn,rt);function nt(c){const x=wn();ot(x,new Rn(x,c))}He.Ma="timingevent";function ee(c,x){rt.call(this,He.Ma,c),this.size=x}L(ee,rt);function J(c,x){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return h.setTimeout(function(){c()},x)}function oe(){this.g=!0}oe.prototype.xa=function(){this.g=!1};function _e(c,x,v,S,G,Q){c.info(function(){if(c.g)if(Q)for(var ue="",Ot=Q.split("&"),gn=0;gn<Ot.length;gn++){var mt=Ot[gn].split("=");if(1<mt.length){var fn=mt[0];mt=mt[1];var En=fn.split("_");ue=2<=En.length&&En[1]=="type"?ue+(fn+"="+mt+"&"):ue+(fn+"=redacted&")}}else ue=null;else ue=Q;return"XMLHTTP REQ ("+S+") [attempt "+G+"]: "+x+`
`+v+`
`+ue})}function Se(c,x,v,S,G,Q,ue){c.info(function(){return"XMLHTTP RESP ("+S+") [ attempt "+G+"]: "+x+`
`+v+`
`+Q+" "+ue})}function $e(c,x,v,S){c.info(function(){return"XMLHTTP TEXT ("+x+"): "+Ye(c,v)+(S?" "+S:"")})}function ge(c,x){c.info(function(){return"TIMEOUT: "+x})}oe.prototype.info=function(){};function Ye(c,x){if(!c.g)return x;if(!x)return null;try{var v=JSON.parse(x);if(v){for(c=0;c<v.length;c++)if(Array.isArray(v[c])){var S=v[c];if(!(2>S.length)){var G=S[1];if(Array.isArray(G)&&!(1>G.length)){var Q=G[0];if(Q!="noop"&&Q!="stop"&&Q!="close")for(var ue=1;ue<G.length;ue++)G[ue]=""}}}}return Tt(v)}catch{return x}}var Ze={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Fe={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Je;function Ct(){}L(Ct,bt),Ct.prototype.g=function(){return new XMLHttpRequest},Ct.prototype.i=function(){return{}},Je=new Ct;function St(c,x,v,S){this.j=c,this.i=x,this.l=v,this.R=S||1,this.U=new xn(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new lt}function lt(){this.i=null,this.g="",this.h=!1}var xt={},Wt={};function Pt(c,x,v){c.L=1,c.v=er(tn(x)),c.m=v,c.P=!0,bn(c,null)}function bn(c,x){c.F=Date.now(),vn(c),c.A=tn(c.v);var v=c.A,S=c.R;Array.isArray(S)||(S=[String(S)]),wr(v.i,"t",S),c.C=0,v=c.j.J,c.h=new lt,c.g=nc(c.j,v?x:null,!c.m),0<c.O&&(c.M=new Xt(T(c.Y,c,c.g),c.O)),x=c.U,v=c.g,S=c.ca;var G="readystatechange";Array.isArray(G)||(G&&(Mt[0]=G.toString()),G=Mt);for(var Q=0;Q<G.length;Q++){var ue=Ge(v,G[Q],S||x.handleEvent,!1,x.h||x);if(!ue)break;x.g[ue.key]=ue}x=c.H?C(c.H):{},c.m?(c.u||(c.u="POST"),x["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.A,c.u,c.m,x)):(c.u="GET",c.g.ea(c.A,c.u,null,x)),Ht(),_e(c.i,c.u,c.A,c.l,c.R,c.m)}St.prototype.ca=function(c){c=c.target;const x=this.M;x&&Mr(c)==3?x.j():this.Y(c)},St.prototype.Y=function(c){try{if(c==this.g)e:{const En=Mr(this.g);var x=this.g.Ba();const lr=this.g.Z();if(!(3>En)&&(En!=3||this.g&&(this.h.h||this.g.oa()||Jl(this.g)))){this.J||En!=4||x==7||(x==8||0>=lr?Ht(3):Ht(2)),Ae(this);var v=this.g.Z();this.X=v;t:if(hn(this)){var S=Jl(this.g);c="";var G=S.length,Q=Mr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Gt(this),jn(this);var ue="";break t}this.h.i=new h.TextDecoder}for(x=0;x<G;x++)this.h.h=!0,c+=this.h.i.decode(S[x],{stream:!(Q&&x==G-1)});S.length=0,this.h.g+=c,this.C=0,ue=this.h.g}else ue=this.g.oa();if(this.o=v==200,Se(this.i,this.u,this.A,this.l,this.R,En,v),this.o){if(this.T&&!this.K){t:{if(this.g){var Ot,gn=this.g;if((Ot=gn.g?gn.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!M(Ot)){var mt=Ot;break t}}mt=null}if(v=mt)$e(this.i,this.l,v,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Jn(this,v);else{this.o=!1,this.s=3,nt(12),Gt(this),jn(this);break e}}if(this.P){v=!0;let cr;for(;!this.J&&this.C<ue.length;)if(cr=Er(this,ue),cr==Wt){En==4&&(this.s=4,nt(14),v=!1),$e(this.i,this.l,null,"[Incomplete Response]");break}else if(cr==xt){this.s=4,nt(15),$e(this.i,this.l,ue,"[Invalid Chunk]"),v=!1;break}else $e(this.i,this.l,cr,null),Jn(this,cr);if(hn(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),En!=4||ue.length!=0||this.h.h||(this.s=1,nt(16),v=!1),this.o=this.o&&v,!v)$e(this.i,this.l,ue,"[Invalid Chunked Response]"),Gt(this),jn(this);else if(0<ue.length&&!this.W){this.W=!0;var fn=this.j;fn.g==this&&fn.ba&&!fn.M&&(fn.j.info("Great, no buffering proxy detected. Bytes received: "+ue.length),Ki(fn),fn.M=!0,nt(11))}}else $e(this.i,this.l,ue,null),Jn(this,ue);En==4&&Gt(this),this.o&&!this.J&&(En==4?tr(this.j,this):(this.o=!1,vn(this)))}else $n(this.g),v==400&&0<ue.indexOf("Unknown SID")?(this.s=3,nt(12)):(this.s=0,nt(13)),Gt(this),jn(this)}}}catch{}finally{}};function hn(c){return c.g?c.u=="GET"&&c.L!=2&&c.j.Ca:!1}function Er(c,x){var v=c.C,S=x.indexOf(`
`,v);return S==-1?Wt:(v=Number(x.substring(v,S)),isNaN(v)?xt:(S+=1,S+v>x.length?Wt:(x=x.slice(S,S+v),c.C=S+v,x)))}St.prototype.cancel=function(){this.J=!0,Gt(this)};function vn(c){c.S=Date.now()+c.I,Qr(c,c.I)}function Qr(c,x){if(c.B!=null)throw Error("WatchDog timer not null");c.B=J(T(c.ba,c),x)}function Ae(c){c.B&&(h.clearTimeout(c.B),c.B=null)}St.prototype.ba=function(){this.B=null;const c=Date.now();0<=c-this.S?(ge(this.i,this.A),this.L!=2&&(Ht(),nt(17)),Gt(this),this.s=2,jn(this)):Qr(this,this.S-c)};function jn(c){c.j.G==0||c.J||tr(c.j,c)}function Gt(c){Ae(c);var x=c.M;x&&typeof x.ma=="function"&&x.ma(),c.M=null,we(c.U),c.g&&(x=c.g,c.g=null,x.abort(),x.ma())}function Jn(c,x){try{var v=c.j;if(v.G!=0&&(v.g==c||pn(v.h,c))){if(!c.K&&pn(v.h,c)&&v.G==3){try{var S=v.Da.g.parse(x)}catch{S=null}if(Array.isArray(S)&&S.length==3){var G=S;if(G[0]==0){e:if(!v.u){if(v.g)if(v.g.F+3e3<c.F)xi(v),qi(v);else break e;Za(v),nt(18)}}else v.za=G[1],0<v.za-v.T&&37500>G[2]&&v.F&&v.v==0&&!v.C&&(v.C=J(T(v.Za,v),6e3));if(1>=Ut(v.h)&&v.ca){try{v.ca()}catch{}v.ca=void 0}}else br(v,11)}else if((c.K||v.g==c)&&xi(v),!M(x))for(G=v.Da.g.parse(x),x=0;x<G.length;x++){let mt=G[x];if(v.T=mt[0],mt=mt[1],v.G==2)if(mt[0]=="c"){v.K=mt[1],v.ia=mt[2];const fn=mt[3];fn!=null&&(v.la=fn,v.j.info("VER="+v.la));const En=mt[4];En!=null&&(v.Aa=En,v.j.info("SVER="+v.Aa));const lr=mt[5];lr!=null&&typeof lr=="number"&&0<lr&&(S=1.5*lr,v.L=S,v.j.info("backChannelRequestTimeoutMs_="+S)),S=v;const cr=c.g;if(cr){const zr=cr.g?cr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(zr){var Q=S.h;Q.g||zr.indexOf("spdy")==-1&&zr.indexOf("quic")==-1&&zr.indexOf("h2")==-1||(Q.j=Q.l,Q.g=new Set,Q.h&&(hr(Q,Q.h),Q.h=null))}if(S.D){const Ja=cr.g?cr.g.getResponseHeader("X-HTTP-Session-Id"):null;Ja&&(S.ya=Ja,Pe(S.I,S.D,Ja))}}v.G=3,v.l&&v.l.ua(),v.ba&&(v.R=Date.now()-c.F,v.j.info("Handshake RTT: "+v.R+"ms")),S=v;var ue=c;if(S.qa=Dt(S,S.J?S.ia:null,S.W),ue.K){qs(S.h,ue);var Ot=ue,gn=S.L;gn&&(Ot.I=gn),Ot.B&&(Ae(Ot),vn(Ot)),S.g=ue}else tc(S);0<v.i.length&&Qt(v)}else mt[0]!="stop"&&mt[0]!="close"||br(v,7);else v.G==3&&(mt[0]=="stop"||mt[0]=="close"?mt[0]=="stop"?br(v,7):Es(v):mt[0]!="noop"&&v.l&&v.l.ta(mt),v.v=0)}}Ht(4)}catch{}}var en=class{constructor(c,x){this.g=c,this.map=x}};function ct(c){this.l=c||10,h.PerformanceNavigationTiming?(c=h.performance.getEntriesByType("navigation"),c=0<c.length&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(h.chrome&&h.chrome.loadTimes&&h.chrome.loadTimes()&&h.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function It(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function Ut(c){return c.h?1:c.g?c.g.size:0}function pn(c,x){return c.h?c.h==x:c.g?c.g.has(x):!1}function hr(c,x){c.g?c.g.add(x):c.h=x}function qs(c,x){c.h&&c.h==x?c.h=null:c.g&&c.g.has(x)&&c.g.delete(x)}ct.prototype.cancel=function(){if(this.i=Hn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function Hn(c){if(c.h!=null)return c.i.concat(c.h.D);if(c.g!=null&&c.g.size!==0){let x=c.i;for(const v of c.g.values())x=x.concat(v.D);return x}return B(c.i)}function Ks(c){if(c.V&&typeof c.V=="function")return c.V();if(typeof Map<"u"&&c instanceof Map||typeof Set<"u"&&c instanceof Set)return Array.from(c.values());if(typeof c=="string")return c.split("");if(p(c)){for(var x=[],v=c.length,S=0;S<v;S++)x.push(c[S]);return x}x=[],v=0;for(S in c)x[v++]=c[S];return x}function Xl(c){if(c.na&&typeof c.na=="function")return c.na();if(!c.V||typeof c.V!="function"){if(typeof Map<"u"&&c instanceof Map)return Array.from(c.keys());if(!(typeof Set<"u"&&c instanceof Set)){if(p(c)||typeof c=="string"){var x=[];c=c.length;for(var v=0;v<c;v++)x.push(v);return x}x=[],v=0;for(const S in c)x[v++]=S;return x}}}function nr(c,x){if(c.forEach&&typeof c.forEach=="function")c.forEach(x,void 0);else if(p(c)||typeof c=="string")Array.prototype.forEach.call(c,x,void 0);else for(var v=Xl(c),S=Ks(c),G=S.length,Q=0;Q<G;Q++)x.call(void 0,S[Q],v&&v[Q],c)}var Xs=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Hd(c,x){if(c){c=c.split("&");for(var v=0;v<c.length;v++){var S=c[v].indexOf("="),G=null;if(0<=S){var Q=c[v].substring(0,S);G=c[v].substring(S+1)}else Q=c[v];x(Q,G?decodeURIComponent(G.replace(/\+/g," ")):"")}}}function Nr(c){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,c instanceof Nr){this.h=c.h,or(this,c.j),this.o=c.o,this.g=c.g,le(this,c.s),this.l=c.l;var x=c.i,v=new Ls;v.i=x.i,x.g&&(v.g=new Map(x.g),v.h=x.h),X(this,v),this.m=c.m}else c&&(x=String(c).match(Xs))?(this.h=!1,or(this,x[1]||"",!0),this.o=xr(x[2]||""),this.g=xr(x[3]||"",!0),le(this,x[4]),this.l=xr(x[5]||"",!0),X(this,x[6]||"",!0),this.m=xr(x[7]||"")):(this.h=!1,this.i=new Ls(null,this.h))}Nr.prototype.toString=function(){var c=[],x=this.j;x&&c.push(fi(x,ts,!0),":");var v=this.g;return(v||x=="file")&&(c.push("//"),(x=this.o)&&c.push(fi(x,ts,!0),"@"),c.push(encodeURIComponent(String(v)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),v=this.s,v!=null&&c.push(":",String(v))),(v=this.l)&&(this.g&&v.charAt(0)!="/"&&c.push("/"),c.push(fi(v,v.charAt(0)=="/"?rr:kt,!0))),(v=this.i.toString())&&c.push("?",v),(v=this.m)&&c.push("#",fi(v,Gd)),c.join("")};function tn(c){return new Nr(c)}function or(c,x,v){c.j=v?xr(x,!0):x,c.j&&(c.j=c.j.replace(/:$/,""))}function le(c,x){if(x){if(x=Number(x),isNaN(x)||0>x)throw Error("Bad port number "+x);c.s=x}else c.s=null}function X(c,x,v){x instanceof Ls?(c.i=x,ki(c.i,c.h)):(v||(x=fi(x,uu)),c.i=new Ls(x,c.h))}function Pe(c,x,v){c.i.set(x,v)}function er(c){return Pe(c,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),c}function xr(c,x){return c?x?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function fi(c,x,v){return typeof c=="string"?(c=encodeURI(c).replace(x,Ql),v&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function Ql(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var ts=/[#\/\?@]/g,kt=/[#\?:]/g,rr=/[#\?]/g,uu=/[#\?@]/g,Gd=/#/g;function Ls(c,x){this.h=this.g=null,this.i=c||null,this.j=!!x}function Rr(c){c.g||(c.g=new Map,c.h=0,c.i&&Hd(c.i,function(x,v){c.add(decodeURIComponent(x.replace(/\+/g," ")),v)}))}t=Ls.prototype,t.add=function(c,x){Rr(this),this.i=null,c=Yr(this,c);var v=this.g.get(c);return v||this.g.set(c,v=[]),v.push(x),this.h+=1,this};function Xa(c,x){Rr(c),x=Yr(c,x),c.g.has(x)&&(c.i=null,c.h-=c.g.get(x).length,c.g.delete(x))}function Yl(c,x){return Rr(c),x=Yr(c,x),c.g.has(x)}t.forEach=function(c,x){Rr(this),this.g.forEach(function(v,S){v.forEach(function(G){c.call(x,G,S,this)},this)},this)},t.na=function(){Rr(this);const c=Array.from(this.g.values()),x=Array.from(this.g.keys()),v=[];for(let S=0;S<x.length;S++){const G=c[S];for(let Q=0;Q<G.length;Q++)v.push(x[S])}return v},t.V=function(c){Rr(this);let x=[];if(typeof c=="string")Yl(this,c)&&(x=x.concat(this.g.get(Yr(this,c))));else{c=Array.from(this.g.values());for(let v=0;v<c.length;v++)x=x.concat(c[v])}return x},t.set=function(c,x){return Rr(this),this.i=null,c=Yr(this,c),Yl(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[x]),this.h+=1,this},t.get=function(c,x){return c?(c=this.V(c),0<c.length?String(c[0]):x):x};function wr(c,x,v){Xa(c,x),0<v.length&&(c.i=null,c.g.set(Yr(c,x),B(v)),c.h+=v.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],x=Array.from(this.g.keys());for(var v=0;v<x.length;v++){var S=x[v];const Q=encodeURIComponent(String(S)),ue=this.V(S);for(S=0;S<ue.length;S++){var G=Q;ue[S]!==""&&(G+="="+encodeURIComponent(String(ue[S]))),c.push(G)}}return this.i=c.join("&")};function Yr(c,x){return x=String(x),c.j&&(x=x.toLowerCase()),x}function ki(c,x){x&&!c.j&&(Rr(c),c.i=null,c.g.forEach(function(v,S){var G=S.toLowerCase();S!=G&&(Xa(this,S),wr(this,G,v))},c)),c.j=x}function $t(c,x){const v=new oe;if(h.Image){const S=new Image;S.onload=k(Nt,v,"TestLoadImage: loaded",!0,x,S),S.onerror=k(Nt,v,"TestLoadImage: error",!1,x,S),S.onabort=k(Nt,v,"TestLoadImage: abort",!1,x,S),S.ontimeout=k(Nt,v,"TestLoadImage: timeout",!1,x,S),h.setTimeout(function(){S.ontimeout&&S.ontimeout()},1e4),S.src=c}else x(!1)}function qd(c,x){const v=new oe,S=new AbortController,G=setTimeout(()=>{S.abort(),Nt(v,"TestPingServer: timeout",!1,x)},1e4);fetch(c,{signal:S.signal}).then(Q=>{clearTimeout(G),Q.ok?Nt(v,"TestPingServer: ok",!0,x):Nt(v,"TestPingServer: server error",!1,x)}).catch(()=>{clearTimeout(G),Nt(v,"TestPingServer: error",!1,x)})}function Nt(c,x,v,S,G){try{G&&(G.onload=null,G.onerror=null,G.onabort=null,G.ontimeout=null),S(v)}catch{}}function Or(){this.g=new wt}function Kd(c,x,v){const S=v||"";try{nr(c,function(G,Q){let ue=G;y(G)&&(ue=Tt(G)),x.push(S+Q+"="+encodeURIComponent(ue))})}catch(G){throw x.push(S+"type="+encodeURIComponent("_badmap")),G}}function mi(c){this.l=c.Ub||null,this.j=c.eb||!1}L(mi,bt),mi.prototype.g=function(){return new Di(this.l,this.j)},mi.prototype.i=function(c){return function(){return c}}({});function Di(c,x){tt.call(this),this.D=c,this.o=x,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}L(Di,tt),t=Di.prototype,t.open=function(c,x){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=c,this.A=x,this.readyState=1,ds(this)},t.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const x={headers:this.u,method:this.B,credentials:this.m,cache:void 0};c&&(x.body=c),(this.D||h).fetch(new Request(this.A,x)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,gi(this)),this.readyState=0},t.Sa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,ds(this)),this.g&&(this.readyState=3,ds(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof h.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;pi(this)}else c.text().then(this.Ra.bind(this),this.ga.bind(this))};function pi(c){c.j.read().then(c.Pa.bind(c)).catch(c.ga.bind(c))}t.Pa=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var x=c.value?c.value:new Uint8Array(0);(x=this.v.decode(x,{stream:!c.done}))&&(this.response=this.responseText+=x)}c.done?gi(this):ds(this),this.readyState==3&&pi(this)}},t.Ra=function(c){this.g&&(this.response=this.responseText=c,gi(this))},t.Qa=function(c){this.g&&(this.response=c,gi(this))},t.ga=function(){this.g&&gi(this)};function gi(c){c.readyState=4,c.l=null,c.j=null,c.v=null,ds(c)}t.setRequestHeader=function(c,x){this.u.append(c,x)},t.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],x=this.h.entries();for(var v=x.next();!v.done;)v=v.value,c.push(v[0]+": "+v[1]),v=x.next();return c.join(`\r
`)};function ds(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(Di.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function Gi(c){let x="";return Z(c,function(v,S){x+=S,x+=":",x+=v,x+=`\r
`}),x}function yi(c,x,v){e:{for(S in v){var S=!1;break e}S=!0}S||(v=Gi(v),typeof c=="string"?v!=null&&encodeURIComponent(String(v)):Pe(c,x,v))}function Zt(c){tt.call(this),this.headers=new Map,this.o=c||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}L(Zt,tt);var Qa=/^https?$/i,Ya=["POST","PUT"];t=Zt.prototype,t.Ha=function(c){this.J=c},t.ea=function(c,x,v,S){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);x=x?x.toUpperCase():"GET",this.D=c,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Je.g(),this.v=this.o?ce(this.o):ce(Je),this.g.onreadystatechange=T(this.Ea,this);try{this.B=!0,this.g.open(x,String(c),!0),this.B=!1}catch(Q){$r(this,Q);return}if(c=v||"",v=new Map(this.headers),S)if(Object.getPrototypeOf(S)===Object.prototype)for(var G in S)v.set(G,S[G]);else if(typeof S.keys=="function"&&typeof S.get=="function")for(const Q of S.keys())v.set(Q,S.get(Q));else throw Error("Unknown input type for opt_headers: "+String(S));S=Array.from(v.keys()).find(Q=>Q.toLowerCase()=="content-type"),G=h.FormData&&c instanceof h.FormData,!(0<=Array.prototype.indexOf.call(Ya,x,void 0))||S||G||v.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Q,ue]of v)this.g.setRequestHeader(Q,ue);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Zl(this),this.u=!0,this.g.send(c),this.u=!1}catch(Q){$r(this,Q)}};function $r(c,x){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=x,c.m=5,$o(c),Oi(c)}function $o(c){c.A||(c.A=!0,ot(c,"complete"),ot(c,"error"))}t.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=c||7,ot(this,"complete"),ot(this,"abort"),Oi(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Oi(this,!0)),Zt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?zo(this):this.bb())},t.bb=function(){zo(this)};function zo(c){if(c.h&&typeof l<"u"&&(!c.v[1]||Mr(c)!=4||c.Z()!=2)){if(c.u&&Mr(c)==4)Kt(c.Ea,0,c);else if(ot(c,"readystatechange"),Mr(c)==4){c.h=!1;try{const ue=c.Z();e:switch(ue){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var x=!0;break e;default:x=!1}var v;if(!(v=x)){var S;if(S=ue===0){var G=String(c.D).match(Xs)[1]||null;!G&&h.self&&h.self.location&&(G=h.self.location.protocol.slice(0,-1)),S=!Qa.test(G?G.toLowerCase():"")}v=S}if(v)ot(c,"complete"),ot(c,"success");else{c.m=6;try{var Q=2<Mr(c)?c.g.statusText:""}catch{Q=""}c.l=Q+" ["+c.Z()+"]",$o(c)}}finally{Oi(c)}}}}function Oi(c,x){if(c.g){Zl(c);const v=c.g,S=c.v[0]?()=>{}:null;c.g=null,c.v=null,x||ot(c,"ready");try{v.onreadystatechange=S}catch{}}}function Zl(c){c.I&&(h.clearTimeout(c.I),c.I=null)}t.isActive=function(){return!!this.g};function Mr(c){return c.g?c.g.readyState:0}t.Z=function(){try{return 2<Mr(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(c){if(this.g){var x=this.g.responseText;return c&&x.indexOf(c)==0&&(x=x.substring(c.length)),Rt(x)}};function Jl(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.H){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function $n(c){const x={};c=(c.g&&2<=Mr(c)&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let S=0;S<c.length;S++){if(M(c[S]))continue;var v=O(c[S]);const G=v[0];if(v=v[1],typeof v!="string")continue;v=v.trim();const Q=x[G]||[];x[G]=Q,Q.push(v)}A(x,function(S){return S.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Qs(c,x,v){return v&&v.internalChannelParams&&v.internalChannelParams[c]||x}function pa(c){this.Aa=0,this.i=[],this.j=new oe,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Qs("failFast",!1,c),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Qs("baseRetryDelayMs",5e3,c),this.cb=Qs("retryDelaySeedMs",1e4,c),this.Wa=Qs("forwardChannelMaxRetries",2,c),this.wa=Qs("forwardChannelRequestTimeoutMs",2e4,c),this.pa=c&&c.xmlHttpFactory||void 0,this.Xa=c&&c.Tb||void 0,this.Ca=c&&c.useFetchStreams||!1,this.L=void 0,this.J=c&&c.supportsCrossDomainXhr||!1,this.K="",this.h=new ct(c&&c.concurrentRequestLimit),this.Da=new Or,this.P=c&&c.fastHandshake||!1,this.O=c&&c.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=c&&c.Rb||!1,c&&c.xa&&this.j.xa(),c&&c.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&c&&c.detectBufferingProxy||!1,this.ja=void 0,c&&c.longPollingTimeout&&0<c.longPollingTimeout&&(this.ja=c.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=pa.prototype,t.la=8,t.G=1,t.connect=function(c,x,v,S){nt(0),this.W=c,this.H=x||{},v&&S!==void 0&&(this.H.OSID=v,this.H.OAID=S),this.F=this.X,this.I=Dt(this,null,this.W),Qt(this)};function Es(c){if(he(c),c.G==3){var x=c.U++,v=tn(c.I);if(Pe(v,"SID",c.K),Pe(v,"RID",x),Pe(v,"TYPE","terminate"),Ys(c,v),x=new St(c,c.j,x),x.L=2,x.v=er(tn(v)),v=!1,h.navigator&&h.navigator.sendBeacon)try{v=h.navigator.sendBeacon(x.v.toString(),"")}catch{}!v&&h.Image&&(new Image().src=x.v,v=!0),v||(x.g=nc(x.j,null),x.g.ea(x.v)),x.F=Date.now(),vn(x)}Fn(c)}function qi(c){c.g&&(Ki(c),c.g.cancel(),c.g=null)}function he(c){qi(c),c.u&&(h.clearTimeout(c.u),c.u=null),xi(c),c.h.cancel(),c.s&&(typeof c.s=="number"&&h.clearTimeout(c.s),c.s=null)}function Qt(c){if(!It(c.h)&&!c.s){c.s=!0;var x=c.Ga;We||et(),Ee||(We(),Ee=!0),qe.add(x,c),c.B=0}}function Lr(c,x){return Ut(c.h)>=c.h.j-(c.s?1:0)?!1:c.s?(c.i=x.D.concat(c.i),!0):c.G==1||c.G==2||c.B>=(c.Va?0:c.Wa)?!1:(c.s=J(T(c.Ga,c,x),ya(c,c.B)),c.B++,!0)}t.Ga=function(c){if(this.s)if(this.s=null,this.G==1){if(!c){this.U=Math.floor(1e5*Math.random()),c=this.U++;const G=new St(this,this.j,c);let Q=this.o;if(this.S&&(Q?(Q=C(Q),D(Q,this.S)):Q=this.S),this.m!==null||this.O||(G.H=Q,Q=null),this.P)e:{for(var x=0,v=0;v<this.i.length;v++){t:{var S=this.i[v];if("__data__"in S.map&&(S=S.map.__data__,typeof S=="string")){S=S.length;break t}S=void 0}if(S===void 0)break;if(x+=S,4096<x){x=v;break e}if(x===4096||v===this.i.length-1){x=v+1;break e}}x=1e3}else x=1e3;x=ec(this,G,x),v=tn(this.I),Pe(v,"RID",c),Pe(v,"CVER",22),this.D&&Pe(v,"X-HTTP-Session-Id",this.D),Ys(this,v),Q&&(this.O?x="headers="+encodeURIComponent(String(Gi(Q)))+"&"+x:this.m&&yi(v,this.m,Q)),hr(this.h,G),this.Ua&&Pe(v,"TYPE","init"),this.P?(Pe(v,"$req",x),Pe(v,"SID","null"),G.T=!0,Pt(G,v,null)):Pt(G,v,x),this.G=2}}else this.G==3&&(c?ga(this,c):this.i.length==0||It(this.h)||ga(this))};function ga(c,x){var v;x?v=x.l:v=c.U++;const S=tn(c.I);Pe(S,"SID",c.K),Pe(S,"RID",v),Pe(S,"AID",c.T),Ys(c,S),c.m&&c.o&&yi(S,c.m,c.o),v=new St(c,c.j,v,c.B+1),c.m===null&&(v.H=c.o),x&&(c.i=x.D.concat(c.i)),x=ec(c,v,1e3),v.I=Math.round(.5*c.wa)+Math.round(.5*c.wa*Math.random()),hr(c.h,v),Pt(v,S,x)}function Ys(c,x){c.H&&Z(c.H,function(v,S){Pe(x,S,v)}),c.l&&nr({},function(v,S){Pe(x,S,v)})}function ec(c,x,v){v=Math.min(c.i.length,v);var S=c.l?T(c.l.Na,c.l,c):null;e:{var G=c.i;let Q=-1;for(;;){const ue=["count="+v];Q==-1?0<v?(Q=G[0].g,ue.push("ofs="+Q)):Q=0:ue.push("ofs="+Q);let Ot=!0;for(let gn=0;gn<v;gn++){let mt=G[gn].g;const fn=G[gn].map;if(mt-=Q,0>mt)Q=Math.max(0,G[gn].g-100),Ot=!1;else try{Kd(fn,ue,"req"+mt+"_")}catch{S&&S(fn)}}if(Ot){S=ue.join("&");break e}}}return c=c.i.splice(0,v),x.D=c,S}function tc(c){if(!c.g&&!c.u){c.Y=1;var x=c.Fa;We||et(),Ee||(We(),Ee=!0),qe.add(x,c),c.v=0}}function Za(c){return c.g||c.u||3<=c.v?!1:(c.Y++,c.u=J(T(c.Fa,c),ya(c,c.v)),c.v++,!0)}t.Fa=function(){if(this.u=null,fr(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var c=2*this.R;this.j.info("BP detection timer enabled: "+c),this.A=J(T(this.ab,this),c)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,nt(10),qi(this),fr(this))};function Ki(c){c.A!=null&&(h.clearTimeout(c.A),c.A=null)}function fr(c){c.g=new St(c,c.j,"rpc",c.Y),c.m===null&&(c.g.H=c.o),c.g.O=0;var x=tn(c.qa);Pe(x,"RID","rpc"),Pe(x,"SID",c.K),Pe(x,"AID",c.T),Pe(x,"CI",c.F?"0":"1"),!c.F&&c.ja&&Pe(x,"TO",c.ja),Pe(x,"TYPE","xmlhttp"),Ys(c,x),c.m&&c.o&&yi(x,c.m,c.o),c.L&&(c.g.I=c.L);var v=c.g;c=c.ia,v.L=1,v.v=er(tn(x)),v.m=null,v.P=!0,bn(v,c)}t.Za=function(){this.C!=null&&(this.C=null,qi(this),Za(this),nt(19))};function xi(c){c.C!=null&&(h.clearTimeout(c.C),c.C=null)}function tr(c,x){var v=null;if(c.g==x){xi(c),Ki(c),c.g=null;var S=2}else if(pn(c.h,x))v=x.D,qs(c.h,x),S=1;else return;if(c.G!=0){if(x.o)if(S==1){v=x.m?x.m.length:0,x=Date.now()-x.F;var G=c.B;S=wn(),ot(S,new ee(S,v)),Qt(c)}else tc(c);else if(G=x.s,G==3||G==0&&0<x.X||!(S==1&&Lr(c,x)||S==2&&Za(c)))switch(v&&0<v.length&&(x=c.h,x.i=x.i.concat(v)),G){case 1:br(c,5);break;case 4:br(c,10);break;case 3:br(c,6);break;default:br(c,2)}}}function ya(c,x){let v=c.Ta+Math.floor(Math.random()*c.cb);return c.isActive()||(v*=2),v*x}function br(c,x){if(c.j.info("Error code "+x),x==2){var v=T(c.fb,c),S=c.Xa;const G=!S;S=new Nr(S||"//www.google.com/images/cleardot.gif"),h.location&&h.location.protocol=="http"||or(S,"https"),er(S),G?$t(S.toString(),v):qd(S.toString(),v)}else nt(2);c.G=0,c.l&&c.l.sa(x),Fn(c),he(c)}t.fb=function(c){c?(this.j.info("Successfully pinged google.com"),nt(2)):(this.j.info("Failed to ping google.com"),nt(1))};function Fn(c){if(c.G=0,c.ka=[],c.l){const x=Hn(c.h);(x.length!=0||c.i.length!=0)&&(H(c.ka,x),H(c.ka,c.i),c.h.i.length=0,B(c.i),c.i.length=0),c.l.ra()}}function Dt(c,x,v){var S=v instanceof Nr?tn(v):new Nr(v);if(S.g!="")x&&(S.g=x+"."+S.g),le(S,S.s);else{var G=h.location;S=G.protocol,x=x?x+"."+G.hostname:G.hostname,G=+G.port;var Q=new Nr(null);S&&or(Q,S),x&&(Q.g=x),G&&le(Q,G),v&&(Q.l=v),S=Q}return v=c.D,x=c.ya,v&&x&&Pe(S,v,x),Pe(S,"VER",c.la),Ys(c,S),S}function nc(c,x,v){if(x&&!c.J)throw Error("Can't create secondary domain capable XhrIo object.");return x=c.Ca&&!c.pa?new Zt(new mi({eb:v})):new Zt(c.pa),x.Ha(c.J),x}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Gn(){}t=Gn.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function hs(){}hs.prototype.g=function(c,x){return new On(c,x)};function On(c,x){tt.call(this),this.g=new pa(x),this.l=c,this.h=x&&x.messageUrlParams||null,c=x&&x.messageHeaders||null,x&&x.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=x&&x.initMessageHeaders||null,x&&x.messageContentType&&(c?c["X-WebChannel-Content-Type"]=x.messageContentType:c={"X-WebChannel-Content-Type":x.messageContentType}),x&&x.va&&(c?c["X-WebChannel-Client-Profile"]=x.va:c={"X-WebChannel-Client-Profile":x.va}),this.g.S=c,(c=x&&x.Sb)&&!M(c)&&(this.g.m=c),this.v=x&&x.supportsCrossDomainXhr||!1,this.u=x&&x.sendRawJson||!1,(x=x&&x.httpSessionIdParam)&&!M(x)&&(this.g.D=x,c=this.h,c!==null&&x in c&&(c=this.h,x in c&&delete c[x])),this.j=new fs(this)}L(On,tt),On.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},On.prototype.close=function(){Es(this.g)},On.prototype.o=function(c){var x=this.g;if(typeof c=="string"){var v={};v.__data__=c,c=v}else this.u&&(v={},v.__data__=Tt(c),c=v);x.i.push(new en(x.Ya++,c)),x.G==3&&Qt(x)},On.prototype.N=function(){this.g.l=null,delete this.j,Es(this.g),delete this.g,On.aa.N.call(this)};function rc(c){Ce.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var x=c.__sm__;if(x){e:{for(const v in x){c=v;break e}c=void 0}(this.i=c)&&(c=this.i,x=x!==null&&c in x?x[c]:void 0),this.data=x}else this.data=c}L(rc,Ce);function bs(){it.call(this),this.status=1}L(bs,it);function fs(c){this.g=c}L(fs,Gn),fs.prototype.ua=function(){ot(this.g,"a")},fs.prototype.ta=function(c){ot(this.g,new rc(c))},fs.prototype.sa=function(c){ot(this.g,new bs)},fs.prototype.ra=function(){ot(this.g,"b")},hs.prototype.createWebChannel=hs.prototype.g,On.prototype.send=On.prototype.o,On.prototype.open=On.prototype.m,On.prototype.close=On.prototype.close,WR=function(){return new hs},zR=function(){return wn()},$R=He,qx={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ze.NO_ERROR=0,Ze.TIMEOUT=8,Ze.HTTP_ERROR=6,Cp=Ze,Fe.COMPLETE="complete",UR=Fe,Ie.EventType=be,be.OPEN="a",be.CLOSE="b",be.ERROR="c",be.MESSAGE="d",tt.prototype.listen=tt.prototype.K,vh=Ie,Zt.prototype.listenOnce=Zt.prototype.L,Zt.prototype.getLastError=Zt.prototype.Ka,Zt.prototype.getLastErrorCode=Zt.prototype.Ba,Zt.prototype.getStatus=Zt.prototype.Z,Zt.prototype.getResponseJson=Zt.prototype.Oa,Zt.prototype.getResponseText=Zt.prototype.oa,Zt.prototype.send=Zt.prototype.ea,Zt.prototype.setWithCredentials=Zt.prototype.Ha,BR=Zt}).apply(typeof Qm<"u"?Qm:typeof self<"u"?self:typeof window<"u"?window:{});const cI="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ns=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Ns.UNAUTHENTICATED=new Ns(null),Ns.GOOGLE_CREDENTIALS=new Ns("google-credentials-uid"),Ns.FIRST_PARTY=new Ns("first-party-uid"),Ns.MOCK_USER=new Ns("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Md="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Uc=new nv("@firebase/firestore");function lh(){return Uc.logLevel}function _t(t,...e){if(Uc.logLevel<=kn.DEBUG){const n=e.map(mv);Uc.debug(`Firestore (${Md}): ${t}`,...n)}}function Co(t,...e){if(Uc.logLevel<=kn.ERROR){const n=e.map(mv);Uc.error(`Firestore (${Md}): ${t}`,...n)}}function gd(t,...e){if(Uc.logLevel<=kn.WARN){const n=e.map(mv);Uc.warn(`Firestore (${Md}): ${t}`,...n)}}function mv(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sn(t="Unexpected state"){const e=`FIRESTORE (${Md}) INTERNAL ASSERTION FAILED: `+t;throw Co(e),new Error(e)}function Yn(t,e){t||sn()}function ln(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ne={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};let ut=class extends $a{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xo=class{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let HR=class{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}},cF=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Ns.UNAUTHENTICATED))}shutdown(){}},uF=class{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}},dF=class{constructor(e){this.t=e,this.currentUser=Ns.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Yn(this.o===void 0);let r=this.i;const s=p=>this.i!==r?(r=this.i,n(p)):Promise.resolve();let i=new xo;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new xo,e.enqueueRetryable(()=>s(this.currentUser))};const l=()=>{const p=i;e.enqueueRetryable(async()=>{await p.promise,await s(this.currentUser)})},h=p=>{_t("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=p,this.o&&(this.auth.addAuthTokenListener(this.o),l())};this.t.onInit(p=>h(p)),setTimeout(()=>{if(!this.auth){const p=this.t.getImmediate({optional:!0});p?h(p):(_t("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new xo)}},0),l()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(_t("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Yn(typeof r.accessToken=="string"),new HR(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Yn(e===null||typeof e=="string"),new Ns(e)}},hF=class{constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=Ns.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},fF=class{constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new hF(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Ns.FIRST_PARTY))}shutdown(){}invalidateToken(){}},mF=class{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},pF=class{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){Yn(this.o===void 0);const r=i=>{i.error!=null&&_t("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const l=i.token!==this.R;return this.R=i.token,_t("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{_t("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):_t("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Yn(typeof n.token=="string"),this.R=n.token,new mF(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gF(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let GR=class{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=gF(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%e.length))}return r}};function zn(t,e){return t<e?-1:t>e?1:0}function yd(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $s=class Sp{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new ut(Ne.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new ut(Ne.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new ut(Ne.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ut(Ne.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Sp.fromMillis(Date.now())}static fromDate(e){return Sp.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new Sp(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?zn(this.nanoseconds,e.nanoseconds):zn(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let yn=class Np{constructor(e){this.timestamp=e}static fromTimestamp(e){return new Np(e)}static min(){return new Np(new $s(0,0))}static max(){return new Np(new $s(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let qR=class Kx{constructor(e,n,r){n===void 0?n=0:n>e.length&&sn(),r===void 0?r=e.length-n:r>e.length-n&&sn(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Kx.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Kx?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=e.get(s),l=n.get(s);if(i<l)return-1;if(i>l)return 1}return e.length<n.length?-1:e.length>n.length?1:0}},Br=class Rp extends qR{construct(e,n,r){return new Rp(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new ut(Ne.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new Rp(n)}static emptyPath(){return new Rp([])}};const yF=/^[_a-zA-Z][_a-zA-Z0-9]*$/;let la=class _u extends qR{construct(e,n,r){return new _u(e,n,r)}static isValidIdentifier(e){return yF.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),_u.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new _u(["__name__"])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new ut(Ne.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let l=!1;for(;s<e.length;){const h=e[s];if(h==="\\"){if(s+1===e.length)throw new ut(Ne.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const p=e[s+1];if(p!=="\\"&&p!=="."&&p!=="`")throw new ut(Ne.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=p,s+=2}else h==="`"?(l=!l,s++):h!=="."||l?(r+=h,s++):(i(),s++)}if(i(),l)throw new ut(Ne.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new _u(n)}static emptyPath(){return new _u([])}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Yt=class Eh{constructor(e){this.path=e}static fromPath(e){return new Eh(Br.fromString(e))}static fromName(e){return new Eh(Br.fromString(e).popFirst(5))}static empty(){return new Eh(Br.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Br.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Br.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Eh(new Br(e.slice()))}};function xF(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=yn.fromTimestamp(r===1e9?new $s(n+1,0):new $s(n,r));return new Tf(s,Yt.empty(),e)}function wF(t){return new Tf(t.readTime,t.key,-1)}let Tf=class Xx{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Xx(yn.min(),Yt.empty(),-1)}static max(){return new Xx(yn.max(),Yt.empty(),-1)}};function _F(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=Yt.comparator(t.documentKey,e.documentKey),n!==0?n:zn(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vF="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";let EF=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function am(t){if(t.code!==Ne.FAILED_PRECONDITION||t.message!==vF)throw t;_t("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Xe=class ei{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&sn(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new ei((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof ei?n:ei.resolve(n)}catch(n){return ei.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):ei.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):ei.reject(n)}static resolve(e){return new ei((n,r)=>{n(e)})}static reject(e){return new ei((n,r)=>{r(e)})}static waitFor(e){return new ei((n,r)=>{let s=0,i=0,l=!1;e.forEach(h=>{++s,h.next(()=>{++i,l&&i===s&&n()},p=>r(p))}),l=!0,i===s&&n()})}static or(e){let n=ei.resolve(!1);for(const r of e)n=n.next(s=>s?ei.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new ei((r,s)=>{const i=e.length,l=new Array(i);let h=0;for(let p=0;p<i;p++){const y=p;n(e[y]).next(_=>{l[y]=_,++h,h===i&&r(l)},_=>s(_))}})}static doWhile(e,n){return new ei((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}};function bF(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function om(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let pv=class{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}};pv.oe=-1;function Bg(t){return t==null}function R0(t){return t===0&&1/t==-1/0}function IF(t){return typeof t=="number"&&Number.isInteger(t)&&!R0(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uI(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ru(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function KR(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Xr=class Qx{constructor(e,n){this.comparator=e,this.root=n||Al.EMPTY}insert(e,n){return new Qx(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Al.BLACK,null,null))}remove(e){return new Qx(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Al.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ym(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ym(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ym(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ym(this.root,e,this.comparator,!0)}},Ym=class{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}},Al=class to{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??to.RED,this.left=s??to.EMPTY,this.right=i??to.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new to(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return to.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return to.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,to.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,to.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw sn();const e=this.left.check();if(e!==this.right.check())throw sn();return e+(this.isRed()?0:1)}};Al.EMPTY=null,Al.RED=!0,Al.BLACK=!1;Al.EMPTY=new class{constructor(){this.size=0}get key(){throw sn()}get value(){throw sn()}get color(){throw sn()}get left(){throw sn()}get right(){throw sn()}copy(e,n,r,s,i){return this}insert(e,n,r){return new Al(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ui=class Yx{constructor(e){this.comparator=e,this.data=new Xr(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new dI(this.data.getIterator())}getIteratorFrom(e){return new dI(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Yx)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Yx(this.comparator);return n.data=e,n}},dI=class{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ta=class Zx{constructor(e){this.fields=e,e.sort(la.comparator)}static empty(){return new Zx([])}unionWith(e){let n=new ui(la.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Zx(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return yd(this.fields,e.fields,(n,r)=>n.isEqual(r))}};/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let XR=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let hi=class Jx{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new XR("Invalid base64 string: "+i):i}}(e);return new Jx(n)}static fromUint8Array(e){const n=function(s){let i="";for(let l=0;l<s.length;++l)i+=String.fromCharCode(s[l]);return i}(e);return new Jx(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return zn(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}};hi.EMPTY_BYTE_STRING=new hi("");const AF=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ol(t){if(Yn(!!t),typeof t=="string"){let e=0;const n=AF.exec(t);if(Yn(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:jr(t.seconds),nanos:jr(t.nanos)}}function jr(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function $c(t){return typeof t=="string"?hi.fromBase64String(t):hi.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gv(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function yv(t){const e=t.mapValue.fields.__previous_value__;return gv(e)?yv(e):e}function Cf(t){const e=Ol(t.mapValue.fields.__local_write_time__.timestampValue);return new $s(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let TF=class{constructor(e,n,r,s,i,l,h,p,y){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=l,this.autoDetectLongPolling=h,this.longPollingOptions=p,this.useFetchStreams=y}},QR=class ew{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new ew("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof ew&&e.projectId===this.projectId&&e.database===this.database}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zm={mapValue:{}};function zc(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?gv(t)?4:SF(t)?9007199254740991:CF(t)?10:11:sn()}function za(t,e){if(t===e)return!0;const n=zc(t);if(n!==zc(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Cf(t).isEqual(Cf(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const l=Ol(s.timestampValue),h=Ol(i.timestampValue);return l.seconds===h.seconds&&l.nanos===h.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return $c(s.bytesValue).isEqual($c(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return jr(s.geoPointValue.latitude)===jr(i.geoPointValue.latitude)&&jr(s.geoPointValue.longitude)===jr(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return jr(s.integerValue)===jr(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const l=jr(s.doubleValue),h=jr(i.doubleValue);return l===h?R0(l)===R0(h):isNaN(l)&&isNaN(h)}return!1}(t,e);case 9:return yd(t.arrayValue.values||[],e.arrayValue.values||[],za);case 10:case 11:return function(s,i){const l=s.mapValue.fields||{},h=i.mapValue.fields||{};if(uI(l)!==uI(h))return!1;for(const p in l)if(l.hasOwnProperty(p)&&(h[p]===void 0||!za(l[p],h[p])))return!1;return!0}(t,e);default:return sn()}}function Sf(t,e){return(t.values||[]).find(n=>za(n,e))!==void 0}function xd(t,e){if(t===e)return 0;const n=zc(t),r=zc(e);if(n!==r)return zn(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return zn(t.booleanValue,e.booleanValue);case 2:return function(i,l){const h=jr(i.integerValue||i.doubleValue),p=jr(l.integerValue||l.doubleValue);return h<p?-1:h>p?1:h===p?0:isNaN(h)?isNaN(p)?0:-1:1}(t,e);case 3:return hI(t.timestampValue,e.timestampValue);case 4:return hI(Cf(t),Cf(e));case 5:return zn(t.stringValue,e.stringValue);case 6:return function(i,l){const h=$c(i),p=$c(l);return h.compareTo(p)}(t.bytesValue,e.bytesValue);case 7:return function(i,l){const h=i.split("/"),p=l.split("/");for(let y=0;y<h.length&&y<p.length;y++){const _=zn(h[y],p[y]);if(_!==0)return _}return zn(h.length,p.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,l){const h=zn(jr(i.latitude),jr(l.latitude));return h!==0?h:zn(jr(i.longitude),jr(l.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return fI(t.arrayValue,e.arrayValue);case 10:return function(i,l){var h,p,y,_;const E=i.fields||{},T=l.fields||{},k=(h=E.value)===null||h===void 0?void 0:h.arrayValue,L=(p=T.value)===null||p===void 0?void 0:p.arrayValue,B=zn(((y=k==null?void 0:k.values)===null||y===void 0?void 0:y.length)||0,((_=L==null?void 0:L.values)===null||_===void 0?void 0:_.length)||0);return B!==0?B:fI(k,L)}(t.mapValue,e.mapValue);case 11:return function(i,l){if(i===Zm.mapValue&&l===Zm.mapValue)return 0;if(i===Zm.mapValue)return 1;if(l===Zm.mapValue)return-1;const h=i.fields||{},p=Object.keys(h),y=l.fields||{},_=Object.keys(y);p.sort(),_.sort();for(let E=0;E<p.length&&E<_.length;++E){const T=zn(p[E],_[E]);if(T!==0)return T;const k=xd(h[p[E]],y[_[E]]);if(k!==0)return k}return zn(p.length,_.length)}(t.mapValue,e.mapValue);default:throw sn()}}function hI(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return zn(t,e);const n=Ol(t),r=Ol(e),s=zn(n.seconds,r.seconds);return s!==0?s:zn(n.nanos,r.nanos)}function fI(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=xd(n[s],r[s]);if(i)return i}return zn(n.length,r.length)}function wd(t){return tw(t)}function tw(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Ol(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return $c(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return Yt.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=tw(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const l of r)i?i=!1:s+=",",s+=`${l}:${tw(n.fields[l])}`;return s+"}"}(t.mapValue):sn()}function mI(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function nw(t){return!!t&&"integerValue"in t}function xv(t){return!!t&&"arrayValue"in t}function pI(t){return!!t&&"nullValue"in t}function gI(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Pp(t){return!!t&&"mapValue"in t}function CF(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function Uh(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return ru(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Uh(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Uh(t.arrayValue.values[n]);return e}return Object.assign({},t)}function SF(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let sa=class rw{constructor(e){this.value=e}static empty(){return new rw({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Pp(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Uh(n)}setAll(e){let n=la.emptyPath(),r={},s=[];e.forEach((l,h)=>{if(!n.isImmediateParentOf(h)){const p=this.getFieldsMap(n);this.applyChanges(p,r,s),r={},s=[],n=h.popLast()}l?r[h.lastSegment()]=Uh(l):s.push(h.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());Pp(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return za(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];Pp(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){ru(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new rw(Uh(this.value))}};function YR(t){const e=[];return ru(t.fields,(n,r)=>{const s=new la([n]);if(Pp(r)){const i=YR(r.mapValue).fields;if(i.length===0)e.push(s);else for(const l of i)e.push(s.child(l))}else e.push(s)}),new Ta(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let So=class oc{constructor(e,n,r,s,i,l,h){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=l,this.documentState=h}static newInvalidDocument(e){return new oc(e,0,yn.min(),yn.min(),yn.min(),sa.empty(),0)}static newFoundDocument(e,n,r,s){return new oc(e,1,n,yn.min(),r,s,0)}static newNoDocument(e,n){return new oc(e,2,n,yn.min(),yn.min(),sa.empty(),0)}static newUnknownDocument(e,n){return new oc(e,3,n,yn.min(),yn.min(),sa.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(yn.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=sa.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=sa.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=yn.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof oc&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new oc(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let P0=class{constructor(e,n){this.position=e,this.inclusive=n}};function yI(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],l=t.position[s];if(i.field.isKeyField()?r=Yt.comparator(Yt.fromName(l.referenceValue),n.key):r=xd(l,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function xI(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!za(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Nf=class{constructor(e,n="asc"){this.field=e,this.dir=n}};function NF(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let ZR=class{},as=class JR extends ZR{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new PF(e,n,r):n==="array-contains"?new OF(e,r):n==="in"?new MF(e,r):n==="not-in"?new LF(e,r):n==="array-contains-any"?new jF(e,r):new JR(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new kF(e,r):new DF(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(xd(n,this.value)):n!==null&&zc(this.value)===zc(n)&&this.matchesComparison(xd(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return sn()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},No=class e4 extends ZR{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new e4(e,n)}matches(e){return t4(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function t4(t){return t.op==="and"}function n4(t){return RF(t)&&t4(t)}function RF(t){for(const e of t.filters)if(e instanceof No)return!1;return!0}function sw(t){if(t instanceof as)return t.field.canonicalString()+t.op.toString()+wd(t.value);if(n4(t))return t.filters.map(e=>sw(e)).join(",");{const e=t.filters.map(n=>sw(n)).join(",");return`${t.op}(${e})`}}function r4(t,e){return t instanceof as?function(r,s){return s instanceof as&&r.op===s.op&&r.field.isEqual(s.field)&&za(r.value,s.value)}(t,e):t instanceof No?function(r,s){return s instanceof No&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,l,h)=>i&&r4(l,s.filters[h]),!0):!1}(t,e):void sn()}function s4(t){return t instanceof as?function(n){return`${n.field.canonicalString()} ${n.op} ${wd(n.value)}`}(t):t instanceof No?function(n){return n.op.toString()+" {"+n.getFilters().map(s4).join(" ,")+"}"}(t):"Filter"}let PF=class extends as{constructor(e,n,r){super(e,n,r),this.key=Yt.fromName(r.referenceValue)}matches(e){const n=Yt.comparator(e.key,this.key);return this.matchesComparison(n)}},kF=class extends as{constructor(e,n){super(e,"in",n),this.keys=i4("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}},DF=class extends as{constructor(e,n){super(e,"not-in",n),this.keys=i4("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}};function i4(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>Yt.fromName(r.referenceValue))}let OF=class extends as{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return xv(n)&&Sf(n.arrayValue,this.value)}},MF=class extends as{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Sf(this.value.arrayValue,n)}},LF=class extends as{constructor(e,n){super(e,"not-in",n)}matches(e){if(Sf(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!Sf(this.value.arrayValue,n)}},jF=class extends as{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!xv(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Sf(this.value.arrayValue,r))}};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let FF=class{constructor(e,n=null,r=[],s=[],i=null,l=null,h=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=l,this.endAt=h,this.ue=null}};function wI(t,e=null,n=[],r=[],s=null,i=null,l=null){return new FF(t,e,n,r,s,i,l)}function wv(t){const e=ln(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>sw(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),Bg(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>wd(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>wd(r)).join(",")),e.ue=n}return e.ue}function _v(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!NF(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!r4(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!xI(t.startAt,e.startAt)&&xI(t.endAt,e.endAt)}function iw(t){return Yt.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ld=class{constructor(e,n=null,r=[],s=[],i=null,l="F",h=null,p=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=l,this.startAt=h,this.endAt=p,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function VF(t,e,n,r,s,i,l,h){return new Ld(t,e,n,r,s,i,l,h)}function vv(t){return new Ld(t)}function _I(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function a4(t){return t.collectionGroup!==null}function $h(t){const e=ln(t);if(e.ce===null){e.ce=[];const n=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(l){let h=new ui(la.comparator);return l.filters.forEach(p=>{p.getFlattenedFilters().forEach(y=>{y.isInequality()&&(h=h.add(y.field))})}),h})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.ce.push(new Nf(i,r))}),n.has(la.keyField().canonicalString())||e.ce.push(new Nf(la.keyField(),r))}return e.ce}function Ma(t){const e=ln(t);return e.le||(e.le=BF(e,$h(t))),e.le}function BF(t,e){if(t.limitType==="F")return wI(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Nf(s.field,i)});const n=t.endAt?new P0(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new P0(t.startAt.position,t.startAt.inclusive):null;return wI(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function aw(t,e){const n=t.filters.concat([e]);return new Ld(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function ow(t,e,n){return new Ld(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Ug(t,e){return _v(Ma(t),Ma(e))&&t.limitType===e.limitType}function o4(t){return`${wv(Ma(t))}|lt:${t.limitType}`}function vu(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>s4(s)).join(", ")}]`),Bg(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(l){return`${l.field.canonicalString()} (${l.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>wd(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>wd(s)).join(",")),`Target(${r})`}(Ma(t))}; limitType=${t.limitType})`}function $g(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):Yt.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of $h(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(l,h,p){const y=yI(l,h,p);return l.inclusive?y<=0:y<0}(r.startAt,$h(r),s)||r.endAt&&!function(l,h,p){const y=yI(l,h,p);return l.inclusive?y>=0:y>0}(r.endAt,$h(r),s))}(t,e)}function UF(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function l4(t){return(e,n)=>{let r=!1;for(const s of $h(t)){const i=$F(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function $F(t,e,n){const r=t.field.isKeyField()?Yt.comparator(e.key,n.key):function(i,l,h){const p=l.data.field(i),y=h.data.field(i);return p!==null&&y!==null?xd(p,y):sn()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return sn()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let jd=class{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){ru(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return KR(this.inner)}size(){return this.innerSize}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zF=new Xr(Yt.comparator);function Ro(){return zF}const c4=new Xr(Yt.comparator);function bh(...t){let e=c4;for(const n of t)e=e.insert(n.key,n);return e}function u4(t){let e=c4;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function yc(){return zh()}function d4(){return zh()}function zh(){return new jd(t=>t.toString(),(t,e)=>t.isEqual(e))}const WF=new Xr(Yt.comparator),HF=new ui(Yt.comparator);function Sn(...t){let e=HF;for(const n of t)e=e.add(n);return e}const GF=new ui(zn);function qF(){return GF}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ev(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:R0(e)?"-0":e}}function h4(t){return{integerValue:""+t}}function KF(t,e){return IF(e)?h4(e):Ev(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let zg=class{constructor(){this._=void 0}};function XF(t,e,n){return t instanceof Rf?function(s,i){const l={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&gv(i)&&(i=yv(i)),i&&(l.fields.__previous_value__=i),{mapValue:l}}(n,e):t instanceof Pf?m4(t,e):t instanceof kf?p4(t,e):function(s,i){const l=f4(s,i),h=vI(l)+vI(s.Pe);return nw(l)&&nw(s.Pe)?h4(h):Ev(s.serializer,h)}(t,e)}function QF(t,e,n){return t instanceof Pf?m4(t,e):t instanceof kf?p4(t,e):n}function f4(t,e){return t instanceof k0?function(r){return nw(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}let Rf=class extends zg{},Pf=class extends zg{constructor(e){super(),this.elements=e}};function m4(t,e){const n=g4(e);for(const r of t.elements)n.some(s=>za(s,r))||n.push(r);return{arrayValue:{values:n}}}let kf=class extends zg{constructor(e){super(),this.elements=e}};function p4(t,e){let n=g4(e);for(const r of t.elements)n=n.filter(s=>!za(s,r));return{arrayValue:{values:n}}}let k0=class extends zg{constructor(e,n){super(),this.serializer=e,this.Pe=n}};function vI(t){return jr(t.integerValue||t.doubleValue)}function g4(t){return xv(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YF{constructor(e,n){this.field=e,this.transform=n}}function ZF(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof Pf&&s instanceof Pf||r instanceof kf&&s instanceof kf?yd(r.elements,s.elements,za):r instanceof k0&&s instanceof k0?za(r.Pe,s.Pe):r instanceof Rf&&s instanceof Rf}(t.transform,e.transform)}let JF=class{constructor(e,n){this.version=e,this.transformResults=n}},Tl=class kp{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new kp}static exists(e){return new kp(void 0,e)}static updateTime(e){return new kp(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}};function Dp(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}let Wg=class{};function y4(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new bv(t.key,Tl.none()):new lm(t.key,t.data,Tl.none());{const n=t.data,r=sa.empty();let s=new ui(la.comparator);for(let i of e.fields)if(!s.has(i)){let l=n.field(i);l===null&&i.length>1&&(i=i.popLast(),l=n.field(i)),l===null?r.delete(i):r.set(i,l),s=s.add(i)}return new Hl(t.key,r,new Ta(s.toArray()),Tl.none())}}function eV(t,e,n){t instanceof lm?function(s,i,l){const h=s.value.clone(),p=bI(s.fieldTransforms,i,l.transformResults);h.setAll(p),i.convertToFoundDocument(l.version,h).setHasCommittedMutations()}(t,e,n):t instanceof Hl?function(s,i,l){if(!Dp(s.precondition,i))return void i.convertToUnknownDocument(l.version);const h=bI(s.fieldTransforms,i,l.transformResults),p=i.data;p.setAll(x4(s)),p.setAll(h),i.convertToFoundDocument(l.version,p).setHasCommittedMutations()}(t,e,n):function(s,i,l){i.convertToNoDocument(l.version).setHasCommittedMutations()}(0,e,n)}function Wh(t,e,n,r){return t instanceof lm?function(i,l,h,p){if(!Dp(i.precondition,l))return h;const y=i.value.clone(),_=II(i.fieldTransforms,p,l);return y.setAll(_),l.convertToFoundDocument(l.version,y).setHasLocalMutations(),null}(t,e,n,r):t instanceof Hl?function(i,l,h,p){if(!Dp(i.precondition,l))return h;const y=II(i.fieldTransforms,p,l),_=l.data;return _.setAll(x4(i)),_.setAll(y),l.convertToFoundDocument(l.version,_).setHasLocalMutations(),h===null?null:h.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(E=>E.field))}(t,e,n,r):function(i,l,h){return Dp(i.precondition,l)?(l.convertToNoDocument(l.version).setHasLocalMutations(),null):h}(t,e,n)}function tV(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=f4(r.transform,s||null);i!=null&&(n===null&&(n=sa.empty()),n.set(r.field,i))}return n||null}function EI(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&yd(r,s,(i,l)=>ZF(i,l))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}let lm=class extends Wg{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}},Hl=class extends Wg{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}};function x4(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function bI(t,e,n){const r=new Map;Yn(t.length===n.length);for(let s=0;s<n.length;s++){const i=t[s],l=i.transform,h=e.data.field(i.field);r.set(i.field,QF(l,h,n[s]))}return r}function II(t,e,n){const r=new Map;for(const s of t){const i=s.transform,l=n.data.field(s.field);r.set(s.field,XF(i,l,e))}return r}let bv=class extends Wg{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},nV=class extends Wg{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let rV=class{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&eV(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Wh(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Wh(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=d4();return this.mutations.forEach(s=>{const i=e.get(s.key),l=i.overlayedDocument;let h=this.applyToLocalView(l,i.mutatedFields);h=n.has(s.key)?null:h;const p=y4(l,h);p!==null&&r.set(s.key,p),l.isValidDocument()||l.convertToNoDocument(yn.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Sn())}isEqual(e){return this.batchId===e.batchId&&yd(this.mutations,e.mutations,(n,r)=>EI(n,r))&&yd(this.baseMutations,e.baseMutations,(n,r)=>EI(n,r))}},sV=class w4{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){Yn(e.mutations.length===r.length);let s=function(){return WF}();const i=e.mutations;for(let l=0;l<i.length;l++)s=s.insert(i[l].key,r[l].version);return new w4(e,n,r,s)}};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let iV=class{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let aV=class{constructor(e,n){this.count=e,this.unchangedNames=n}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Wr,Mn;function oV(t){switch(t){default:return sn();case Ne.CANCELLED:case Ne.UNKNOWN:case Ne.DEADLINE_EXCEEDED:case Ne.RESOURCE_EXHAUSTED:case Ne.INTERNAL:case Ne.UNAVAILABLE:case Ne.UNAUTHENTICATED:return!1;case Ne.INVALID_ARGUMENT:case Ne.NOT_FOUND:case Ne.ALREADY_EXISTS:case Ne.PERMISSION_DENIED:case Ne.FAILED_PRECONDITION:case Ne.ABORTED:case Ne.OUT_OF_RANGE:case Ne.UNIMPLEMENTED:case Ne.DATA_LOSS:return!0}}function _4(t){if(t===void 0)return Co("GRPC error has no .code"),Ne.UNKNOWN;switch(t){case Wr.OK:return Ne.OK;case Wr.CANCELLED:return Ne.CANCELLED;case Wr.UNKNOWN:return Ne.UNKNOWN;case Wr.DEADLINE_EXCEEDED:return Ne.DEADLINE_EXCEEDED;case Wr.RESOURCE_EXHAUSTED:return Ne.RESOURCE_EXHAUSTED;case Wr.INTERNAL:return Ne.INTERNAL;case Wr.UNAVAILABLE:return Ne.UNAVAILABLE;case Wr.UNAUTHENTICATED:return Ne.UNAUTHENTICATED;case Wr.INVALID_ARGUMENT:return Ne.INVALID_ARGUMENT;case Wr.NOT_FOUND:return Ne.NOT_FOUND;case Wr.ALREADY_EXISTS:return Ne.ALREADY_EXISTS;case Wr.PERMISSION_DENIED:return Ne.PERMISSION_DENIED;case Wr.FAILED_PRECONDITION:return Ne.FAILED_PRECONDITION;case Wr.ABORTED:return Ne.ABORTED;case Wr.OUT_OF_RANGE:return Ne.OUT_OF_RANGE;case Wr.UNIMPLEMENTED:return Ne.UNIMPLEMENTED;case Wr.DATA_LOSS:return Ne.DATA_LOSS;default:return sn()}}(Mn=Wr||(Wr={}))[Mn.OK=0]="OK",Mn[Mn.CANCELLED=1]="CANCELLED",Mn[Mn.UNKNOWN=2]="UNKNOWN",Mn[Mn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Mn[Mn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Mn[Mn.NOT_FOUND=5]="NOT_FOUND",Mn[Mn.ALREADY_EXISTS=6]="ALREADY_EXISTS",Mn[Mn.PERMISSION_DENIED=7]="PERMISSION_DENIED",Mn[Mn.UNAUTHENTICATED=16]="UNAUTHENTICATED",Mn[Mn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Mn[Mn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Mn[Mn.ABORTED=10]="ABORTED",Mn[Mn.OUT_OF_RANGE=11]="OUT_OF_RANGE",Mn[Mn.UNIMPLEMENTED=12]="UNIMPLEMENTED",Mn[Mn.INTERNAL=13]="INTERNAL",Mn[Mn.UNAVAILABLE=14]="UNAVAILABLE",Mn[Mn.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lV(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cV=new Rc([4294967295,4294967295],0);function AI(t){const e=lV().encode(t),n=new VR;return n.update(e),new Uint8Array(n.digest())}function TI(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Rc([n,r],0),new Rc([s,i],0)]}let uV=class v4{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Ih(`Invalid padding: ${n}`);if(r<0)throw new Ih(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Ih(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Ih(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=Rc.fromNumber(this.Ie)}Ee(e,n,r){let s=e.add(n.multiply(Rc.fromNumber(r)));return s.compare(cV)===1&&(s=new Rc([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=AI(e),[r,s]=TI(n);for(let i=0;i<this.hashCount;i++){const l=this.Ee(r,s,i);if(!this.de(l))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),l=new v4(i,s,n);return r.forEach(h=>l.insert(h)),l}insert(e){if(this.Ie===0)return;const n=AI(e),[r,s]=TI(n);for(let i=0;i<this.hashCount;i++){const l=this.Ee(r,s,i);this.Ae(l)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}},Ih=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let E4=class b4{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,Iv.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new b4(yn.min(),s,new Xr(zn),Ro(),Sn())}},Iv=class I4{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new I4(r,n,Sn(),Sn(),Sn())}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Op=class{constructor(e,n,r,s){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=s}},A4=class{constructor(e,n){this.targetId=e,this.me=n}},T4=class{constructor(e,n,r=hi.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}},CI=class{constructor(){this.fe=0,this.ge=NI(),this.pe=hi.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Sn(),n=Sn(),r=Sn();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:sn()}}),new Iv(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=NI()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Yn(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},dV=class{constructor(e){this.Le=e,this.Be=new Map,this.ke=Ro(),this.qe=SI(),this.Qe=new Xr(zn)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:sn()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,s)=>{this.ze(s)&&n(s)})}He(e){const n=e.targetId,r=e.me.count,s=this.Je(n);if(s){const i=s.target;if(iw(i))if(r===0){const l=new Yt(i.path);this.Ue(n,l,So.newNoDocument(l,yn.min()))}else Yn(r===1);else{const l=this.Ye(n);if(l!==r){const h=this.Ze(e),p=h?this.Xe(h,e,l):1;if(p!==0){this.je(n);const y=p===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,y)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let l,h;try{l=$c(r).toUint8Array()}catch(p){if(p instanceof XR)return gd("Decoding the base64 bloom filter in existence filter failed ("+p.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw p}try{h=new uV(l,s,i)}catch(p){return gd(p instanceof Ih?"BloomFilter error: ":"Applying bloom filter failed: ",p),null}return h.Ie===0?null:h}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const l=this.Le.tt(),h=`projects/${l.projectId}/databases/${l.database}/documents/${i.path.canonicalString()}`;e.mightContain(h)||(this.Ue(n,i,null),s++)}),s}rt(e){const n=new Map;this.Be.forEach((i,l)=>{const h=this.Je(l);if(h){if(i.current&&iw(h.target)){const p=new Yt(h.target.path);this.ke.get(p)!==null||this.it(l,p)||this.Ue(l,p,So.newNoDocument(p,e))}i.be&&(n.set(l,i.ve()),i.Ce())}});let r=Sn();this.qe.forEach((i,l)=>{let h=!0;l.forEachWhile(p=>{const y=this.Je(p);return!y||y.purpose==="TargetPurposeLimboResolution"||(h=!1,!1)}),h&&(r=r.add(i))}),this.ke.forEach((i,l)=>l.setReadTime(e));const s=new E4(e,n,this.Qe,this.ke,r);return this.ke=Ro(),this.qe=SI(),this.Qe=new Xr(zn),s}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,n)?s.Fe(n,1):s.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new CI,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new ui(zn),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||_t("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new CI),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}};function SI(){return new Xr(Yt.comparator)}function NI(){return new Xr(Yt.comparator)}const hV={asc:"ASCENDING",desc:"DESCENDING"},fV={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},mV={and:"AND",or:"OR"};let pV=class{constructor(e,n){this.databaseId=e,this.useProto3Json=n}};function lw(t,e){return t.useProto3Json||Bg(e)?e:{value:e}}function D0(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function C4(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function gV(t,e){return D0(t,e.toTimestamp())}function La(t){return Yn(!!t),yn.fromTimestamp(function(n){const r=Ol(n);return new $s(r.seconds,r.nanos)}(t))}function Av(t,e){return cw(t,e).canonicalString()}function cw(t,e){const n=function(s){return new Br(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function S4(t){const e=Br.fromString(t);return Yn(D4(e)),e}function uw(t,e){return Av(t.databaseId,e.path)}function hy(t,e){const n=S4(e);if(n.get(1)!==t.databaseId.projectId)throw new ut(Ne.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new ut(Ne.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Yt(R4(n))}function N4(t,e){return Av(t.databaseId,e)}function yV(t){const e=S4(t);return e.length===4?Br.emptyPath():R4(e)}function dw(t){return new Br(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function R4(t){return Yn(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function RI(t,e,n){return{name:uw(t,e),fields:n.value.mapValue.fields}}function xV(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(y){return y==="NO_CHANGE"?0:y==="ADD"?1:y==="REMOVE"?2:y==="CURRENT"?3:y==="RESET"?4:sn()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(y,_){return y.useProto3Json?(Yn(_===void 0||typeof _=="string"),hi.fromBase64String(_||"")):(Yn(_===void 0||_ instanceof Buffer||_ instanceof Uint8Array),hi.fromUint8Array(_||new Uint8Array))}(t,e.targetChange.resumeToken),l=e.targetChange.cause,h=l&&function(y){const _=y.code===void 0?Ne.UNKNOWN:_4(y.code);return new ut(_,y.message||"")}(l);n=new T4(r,s,i,h||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=hy(t,r.document.name),i=La(r.document.updateTime),l=r.document.createTime?La(r.document.createTime):yn.min(),h=new sa({mapValue:{fields:r.document.fields}}),p=So.newFoundDocument(s,i,l,h),y=r.targetIds||[],_=r.removedTargetIds||[];n=new Op(y,_,p.key,p)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=hy(t,r.document),i=r.readTime?La(r.readTime):yn.min(),l=So.newNoDocument(s,i),h=r.removedTargetIds||[];n=new Op([],h,l.key,l)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=hy(t,r.document),i=r.removedTargetIds||[];n=new Op([],i,s,null)}else{if(!("filter"in e))return sn();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,l=new aV(s,i),h=r.targetId;n=new A4(h,l)}}return n}function wV(t,e){let n;if(e instanceof lm)n={update:RI(t,e.key,e.value)};else if(e instanceof bv)n={delete:uw(t,e.key)};else if(e instanceof Hl)n={update:RI(t,e.key,e.data),updateMask:SV(e.fieldMask)};else{if(!(e instanceof nV))return sn();n={verify:uw(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,l){const h=l.transform;if(h instanceof Rf)return{fieldPath:l.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(h instanceof Pf)return{fieldPath:l.field.canonicalString(),appendMissingElements:{values:h.elements}};if(h instanceof kf)return{fieldPath:l.field.canonicalString(),removeAllFromArray:{values:h.elements}};if(h instanceof k0)return{fieldPath:l.field.canonicalString(),increment:h.Pe};throw sn()}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:gV(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:sn()}(t,e.precondition)),n}function _V(t,e){return t&&t.length>0?(Yn(e!==void 0),t.map(n=>function(s,i){let l=s.updateTime?La(s.updateTime):La(i);return l.isEqual(yn.min())&&(l=La(i)),new JF(l,s.transformResults||[])}(n,e))):[]}function vV(t,e){return{documents:[N4(t,e.path)]}}function EV(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=N4(t,s);const i=function(y){if(y.length!==0)return k4(No.create(y,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const l=function(y){if(y.length!==0)return y.map(_=>function(T){return{field:Eu(T.field),direction:AV(T.dir)}}(_))}(e.orderBy);l&&(n.structuredQuery.orderBy=l);const h=lw(t,e.limit);return h!==null&&(n.structuredQuery.limit=h),e.startAt&&(n.structuredQuery.startAt=function(y){return{before:y.inclusive,values:y.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(y){return{before:!y.inclusive,values:y.position}}(e.endAt)),{_t:n,parent:s}}function bV(t){let e=yV(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){Yn(r===1);const _=n.from[0];_.allDescendants?s=_.collectionId:e=e.child(_.collectionId)}let i=[];n.where&&(i=function(E){const T=P4(E);return T instanceof No&&n4(T)?T.getFilters():[T]}(n.where));let l=[];n.orderBy&&(l=function(E){return E.map(T=>function(L){return new Nf(bu(L.field),function(H){switch(H){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(L.direction))}(T))}(n.orderBy));let h=null;n.limit&&(h=function(E){let T;return T=typeof E=="object"?E.value:E,Bg(T)?null:T}(n.limit));let p=null;n.startAt&&(p=function(E){const T=!!E.before,k=E.values||[];return new P0(k,T)}(n.startAt));let y=null;return n.endAt&&(y=function(E){const T=!E.before,k=E.values||[];return new P0(k,T)}(n.endAt)),VF(e,s,l,i,h,"F",p,y)}function IV(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return sn()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function P4(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=bu(n.unaryFilter.field);return as.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=bu(n.unaryFilter.field);return as.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=bu(n.unaryFilter.field);return as.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const l=bu(n.unaryFilter.field);return as.create(l,"!=",{nullValue:"NULL_VALUE"});default:return sn()}}(t):t.fieldFilter!==void 0?function(n){return as.create(bu(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return sn()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return No.create(n.compositeFilter.filters.map(r=>P4(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return sn()}}(n.compositeFilter.op))}(t):sn()}function AV(t){return hV[t]}function TV(t){return fV[t]}function CV(t){return mV[t]}function Eu(t){return{fieldPath:t.canonicalString()}}function bu(t){return la.fromServerFormat(t.fieldPath)}function k4(t){return t instanceof as?function(n){if(n.op==="=="){if(gI(n.value))return{unaryFilter:{field:Eu(n.field),op:"IS_NAN"}};if(pI(n.value))return{unaryFilter:{field:Eu(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(gI(n.value))return{unaryFilter:{field:Eu(n.field),op:"IS_NOT_NAN"}};if(pI(n.value))return{unaryFilter:{field:Eu(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Eu(n.field),op:TV(n.op),value:n.value}}}(t):t instanceof No?function(n){const r=n.getFilters().map(s=>k4(s));return r.length===1?r[0]:{compositeFilter:{op:CV(n.op),filters:r}}}(t):sn()}function SV(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function D4(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Tv=class Ah{constructor(e,n,r,s,i=yn.min(),l=yn.min(),h=hi.EMPTY_BYTE_STRING,p=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=h,this.expectedCount=p}withSequenceNumber(e){return new Ah(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Ah(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ah(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ah(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let NV=class{constructor(e){this.ct=e}};function RV(t){const e=bV({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?ow(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let PV=class{constructor(){this.un=new kV}addToCollectionParentIndex(e,n){return this.un.add(n),Xe.resolve()}getCollectionParents(e,n){return Xe.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return Xe.resolve()}deleteFieldIndex(e,n){return Xe.resolve()}deleteAllFieldIndexes(e){return Xe.resolve()}createTargetIndexes(e,n){return Xe.resolve()}getDocumentsMatchingTarget(e,n){return Xe.resolve(null)}getIndexType(e,n){return Xe.resolve(0)}getFieldIndexes(e,n){return Xe.resolve([])}getNextCollectionGroupToUpdate(e){return Xe.resolve(null)}getMinOffset(e,n){return Xe.resolve(Tf.min())}getMinOffsetFromCollectionGroup(e,n){return Xe.resolve(Tf.min())}updateCollectionGroup(e,n,r){return Xe.resolve()}updateIndexEntries(e,n){return Xe.resolve()}},kV=class{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new ui(Br.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new ui(Br.comparator)).toArray()}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let hw=class fw{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new fw(0)}static kn(){return new fw(-1)}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let DV=class{constructor(){this.changes=new jd(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,So.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?Xe.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let OV=class{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let MV=class{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&Wh(r.mutation,s,Ta.empty(),$s.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Sn()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Sn()){const s=yc();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let l=bh();return i.forEach((h,p)=>{l=l.insert(h,p.overlayedDocument)}),l}))}getOverlayedDocuments(e,n){const r=yc();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Sn()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((l,h)=>{n.set(l,h)})})}computeViews(e,n,r,s){let i=Ro();const l=zh(),h=function(){return zh()}();return n.forEach((p,y)=>{const _=r.get(y.key);s.has(y.key)&&(_===void 0||_.mutation instanceof Hl)?i=i.insert(y.key,y):_!==void 0?(l.set(y.key,_.mutation.getFieldMask()),Wh(_.mutation,y,_.mutation.getFieldMask(),$s.now())):l.set(y.key,Ta.empty())}),this.recalculateAndSaveOverlays(e,i).next(p=>(p.forEach((y,_)=>l.set(y,_)),n.forEach((y,_)=>{var E;return h.set(y,new OV(_,(E=l.get(y))!==null&&E!==void 0?E:null))}),h))}recalculateAndSaveOverlays(e,n){const r=zh();let s=new Xr((l,h)=>l-h),i=Sn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(l=>{for(const h of l)h.keys().forEach(p=>{const y=n.get(p);if(y===null)return;let _=r.get(p)||Ta.empty();_=h.applyToLocalView(y,_),r.set(p,_);const E=(s.get(h.batchId)||Sn()).add(p);s=s.insert(h.batchId,E)})}).next(()=>{const l=[],h=s.getReverseIterator();for(;h.hasNext();){const p=h.getNext(),y=p.key,_=p.value,E=d4();_.forEach(T=>{if(!i.has(T)){const k=y4(n.get(T),r.get(T));k!==null&&E.set(T,k),i=i.add(T)}}),l.push(this.documentOverlayCache.saveOverlays(e,y,E))}return Xe.waitFor(l)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(l){return Yt.isDocumentKey(l.path)&&l.collectionGroup===null&&l.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):a4(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const l=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):Xe.resolve(yc());let h=-1,p=i;return l.next(y=>Xe.forEach(y,(_,E)=>(h<E.largestBatchId&&(h=E.largestBatchId),i.get(_)?Xe.resolve():this.remoteDocumentCache.getEntry(e,_).next(T=>{p=p.insert(_,T)}))).next(()=>this.populateOverlays(e,y,i)).next(()=>this.computeViews(e,p,y,Sn())).next(_=>({batchId:h,changes:u4(_)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new Yt(n)).next(r=>{let s=bh();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let l=bh();return this.indexManager.getCollectionParents(e,i).next(h=>Xe.forEach(h,p=>{const y=function(E,T){return new Ld(T,null,E.explicitOrderBy.slice(),E.filters.slice(),E.limit,E.limitType,E.startAt,E.endAt)}(n,p.child(i));return this.getDocumentsMatchingCollectionQuery(e,y,r,s).next(_=>{_.forEach((E,T)=>{l=l.insert(E,T)})})}).next(()=>l))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(l=>(i=l,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(l=>{i.forEach((p,y)=>{const _=y.getKey();l.get(_)===null&&(l=l.insert(_,So.newInvalidDocument(_)))});let h=bh();return l.forEach((p,y)=>{const _=i.get(p);_!==void 0&&Wh(_.mutation,y,Ta.empty(),$s.now()),$g(n,y)&&(h=h.insert(p,y))}),h})}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let LV=class{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return Xe.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:La(s.createTime)}}(n)),Xe.resolve()}getNamedQuery(e,n){return Xe.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(s){return{name:s.name,query:RV(s.bundledQuery),readTime:La(s.readTime)}}(n)),Xe.resolve()}};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let jV=class{constructor(){this.overlays=new Xr(Yt.comparator),this.Ir=new Map}getOverlay(e,n){return Xe.resolve(this.overlays.get(n))}getOverlays(e,n){const r=yc();return Xe.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.ht(e,n,i)}),Xe.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Ir.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(r)),Xe.resolve()}getOverlaysForCollection(e,n,r){const s=yc(),i=n.length+1,l=new Yt(n.child("")),h=this.overlays.getIteratorFrom(l);for(;h.hasNext();){const p=h.getNext().value,y=p.getKey();if(!n.isPrefixOf(y.path))break;y.path.length===i&&p.largestBatchId>r&&s.set(p.getKey(),p)}return Xe.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new Xr((y,_)=>y-_);const l=this.overlays.getIterator();for(;l.hasNext();){const y=l.getNext().value;if(y.getKey().getCollectionGroup()===n&&y.largestBatchId>r){let _=i.get(y.largestBatchId);_===null&&(_=yc(),i=i.insert(y.largestBatchId,_)),_.set(y.getKey(),y)}}const h=yc(),p=i.getIterator();for(;p.hasNext()&&(p.getNext().value.forEach((y,_)=>h.set(y,_)),!(h.size()>=s)););return Xe.resolve(h)}ht(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const l=this.Ir.get(s.largestBatchId).delete(r.key);this.Ir.set(s.largestBatchId,l)}this.overlays=this.overlays.insert(r.key,new iV(n,r));let i=this.Ir.get(n);i===void 0&&(i=Sn(),this.Ir.set(n,i)),this.Ir.set(n,i.add(r.key))}};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let FV=class{constructor(){this.sessionToken=hi.EMPTY_BYTE_STRING}getSessionToken(e){return Xe.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,Xe.resolve()}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Cv=class{constructor(){this.Tr=new ui(rs.Er),this.dr=new ui(rs.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new rs(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new rs(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new Yt(new Br([])),r=new rs(n,e),s=new rs(n,e+1),i=[];return this.dr.forEachInRange([r,s],l=>{this.Vr(l),i.push(l.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new Yt(new Br([])),r=new rs(n,e),s=new rs(n,e+1);let i=Sn();return this.dr.forEachInRange([r,s],l=>{i=i.add(l.key)}),i}containsKey(e){const n=new rs(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}},rs=class{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return Yt.comparator(e.key,n.key)||zn(e.wr,n.wr)}static Ar(e,n){return zn(e.wr,n.wr)||Yt.comparator(e.key,n.key)}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let VV=class{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new ui(rs.Er)}checkEmpty(e){return Xe.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const l=new rV(i,n,r,s);this.mutationQueue.push(l);for(const h of s)this.br=this.br.add(new rs(h.key,i)),this.indexManager.addToCollectionParentIndex(e,h.key.path.popLast());return Xe.resolve(l)}lookupMutationBatch(e,n){return Xe.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.vr(r),i=s<0?0:s;return Xe.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return Xe.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return Xe.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new rs(n,0),s=new rs(n,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([r,s],l=>{const h=this.Dr(l.wr);i.push(h)}),Xe.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new ui(zn);return n.forEach(s=>{const i=new rs(s,0),l=new rs(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,l],h=>{r=r.add(h.wr)})}),Xe.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;Yt.isDocumentKey(i)||(i=i.child(""));const l=new rs(new Yt(i),0);let h=new ui(zn);return this.br.forEachWhile(p=>{const y=p.key.path;return!!r.isPrefixOf(y)&&(y.length===s&&(h=h.add(p.wr)),!0)},l),Xe.resolve(this.Cr(h))}Cr(e){const n=[];return e.forEach(r=>{const s=this.Dr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){Yn(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return Xe.forEach(n.mutations,s=>{const i=new rs(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new rs(n,0),s=this.br.firstAfterOrEqual(r);return Xe.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,Xe.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let BV=class{constructor(e){this.Mr=e,this.docs=function(){return new Xr(Yt.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,l=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:l}),this.size+=l-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return Xe.resolve(r?r.document.mutableCopy():So.newInvalidDocument(n))}getEntries(e,n){let r=Ro();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():So.newInvalidDocument(s))}),Xe.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=Ro();const l=n.path,h=new Yt(l.child("")),p=this.docs.getIteratorFrom(h);for(;p.hasNext();){const{key:y,value:{document:_}}=p.getNext();if(!l.isPrefixOf(y.path))break;y.path.length>l.length+1||_F(wF(_),r)<=0||(s.has(_.key)||$g(n,_))&&(i=i.insert(_.key,_.mutableCopy()))}return Xe.resolve(i)}getAllFromCollectionGroup(e,n,r,s){sn()}Or(e,n){return Xe.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new UV(this)}getSize(e){return Xe.resolve(this.size)}},UV=class extends DV{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.cr.addEntry(e,s)):this.cr.removeEntry(r)}),Xe.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let $V=class{constructor(e){this.persistence=e,this.Nr=new jd(n=>wv(n),_v),this.lastRemoteSnapshotVersion=yn.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Cv,this.targetCount=0,this.kr=hw.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,s)=>n(s)),Xe.resolve()}getLastRemoteSnapshotVersion(e){return Xe.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Xe.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),Xe.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),Xe.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new hw(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,Xe.resolve()}updateTargetData(e,n){return this.Kn(n),Xe.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,Xe.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.Nr.forEach((l,h)=>{h.sequenceNumber<=n&&r.get(h.targetId)===null&&(this.Nr.delete(l),i.push(this.removeMatchingKeysForTargetId(e,h.targetId)),s++)}),Xe.waitFor(i).next(()=>s)}getTargetCount(e){return Xe.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return Xe.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),Xe.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(l=>{i.push(s.markPotentiallyOrphaned(e,l))}),Xe.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),Xe.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return Xe.resolve(r)}containsKey(e,n){return Xe.resolve(this.Br.containsKey(n))}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let zV=class{constructor(e,n){this.qr={},this.overlays={},this.Qr=new pv(0),this.Kr=!1,this.Kr=!0,this.$r=new FV,this.referenceDelegate=e(this),this.Ur=new $V(this),this.indexManager=new PV,this.remoteDocumentCache=function(s){return new BV(s)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new NV(n),this.Gr=new LV(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new jV,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new VV(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){_t("MemoryPersistence","Starting transaction:",e);const s=new WV(this.Qr.next());return this.referenceDelegate.zr(),r(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,n){return Xe.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}},WV=class extends EF{constructor(e){super(),this.currentSequenceNumber=e}},HV=class O4{constructor(e){this.persistence=e,this.Jr=new Cv,this.Yr=null}static Zr(e){return new O4(e)}get Xr(){if(this.Yr)return this.Yr;throw sn()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),Xe.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),Xe.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),Xe.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(s=>this.Xr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Xe.forEach(this.Xr,r=>{const s=Yt.fromPath(r);return this.ei(e,s).next(i=>{i||n.removeEntry(s,yn.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return Xe.or([()=>Xe.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let GV=class M4{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=s}static Wi(e,n){let r=Sn(),s=Sn();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new M4(e,n.fromCache,r,s)}};/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let qV=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let KV=class{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return C8()?8:bF(Os())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.Yi(e,n).next(l=>{i.result=l}).next(()=>{if(!i.result)return this.Zi(e,n,s,r).next(l=>{i.result=l})}).next(()=>{if(i.result)return;const l=new qV;return this.Xi(e,n,l).next(h=>{if(i.result=h,this.zi)return this.es(e,n,l,h.size)})}).next(()=>i.result)}es(e,n,r,s){return r.documentReadCount<this.ji?(lh()<=kn.DEBUG&&_t("QueryEngine","SDK will not create cache indexes for query:",vu(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),Xe.resolve()):(lh()<=kn.DEBUG&&_t("QueryEngine","Query:",vu(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Hi*s?(lh()<=kn.DEBUG&&_t("QueryEngine","The SDK decides to create cache indexes for query:",vu(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Ma(n))):Xe.resolve())}Yi(e,n){if(_I(n))return Xe.resolve(null);let r=Ma(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=ow(n,null,"F"),r=Ma(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const l=Sn(...i);return this.Ji.getDocuments(e,l).next(h=>this.indexManager.getMinOffset(e,r).next(p=>{const y=this.ts(n,h);return this.ns(n,y,l,p.readTime)?this.Yi(e,ow(n,null,"F")):this.rs(e,y,n,p)}))})))}Zi(e,n,r,s){return _I(n)||s.isEqual(yn.min())?Xe.resolve(null):this.Ji.getDocuments(e,r).next(i=>{const l=this.ts(n,i);return this.ns(n,l,r,s)?Xe.resolve(null):(lh()<=kn.DEBUG&&_t("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),vu(n)),this.rs(e,l,n,xF(s,-1)).next(h=>h))})}ts(e,n){let r=new ui(l4(e));return n.forEach((s,i)=>{$g(e,i)&&(r=r.add(i))}),r}ns(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,n,r){return lh()<=kn.DEBUG&&_t("QueryEngine","Using full collection scan to execute query:",vu(n)),this.Ji.getDocumentsMatchingQuery(e,n,Tf.min(),r)}rs(e,n,r,s){return this.Ji.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(l=>{i=i.insert(l.key,l)}),i))}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let XV=class{constructor(e,n,r,s){this.persistence=e,this.ss=n,this.serializer=s,this.os=new Xr(zn),this._s=new jd(i=>wv(i),_v),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new MV(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}};function QV(t,e,n,r){return new XV(t,e,n,r)}async function L4(t,e){const n=ln(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const l=[],h=[];let p=Sn();for(const y of s){l.push(y.batchId);for(const _ of y.mutations)p=p.add(_.key)}for(const y of i){h.push(y.batchId);for(const _ of y.mutations)p=p.add(_.key)}return n.localDocuments.getDocuments(r,p).next(y=>({hs:y,removedBatchIds:l,addedBatchIds:h}))})})}function YV(t,e){const n=ln(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.cs.newChangeBuffer({trackRemovals:!0});return function(h,p,y,_){const E=y.batch,T=E.keys();let k=Xe.resolve();return T.forEach(L=>{k=k.next(()=>_.getEntry(p,L)).next(B=>{const H=y.docVersions.get(L);Yn(H!==null),B.version.compareTo(H)<0&&(E.applyToRemoteDocument(B,y),B.isValidDocument()&&(B.setReadTime(y.commitVersion),_.addEntry(B)))})}),k.next(()=>h.mutationQueue.removeMutationBatch(p,E))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(h){let p=Sn();for(let y=0;y<h.mutationResults.length;++y)h.mutationResults[y].transformResults.length>0&&(p=p.add(h.batch.mutations[y].key));return p}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function j4(t){const e=ln(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function ZV(t,e){const n=ln(t),r=e.snapshotVersion;let s=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const l=n.cs.newChangeBuffer({trackRemovals:!0});s=n.os;const h=[];e.targetChanges.forEach((_,E)=>{const T=s.get(E);if(!T)return;h.push(n.Ur.removeMatchingKeys(i,_.removedDocuments,E).next(()=>n.Ur.addMatchingKeys(i,_.addedDocuments,E)));let k=T.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(E)!==null?k=k.withResumeToken(hi.EMPTY_BYTE_STRING,yn.min()).withLastLimboFreeSnapshotVersion(yn.min()):_.resumeToken.approximateByteSize()>0&&(k=k.withResumeToken(_.resumeToken,r)),s=s.insert(E,k),function(B,H,W){return B.resumeToken.approximateByteSize()===0||H.snapshotVersion.toMicroseconds()-B.snapshotVersion.toMicroseconds()>=3e8?!0:W.addedDocuments.size+W.modifiedDocuments.size+W.removedDocuments.size>0}(T,k,_)&&h.push(n.Ur.updateTargetData(i,k))});let p=Ro(),y=Sn();if(e.documentUpdates.forEach(_=>{e.resolvedLimboDocuments.has(_)&&h.push(n.persistence.referenceDelegate.updateLimboDocument(i,_))}),h.push(JV(i,l,e.documentUpdates).next(_=>{p=_.Ps,y=_.Is})),!r.isEqual(yn.min())){const _=n.Ur.getLastRemoteSnapshotVersion(i).next(E=>n.Ur.setTargetsMetadata(i,i.currentSequenceNumber,r));h.push(_)}return Xe.waitFor(h).next(()=>l.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,p,y)).next(()=>p)}).then(i=>(n.os=s,i))}function JV(t,e,n){let r=Sn(),s=Sn();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let l=Ro();return n.forEach((h,p)=>{const y=i.get(h);p.isFoundDocument()!==y.isFoundDocument()&&(s=s.add(h)),p.isNoDocument()&&p.version.isEqual(yn.min())?(e.removeEntry(h,p.readTime),l=l.insert(h,p)):!y.isValidDocument()||p.version.compareTo(y.version)>0||p.version.compareTo(y.version)===0&&y.hasPendingWrites?(e.addEntry(p),l=l.insert(h,p)):_t("LocalStore","Ignoring outdated watch update for ",h,". Current version:",y.version," Watch version:",p.version)}),{Ps:l,Is:s}})}function e7(t,e){const n=ln(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function t7(t,e){const n=ln(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Ur.getTargetData(r,e).next(i=>i?(s=i,Xe.resolve(s)):n.Ur.allocateTargetId(r).next(l=>(s=new Tv(e,l,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.os.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function mw(t,e,n){const r=ln(t),s=r.os.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,l=>r.persistence.referenceDelegate.removeTarget(l,s))}catch(l){if(!om(l))throw l;_t("LocalStore",`Failed to update sequence numbers for target ${e}: ${l}`)}r.os=r.os.remove(e),r._s.delete(s.target)}function PI(t,e,n){const r=ln(t);let s=yn.min(),i=Sn();return r.persistence.runTransaction("Execute query","readwrite",l=>function(p,y,_){const E=ln(p),T=E._s.get(_);return T!==void 0?Xe.resolve(E.os.get(T)):E.Ur.getTargetData(y,_)}(r,l,Ma(e)).next(h=>{if(h)return s=h.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(l,h.targetId).next(p=>{i=p})}).next(()=>r.ss.getDocumentsMatchingQuery(l,e,n?s:yn.min(),n?i:Sn())).next(h=>(n7(r,UF(e),h),{documents:h,Ts:i})))}function n7(t,e,n){let r=t.us.get(e)||yn.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.us.set(e,r)}let kI=class{constructor(){this.activeTargetIds=qF()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}},r7=class{constructor(){this.so=new kI,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new kI,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let s7=class{_o(e){}shutdown(){}};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let DI=class{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){_t("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){_t("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Jm=null;function fy(){return Jm===null?Jm=function(){return 268435456+Math.round(2147483648*Math.random())}():Jm++,"0x"+Jm.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const i7={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let a7=class{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cs="WebChannelConnection";let o7=class extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(n,r,s,i,l){const h=fy(),p=this.xo(n,r.toUriEncodedString());_t("RestConnection",`Sending RPC '${n}' ${h}:`,p,s);const y={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(y,i,l),this.No(n,p,y,s).then(_=>(_t("RestConnection",`Received RPC '${n}' ${h}: `,_),_),_=>{throw gd("RestConnection",`RPC '${n}' ${h} failed with error: `,_,"url: ",p,"request:",s),_})}Lo(n,r,s,i,l,h){return this.Mo(n,r,s,i,l)}Oo(n,r,s){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Md}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,l)=>n[l]=i),s&&s.headers.forEach((i,l)=>n[l]=i)}xo(n,r){const s=i7[n];return`${this.Do}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,s){const i=fy();return new Promise((l,h)=>{const p=new BR;p.setWithCredentials(!0),p.listenOnce(UR.COMPLETE,()=>{try{switch(p.getLastErrorCode()){case Cp.NO_ERROR:const _=p.getResponseJson();_t(Cs,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(_)),l(_);break;case Cp.TIMEOUT:_t(Cs,`RPC '${e}' ${i} timed out`),h(new ut(Ne.DEADLINE_EXCEEDED,"Request time out"));break;case Cp.HTTP_ERROR:const E=p.getStatus();if(_t(Cs,`RPC '${e}' ${i} failed with status:`,E,"response text:",p.getResponseText()),E>0){let T=p.getResponseJson();Array.isArray(T)&&(T=T[0]);const k=T==null?void 0:T.error;if(k&&k.status&&k.message){const L=function(H){const W=H.toLowerCase().replace(/_/g,"-");return Object.values(Ne).indexOf(W)>=0?W:Ne.UNKNOWN}(k.status);h(new ut(L,k.message))}else h(new ut(Ne.UNKNOWN,"Server responded with status "+p.getStatus()))}else h(new ut(Ne.UNAVAILABLE,"Connection failed."));break;default:sn()}}finally{_t(Cs,`RPC '${e}' ${i} completed.`)}});const y=JSON.stringify(s);_t(Cs,`RPC '${e}' ${i} sending request:`,s),p.send(n,"POST",y,r,15)})}Bo(e,n,r){const s=fy(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],l=WR(),h=zR(),p={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},y=this.longPollingOptions.timeoutSeconds;y!==void 0&&(p.longPollingTimeout=Math.round(1e3*y)),this.useFetchStreams&&(p.useFetchStreams=!0),this.Oo(p.initMessageHeaders,n,r),p.encodeInitMessageHeaders=!0;const _=i.join("");_t(Cs,`Creating RPC '${e}' stream ${s}: ${_}`,p);const E=l.createWebChannel(_,p);let T=!1,k=!1;const L=new a7({Io:H=>{k?_t(Cs,`Not sending because RPC '${e}' stream ${s} is closed:`,H):(T||(_t(Cs,`Opening RPC '${e}' stream ${s} transport.`),E.open(),T=!0),_t(Cs,`RPC '${e}' stream ${s} sending:`,H),E.send(H))},To:()=>E.close()}),B=(H,W,M)=>{H.listen(W,U=>{try{M(U)}catch($){setTimeout(()=>{throw $},0)}})};return B(E,vh.EventType.OPEN,()=>{k||(_t(Cs,`RPC '${e}' stream ${s} transport opened.`),L.yo())}),B(E,vh.EventType.CLOSE,()=>{k||(k=!0,_t(Cs,`RPC '${e}' stream ${s} transport closed`),L.So())}),B(E,vh.EventType.ERROR,H=>{k||(k=!0,gd(Cs,`RPC '${e}' stream ${s} transport errored:`,H),L.So(new ut(Ne.UNAVAILABLE,"The operation could not be completed")))}),B(E,vh.EventType.MESSAGE,H=>{var W;if(!k){const M=H.data[0];Yn(!!M);const U=M,$=U.error||((W=U[0])===null||W===void 0?void 0:W.error);if($){_t(Cs,`RPC '${e}' stream ${s} received error:`,$);const K=$.status;let Z=function(N){const D=Wr[N];if(D!==void 0)return _4(D)}(K),A=$.message;Z===void 0&&(Z=Ne.INTERNAL,A="Unknown error status: "+K+" with message "+$.message),k=!0,L.So(new ut(Z,A)),E.close()}else _t(Cs,`RPC '${e}' stream ${s} received:`,M),L.bo(M)}}),B(h,$R.STAT_EVENT,H=>{H.stat===qx.PROXY?_t(Cs,`RPC '${e}' stream ${s} detected buffering proxy`):H.stat===qx.NOPROXY&&_t(Cs,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{L.wo()},0),L}};function my(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hg(t){return new pV(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let F4=class{constructor(e,n,r=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),s=Math.max(0,n-r);s>0&&_t("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let V4=class{constructor(e,n,r,s,i,l,h,p){this.ui=e,this.Ho=r,this.Jo=s,this.connection=i,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=h,this.listener=p,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new F4(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===Ne.RESOURCE_EXHAUSTED?(Co(n.toString()),Co("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===Ne.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Yo===n&&this.P_(r,s)},r=>{e(()=>{const s=new ut(Ne.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(s)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{r(()=>this.I_(s))}),this.stream.onMessage(s=>{r(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return _t("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(_t("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},l7=class extends V4{constructor(e,n,r,s,i,l){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,l),this.serializer=i}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=xV(this.serializer,e),r=function(i){if(!("targetChange"in i))return yn.min();const l=i.targetChange;return l.targetIds&&l.targetIds.length?yn.min():l.readTime?La(l.readTime):yn.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=dw(this.serializer),n.addTarget=function(i,l){let h;const p=l.target;if(h=iw(p)?{documents:vV(i,p)}:{query:EV(i,p)._t},h.targetId=l.targetId,l.resumeToken.approximateByteSize()>0){h.resumeToken=C4(i,l.resumeToken);const y=lw(i,l.expectedCount);y!==null&&(h.expectedCount=y)}else if(l.snapshotVersion.compareTo(yn.min())>0){h.readTime=D0(i,l.snapshotVersion.toTimestamp());const y=lw(i,l.expectedCount);y!==null&&(h.expectedCount=y)}return h}(this.serializer,e);const r=IV(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=dw(this.serializer),n.removeTarget=e,this.a_(n)}},c7=class extends V4{constructor(e,n,r,s,i,l){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,l),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return Yn(!!e.streamToken),this.lastStreamToken=e.streamToken,Yn(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Yn(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=_V(e.writeResults,e.commitTime),r=La(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=dw(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>wV(this.serializer,r))};this.a_(n)}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let u7=class extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new ut(Ne.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,l])=>this.connection.Mo(e,cw(n,r),s,i,l)).catch(i=>{throw i.name==="FirebaseError"?(i.code===Ne.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new ut(Ne.UNKNOWN,i.toString())})}Lo(e,n,r,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([l,h])=>this.connection.Lo(e,cw(n,r),s,l,h,i)).catch(l=>{throw l.name==="FirebaseError"?(l.code===Ne.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new ut(Ne.UNKNOWN,l.toString())})}terminate(){this.y_=!0,this.connection.terminate()}},d7=class{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Co(n),this.D_=!1):_t("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let h7=class{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(l=>{r.enqueueAndForget(async()=>{su(this)&&(_t("RemoteStore","Restarting streams for network reachability change."),await async function(p){const y=ln(p);y.L_.add(4),await cm(y),y.q_.set("Unknown"),y.L_.delete(4),await Gg(y)}(this))})}),this.q_=new d7(r,s)}};async function Gg(t){if(su(t))for(const e of t.B_)await e(!0)}async function cm(t){for(const e of t.B_)await e(!1)}function B4(t,e){const n=ln(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),Pv(n)?Rv(n):Fd(n).r_()&&Nv(n,e))}function Sv(t,e){const n=ln(t),r=Fd(n);n.N_.delete(e),r.r_()&&U4(n,e),n.N_.size===0&&(r.r_()?r.o_():su(n)&&n.q_.set("Unknown"))}function Nv(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(yn.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Fd(t).A_(e)}function U4(t,e){t.Q_.xe(e),Fd(t).R_(e)}function Rv(t){t.Q_=new dV({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),Fd(t).start(),t.q_.v_()}function Pv(t){return su(t)&&!Fd(t).n_()&&t.N_.size>0}function su(t){return ln(t).L_.size===0}function $4(t){t.Q_=void 0}async function f7(t){t.q_.set("Online")}async function m7(t){t.N_.forEach((e,n)=>{Nv(t,e)})}async function p7(t,e){$4(t),Pv(t)?(t.q_.M_(e),Rv(t)):t.q_.set("Unknown")}async function g7(t,e,n){if(t.q_.set("Online"),e instanceof T4&&e.state===2&&e.cause)try{await async function(s,i){const l=i.cause;for(const h of i.targetIds)s.N_.has(h)&&(await s.remoteSyncer.rejectListen(h,l),s.N_.delete(h),s.Q_.removeTarget(h))}(t,e)}catch(r){_t("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await O0(t,r)}else if(e instanceof Op?t.Q_.Ke(e):e instanceof A4?t.Q_.He(e):t.Q_.We(e),!n.isEqual(yn.min()))try{const r=await j4(t.localStore);n.compareTo(r)>=0&&await function(i,l){const h=i.Q_.rt(l);return h.targetChanges.forEach((p,y)=>{if(p.resumeToken.approximateByteSize()>0){const _=i.N_.get(y);_&&i.N_.set(y,_.withResumeToken(p.resumeToken,l))}}),h.targetMismatches.forEach((p,y)=>{const _=i.N_.get(p);if(!_)return;i.N_.set(p,_.withResumeToken(hi.EMPTY_BYTE_STRING,_.snapshotVersion)),U4(i,p);const E=new Tv(_.target,p,y,_.sequenceNumber);Nv(i,E)}),i.remoteSyncer.applyRemoteEvent(h)}(t,n)}catch(r){_t("RemoteStore","Failed to raise snapshot:",r),await O0(t,r)}}async function O0(t,e,n){if(!om(e))throw e;t.L_.add(1),await cm(t),t.q_.set("Offline"),n||(n=()=>j4(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{_t("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await Gg(t)})}function z4(t,e){return e().catch(n=>O0(t,n,e))}async function qg(t){const e=ln(t),n=Ml(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;y7(e);)try{const s=await e7(e.localStore,r);if(s===null){e.O_.length===0&&n.o_();break}r=s.batchId,x7(e,s)}catch(s){await O0(e,s)}W4(e)&&H4(e)}function y7(t){return su(t)&&t.O_.length<10}function x7(t,e){t.O_.push(e);const n=Ml(t);n.r_()&&n.V_&&n.m_(e.mutations)}function W4(t){return su(t)&&!Ml(t).n_()&&t.O_.length>0}function H4(t){Ml(t).start()}async function w7(t){Ml(t).p_()}async function _7(t){const e=Ml(t);for(const n of t.O_)e.m_(n.mutations)}async function v7(t,e,n){const r=t.O_.shift(),s=sV.from(r,e,n);await z4(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await qg(t)}async function E7(t,e){e&&Ml(t).V_&&await async function(r,s){if(function(l){return oV(l)&&l!==Ne.ABORTED}(s.code)){const i=r.O_.shift();Ml(r).s_(),await z4(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await qg(r)}}(t,e),W4(t)&&H4(t)}async function OI(t,e){const n=ln(t);n.asyncQueue.verifyOperationInProgress(),_t("RemoteStore","RemoteStore received new credentials");const r=su(n);n.L_.add(3),await cm(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await Gg(n)}async function b7(t,e){const n=ln(t);e?(n.L_.delete(2),await Gg(n)):e||(n.L_.add(2),await cm(n),n.q_.set("Unknown"))}function Fd(t){return t.K_||(t.K_=function(n,r,s){const i=ln(n);return i.w_(),new l7(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:f7.bind(null,t),Ro:m7.bind(null,t),mo:p7.bind(null,t),d_:g7.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),Pv(t)?Rv(t):t.q_.set("Unknown")):(await t.K_.stop(),$4(t))})),t.K_}function Ml(t){return t.U_||(t.U_=function(n,r,s){const i=ln(n);return i.w_(),new c7(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:w7.bind(null,t),mo:E7.bind(null,t),f_:_7.bind(null,t),g_:v7.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await qg(t)):(await t.U_.stop(),t.O_.length>0&&(_t("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let I7=class G4{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new xo,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(l=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const l=Date.now()+r,h=new G4(e,n,l,s,i);return h.start(r),h}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ut(Ne.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function kv(t,e){if(Co("AsyncQueue",`${e}: ${t}`),om(t))return new ut(Ne.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let q4=class Mp{constructor(e){this.comparator=e?(n,r)=>e(n,r)||Yt.comparator(n.key,r.key):(n,r)=>Yt.comparator(n.key,r.key),this.keyedMap=bh(),this.sortedSet=new Xr(this.comparator)}static emptySet(e){return new Mp(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Mp)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Mp;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let MI=class{constructor(){this.W_=new Xr(Yt.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):sn():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}},M0=class K4{constructor(e,n,r,s,i,l,h,p,y){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=l,this.syncStateChanged=h,this.excludesMetadataChanges=p,this.hasCachedResults=y}static fromInitialDocuments(e,n,r,s,i){const l=[];return n.forEach(h=>{l.push({type:0,doc:h})}),new K4(e,n,q4.emptySet(n),l,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Ug(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let A7=class{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}},T7=class{constructor(){this.queries=LI(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const s=ln(n),i=s.queries;s.queries=LI(),i.forEach((l,h)=>{for(const p of h.j_)p.onError(r)})})(this,new ut(Ne.ABORTED,"Firestore shutting down"))}};function LI(){return new jd(t=>o4(t),Ug)}async function X4(t,e){const n=ln(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.H_()&&e.J_()&&(r=2):(i=new A7,r=e.J_()?0:1);try{switch(r){case 0:i.z_=await n.onListen(s,!0);break;case 1:i.z_=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(l){const h=kv(l,`Initialization of query '${vu(e.query)}' failed`);return void e.onError(h)}n.queries.set(s,i),i.j_.push(e),e.Z_(n.onlineState),i.z_&&e.X_(i.z_)&&Dv(n)}async function Q4(t,e){const n=ln(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const l=i.j_.indexOf(e);l>=0&&(i.j_.splice(l,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function C7(t,e){const n=ln(t);let r=!1;for(const s of e){const i=s.query,l=n.queries.get(i);if(l){for(const h of l.j_)h.X_(s)&&(r=!0);l.z_=s}}r&&Dv(n)}function S7(t,e,n){const r=ln(t),s=r.queries.get(e);if(s)for(const i of s.j_)i.onError(n);r.queries.delete(e)}function Dv(t){t.Y_.forEach(e=>{e.next()})}var pw,jI;(jI=pw||(pw={})).ea="default",jI.Cache="cache";let Y4=class{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new M0(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=M0.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==pw.Cache}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Z4=class{constructor(e){this.key=e}},J4=class{constructor(e){this.key=e}},N7=class{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Sn(),this.mutatedKeys=Sn(),this.Aa=l4(e),this.Ra=new q4(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new MI,s=n?n.Ra:this.Ra;let i=n?n.mutatedKeys:this.mutatedKeys,l=s,h=!1;const p=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,y=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((_,E)=>{const T=s.get(_),k=$g(this.query,E)?E:null,L=!!T&&this.mutatedKeys.has(T.key),B=!!k&&(k.hasLocalMutations||this.mutatedKeys.has(k.key)&&k.hasCommittedMutations);let H=!1;T&&k?T.data.isEqual(k.data)?L!==B&&(r.track({type:3,doc:k}),H=!0):this.ga(T,k)||(r.track({type:2,doc:k}),H=!0,(p&&this.Aa(k,p)>0||y&&this.Aa(k,y)<0)&&(h=!0)):!T&&k?(r.track({type:0,doc:k}),H=!0):T&&!k&&(r.track({type:1,doc:T}),H=!0,(p||y)&&(h=!0)),H&&(k?(l=l.add(k),i=B?i.add(_):i.delete(_)):(l=l.delete(_),i=i.delete(_)))}),this.query.limit!==null)for(;l.size>this.query.limit;){const _=this.query.limitType==="F"?l.last():l.first();l=l.delete(_.key),i=i.delete(_.key),r.track({type:1,doc:_})}return{Ra:l,fa:r,ns:h,mutatedKeys:i}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const l=e.fa.G_();l.sort((_,E)=>function(k,L){const B=H=>{switch(H){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return sn()}};return B(k)-B(L)}(_.type,E.type)||this.Aa(_.doc,E.doc)),this.pa(r),s=s!=null&&s;const h=n&&!s?this.ya():[],p=this.da.size===0&&this.current&&!s?1:0,y=p!==this.Ea;return this.Ea=p,l.length!==0||y?{snapshot:new M0(this.query,e.Ra,i,l,e.mutatedKeys,p===0,y,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:h}:{wa:h}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new MI,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Sn(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new J4(r))}),this.da.forEach(r=>{e.has(r)||n.push(new Z4(r))}),n}ba(e){this.Ta=e.Ts,this.da=Sn();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return M0.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}},R7=class{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}},P7=class{constructor(e){this.key=e,this.va=!1}},k7=class{constructor(e,n,r,s,i,l){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=l,this.Ca={},this.Fa=new jd(h=>o4(h),Ug),this.Ma=new Map,this.xa=new Set,this.Oa=new Xr(Yt.comparator),this.Na=new Map,this.La=new Cv,this.Ba={},this.ka=new Map,this.qa=hw.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}};async function D7(t,e,n=!0){const r=iP(t);let s;const i=r.Fa.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await eP(r,e,n,!0),s}async function O7(t,e){const n=iP(t);await eP(n,e,!0,!1)}async function eP(t,e,n,r){const s=await t7(t.localStore,Ma(e)),i=s.targetId,l=t.sharedClientState.addLocalQueryTarget(i,n);let h;return r&&(h=await M7(t,e,i,l==="current",s.resumeToken)),t.isPrimaryClient&&n&&B4(t.remoteStore,s),h}async function M7(t,e,n,r,s){t.Ka=(E,T,k)=>async function(B,H,W,M){let U=H.view.ma(W);U.ns&&(U=await PI(B.localStore,H.query,!1).then(({documents:A})=>H.view.ma(A,U)));const $=M&&M.targetChanges.get(H.targetId),K=M&&M.targetMismatches.get(H.targetId)!=null,Z=H.view.applyChanges(U,B.isPrimaryClient,$,K);return VI(B,H.targetId,Z.wa),Z.snapshot}(t,E,T,k);const i=await PI(t.localStore,e,!0),l=new N7(e,i.Ts),h=l.ma(i.documents),p=Iv.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),y=l.applyChanges(h,t.isPrimaryClient,p);VI(t,n,y.wa);const _=new R7(e,n,l);return t.Fa.set(e,_),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),y.snapshot}async function L7(t,e,n){const r=ln(t),s=r.Fa.get(e),i=r.Ma.get(s.targetId);if(i.length>1)return r.Ma.set(s.targetId,i.filter(l=>!Ug(l,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await mw(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&Sv(r.remoteStore,s.targetId),gw(r,s.targetId)}).catch(am)):(gw(r,s.targetId),await mw(r.localStore,s.targetId,!0))}async function j7(t,e){const n=ln(t),r=n.Fa.get(e),s=n.Ma.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Sv(n.remoteStore,r.targetId))}async function F7(t,e,n){const r=H7(t);try{const s=await function(l,h){const p=ln(l),y=$s.now(),_=h.reduce((k,L)=>k.add(L.key),Sn());let E,T;return p.persistence.runTransaction("Locally write mutations","readwrite",k=>{let L=Ro(),B=Sn();return p.cs.getEntries(k,_).next(H=>{L=H,L.forEach((W,M)=>{M.isValidDocument()||(B=B.add(W))})}).next(()=>p.localDocuments.getOverlayedDocuments(k,L)).next(H=>{E=H;const W=[];for(const M of h){const U=tV(M,E.get(M.key).overlayedDocument);U!=null&&W.push(new Hl(M.key,U,YR(U.value.mapValue),Tl.exists(!0)))}return p.mutationQueue.addMutationBatch(k,y,W,h)}).next(H=>{T=H;const W=H.applyToLocalDocumentSet(E,B);return p.documentOverlayCache.saveOverlays(k,H.batchId,W)})}).then(()=>({batchId:T.batchId,changes:u4(E)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(l,h,p){let y=l.Ba[l.currentUser.toKey()];y||(y=new Xr(zn)),y=y.insert(h,p),l.Ba[l.currentUser.toKey()]=y}(r,s.batchId,n),await um(r,s.changes),await qg(r.remoteStore)}catch(s){const i=kv(s,"Failed to persist write");n.reject(i)}}async function tP(t,e){const n=ln(t);try{const r=await ZV(n.localStore,e);e.targetChanges.forEach((s,i)=>{const l=n.Na.get(i);l&&(Yn(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?l.va=!0:s.modifiedDocuments.size>0?Yn(l.va):s.removedDocuments.size>0&&(Yn(l.va),l.va=!1))}),await um(n,r,e)}catch(r){await am(r)}}function FI(t,e,n){const r=ln(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Fa.forEach((i,l)=>{const h=l.view.Z_(e);h.snapshot&&s.push(h.snapshot)}),function(l,h){const p=ln(l);p.onlineState=h;let y=!1;p.queries.forEach((_,E)=>{for(const T of E.j_)T.Z_(h)&&(y=!0)}),y&&Dv(p)}(r.eventManager,e),s.length&&r.Ca.d_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function V7(t,e,n){const r=ln(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Na.get(e),i=s&&s.key;if(i){let l=new Xr(Yt.comparator);l=l.insert(i,So.newNoDocument(i,yn.min()));const h=Sn().add(i),p=new E4(yn.min(),new Map,new Xr(zn),l,h);await tP(r,p),r.Oa=r.Oa.remove(i),r.Na.delete(e),Ov(r)}else await mw(r.localStore,e,!1).then(()=>gw(r,e,n)).catch(am)}async function B7(t,e){const n=ln(t),r=e.batch.batchId;try{const s=await YV(n.localStore,e);rP(n,r,null),nP(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await um(n,s)}catch(s){await am(s)}}async function U7(t,e,n){const r=ln(t);try{const s=await function(l,h){const p=ln(l);return p.persistence.runTransaction("Reject batch","readwrite-primary",y=>{let _;return p.mutationQueue.lookupMutationBatch(y,h).next(E=>(Yn(E!==null),_=E.keys(),p.mutationQueue.removeMutationBatch(y,E))).next(()=>p.mutationQueue.performConsistencyCheck(y)).next(()=>p.documentOverlayCache.removeOverlaysForBatchId(y,_,h)).next(()=>p.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(y,_)).next(()=>p.localDocuments.getDocuments(y,_))})}(r.localStore,e);rP(r,e,n),nP(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await um(r,s)}catch(s){await am(s)}}function nP(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function rP(t,e,n){const r=ln(t);let s=r.Ba[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Ba[r.currentUser.toKey()]=s}}function gw(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||sP(t,r)})}function sP(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(Sv(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),Ov(t))}function VI(t,e,n){for(const r of n)r instanceof Z4?(t.La.addReference(r.key,e),$7(t,r)):r instanceof J4?(_t("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||sP(t,r.key)):sn()}function $7(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(_t("SyncEngine","New document in limbo: "+n),t.xa.add(r),Ov(t))}function Ov(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new Yt(Br.fromString(e)),r=t.qa.next();t.Na.set(r,new P7(n)),t.Oa=t.Oa.insert(n,r),B4(t.remoteStore,new Tv(Ma(vv(n.path)),r,"TargetPurposeLimboResolution",pv.oe))}}async function um(t,e,n){const r=ln(t),s=[],i=[],l=[];r.Fa.isEmpty()||(r.Fa.forEach((h,p)=>{l.push(r.Ka(p,e,n).then(y=>{var _;if((y||n)&&r.isPrimaryClient){const E=y?!y.fromCache:(_=n==null?void 0:n.targetChanges.get(p.targetId))===null||_===void 0?void 0:_.current;r.sharedClientState.updateQueryState(p.targetId,E?"current":"not-current")}if(y){s.push(y);const E=GV.Wi(p.targetId,y);i.push(E)}}))}),await Promise.all(l),r.Ca.d_(s),await async function(p,y){const _=ln(p);try{await _.persistence.runTransaction("notifyLocalViewChanges","readwrite",E=>Xe.forEach(y,T=>Xe.forEach(T.$i,k=>_.persistence.referenceDelegate.addReference(E,T.targetId,k)).next(()=>Xe.forEach(T.Ui,k=>_.persistence.referenceDelegate.removeReference(E,T.targetId,k)))))}catch(E){if(!om(E))throw E;_t("LocalStore","Failed to update sequence numbers: "+E)}for(const E of y){const T=E.targetId;if(!E.fromCache){const k=_.os.get(T),L=k.snapshotVersion,B=k.withLastLimboFreeSnapshotVersion(L);_.os=_.os.insert(T,B)}}}(r.localStore,i))}async function z7(t,e){const n=ln(t);if(!n.currentUser.isEqual(e)){_t("SyncEngine","User change. New user:",e.toKey());const r=await L4(n.localStore,e);n.currentUser=e,function(i,l){i.ka.forEach(h=>{h.forEach(p=>{p.reject(new ut(Ne.CANCELLED,l))})}),i.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await um(n,r.hs)}}function W7(t,e){const n=ln(t),r=n.Na.get(e);if(r&&r.va)return Sn().add(r.key);{let s=Sn();const i=n.Ma.get(e);if(!i)return s;for(const l of i){const h=n.Fa.get(l);s=s.unionWith(h.view.Va)}return s}}function iP(t){const e=ln(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=tP.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=W7.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=V7.bind(null,e),e.Ca.d_=C7.bind(null,e.eventManager),e.Ca.$a=S7.bind(null,e.eventManager),e}function H7(t){const e=ln(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=B7.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=U7.bind(null,e),e}let L0=class{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Hg(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return QV(this.persistence,new KV,e.initialUser,this.serializer)}Ga(e){return new zV(HV.Zr,this.serializer)}Wa(e){return new r7}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}};L0.provider={build:()=>new L0};let yw=class{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>FI(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=z7.bind(null,this.syncEngine),await b7(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new T7}()}createDatastore(e){const n=Hg(e.databaseInfo.databaseId),r=function(i){return new o7(i)}(e.databaseInfo);return function(i,l,h,p){return new u7(i,l,h,p)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,l,h){return new h7(r,s,i,l,h)}(this.localStore,this.datastore,e.asyncQueue,n=>FI(this.syncEngine,n,0),function(){return DI.D()?new DI:new s7}())}createSyncEngine(e,n){return function(s,i,l,h,p,y,_){const E=new k7(s,i,l,h,p,y);return _&&(E.Qa=!0),E}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=ln(s);_t("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await cm(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}};yw.provider={build:()=>new yw};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let aP=class{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):Co("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let G7=class{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=Ns.UNAUTHENTICATED,this.clientId=GR.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async l=>{_t("FirestoreClient","Received user=",l.uid),await this.authCredentialListener(l),this.user=l}),this.appCheckCredentials.start(r,l=>(_t("FirestoreClient","Received new app check token=",l),this.appCheckCredentialListener(l,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new xo;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=kv(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}};async function py(t,e){t.asyncQueue.verifyOperationInProgress(),_t("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await L4(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function BI(t,e){t.asyncQueue.verifyOperationInProgress();const n=await q7(t);_t("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>OI(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>OI(e.remoteStore,s)),t._onlineComponents=e}async function q7(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){_t("FirestoreClient","Using user provided OfflineComponentProvider");try{await py(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===Ne.FAILED_PRECONDITION||s.code===Ne.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;gd("Error using user provided cache. Falling back to memory cache: "+n),await py(t,new L0)}}else _t("FirestoreClient","Using default OfflineComponentProvider"),await py(t,new L0);return t._offlineComponents}async function oP(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(_t("FirestoreClient","Using user provided OnlineComponentProvider"),await BI(t,t._uninitializedComponentsProvider._online)):(_t("FirestoreClient","Using default OnlineComponentProvider"),await BI(t,new yw))),t._onlineComponents}function K7(t){return oP(t).then(e=>e.syncEngine)}async function lP(t){const e=await oP(t),n=e.eventManager;return n.onListen=D7.bind(null,e.syncEngine),n.onUnlisten=L7.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=O7.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=j7.bind(null,e.syncEngine),n}function X7(t,e,n={}){const r=new xo;return t.asyncQueue.enqueueAndForget(async()=>function(i,l,h,p,y){const _=new aP({next:T=>{_.Za(),l.enqueueAndForget(()=>Q4(i,E));const k=T.docs.has(h);!k&&T.fromCache?y.reject(new ut(Ne.UNAVAILABLE,"Failed to get document because the client is offline.")):k&&T.fromCache&&p&&p.source==="server"?y.reject(new ut(Ne.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):y.resolve(T)},error:T=>y.reject(T)}),E=new Y4(vv(h.path),_,{includeMetadataChanges:!0,_a:!0});return X4(i,E)}(await lP(t),t.asyncQueue,e,n,r)),r.promise}function Q7(t,e,n={}){const r=new xo;return t.asyncQueue.enqueueAndForget(async()=>function(i,l,h,p,y){const _=new aP({next:T=>{_.Za(),l.enqueueAndForget(()=>Q4(i,E)),T.fromCache&&p.source==="server"?y.reject(new ut(Ne.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):y.resolve(T)},error:T=>y.reject(T)}),E=new Y4(h,_,{includeMetadataChanges:!0,_a:!0});return X4(i,E)}(await lP(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cP(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UI=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uP(t,e,n){if(!n)throw new ut(Ne.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function Y7(t,e,n,r){if(e===!0&&r===!0)throw new ut(Ne.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function $I(t){if(!Yt.isDocumentKey(t))throw new ut(Ne.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function zI(t){if(Yt.isDocumentKey(t))throw new ut(Ne.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Kg(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":sn()}function da(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new ut(Ne.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Kg(t);throw new ut(Ne.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let WI=class{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new ut(Ne.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new ut(Ne.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Y7("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=cP((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new ut(Ne.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new ut(Ne.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new ut(Ne.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}},Xg=class{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new WI({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ut(Ne.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ut(Ne.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new WI(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new cF;switch(r.type){case"firstParty":return new fF(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new ut(Ne.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=UI.get(n);r&&(_t("ComponentProvider","Removing Datastore"),UI.delete(n),r.terminate())}(this),Promise.resolve()}};function Z7(t,e,n,r={}){var s;const i=(t=da(t,Xg))._getSettings(),l=`${e}:${n}`;if(i.host!=="firestore.googleapis.com"&&i.host!==l&&gd("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},i),{host:l,ssl:!1})),r.mockUserToken){let h,p;if(typeof r.mockUserToken=="string")h=r.mockUserToken,p=Ns.MOCK_USER;else{h=GN(r.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const y=r.mockUserToken.sub||r.mockUserToken.user_id;if(!y)throw new ut(Ne.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");p=new Ns(y)}t._authCredentials=new uF(new HR(h,p))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let dm=class dP{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new dP(this.firestore,e,this._query)}},Si=class hP{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Xu(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new hP(this.firestore,e,this._key)}},Xu=class fP extends dm{constructor(e,n,r){super(e,n,vv(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Si(this.firestore,null,new Yt(e))}withConverter(e){return new fP(this.firestore,e,this._path)}};function In(t,e,...n){if(t=es(t),uP("collection","path",e),t instanceof Xg){const r=Br.fromString(e,...n);return zI(r),new Xu(t,null,r)}{if(!(t instanceof Si||t instanceof Xu))throw new ut(Ne.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Br.fromString(e,...n));return zI(r),new Xu(t.firestore,null,r)}}function Bn(t,e,...n){if(t=es(t),arguments.length===1&&(e=GR.newId()),uP("doc","path",e),t instanceof Xg){const r=Br.fromString(e,...n);return $I(r),new Si(t,null,new Yt(r))}{if(!(t instanceof Si||t instanceof Xu))throw new ut(Ne.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Br.fromString(e,...n));return $I(r),new Si(t.firestore,t instanceof Xu?t.converter:null,new Yt(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let HI=class{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new F4(this,"async_queue_retry"),this.Vu=()=>{const r=my();r&&_t("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=my();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=my();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new xo;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!om(e))throw e;_t("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const s=function(l){let h=l.message||"";return l.stack&&(h=l.stack.includes(l.message)?l.stack:l.message+`
`+l.stack),h}(r);throw Co("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const s=I7.createAndSchedule(this,e,n,r,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&sn()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}},iu=class extends Xg{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new HI,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new HI(e),this._firestoreClient=void 0,await e}}};function J7(t,e){const n=typeof t=="object"?t:sv(),r=typeof t=="string"?t:"(default)",s=Mg(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=zN("firestore");i&&Z7(s,...i)}return s}function Mv(t){if(t._terminated)throw new ut(Ne.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||eB(t),t._firestoreClient}function eB(t){var e,n,r;const s=t._freezeSettings(),i=function(h,p,y,_){return new TF(h,p,y,_.host,_.ssl,_.experimentalForceLongPolling,_.experimentalAutoDetectLongPolling,cP(_.experimentalLongPollingOptions),_.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new G7(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(h){const p=h==null?void 0:h._online.build();return{_offline:h==null?void 0:h._offline.build(p),_online:p}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Lv=class xw{constructor(e){this._byteString=e}static fromBase64String(e){try{return new xw(hi.fromBase64String(e))}catch(n){throw new ut(Ne.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new xw(hi.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Qg=class{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new ut(Ne.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new la(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Yg=class{constructor(e){this._methodName=e}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let jv=class{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new ut(Ne.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new ut(Ne.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return zn(this._lat,e._lat)||zn(this._long,e._long)}};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Fv=class{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tB=/^__.*__$/;let nB=class{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Hl(e,this.data,this.fieldMask,n,this.fieldTransforms):new lm(e,this.data,n,this.fieldTransforms)}},mP=class{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Hl(e,this.data,this.fieldMask,n,this.fieldTransforms)}};function pP(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw sn()}}let rB=class gP{constructor(e,n,r,s,i,l){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=l||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new gP(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.Ou(e),s}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return j0(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(pP(this.Cu)&&tB.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}},sB=class{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Hg(e)}Qu(e,n,r,s=!1){return new rB({Cu:e,methodName:n,qu:r,path:la.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function Zg(t){const e=t._freezeSettings(),n=Hg(t._databaseId);return new sB(t._databaseId,!!e.ignoreUndefinedProperties,n)}function yP(t,e,n,r,s,i={}){const l=t.Qu(i.merge||i.mergeFields?2:0,e,n,s);Bv("Data must be an object, but it was:",l,r);const h=_P(r,l);let p,y;if(i.merge)p=new Ta(l.fieldMask),y=l.fieldTransforms;else if(i.mergeFields){const _=[];for(const E of i.mergeFields){const T=ww(e,E,n);if(!l.contains(T))throw new ut(Ne.INVALID_ARGUMENT,`Field '${T}' is specified in your field mask but missing from your input data.`);EP(_,T)||_.push(T)}p=new Ta(_),y=l.fieldTransforms.filter(E=>p.covers(E.field))}else p=null,y=l.fieldTransforms;return new nB(new sa(h),p,y)}let xP=class wP extends Yg{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof wP}};class Vv extends Yg{_toFieldTransform(e){return new YF(e.path,new Rf)}isEqual(e){return e instanceof Vv}}function iB(t,e,n,r){const s=t.Qu(1,e,n);Bv("Data must be an object, but it was:",s,r);const i=[],l=sa.empty();ru(r,(p,y)=>{const _=Uv(e,p,n);y=es(y);const E=s.Nu(_);if(y instanceof xP)i.push(_);else{const T=hm(y,E);T!=null&&(i.push(_),l.set(_,T))}});const h=new Ta(i);return new mP(l,h,s.fieldTransforms)}function aB(t,e,n,r,s,i){const l=t.Qu(1,e,n),h=[ww(e,r,n)],p=[s];if(i.length%2!=0)throw new ut(Ne.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let T=0;T<i.length;T+=2)h.push(ww(e,i[T])),p.push(i[T+1]);const y=[],_=sa.empty();for(let T=h.length-1;T>=0;--T)if(!EP(y,h[T])){const k=h[T];let L=p[T];L=es(L);const B=l.Nu(k);if(L instanceof xP)y.push(k);else{const H=hm(L,B);H!=null&&(y.push(k),_.set(k,H))}}const E=new Ta(y);return new mP(_,E,l.fieldTransforms)}function oB(t,e,n,r=!1){return hm(n,t.Qu(r?4:3,e))}function hm(t,e){if(vP(t=es(t)))return Bv("Unsupported field value:",e,t),_P(t,e);if(t instanceof Yg)return function(r,s){if(!pP(s.Cu))throw s.Bu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,s){const i=[];let l=0;for(const h of r){let p=hm(h,s.Lu(l));p==null&&(p={nullValue:"NULL_VALUE"}),i.push(p),l++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=es(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return KF(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=$s.fromDate(r);return{timestampValue:D0(s.serializer,i)}}if(r instanceof $s){const i=new $s(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:D0(s.serializer,i)}}if(r instanceof jv)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Lv)return{bytesValue:C4(s.serializer,r._byteString)};if(r instanceof Si){const i=s.databaseId,l=r.firestore._databaseId;if(!l.isEqual(i))throw s.Bu(`Document reference is for database ${l.projectId}/${l.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:Av(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof Fv)return function(l,h){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:l.toArray().map(p=>{if(typeof p!="number")throw h.Bu("VectorValues must only contain numeric values.");return Ev(h.serializer,p)})}}}}}}(r,s);throw s.Bu(`Unsupported field value: ${Kg(r)}`)}(t,e)}function _P(t,e){const n={};return KR(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ru(t,(r,s)=>{const i=hm(s,e.Mu(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function vP(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof $s||t instanceof jv||t instanceof Lv||t instanceof Si||t instanceof Yg||t instanceof Fv)}function Bv(t,e,n){if(!vP(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const r=Kg(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function ww(t,e,n){if((e=es(e))instanceof Qg)return e._internalPath;if(typeof e=="string")return Uv(t,e);throw j0("Field path arguments must be of type string or ",t,!1,void 0,n)}const lB=new RegExp("[~\\*/\\[\\]]");function Uv(t,e,n){if(e.search(lB)>=0)throw j0(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Qg(...e.split("."))._internalPath}catch{throw j0(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function j0(t,e,n,r,s){const i=r&&!r.isEmpty(),l=s!==void 0;let h=`Function ${e}() called with invalid data`;n&&(h+=" (via `toFirestore()`)"),h+=". ";let p="";return(i||l)&&(p+=" (found",i&&(p+=` in field ${r}`),l&&(p+=` in document ${s}`),p+=")"),new ut(Ne.INVALID_ARGUMENT,h+t+p)}function EP(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let bP=class{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Si(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new cB(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Jg("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}},cB=class extends bP{data(){return super.data()}};function Jg(t,e){return typeof e=="string"?Uv(t,e):e instanceof Qg?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uB(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new ut(Ne.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}let $v=class{},IP=class extends $v{};function Ii(t,e,...n){let r=[];e instanceof $v&&r.push(e),r=r.concat(n),function(i){const l=i.filter(p=>p instanceof dB).length,h=i.filter(p=>p instanceof AP).length;if(l>1||l>0&&h>0)throw new ut(Ne.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}let AP=class TP extends IP{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new TP(e,n,r)}_apply(e){const n=this._parse(e);return SP(e._query,n),new dm(e.firestore,e.converter,aw(e._query,n))}_parse(e){const n=Zg(e.firestore);return function(i,l,h,p,y,_,E){let T;if(y.isKeyField()){if(_==="array-contains"||_==="array-contains-any")throw new ut(Ne.INVALID_ARGUMENT,`Invalid Query. You can't perform '${_}' queries on documentId().`);if(_==="in"||_==="not-in"){qI(E,_);const k=[];for(const L of E)k.push(GI(p,i,L));T={arrayValue:{values:k}}}else T=GI(p,i,E)}else _!=="in"&&_!=="not-in"&&_!=="array-contains-any"||qI(E,_),T=oB(h,l,E,_==="in"||_==="not-in");return as.create(y,_,T)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}};function hc(t,e,n){const r=e,s=Jg("where",t);return AP._create(s,r,n)}let dB=class CP extends $v{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new CP(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:No.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let l=s;const h=i.getFlattenedFilters();for(const p of h)SP(l,p),l=aw(l,p)}(e._query,n),new dm(e.firestore,e.converter,aw(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};class zv extends IP{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new zv(e,n)}_apply(e){const n=function(s,i,l){if(s.startAt!==null)throw new ut(Ne.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(s.endAt!==null)throw new ut(Ne.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Nf(i,l)}(e._query,this._field,this._direction);return new dm(e.firestore,e.converter,function(s,i){const l=s.explicitOrderBy.concat([i]);return new Ld(s.path,s.collectionGroup,l,s.filters.slice(),s.limit,s.limitType,s.startAt,s.endAt)}(e._query,n))}}function xc(t,e="asc"){const n=e,r=Jg("orderBy",t);return zv._create(r,n)}function GI(t,e,n){if(typeof(n=es(n))=="string"){if(n==="")throw new ut(Ne.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!a4(e)&&n.indexOf("/")!==-1)throw new ut(Ne.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Br.fromString(n));if(!Yt.isDocumentKey(r))throw new ut(Ne.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return mI(t,new Yt(r))}if(n instanceof Si)return mI(t,n._key);throw new ut(Ne.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Kg(n)}.`)}function qI(t,e){if(!Array.isArray(t)||t.length===0)throw new ut(Ne.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function SP(t,e){const n=function(s,i){for(const l of s)for(const h of l.getFlattenedFilters())if(i.indexOf(h.op)>=0)return h.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new ut(Ne.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ut(Ne.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}let hB=class{convertValue(e,n="none"){switch(zc(e)){case 0:return null;case 1:return e.booleanValue;case 2:return jr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes($c(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw sn()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return ru(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var n,r,s;const i=(s=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(l=>jr(l.doubleValue));return new Fv(i)}convertGeoPoint(e){return new jv(jr(e.latitude),jr(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=yv(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Cf(e));default:return null}}convertTimestamp(e){const n=Ol(e);return new $s(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Br.fromString(e);Yn(D4(r));const s=new QR(r.get(1),r.get(3)),i=new Yt(r.popFirst(5));return s.isEqual(n)||Co(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function NP(t,e,n){let r;return r=t?t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Th=class{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}},RP=class extends bP{constructor(e,n,r,s,i,l){super(e,n,r,s,l),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Lp(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Jg("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}},Lp=class extends RP{data(e={}){return super.data(e)}},fB=class{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new Th(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Lp(this._firestore,this._userDataWriter,r.key,r,new Th(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new ut(Ne.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let l=0;return s._snapshot.docChanges.map(h=>{const p=new Lp(s._firestore,s._userDataWriter,h.doc.key,h.doc,new Th(s._snapshot.mutatedKeys.has(h.doc.key),s._snapshot.fromCache),s.query.converter);return h.doc,{type:"added",doc:p,oldIndex:-1,newIndex:l++}})}{let l=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(h=>i||h.type!==3).map(h=>{const p=new Lp(s._firestore,s._userDataWriter,h.doc.key,h.doc,new Th(s._snapshot.mutatedKeys.has(h.doc.key),s._snapshot.fromCache),s.query.converter);let y=-1,_=-1;return h.type!==0&&(y=l.indexOf(h.doc.key),l=l.delete(h.doc.key)),h.type!==1&&(l=l.add(h.doc),_=l.indexOf(h.doc.key)),{type:mB(h.type),doc:p,oldIndex:y,newIndex:_}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}};function mB(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return sn()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ri(t){t=da(t,Si);const e=da(t.firestore,iu);return X7(Mv(e),t._key).then(n=>pB(e,t,n))}let PP=class extends hB{constructor(e){super(),this.firestore=e}convertBytes(e){return new Lv(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Si(this.firestore,null,n)}};function Cn(t){t=da(t,dm);const e=da(t.firestore,iu),n=Mv(e),r=new PP(e);return uB(t._query),Q7(n,t._query).then(s=>new fB(e,r,t,s))}function _w(t,e,n){t=da(t,Si);const r=da(t.firestore,iu),s=NP(t.converter,e);return e1(r,[yP(Zg(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,Tl.none())])}function ls(t,e,n,...r){t=da(t,Si);const s=da(t.firestore,iu),i=Zg(s);let l;return l=typeof(e=es(e))=="string"||e instanceof Qg?aB(i,"updateDoc",t._key,e,n,r):iB(i,"updateDoc",t._key,e),e1(s,[l.toMutation(t._key,Tl.exists(!0))])}function vw(t){return e1(da(t.firestore,iu),[new bv(t._key,Tl.none())])}function Wc(t,e){const n=da(t.firestore,iu),r=Bn(t),s=NP(t.converter,e);return e1(n,[yP(Zg(t.firestore),"addDoc",r._key,s,t.converter!==null,{}).toMutation(r._key,Tl.exists(!1))]).then(()=>r)}function e1(t,e){return function(r,s){const i=new xo;return r.asyncQueue.enqueueAndForget(async()=>F7(await K7(r),s,i)),i.promise}(Mv(t),e)}function pB(t,e,n){const r=n.docs.get(e._key),s=new PP(t);return new RP(t,s,e._key,r,new Th(n.hasPendingWrites,n.fromCache),e.converter)}function F0(){return new Vv("serverTimestamp")}(function(e,n=!0){(function(s){Md=s})(nu),Bc(new Dl("firestore",(r,{instanceIdentifier:s,options:i})=>{const l=r.getProvider("app").getImmediate(),h=new iu(new dF(r.getProvider("auth-internal")),new pF(r.getProvider("app-check-internal")),function(y,_){if(!Object.prototype.hasOwnProperty.apply(y.options,["projectId"]))throw new ut(Ne.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new QR(y.options.projectId,_)}(l,s),l);return i=Object.assign({useFetchStreams:n},i),h._setSettings(i),h},"PUBLIC").setMultipleInstances(!0)),ka(cI,"4.7.3",e),ka(cI,"4.7.3","esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kP="firebasestorage.googleapis.com",gB="storageBucket",yB=2*60*1e3,xB=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Gl=class DP extends $a{constructor(e,n,r=0){super(gy(e),`Firebase Storage: ${n} (${gy(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,DP.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return gy(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}};var Wa;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Wa||(Wa={}));function gy(t){return"storage/"+t}function wB(){const t="An unknown error occurred, please check the error payload for server response.";return new Gl(Wa.UNKNOWN,t)}function _B(){return new Gl(Wa.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function vB(){return new Gl(Wa.CANCELED,"User canceled the upload/download.")}function EB(t){return new Gl(Wa.INVALID_URL,"Invalid URL '"+t+"'.")}function bB(t){return new Gl(Wa.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function KI(t){return new Gl(Wa.INVALID_ARGUMENT,t)}function OP(){return new Gl(Wa.APP_DELETED,"The Firebase app was deleted.")}function IB(t){return new Gl(Wa.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let wc=class jp{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=jp.makeFromUrl(e,n)}catch{return new jp(e,"")}if(r.path==="")return r;throw bB(e)}static makeFromUrl(e,n){let r=null;const s="([A-Za-z0-9.\\-_]+)";function i($){$.path.charAt($.path.length-1)==="/"&&($.path_=$.path_.slice(0,-1))}const l="(/(.*))?$",h=new RegExp("^gs://"+s+l,"i"),p={bucket:1,path:3};function y($){$.path_=decodeURIComponent($.path)}const _="v[A-Za-z0-9_]+",E=n.replace(/[.]/g,"\\."),T="(/([^?#]*).*)?$",k=new RegExp(`^https?://${E}/${_}/b/${s}/o${T}`,"i"),L={bucket:1,path:3},B=n===kP?"(?:storage.googleapis.com|storage.cloud.google.com)":n,H="([^?#]*)",W=new RegExp(`^https?://${B}/${s}/${H}`,"i"),U=[{regex:h,indices:p,postModify:i},{regex:k,indices:L,postModify:y},{regex:W,indices:{bucket:1,path:2},postModify:y}];for(let $=0;$<U.length;$++){const K=U[$],Z=K.regex.exec(e);if(Z){const A=Z[K.indices.bucket];let C=Z[K.indices.path];C||(C=""),r=new jp(A,C),K.postModify(r);break}}if(r==null)throw EB(e);return r}},AB=class{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TB(t,e,n){let r=1,s=null,i=null,l=!1,h=0;function p(){return h===2}let y=!1;function _(...H){y||(y=!0,e.apply(null,H))}function E(H){s=setTimeout(()=>{s=null,t(k,p())},H)}function T(){i&&clearTimeout(i)}function k(H,...W){if(y){T();return}if(H){T(),_.call(null,H,...W);return}if(p()||l){T(),_.call(null,H,...W);return}r<64&&(r*=2);let U;h===1?(h=2,U=0):U=(r+Math.random())*1e3,E(U)}let L=!1;function B(H){L||(L=!0,T(),!y&&(s!==null?(H||(h=2),clearTimeout(s),E(0)):H||(h=1)))}return E(0),i=setTimeout(()=>{l=!0,B(!0)},n),B}function CB(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SB(t){return t!==void 0}function XI(t,e,n,r){if(r<e)throw KI(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw KI(`Invalid value for '${t}'. Expected ${n} or less.`)}function NB(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const s=e(r)+"="+e(t[r]);n=n+s+"&"}return n=n.slice(0,-1),n}var V0;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(V0||(V0={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RB(t,e){const n=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return n||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let PB=class{constructor(e,n,r,s,i,l,h,p,y,_,E,T=!0){this.url_=e,this.method_=n,this.headers_=r,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=l,this.callback_=h,this.errorCallback_=p,this.timeout_=y,this.progressCallback_=_,this.connectionFactory_=E,this.retry=T,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((k,L)=>{this.resolve_=k,this.reject_=L,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new ep(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const l=h=>{const p=h.loaded,y=h.lengthComputable?h.total:-1;this.progressCallback_!==null&&this.progressCallback_(p,y)};this.progressCallback_!==null&&i.addUploadProgressListener(l),i.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(l),this.pendingConnection_=null;const h=i.getErrorCode()===V0.NO_ERROR,p=i.getStatus();if(!h||RB(p,this.additionalRetryCodes_)&&this.retry){const _=i.getErrorCode()===V0.ABORT;r(!1,new ep(!1,null,_));return}const y=this.successCodes_.indexOf(p)!==-1;r(!0,new ep(y,i))})},n=(r,s)=>{const i=this.resolve_,l=this.reject_,h=s.connection;if(s.wasSuccessCode)try{const p=this.callback_(h,h.getResponse());SB(p)?i(p):i()}catch(p){l(p)}else if(h!==null){const p=wB();p.serverResponse=h.getErrorText(),this.errorCallback_?l(this.errorCallback_(h,p)):l(p)}else if(s.canceled){const p=this.appDelete_?OP():vB();l(p)}else{const p=_B();l(p)}};this.canceled_?n(!1,new ep(!1,null,!0)):this.backoffId_=TB(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&CB(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}},ep=class{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}};function kB(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function DB(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function OB(t,e){e&&(t["X-Firebase-GMPID"]=e)}function MB(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function LB(t,e,n,r,s,i,l=!0){const h=NB(t.urlParams),p=t.url+h,y=Object.assign({},t.headers);return OB(y,e),kB(y,n),DB(y,i),MB(y,r),new PB(p,t.method,y,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,l)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jB(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function FB(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let VB=class Ew{constructor(e,n){this._service=e,n instanceof wc?this._location=n:this._location=wc.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new Ew(e,n)}get root(){const e=new wc(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return FB(this._location.path)}get storage(){return this._service}get parent(){const e=jB(this._location.path);if(e===null)return null;const n=new wc(this._location.bucket,e);return new Ew(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw IB(e)}};function QI(t,e){const n=e==null?void 0:e[gB];return n==null?null:wc.makeFromBucketSpec(n,t)}function BB(t,e,n,r={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:s}=r;s&&(t._overrideAuthToken=typeof s=="string"?s:GN(s,t.app.options.projectId))}let UB=class{constructor(e,n,r,s,i){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=s,this._firebaseVersion=i,this._bucket=null,this._host=kP,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=yB,this._maxUploadRetryTime=xB,this._requests=new Set,s!=null?this._bucket=wc.makeFromBucketSpec(s,this._host):this._bucket=QI(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=wc.makeFromBucketSpec(this._url,e):this._bucket=QI(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){XI("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){XI("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new VB(this,e)}_makeRequest(e,n,r,s,i=!0){if(this._deleted)return new AB(OP());{const l=LB(e,this._appId,r,s,n,this._firebaseVersion,i);return this._requests.add(l),l.getPromise().then(()=>this._requests.delete(l),()=>this._requests.delete(l)),l}}async makeRequestWithTokens(e,n){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,s).getPromise()}};const YI="@firebase/storage",ZI="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MP="storage";function $B(t=sv(),e){t=es(t);const r=Mg(t,MP).getImmediate({identifier:e}),s=zN("storage");return s&&zB(r,...s),r}function zB(t,e,n,r={}){BB(t,e,n,r)}function WB(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new UB(n,r,s,e,nu)}function HB(){Bc(new Dl(MP,WB,"PUBLIC").setMultipleInstances(!0)),ka(YI,ZI,""),ka(YI,ZI,"esm2017")}HB();const GB={apiKey:"AIzaSyC-ls1TrvSkrw71KqmB_kHYgPoj0H550a8",authDomain:"madas-store.firebaseapp.com",projectId:"madas-store",storageBucket:"madas-store.firebasestorage.app",messagingSenderId:"527071300010",appId:"1:527071300010:web:7470e2204065b4590583d3",measurementId:"G-NQVR1F4N3Q"},t1=Fb().length?Fb()[0]:QN(GB),at=J7(t1),ao=iF(t1);$B(t1);typeof window<"u"&&(window.__FIREBASE_DB__=at,window.__FIREBASE_AUTH__=ao,window.__FIREBASE_APP__=t1);const LP=q.createContext(void 0),qB=({children:t})=>{const[e,n]=q.useState(null),[r,s]=q.useState(!0),[i,l]=q.useState(null);q.useEffect(()=>{const y=setTimeout(()=>{r&&(console.error("[AuthContext] Auth state timeout - domain may not be authorized"),l("Authentication timeout. Please ensure this domain is authorized in Firebase Console."),s(!1))},1e4),_=qj(ao,E=>{clearTimeout(y),n(E),s(!1),l(null)},E=>{clearTimeout(y),console.error("[AuthContext] Auth error:",E),l(E.message),s(!1)});return()=>{clearTimeout(y),_()}},[]);const h=q.useCallback(async()=>{await Ip(ao)},[]),p=q.useMemo(()=>({user:e,loading:r,error:i,logout:h}),[e,r,i,h]);return d.jsx(LP.Provider,{value:p,children:t})},fm=()=>{const t=q.useContext(LP);if(!t)throw new Error("useAuth must be used within AuthProvider");return t};var JI={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jP=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},KB=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],l=t[n++],h=t[n++],p=((s&7)<<18|(i&63)<<12|(l&63)<<6|h&63)-65536;e[r++]=String.fromCharCode(55296+(p>>10)),e[r++]=String.fromCharCode(56320+(p&1023))}else{const i=t[n++],l=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|l&63)}}return e.join("")},FP={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],l=s+1<t.length,h=l?t[s+1]:0,p=s+2<t.length,y=p?t[s+2]:0,_=i>>2,E=(i&3)<<4|h>>4;let T=(h&15)<<2|y>>6,k=y&63;p||(k=64,l||(T=64)),r.push(n[_],n[E],n[T],n[k])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(jP(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):KB(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],h=s<t.length?n[t.charAt(s)]:0;++s;const y=s<t.length?n[t.charAt(s)]:64;++s;const E=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||h==null||y==null||E==null)throw new XB;const T=i<<2|h>>4;if(r.push(T),y!==64){const k=h<<4&240|y>>2;if(r.push(k),E!==64){const L=y<<6&192|E;r.push(L)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class XB extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const QB=function(t){const e=jP(t);return FP.encodeByteArray(e,!0)},B0=function(t){return QB(t).replace(/\./g,"")},VP=function(t){try{return FP.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YB(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZB=()=>YB().__FIREBASE_DEFAULTS__,JB=()=>{if(typeof process>"u"||typeof JI>"u")return;const t=JI.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},eU=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&VP(t[1]);return e&&JSON.parse(e)},n1=()=>{try{return ZB()||JB()||eU()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},BP=t=>{var e,n;return(n=(e=n1())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},UP=t=>{const e=BP(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},$P=()=>{var t;return(t=n1())===null||t===void 0?void 0:t.config},zP=t=>{var e;return(e=n1())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tU{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WP(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const l=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t);return[B0(JSON.stringify(n)),B0(JSON.stringify(l)),""].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ms(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function nU(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Ms())}function rU(){var t;const e=(t=n1())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function sU(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function iU(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function aU(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function oU(){const t=Ms();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function lU(){return!rU()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function cU(){try{return typeof indexedDB=="object"}catch{return!1}}function uU(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dU="FirebaseError";class qa extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=dU,Object.setPrototypeOf(this,qa.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,mm.prototype.create)}}class mm{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],l=i?hU(i,r):"Error",h=`${this.serviceName}: ${l} (${s}).`;return new qa(s,h,r)}}function hU(t,e){return t.replace(fU,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const fU=/\{\$([^}]+)}/g;function mU(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function U0(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],l=e[s];if(eA(i)&&eA(l)){if(!U0(i,l))return!1}else if(i!==l)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function eA(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pm(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function pU(t,e){const n=new gU(t,e);return n.subscribe.bind(n)}class gU{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");yU(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=yy),s.error===void 0&&(s.error=yy),s.complete===void 0&&(s.complete=yy);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function yU(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function yy(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function us(t){return t&&t._delegate?t._delegate:t}class Ll{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lc="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xU{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new tU;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(_U(e))try{this.getOrInitializeService({instanceIdentifier:lc})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=lc){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=lc){return this.instances.has(e)}getOptions(e=lc){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,l]of this.instancesDeferred.entries()){const h=this.normalizeInstanceIdentifier(i);r===h&&l.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const l=this.instances.get(s);return l&&e(l,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:wU(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=lc){return this.component?this.component.multipleInstances?e:lc:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function wU(t){return t===lc?void 0:t}function _U(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vU{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new xU(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Dn;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Dn||(Dn={}));const EU={debug:Dn.DEBUG,verbose:Dn.VERBOSE,info:Dn.INFO,warn:Dn.WARN,error:Dn.ERROR,silent:Dn.SILENT},bU=Dn.INFO,IU={[Dn.DEBUG]:"log",[Dn.VERBOSE]:"log",[Dn.INFO]:"info",[Dn.WARN]:"warn",[Dn.ERROR]:"error"},AU=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=IU[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class Wv{constructor(e){this.name=e,this._logLevel=bU,this._logHandler=AU,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Dn))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?EU[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Dn.DEBUG,...e),this._logHandler(this,Dn.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Dn.VERBOSE,...e),this._logHandler(this,Dn.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Dn.INFO,...e),this._logHandler(this,Dn.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Dn.WARN,...e),this._logHandler(this,Dn.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Dn.ERROR,...e),this._logHandler(this,Dn.ERROR,...e)}}const TU=(t,e)=>e.some(n=>t instanceof n);let tA,nA;function CU(){return tA||(tA=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function SU(){return nA||(nA=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const HP=new WeakMap,bw=new WeakMap,GP=new WeakMap,xy=new WeakMap,Hv=new WeakMap;function NU(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",l)},i=()=>{n(Cl(t.result)),s()},l=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",l)});return e.then(n=>{n instanceof IDBCursor&&HP.set(n,t)}).catch(()=>{}),Hv.set(e,t),e}function RU(t){if(bw.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",l),t.removeEventListener("abort",l)},i=()=>{n(),s()},l=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",l),t.addEventListener("abort",l)});bw.set(t,e)}let Iw={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return bw.get(t);if(e==="objectStoreNames")return t.objectStoreNames||GP.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Cl(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function PU(t){Iw=t(Iw)}function kU(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(wy(this),e,...n);return GP.set(r,e.sort?e.sort():[e]),Cl(r)}:SU().includes(t)?function(...e){return t.apply(wy(this),e),Cl(HP.get(this))}:function(...e){return Cl(t.apply(wy(this),e))}}function DU(t){return typeof t=="function"?kU(t):(t instanceof IDBTransaction&&RU(t),TU(t,CU())?new Proxy(t,Iw):t)}function Cl(t){if(t instanceof IDBRequest)return NU(t);if(xy.has(t))return xy.get(t);const e=DU(t);return e!==t&&(xy.set(t,e),Hv.set(e,t)),e}const wy=t=>Hv.get(t);function OU(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const l=indexedDB.open(t,e),h=Cl(l);return r&&l.addEventListener("upgradeneeded",p=>{r(Cl(l.result),p.oldVersion,p.newVersion,Cl(l.transaction),p)}),n&&l.addEventListener("blocked",p=>n(p.oldVersion,p.newVersion,p)),h.then(p=>{i&&p.addEventListener("close",()=>i()),s&&p.addEventListener("versionchange",y=>s(y.oldVersion,y.newVersion,y))}).catch(()=>{}),h}const MU=["get","getKey","getAll","getAllKeys","count"],LU=["put","add","delete","clear"],_y=new Map;function rA(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(_y.get(e))return _y.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=LU.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||MU.includes(n)))return;const i=async function(l,...h){const p=this.transaction(l,s?"readwrite":"readonly");let y=p.store;return r&&(y=y.index(h.shift())),(await Promise.all([y[n](...h),s&&p.done]))[0]};return _y.set(e,i),i}PU(t=>({...t,get:(e,n,r)=>rA(e,n)||t.get(e,n,r),has:(e,n)=>!!rA(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jU{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(FU(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function FU(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const Aw="@firebase/app",sA="0.10.13";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Po=new Wv("@firebase/app"),VU="@firebase/app-compat",BU="@firebase/analytics-compat",UU="@firebase/analytics",$U="@firebase/app-check-compat",zU="@firebase/app-check",WU="@firebase/auth",HU="@firebase/auth-compat",GU="@firebase/database",qU="@firebase/data-connect",KU="@firebase/database-compat",XU="@firebase/functions",QU="@firebase/functions-compat",YU="@firebase/installations",ZU="@firebase/installations-compat",JU="@firebase/messaging",e$="@firebase/messaging-compat",t$="@firebase/performance",n$="@firebase/performance-compat",r$="@firebase/remote-config",s$="@firebase/remote-config-compat",i$="@firebase/storage",a$="@firebase/storage-compat",o$="@firebase/firestore",l$="@firebase/vertexai-preview",c$="@firebase/firestore-compat",u$="firebase",d$="10.14.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tw="[DEFAULT]",h$={[Aw]:"fire-core",[VU]:"fire-core-compat",[UU]:"fire-analytics",[BU]:"fire-analytics-compat",[zU]:"fire-app-check",[$U]:"fire-app-check-compat",[WU]:"fire-auth",[HU]:"fire-auth-compat",[GU]:"fire-rtdb",[qU]:"fire-data-connect",[KU]:"fire-rtdb-compat",[XU]:"fire-fn",[QU]:"fire-fn-compat",[YU]:"fire-iid",[ZU]:"fire-iid-compat",[JU]:"fire-fcm",[e$]:"fire-fcm-compat",[t$]:"fire-perf",[n$]:"fire-perf-compat",[r$]:"fire-rc",[s$]:"fire-rc-compat",[i$]:"fire-gcs",[a$]:"fire-gcs-compat",[o$]:"fire-fst",[c$]:"fire-fst-compat",[l$]:"fire-vertex","fire-js":"fire-js",[u$]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Df=new Map,f$=new Map,Cw=new Map;function iA(t,e){try{t.container.addComponent(e)}catch(n){Po.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Hc(t){const e=t.name;if(Cw.has(e))return Po.debug(`There were multiple attempts to register component ${e}.`),!1;Cw.set(e,t);for(const n of Df.values())iA(n,t);for(const n of f$.values())iA(n,t);return!0}function r1(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function fl(t){return t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m$={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Sl=new mm("app","Firebase",m$);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class p${constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Ll("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Sl.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const au=d$;function qP(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Tw,automaticDataCollectionEnabled:!1},e),s=r.name;if(typeof s!="string"||!s)throw Sl.create("bad-app-name",{appName:String(s)});if(n||(n=$P()),!n)throw Sl.create("no-options");const i=Df.get(s);if(i){if(U0(n,i.options)&&U0(r,i.config))return i;throw Sl.create("duplicate-app",{appName:s})}const l=new vU(s);for(const p of Cw.values())l.addComponent(p);const h=new p$(n,r,l);return Df.set(s,h),h}function Gv(t=Tw){const e=Df.get(t);if(!e&&t===Tw&&$P())return qP();if(!e)throw Sl.create("no-app",{appName:t});return e}function aA(){return Array.from(Df.values())}function ja(t,e,n){var r;let s=(r=h$[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),l=e.match(/\s|\//);if(i||l){const h=[`Unable to register library "${s}" with version "${e}":`];i&&h.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&l&&h.push("and"),l&&h.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Po.warn(h.join(" "));return}Hc(new Ll(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g$="firebase-heartbeat-database",y$=1,Of="firebase-heartbeat-store";let vy=null;function KP(){return vy||(vy=OU(g$,y$,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Of)}catch(n){console.warn(n)}}}}).catch(t=>{throw Sl.create("idb-open",{originalErrorMessage:t.message})})),vy}async function x$(t){try{const n=(await KP()).transaction(Of),r=await n.objectStore(Of).get(XP(t));return await n.done,r}catch(e){if(e instanceof qa)Po.warn(e.message);else{const n=Sl.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});Po.warn(n.message)}}}async function oA(t,e){try{const r=(await KP()).transaction(Of,"readwrite");await r.objectStore(Of).put(e,XP(t)),await r.done}catch(n){if(n instanceof qa)Po.warn(n.message);else{const r=Sl.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});Po.warn(r.message)}}}function XP(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const w$=1024,_$=30*24*60*60*1e3;class v${constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new b$(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=lA();return((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(l=>l.date===i)?void 0:(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter(l=>{const h=new Date(l.date).valueOf();return Date.now()-h<=_$}),this._storage.overwrite(this._heartbeatsCache))}catch(r){Po.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=lA(),{heartbeatsToSend:r,unsentEntries:s}=E$(this._heartbeatsCache.heartbeats),i=B0(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return Po.warn(n),""}}}function lA(){return new Date().toISOString().substring(0,10)}function E$(t,e=w$){const n=[];let r=t.slice();for(const s of t){const i=n.find(l=>l.agent===s.agent);if(i){if(i.dates.push(s.date),cA(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),cA(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class b${constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return cU()?uU().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await x$(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return oA(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return oA(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function cA(t){return B0(JSON.stringify({version:2,heartbeats:t})).length}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I$(t){Hc(new Ll("platform-logger",e=>new jU(e),"PRIVATE")),Hc(new Ll("heartbeat",e=>new v$(e),"PRIVATE")),ja(Aw,sA,t),ja(Aw,sA,"esm2017"),ja("fire-js","")}I$("");var uA=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Pc,QP;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(A,C){function N(){}N.prototype=C.prototype,A.D=C.prototype,A.prototype=new N,A.prototype.constructor=A,A.C=function(D,O,F){for(var R=Array(arguments.length-2),ie=2;ie<arguments.length;ie++)R[ie-2]=arguments[ie];return C.prototype[O].apply(D,R)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(A,C,N){N||(N=0);var D=Array(16);if(typeof C=="string")for(var O=0;16>O;++O)D[O]=C.charCodeAt(N++)|C.charCodeAt(N++)<<8|C.charCodeAt(N++)<<16|C.charCodeAt(N++)<<24;else for(O=0;16>O;++O)D[O]=C[N++]|C[N++]<<8|C[N++]<<16|C[N++]<<24;C=A.g[0],N=A.g[1],O=A.g[2];var F=A.g[3],R=C+(F^N&(O^F))+D[0]+3614090360&4294967295;C=N+(R<<7&4294967295|R>>>25),R=F+(O^C&(N^O))+D[1]+3905402710&4294967295,F=C+(R<<12&4294967295|R>>>20),R=O+(N^F&(C^N))+D[2]+606105819&4294967295,O=F+(R<<17&4294967295|R>>>15),R=N+(C^O&(F^C))+D[3]+3250441966&4294967295,N=O+(R<<22&4294967295|R>>>10),R=C+(F^N&(O^F))+D[4]+4118548399&4294967295,C=N+(R<<7&4294967295|R>>>25),R=F+(O^C&(N^O))+D[5]+1200080426&4294967295,F=C+(R<<12&4294967295|R>>>20),R=O+(N^F&(C^N))+D[6]+2821735955&4294967295,O=F+(R<<17&4294967295|R>>>15),R=N+(C^O&(F^C))+D[7]+4249261313&4294967295,N=O+(R<<22&4294967295|R>>>10),R=C+(F^N&(O^F))+D[8]+1770035416&4294967295,C=N+(R<<7&4294967295|R>>>25),R=F+(O^C&(N^O))+D[9]+2336552879&4294967295,F=C+(R<<12&4294967295|R>>>20),R=O+(N^F&(C^N))+D[10]+4294925233&4294967295,O=F+(R<<17&4294967295|R>>>15),R=N+(C^O&(F^C))+D[11]+2304563134&4294967295,N=O+(R<<22&4294967295|R>>>10),R=C+(F^N&(O^F))+D[12]+1804603682&4294967295,C=N+(R<<7&4294967295|R>>>25),R=F+(O^C&(N^O))+D[13]+4254626195&4294967295,F=C+(R<<12&4294967295|R>>>20),R=O+(N^F&(C^N))+D[14]+2792965006&4294967295,O=F+(R<<17&4294967295|R>>>15),R=N+(C^O&(F^C))+D[15]+1236535329&4294967295,N=O+(R<<22&4294967295|R>>>10),R=C+(O^F&(N^O))+D[1]+4129170786&4294967295,C=N+(R<<5&4294967295|R>>>27),R=F+(N^O&(C^N))+D[6]+3225465664&4294967295,F=C+(R<<9&4294967295|R>>>23),R=O+(C^N&(F^C))+D[11]+643717713&4294967295,O=F+(R<<14&4294967295|R>>>18),R=N+(F^C&(O^F))+D[0]+3921069994&4294967295,N=O+(R<<20&4294967295|R>>>12),R=C+(O^F&(N^O))+D[5]+3593408605&4294967295,C=N+(R<<5&4294967295|R>>>27),R=F+(N^O&(C^N))+D[10]+38016083&4294967295,F=C+(R<<9&4294967295|R>>>23),R=O+(C^N&(F^C))+D[15]+3634488961&4294967295,O=F+(R<<14&4294967295|R>>>18),R=N+(F^C&(O^F))+D[4]+3889429448&4294967295,N=O+(R<<20&4294967295|R>>>12),R=C+(O^F&(N^O))+D[9]+568446438&4294967295,C=N+(R<<5&4294967295|R>>>27),R=F+(N^O&(C^N))+D[14]+3275163606&4294967295,F=C+(R<<9&4294967295|R>>>23),R=O+(C^N&(F^C))+D[3]+4107603335&4294967295,O=F+(R<<14&4294967295|R>>>18),R=N+(F^C&(O^F))+D[8]+1163531501&4294967295,N=O+(R<<20&4294967295|R>>>12),R=C+(O^F&(N^O))+D[13]+2850285829&4294967295,C=N+(R<<5&4294967295|R>>>27),R=F+(N^O&(C^N))+D[2]+4243563512&4294967295,F=C+(R<<9&4294967295|R>>>23),R=O+(C^N&(F^C))+D[7]+1735328473&4294967295,O=F+(R<<14&4294967295|R>>>18),R=N+(F^C&(O^F))+D[12]+2368359562&4294967295,N=O+(R<<20&4294967295|R>>>12),R=C+(N^O^F)+D[5]+4294588738&4294967295,C=N+(R<<4&4294967295|R>>>28),R=F+(C^N^O)+D[8]+2272392833&4294967295,F=C+(R<<11&4294967295|R>>>21),R=O+(F^C^N)+D[11]+1839030562&4294967295,O=F+(R<<16&4294967295|R>>>16),R=N+(O^F^C)+D[14]+4259657740&4294967295,N=O+(R<<23&4294967295|R>>>9),R=C+(N^O^F)+D[1]+2763975236&4294967295,C=N+(R<<4&4294967295|R>>>28),R=F+(C^N^O)+D[4]+1272893353&4294967295,F=C+(R<<11&4294967295|R>>>21),R=O+(F^C^N)+D[7]+4139469664&4294967295,O=F+(R<<16&4294967295|R>>>16),R=N+(O^F^C)+D[10]+3200236656&4294967295,N=O+(R<<23&4294967295|R>>>9),R=C+(N^O^F)+D[13]+681279174&4294967295,C=N+(R<<4&4294967295|R>>>28),R=F+(C^N^O)+D[0]+3936430074&4294967295,F=C+(R<<11&4294967295|R>>>21),R=O+(F^C^N)+D[3]+3572445317&4294967295,O=F+(R<<16&4294967295|R>>>16),R=N+(O^F^C)+D[6]+76029189&4294967295,N=O+(R<<23&4294967295|R>>>9),R=C+(N^O^F)+D[9]+3654602809&4294967295,C=N+(R<<4&4294967295|R>>>28),R=F+(C^N^O)+D[12]+3873151461&4294967295,F=C+(R<<11&4294967295|R>>>21),R=O+(F^C^N)+D[15]+530742520&4294967295,O=F+(R<<16&4294967295|R>>>16),R=N+(O^F^C)+D[2]+3299628645&4294967295,N=O+(R<<23&4294967295|R>>>9),R=C+(O^(N|~F))+D[0]+4096336452&4294967295,C=N+(R<<6&4294967295|R>>>26),R=F+(N^(C|~O))+D[7]+1126891415&4294967295,F=C+(R<<10&4294967295|R>>>22),R=O+(C^(F|~N))+D[14]+2878612391&4294967295,O=F+(R<<15&4294967295|R>>>17),R=N+(F^(O|~C))+D[5]+4237533241&4294967295,N=O+(R<<21&4294967295|R>>>11),R=C+(O^(N|~F))+D[12]+1700485571&4294967295,C=N+(R<<6&4294967295|R>>>26),R=F+(N^(C|~O))+D[3]+2399980690&4294967295,F=C+(R<<10&4294967295|R>>>22),R=O+(C^(F|~N))+D[10]+4293915773&4294967295,O=F+(R<<15&4294967295|R>>>17),R=N+(F^(O|~C))+D[1]+2240044497&4294967295,N=O+(R<<21&4294967295|R>>>11),R=C+(O^(N|~F))+D[8]+1873313359&4294967295,C=N+(R<<6&4294967295|R>>>26),R=F+(N^(C|~O))+D[15]+4264355552&4294967295,F=C+(R<<10&4294967295|R>>>22),R=O+(C^(F|~N))+D[6]+2734768916&4294967295,O=F+(R<<15&4294967295|R>>>17),R=N+(F^(O|~C))+D[13]+1309151649&4294967295,N=O+(R<<21&4294967295|R>>>11),R=C+(O^(N|~F))+D[4]+4149444226&4294967295,C=N+(R<<6&4294967295|R>>>26),R=F+(N^(C|~O))+D[11]+3174756917&4294967295,F=C+(R<<10&4294967295|R>>>22),R=O+(C^(F|~N))+D[2]+718787259&4294967295,O=F+(R<<15&4294967295|R>>>17),R=N+(F^(O|~C))+D[9]+3951481745&4294967295,A.g[0]=A.g[0]+C&4294967295,A.g[1]=A.g[1]+(O+(R<<21&4294967295|R>>>11))&4294967295,A.g[2]=A.g[2]+O&4294967295,A.g[3]=A.g[3]+F&4294967295}r.prototype.u=function(A,C){C===void 0&&(C=A.length);for(var N=C-this.blockSize,D=this.B,O=this.h,F=0;F<C;){if(O==0)for(;F<=N;)s(this,A,F),F+=this.blockSize;if(typeof A=="string"){for(;F<C;)if(D[O++]=A.charCodeAt(F++),O==this.blockSize){s(this,D),O=0;break}}else for(;F<C;)if(D[O++]=A[F++],O==this.blockSize){s(this,D),O=0;break}}this.h=O,this.o+=C},r.prototype.v=function(){var A=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);A[0]=128;for(var C=1;C<A.length-8;++C)A[C]=0;var N=8*this.o;for(C=A.length-8;C<A.length;++C)A[C]=N&255,N/=256;for(this.u(A),A=Array(16),C=N=0;4>C;++C)for(var D=0;32>D;D+=8)A[N++]=this.g[C]>>>D&255;return A};function i(A,C){var N=h;return Object.prototype.hasOwnProperty.call(N,A)?N[A]:N[A]=C(A)}function l(A,C){this.h=C;for(var N=[],D=!0,O=A.length-1;0<=O;O--){var F=A[O]|0;D&&F==C||(N[O]=F,D=!1)}this.g=N}var h={};function p(A){return-128<=A&&128>A?i(A,function(C){return new l([C|0],0>C?-1:0)}):new l([A|0],0>A?-1:0)}function y(A){if(isNaN(A)||!isFinite(A))return E;if(0>A)return H(y(-A));for(var C=[],N=1,D=0;A>=N;D++)C[D]=A/N|0,N*=4294967296;return new l(C,0)}function _(A,C){if(A.length==0)throw Error("number format error: empty string");if(C=C||10,2>C||36<C)throw Error("radix out of range: "+C);if(A.charAt(0)=="-")return H(_(A.substring(1),C));if(0<=A.indexOf("-"))throw Error('number format error: interior "-" character');for(var N=y(Math.pow(C,8)),D=E,O=0;O<A.length;O+=8){var F=Math.min(8,A.length-O),R=parseInt(A.substring(O,O+F),C);8>F?(F=y(Math.pow(C,F)),D=D.j(F).add(y(R))):(D=D.j(N),D=D.add(y(R)))}return D}var E=p(0),T=p(1),k=p(16777216);t=l.prototype,t.m=function(){if(B(this))return-H(this).m();for(var A=0,C=1,N=0;N<this.g.length;N++){var D=this.i(N);A+=(0<=D?D:4294967296+D)*C,C*=4294967296}return A},t.toString=function(A){if(A=A||10,2>A||36<A)throw Error("radix out of range: "+A);if(L(this))return"0";if(B(this))return"-"+H(this).toString(A);for(var C=y(Math.pow(A,6)),N=this,D="";;){var O=$(N,C).g;N=W(N,O.j(C));var F=((0<N.g.length?N.g[0]:N.h)>>>0).toString(A);if(N=O,L(N))return F+D;for(;6>F.length;)F="0"+F;D=F+D}},t.i=function(A){return 0>A?0:A<this.g.length?this.g[A]:this.h};function L(A){if(A.h!=0)return!1;for(var C=0;C<A.g.length;C++)if(A.g[C]!=0)return!1;return!0}function B(A){return A.h==-1}t.l=function(A){return A=W(this,A),B(A)?-1:L(A)?0:1};function H(A){for(var C=A.g.length,N=[],D=0;D<C;D++)N[D]=~A.g[D];return new l(N,~A.h).add(T)}t.abs=function(){return B(this)?H(this):this},t.add=function(A){for(var C=Math.max(this.g.length,A.g.length),N=[],D=0,O=0;O<=C;O++){var F=D+(this.i(O)&65535)+(A.i(O)&65535),R=(F>>>16)+(this.i(O)>>>16)+(A.i(O)>>>16);D=R>>>16,F&=65535,R&=65535,N[O]=R<<16|F}return new l(N,N[N.length-1]&-2147483648?-1:0)};function W(A,C){return A.add(H(C))}t.j=function(A){if(L(this)||L(A))return E;if(B(this))return B(A)?H(this).j(H(A)):H(H(this).j(A));if(B(A))return H(this.j(H(A)));if(0>this.l(k)&&0>A.l(k))return y(this.m()*A.m());for(var C=this.g.length+A.g.length,N=[],D=0;D<2*C;D++)N[D]=0;for(D=0;D<this.g.length;D++)for(var O=0;O<A.g.length;O++){var F=this.i(D)>>>16,R=this.i(D)&65535,ie=A.i(O)>>>16,te=A.i(O)&65535;N[2*D+2*O]+=R*te,M(N,2*D+2*O),N[2*D+2*O+1]+=F*te,M(N,2*D+2*O+1),N[2*D+2*O+1]+=R*ie,M(N,2*D+2*O+1),N[2*D+2*O+2]+=F*ie,M(N,2*D+2*O+2)}for(D=0;D<C;D++)N[D]=N[2*D+1]<<16|N[2*D];for(D=C;D<2*C;D++)N[D]=0;return new l(N,0)};function M(A,C){for(;(A[C]&65535)!=A[C];)A[C+1]+=A[C]>>>16,A[C]&=65535,C++}function U(A,C){this.g=A,this.h=C}function $(A,C){if(L(C))throw Error("division by zero");if(L(A))return new U(E,E);if(B(A))return C=$(H(A),C),new U(H(C.g),H(C.h));if(B(C))return C=$(A,H(C)),new U(H(C.g),C.h);if(30<A.g.length){if(B(A)||B(C))throw Error("slowDivide_ only works with positive integers.");for(var N=T,D=C;0>=D.l(A);)N=K(N),D=K(D);var O=Z(N,1),F=Z(D,1);for(D=Z(D,2),N=Z(N,2);!L(D);){var R=F.add(D);0>=R.l(A)&&(O=O.add(N),F=R),D=Z(D,1),N=Z(N,1)}return C=W(A,O.j(C)),new U(O,C)}for(O=E;0<=A.l(C);){for(N=Math.max(1,Math.floor(A.m()/C.m())),D=Math.ceil(Math.log(N)/Math.LN2),D=48>=D?1:Math.pow(2,D-48),F=y(N),R=F.j(C);B(R)||0<R.l(A);)N-=D,F=y(N),R=F.j(C);L(F)&&(F=T),O=O.add(F),A=W(A,R)}return new U(O,A)}t.A=function(A){return $(this,A).h},t.and=function(A){for(var C=Math.max(this.g.length,A.g.length),N=[],D=0;D<C;D++)N[D]=this.i(D)&A.i(D);return new l(N,this.h&A.h)},t.or=function(A){for(var C=Math.max(this.g.length,A.g.length),N=[],D=0;D<C;D++)N[D]=this.i(D)|A.i(D);return new l(N,this.h|A.h)},t.xor=function(A){for(var C=Math.max(this.g.length,A.g.length),N=[],D=0;D<C;D++)N[D]=this.i(D)^A.i(D);return new l(N,this.h^A.h)};function K(A){for(var C=A.g.length+1,N=[],D=0;D<C;D++)N[D]=A.i(D)<<1|A.i(D-1)>>>31;return new l(N,A.h)}function Z(A,C){var N=C>>5;C%=32;for(var D=A.g.length-N,O=[],F=0;F<D;F++)O[F]=0<C?A.i(F+N)>>>C|A.i(F+N+1)<<32-C:A.i(F+N);return new l(O,A.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,QP=r,l.prototype.add=l.prototype.add,l.prototype.multiply=l.prototype.j,l.prototype.modulo=l.prototype.A,l.prototype.compare=l.prototype.l,l.prototype.toNumber=l.prototype.m,l.prototype.toString=l.prototype.toString,l.prototype.getBits=l.prototype.i,l.fromNumber=y,l.fromString=_,Pc=l}).apply(typeof uA<"u"?uA:typeof self<"u"?self:typeof window<"u"?window:{});var tp=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var YP,Ch,ZP,Fp,Sw,JP,e3,t3;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(c,x,v){return c==Array.prototype||c==Object.prototype||(c[x]=v.value),c};function n(c){c=[typeof globalThis=="object"&&globalThis,c,typeof window=="object"&&window,typeof self=="object"&&self,typeof tp=="object"&&tp];for(var x=0;x<c.length;++x){var v=c[x];if(v&&v.Math==Math)return v}throw Error("Cannot find global object")}var r=n(this);function s(c,x){if(x)e:{var v=r;c=c.split(".");for(var S=0;S<c.length-1;S++){var G=c[S];if(!(G in v))break e;v=v[G]}c=c[c.length-1],S=v[c],x=x(S),x!=S&&x!=null&&e(v,c,{configurable:!0,writable:!0,value:x})}}function i(c,x){c instanceof String&&(c+="");var v=0,S=!1,G={next:function(){if(!S&&v<c.length){var Q=v++;return{value:x(Q,c[Q]),done:!1}}return S=!0,{done:!0,value:void 0}}};return G[Symbol.iterator]=function(){return G},G}s("Array.prototype.values",function(c){return c||function(){return i(this,function(x,v){return v})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var l=l||{},h=this||self;function p(c){var x=typeof c;return x=x!="object"?x:c?Array.isArray(c)?"array":x:"null",x=="array"||x=="object"&&typeof c.length=="number"}function y(c){var x=typeof c;return x=="object"&&c!=null||x=="function"}function _(c,x,v){return c.call.apply(c.bind,arguments)}function E(c,x,v){if(!c)throw Error();if(2<arguments.length){var S=Array.prototype.slice.call(arguments,2);return function(){var G=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(G,S),c.apply(x,G)}}return function(){return c.apply(x,arguments)}}function T(c,x,v){return T=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?_:E,T.apply(null,arguments)}function k(c,x){var v=Array.prototype.slice.call(arguments,1);return function(){var S=v.slice();return S.push.apply(S,arguments),c.apply(this,S)}}function L(c,x){function v(){}v.prototype=x.prototype,c.aa=x.prototype,c.prototype=new v,c.prototype.constructor=c,c.Qb=function(S,G,Q){for(var ue=Array(arguments.length-2),Ot=2;Ot<arguments.length;Ot++)ue[Ot-2]=arguments[Ot];return x.prototype[G].apply(S,ue)}}function B(c){const x=c.length;if(0<x){const v=Array(x);for(let S=0;S<x;S++)v[S]=c[S];return v}return[]}function H(c,x){for(let v=1;v<arguments.length;v++){const S=arguments[v];if(p(S)){const G=c.length||0,Q=S.length||0;c.length=G+Q;for(let ue=0;ue<Q;ue++)c[G+ue]=S[ue]}else c.push(S)}}class W{constructor(x,v){this.i=x,this.j=v,this.h=0,this.g=null}get(){let x;return 0<this.h?(this.h--,x=this.g,this.g=x.next,x.next=null):x=this.i(),x}}function M(c){return/^[\s\xa0]*$/.test(c)}function U(){var c=h.navigator;return c&&(c=c.userAgent)?c:""}function $(c){return $[" "](c),c}$[" "]=function(){};var K=U().indexOf("Gecko")!=-1&&!(U().toLowerCase().indexOf("webkit")!=-1&&U().indexOf("Edge")==-1)&&!(U().indexOf("Trident")!=-1||U().indexOf("MSIE")!=-1)&&U().indexOf("Edge")==-1;function Z(c,x,v){for(const S in c)x.call(v,c[S],S,c)}function A(c,x){for(const v in c)x.call(void 0,c[v],v,c)}function C(c){const x={};for(const v in c)x[v]=c[v];return x}const N="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function D(c,x){let v,S;for(let G=1;G<arguments.length;G++){S=arguments[G];for(v in S)c[v]=S[v];for(let Q=0;Q<N.length;Q++)v=N[Q],Object.prototype.hasOwnProperty.call(S,v)&&(c[v]=S[v])}}function O(c){var x=1;c=c.split(":");const v=[];for(;0<x&&c.length;)v.push(c.shift()),x--;return c.length&&v.push(c.join(":")),v}function F(c){h.setTimeout(()=>{throw c},0)}function R(){var c=qe;let x=null;return c.g&&(x=c.g,c.g=c.g.next,c.g||(c.h=null),x.next=null),x}class ie{constructor(){this.h=this.g=null}add(x,v){const S=te.get();S.set(x,v),this.h?this.h.next=S:this.g=S,this.h=S}}var te=new W(()=>new je,c=>c.reset());class je{constructor(){this.next=this.g=this.h=null}set(x,v){this.h=x,this.g=v,this.next=null}reset(){this.next=this.g=this.h=null}}let We,Ee=!1,qe=new ie,et=()=>{const c=h.Promise.resolve(void 0);We=()=>{c.then(Lt)}};var Lt=()=>{for(var c;c=R();){try{c.h.call(c.g)}catch(v){F(v)}var x=te;x.j(c),100>x.h&&(x.h++,c.next=x.g,x.g=c)}Ee=!1};function Qe(){this.s=this.s,this.C=this.C}Qe.prototype.s=!1,Qe.prototype.ma=function(){this.s||(this.s=!0,this.N())},Qe.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function rt(c,x){this.type=c,this.g=this.target=x,this.defaultPrevented=!1}rt.prototype.h=function(){this.defaultPrevented=!0};var pe=function(){if(!h.addEventListener||!Object.defineProperty)return!1;var c=!1,x=Object.defineProperty({},"passive",{get:function(){c=!0}});try{const v=()=>{};h.addEventListener("test",v,x),h.removeEventListener("test",v,x)}catch{}return c}();function ve(c,x){if(rt.call(this,c?c.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,c){var v=this.type=c.type,S=c.changedTouches&&c.changedTouches.length?c.changedTouches[0]:null;if(this.target=c.target||c.srcElement,this.g=x,x=c.relatedTarget){if(K){e:{try{$(x.nodeName);var G=!0;break e}catch{}G=!1}G||(x=null)}}else v=="mouseover"?x=c.fromElement:v=="mouseout"&&(x=c.toElement);this.relatedTarget=x,S?(this.clientX=S.clientX!==void 0?S.clientX:S.pageX,this.clientY=S.clientY!==void 0?S.clientY:S.pageY,this.screenX=S.screenX||0,this.screenY=S.screenY||0):(this.clientX=c.clientX!==void 0?c.clientX:c.pageX,this.clientY=c.clientY!==void 0?c.clientY:c.pageY,this.screenX=c.screenX||0,this.screenY=c.screenY||0),this.button=c.button,this.key=c.key||"",this.ctrlKey=c.ctrlKey,this.altKey=c.altKey,this.shiftKey=c.shiftKey,this.metaKey=c.metaKey,this.pointerId=c.pointerId||0,this.pointerType=typeof c.pointerType=="string"?c.pointerType:fe[c.pointerType]||"",this.state=c.state,this.i=c,c.defaultPrevented&&ve.aa.h.call(this)}}L(ve,rt);var fe={2:"touch",3:"pen",4:"mouse"};ve.prototype.h=function(){ve.aa.h.call(this);var c=this.i;c.preventDefault?c.preventDefault():c.returnValue=!1};var ke="closure_listenable_"+(1e6*Math.random()|0),Ve=0;function Vt(c,x,v,S,G){this.listener=c,this.proxy=null,this.src=x,this.type=v,this.capture=!!S,this.ha=G,this.key=++Ve,this.da=this.fa=!1}function qt(c){c.da=!0,c.listener=null,c.proxy=null,c.src=null,c.ha=null}function yt(c){this.src=c,this.g={},this.h=0}yt.prototype.add=function(c,x,v,S,G){var Q=c.toString();c=this.g[Q],c||(c=this.g[Q]=[],this.h++);var ue=se(c,x,S,G);return-1<ue?(x=c[ue],v||(x.fa=!1)):(x=new Vt(x,this.src,Q,!!S,G),x.fa=v,c.push(x)),x};function xe(c,x){var v=x.type;if(v in c.g){var S=c.g[v],G=Array.prototype.indexOf.call(S,x,void 0),Q;(Q=0<=G)&&Array.prototype.splice.call(S,G,1),Q&&(qt(x),c.g[v].length==0&&(delete c.g[v],c.h--))}}function se(c,x,v,S){for(var G=0;G<c.length;++G){var Q=c[G];if(!Q.da&&Q.listener==x&&Q.capture==!!v&&Q.ha==S)return G}return-1}var De="closure_lm_"+(1e6*Math.random()|0),Oe={};function Ge(c,x,v,S,G){if(Array.isArray(x)){for(var Q=0;Q<x.length;Q++)Ge(c,x[Q],v,S,G);return null}return v=dn(v),c&&c[ke]?c.K(x,v,y(S)?!!S.capture:!1,G):ht(c,x,v,!1,S,G)}function ht(c,x,v,S,G,Q){if(!x)throw Error("Invalid event type");var ue=y(G)?!!G.capture:!!G,Ot=At(c);if(Ot||(c[De]=Ot=new yt(c)),v=Ot.add(x,v,S,ue,Q),v.proxy)return v;if(S=Et(),v.proxy=S,S.src=c,S.listener=v,c.addEventListener)pe||(G=ue),G===void 0&&(G=!1),c.addEventListener(x.toString(),S,G);else if(c.attachEvent)c.attachEvent(ae(x.toString()),S);else if(c.addListener&&c.removeListener)c.addListener(S);else throw Error("addEventListener and attachEvent are unavailable.");return v}function Et(){function c(v){return x.call(c.src,c.listener,v)}const x=ft;return c}function st(c,x,v,S,G){if(Array.isArray(x))for(var Q=0;Q<x.length;Q++)st(c,x[Q],v,S,G);else S=y(S)?!!S.capture:!!S,v=dn(v),c&&c[ke]?(c=c.i,x=String(x).toString(),x in c.g&&(Q=c.g[x],v=se(Q,v,S,G),-1<v&&(qt(Q[v]),Array.prototype.splice.call(Q,v,1),Q.length==0&&(delete c.g[x],c.h--)))):c&&(c=At(c))&&(x=c.g[x.toString()],c=-1,x&&(c=se(x,v,S,G)),(v=-1<c?x[c]:null)&&me(v))}function me(c){if(typeof c!="number"&&c&&!c.da){var x=c.src;if(x&&x[ke])xe(x.i,c);else{var v=c.type,S=c.proxy;x.removeEventListener?x.removeEventListener(v,S,c.capture):x.detachEvent?x.detachEvent(ae(v),S):x.addListener&&x.removeListener&&x.removeListener(S),(v=At(x))?(xe(v,c),v.h==0&&(v.src=null,x[De]=null)):qt(c)}}}function ae(c){return c in Oe?Oe[c]:Oe[c]="on"+c}function ft(c,x){if(c.da)c=!0;else{x=new ve(x,this);var v=c.listener,S=c.ha||c.src;c.fa&&me(c),c=v.call(S,x)}return c}function At(c){return c=c[De],c instanceof yt?c:null}var Ke="__closure_events_fn_"+(1e9*Math.random()>>>0);function dn(c){return typeof c=="function"?c:(c[Ke]||(c[Ke]=function(x){return c.handleEvent(x)}),c[Ke])}function tt(){Qe.call(this),this.i=new yt(this),this.M=this,this.F=null}L(tt,Qe),tt.prototype[ke]=!0,tt.prototype.removeEventListener=function(c,x,v,S){st(this,c,x,v,S)};function ot(c,x){var v,S=c.F;if(S)for(v=[];S;S=S.F)v.push(S);if(c=c.M,S=x.type||x,typeof x=="string")x=new rt(x,c);else if(x instanceof rt)x.target=x.target||c;else{var G=x;x=new rt(S,c),D(x,G)}if(G=!0,v)for(var Q=v.length-1;0<=Q;Q--){var ue=x.g=v[Q];G=jt(ue,S,!0,x)&&G}if(ue=x.g=c,G=jt(ue,S,!0,x)&&G,G=jt(ue,S,!1,x)&&G,v)for(Q=0;Q<v.length;Q++)ue=x.g=v[Q],G=jt(ue,S,!1,x)&&G}tt.prototype.N=function(){if(tt.aa.N.call(this),this.i){var c=this.i,x;for(x in c.g){for(var v=c.g[x],S=0;S<v.length;S++)qt(v[S]);delete c.g[x],c.h--}}this.F=null},tt.prototype.K=function(c,x,v,S){return this.i.add(String(c),x,!1,v,S)},tt.prototype.L=function(c,x,v,S){return this.i.add(String(c),x,!0,v,S)};function jt(c,x,v,S){if(x=c.i.g[String(x)],!x)return!0;x=x.concat();for(var G=!0,Q=0;Q<x.length;++Q){var ue=x[Q];if(ue&&!ue.da&&ue.capture==v){var Ot=ue.listener,gn=ue.ha||ue.src;ue.fa&&xe(c.i,ue),G=Ot.call(gn,S)!==!1&&G}}return G&&!S.defaultPrevented}function Kt(c,x,v){if(typeof c=="function")v&&(c=T(c,v));else if(c&&typeof c.handleEvent=="function")c=T(c.handleEvent,c);else throw Error("Invalid listener argument");return 2147483647<Number(x)?-1:h.setTimeout(c,x||0)}function ar(c){c.g=Kt(()=>{c.g=null,c.i&&(c.i=!1,ar(c))},c.l);const x=c.h;c.h=null,c.m.apply(null,x)}class Xt extends Qe{constructor(x,v){super(),this.m=x,this.l=v,this.h=null,this.i=!1,this.g=null}j(x){this.h=arguments,this.g?this.i=!0:ar(this)}N(){super.N(),this.g&&(h.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function xn(c){Qe.call(this),this.h=c,this.g={}}L(xn,Qe);var Mt=[];function we(c){Z(c.g,function(x,v){this.g.hasOwnProperty(v)&&me(x)},c),c.g={}}xn.prototype.N=function(){xn.aa.N.call(this),we(this)},xn.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Tt=h.JSON.stringify,Rt=h.JSON.parse,wt=class{stringify(c){return h.JSON.stringify(c,void 0)}parse(c){return h.JSON.parse(c,void 0)}};function bt(){}bt.prototype.h=null;function ce(c){return c.h||(c.h=c.i())}function Ie(){}var be={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Ce(){rt.call(this,"d")}L(Ce,rt);function it(){rt.call(this,"c")}L(it,rt);var He={},un=null;function wn(){return un=un||new tt}He.La="serverreachability";function Bt(c){rt.call(this,He.La,c)}L(Bt,rt);function Ht(c){const x=wn();ot(x,new Bt(x))}He.STAT_EVENT="statevent";function Rn(c,x){rt.call(this,He.STAT_EVENT,c),this.stat=x}L(Rn,rt);function nt(c){const x=wn();ot(x,new Rn(x,c))}He.Ma="timingevent";function ee(c,x){rt.call(this,He.Ma,c),this.size=x}L(ee,rt);function J(c,x){if(typeof c!="function")throw Error("Fn must not be null and must be a function");return h.setTimeout(function(){c()},x)}function oe(){this.g=!0}oe.prototype.xa=function(){this.g=!1};function _e(c,x,v,S,G,Q){c.info(function(){if(c.g)if(Q)for(var ue="",Ot=Q.split("&"),gn=0;gn<Ot.length;gn++){var mt=Ot[gn].split("=");if(1<mt.length){var fn=mt[0];mt=mt[1];var En=fn.split("_");ue=2<=En.length&&En[1]=="type"?ue+(fn+"="+mt+"&"):ue+(fn+"=redacted&")}}else ue=null;else ue=Q;return"XMLHTTP REQ ("+S+") [attempt "+G+"]: "+x+`
`+v+`
`+ue})}function Se(c,x,v,S,G,Q,ue){c.info(function(){return"XMLHTTP RESP ("+S+") [ attempt "+G+"]: "+x+`
`+v+`
`+Q+" "+ue})}function $e(c,x,v,S){c.info(function(){return"XMLHTTP TEXT ("+x+"): "+Ye(c,v)+(S?" "+S:"")})}function ge(c,x){c.info(function(){return"TIMEOUT: "+x})}oe.prototype.info=function(){};function Ye(c,x){if(!c.g)return x;if(!x)return null;try{var v=JSON.parse(x);if(v){for(c=0;c<v.length;c++)if(Array.isArray(v[c])){var S=v[c];if(!(2>S.length)){var G=S[1];if(Array.isArray(G)&&!(1>G.length)){var Q=G[0];if(Q!="noop"&&Q!="stop"&&Q!="close")for(var ue=1;ue<G.length;ue++)G[ue]=""}}}}return Tt(v)}catch{return x}}var Ze={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},Fe={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Je;function Ct(){}L(Ct,bt),Ct.prototype.g=function(){return new XMLHttpRequest},Ct.prototype.i=function(){return{}},Je=new Ct;function St(c,x,v,S){this.j=c,this.i=x,this.l=v,this.R=S||1,this.U=new xn(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new lt}function lt(){this.i=null,this.g="",this.h=!1}var xt={},Wt={};function Pt(c,x,v){c.L=1,c.v=er(tn(x)),c.m=v,c.P=!0,bn(c,null)}function bn(c,x){c.F=Date.now(),vn(c),c.A=tn(c.v);var v=c.A,S=c.R;Array.isArray(S)||(S=[String(S)]),wr(v.i,"t",S),c.C=0,v=c.j.J,c.h=new lt,c.g=nc(c.j,v?x:null,!c.m),0<c.O&&(c.M=new Xt(T(c.Y,c,c.g),c.O)),x=c.U,v=c.g,S=c.ca;var G="readystatechange";Array.isArray(G)||(G&&(Mt[0]=G.toString()),G=Mt);for(var Q=0;Q<G.length;Q++){var ue=Ge(v,G[Q],S||x.handleEvent,!1,x.h||x);if(!ue)break;x.g[ue.key]=ue}x=c.H?C(c.H):{},c.m?(c.u||(c.u="POST"),x["Content-Type"]="application/x-www-form-urlencoded",c.g.ea(c.A,c.u,c.m,x)):(c.u="GET",c.g.ea(c.A,c.u,null,x)),Ht(),_e(c.i,c.u,c.A,c.l,c.R,c.m)}St.prototype.ca=function(c){c=c.target;const x=this.M;x&&Mr(c)==3?x.j():this.Y(c)},St.prototype.Y=function(c){try{if(c==this.g)e:{const En=Mr(this.g);var x=this.g.Ba();const lr=this.g.Z();if(!(3>En)&&(En!=3||this.g&&(this.h.h||this.g.oa()||Jl(this.g)))){this.J||En!=4||x==7||(x==8||0>=lr?Ht(3):Ht(2)),Ae(this);var v=this.g.Z();this.X=v;t:if(hn(this)){var S=Jl(this.g);c="";var G=S.length,Q=Mr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Gt(this),jn(this);var ue="";break t}this.h.i=new h.TextDecoder}for(x=0;x<G;x++)this.h.h=!0,c+=this.h.i.decode(S[x],{stream:!(Q&&x==G-1)});S.length=0,this.h.g+=c,this.C=0,ue=this.h.g}else ue=this.g.oa();if(this.o=v==200,Se(this.i,this.u,this.A,this.l,this.R,En,v),this.o){if(this.T&&!this.K){t:{if(this.g){var Ot,gn=this.g;if((Ot=gn.g?gn.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!M(Ot)){var mt=Ot;break t}}mt=null}if(v=mt)$e(this.i,this.l,v,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Jn(this,v);else{this.o=!1,this.s=3,nt(12),Gt(this),jn(this);break e}}if(this.P){v=!0;let cr;for(;!this.J&&this.C<ue.length;)if(cr=Er(this,ue),cr==Wt){En==4&&(this.s=4,nt(14),v=!1),$e(this.i,this.l,null,"[Incomplete Response]");break}else if(cr==xt){this.s=4,nt(15),$e(this.i,this.l,ue,"[Invalid Chunk]"),v=!1;break}else $e(this.i,this.l,cr,null),Jn(this,cr);if(hn(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),En!=4||ue.length!=0||this.h.h||(this.s=1,nt(16),v=!1),this.o=this.o&&v,!v)$e(this.i,this.l,ue,"[Invalid Chunked Response]"),Gt(this),jn(this);else if(0<ue.length&&!this.W){this.W=!0;var fn=this.j;fn.g==this&&fn.ba&&!fn.M&&(fn.j.info("Great, no buffering proxy detected. Bytes received: "+ue.length),Ki(fn),fn.M=!0,nt(11))}}else $e(this.i,this.l,ue,null),Jn(this,ue);En==4&&Gt(this),this.o&&!this.J&&(En==4?tr(this.j,this):(this.o=!1,vn(this)))}else $n(this.g),v==400&&0<ue.indexOf("Unknown SID")?(this.s=3,nt(12)):(this.s=0,nt(13)),Gt(this),jn(this)}}}catch{}finally{}};function hn(c){return c.g?c.u=="GET"&&c.L!=2&&c.j.Ca:!1}function Er(c,x){var v=c.C,S=x.indexOf(`
`,v);return S==-1?Wt:(v=Number(x.substring(v,S)),isNaN(v)?xt:(S+=1,S+v>x.length?Wt:(x=x.slice(S,S+v),c.C=S+v,x)))}St.prototype.cancel=function(){this.J=!0,Gt(this)};function vn(c){c.S=Date.now()+c.I,Qr(c,c.I)}function Qr(c,x){if(c.B!=null)throw Error("WatchDog timer not null");c.B=J(T(c.ba,c),x)}function Ae(c){c.B&&(h.clearTimeout(c.B),c.B=null)}St.prototype.ba=function(){this.B=null;const c=Date.now();0<=c-this.S?(ge(this.i,this.A),this.L!=2&&(Ht(),nt(17)),Gt(this),this.s=2,jn(this)):Qr(this,this.S-c)};function jn(c){c.j.G==0||c.J||tr(c.j,c)}function Gt(c){Ae(c);var x=c.M;x&&typeof x.ma=="function"&&x.ma(),c.M=null,we(c.U),c.g&&(x=c.g,c.g=null,x.abort(),x.ma())}function Jn(c,x){try{var v=c.j;if(v.G!=0&&(v.g==c||pn(v.h,c))){if(!c.K&&pn(v.h,c)&&v.G==3){try{var S=v.Da.g.parse(x)}catch{S=null}if(Array.isArray(S)&&S.length==3){var G=S;if(G[0]==0){e:if(!v.u){if(v.g)if(v.g.F+3e3<c.F)xi(v),qi(v);else break e;Za(v),nt(18)}}else v.za=G[1],0<v.za-v.T&&37500>G[2]&&v.F&&v.v==0&&!v.C&&(v.C=J(T(v.Za,v),6e3));if(1>=Ut(v.h)&&v.ca){try{v.ca()}catch{}v.ca=void 0}}else br(v,11)}else if((c.K||v.g==c)&&xi(v),!M(x))for(G=v.Da.g.parse(x),x=0;x<G.length;x++){let mt=G[x];if(v.T=mt[0],mt=mt[1],v.G==2)if(mt[0]=="c"){v.K=mt[1],v.ia=mt[2];const fn=mt[3];fn!=null&&(v.la=fn,v.j.info("VER="+v.la));const En=mt[4];En!=null&&(v.Aa=En,v.j.info("SVER="+v.Aa));const lr=mt[5];lr!=null&&typeof lr=="number"&&0<lr&&(S=1.5*lr,v.L=S,v.j.info("backChannelRequestTimeoutMs_="+S)),S=v;const cr=c.g;if(cr){const zr=cr.g?cr.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(zr){var Q=S.h;Q.g||zr.indexOf("spdy")==-1&&zr.indexOf("quic")==-1&&zr.indexOf("h2")==-1||(Q.j=Q.l,Q.g=new Set,Q.h&&(hr(Q,Q.h),Q.h=null))}if(S.D){const Ja=cr.g?cr.g.getResponseHeader("X-HTTP-Session-Id"):null;Ja&&(S.ya=Ja,Pe(S.I,S.D,Ja))}}v.G=3,v.l&&v.l.ua(),v.ba&&(v.R=Date.now()-c.F,v.j.info("Handshake RTT: "+v.R+"ms")),S=v;var ue=c;if(S.qa=Dt(S,S.J?S.ia:null,S.W),ue.K){qs(S.h,ue);var Ot=ue,gn=S.L;gn&&(Ot.I=gn),Ot.B&&(Ae(Ot),vn(Ot)),S.g=ue}else tc(S);0<v.i.length&&Qt(v)}else mt[0]!="stop"&&mt[0]!="close"||br(v,7);else v.G==3&&(mt[0]=="stop"||mt[0]=="close"?mt[0]=="stop"?br(v,7):Es(v):mt[0]!="noop"&&v.l&&v.l.ta(mt),v.v=0)}}Ht(4)}catch{}}var en=class{constructor(c,x){this.g=c,this.map=x}};function ct(c){this.l=c||10,h.PerformanceNavigationTiming?(c=h.performance.getEntriesByType("navigation"),c=0<c.length&&(c[0].nextHopProtocol=="hq"||c[0].nextHopProtocol=="h2")):c=!!(h.chrome&&h.chrome.loadTimes&&h.chrome.loadTimes()&&h.chrome.loadTimes().wasFetchedViaSpdy),this.j=c?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function It(c){return c.h?!0:c.g?c.g.size>=c.j:!1}function Ut(c){return c.h?1:c.g?c.g.size:0}function pn(c,x){return c.h?c.h==x:c.g?c.g.has(x):!1}function hr(c,x){c.g?c.g.add(x):c.h=x}function qs(c,x){c.h&&c.h==x?c.h=null:c.g&&c.g.has(x)&&c.g.delete(x)}ct.prototype.cancel=function(){if(this.i=Hn(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const c of this.g.values())c.cancel();this.g.clear()}};function Hn(c){if(c.h!=null)return c.i.concat(c.h.D);if(c.g!=null&&c.g.size!==0){let x=c.i;for(const v of c.g.values())x=x.concat(v.D);return x}return B(c.i)}function Ks(c){if(c.V&&typeof c.V=="function")return c.V();if(typeof Map<"u"&&c instanceof Map||typeof Set<"u"&&c instanceof Set)return Array.from(c.values());if(typeof c=="string")return c.split("");if(p(c)){for(var x=[],v=c.length,S=0;S<v;S++)x.push(c[S]);return x}x=[],v=0;for(S in c)x[v++]=c[S];return x}function Xl(c){if(c.na&&typeof c.na=="function")return c.na();if(!c.V||typeof c.V!="function"){if(typeof Map<"u"&&c instanceof Map)return Array.from(c.keys());if(!(typeof Set<"u"&&c instanceof Set)){if(p(c)||typeof c=="string"){var x=[];c=c.length;for(var v=0;v<c;v++)x.push(v);return x}x=[],v=0;for(const S in c)x[v++]=S;return x}}}function nr(c,x){if(c.forEach&&typeof c.forEach=="function")c.forEach(x,void 0);else if(p(c)||typeof c=="string")Array.prototype.forEach.call(c,x,void 0);else for(var v=Xl(c),S=Ks(c),G=S.length,Q=0;Q<G;Q++)x.call(void 0,S[Q],v&&v[Q],c)}var Xs=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Hd(c,x){if(c){c=c.split("&");for(var v=0;v<c.length;v++){var S=c[v].indexOf("="),G=null;if(0<=S){var Q=c[v].substring(0,S);G=c[v].substring(S+1)}else Q=c[v];x(Q,G?decodeURIComponent(G.replace(/\+/g," ")):"")}}}function Nr(c){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,c instanceof Nr){this.h=c.h,or(this,c.j),this.o=c.o,this.g=c.g,le(this,c.s),this.l=c.l;var x=c.i,v=new Ls;v.i=x.i,x.g&&(v.g=new Map(x.g),v.h=x.h),X(this,v),this.m=c.m}else c&&(x=String(c).match(Xs))?(this.h=!1,or(this,x[1]||"",!0),this.o=xr(x[2]||""),this.g=xr(x[3]||"",!0),le(this,x[4]),this.l=xr(x[5]||"",!0),X(this,x[6]||"",!0),this.m=xr(x[7]||"")):(this.h=!1,this.i=new Ls(null,this.h))}Nr.prototype.toString=function(){var c=[],x=this.j;x&&c.push(fi(x,ts,!0),":");var v=this.g;return(v||x=="file")&&(c.push("//"),(x=this.o)&&c.push(fi(x,ts,!0),"@"),c.push(encodeURIComponent(String(v)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),v=this.s,v!=null&&c.push(":",String(v))),(v=this.l)&&(this.g&&v.charAt(0)!="/"&&c.push("/"),c.push(fi(v,v.charAt(0)=="/"?rr:kt,!0))),(v=this.i.toString())&&c.push("?",v),(v=this.m)&&c.push("#",fi(v,Gd)),c.join("")};function tn(c){return new Nr(c)}function or(c,x,v){c.j=v?xr(x,!0):x,c.j&&(c.j=c.j.replace(/:$/,""))}function le(c,x){if(x){if(x=Number(x),isNaN(x)||0>x)throw Error("Bad port number "+x);c.s=x}else c.s=null}function X(c,x,v){x instanceof Ls?(c.i=x,ki(c.i,c.h)):(v||(x=fi(x,uu)),c.i=new Ls(x,c.h))}function Pe(c,x,v){c.i.set(x,v)}function er(c){return Pe(c,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),c}function xr(c,x){return c?x?decodeURI(c.replace(/%25/g,"%2525")):decodeURIComponent(c):""}function fi(c,x,v){return typeof c=="string"?(c=encodeURI(c).replace(x,Ql),v&&(c=c.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c):null}function Ql(c){return c=c.charCodeAt(0),"%"+(c>>4&15).toString(16)+(c&15).toString(16)}var ts=/[#\/\?@]/g,kt=/[#\?:]/g,rr=/[#\?]/g,uu=/[#\?@]/g,Gd=/#/g;function Ls(c,x){this.h=this.g=null,this.i=c||null,this.j=!!x}function Rr(c){c.g||(c.g=new Map,c.h=0,c.i&&Hd(c.i,function(x,v){c.add(decodeURIComponent(x.replace(/\+/g," ")),v)}))}t=Ls.prototype,t.add=function(c,x){Rr(this),this.i=null,c=Yr(this,c);var v=this.g.get(c);return v||this.g.set(c,v=[]),v.push(x),this.h+=1,this};function Xa(c,x){Rr(c),x=Yr(c,x),c.g.has(x)&&(c.i=null,c.h-=c.g.get(x).length,c.g.delete(x))}function Yl(c,x){return Rr(c),x=Yr(c,x),c.g.has(x)}t.forEach=function(c,x){Rr(this),this.g.forEach(function(v,S){v.forEach(function(G){c.call(x,G,S,this)},this)},this)},t.na=function(){Rr(this);const c=Array.from(this.g.values()),x=Array.from(this.g.keys()),v=[];for(let S=0;S<x.length;S++){const G=c[S];for(let Q=0;Q<G.length;Q++)v.push(x[S])}return v},t.V=function(c){Rr(this);let x=[];if(typeof c=="string")Yl(this,c)&&(x=x.concat(this.g.get(Yr(this,c))));else{c=Array.from(this.g.values());for(let v=0;v<c.length;v++)x=x.concat(c[v])}return x},t.set=function(c,x){return Rr(this),this.i=null,c=Yr(this,c),Yl(this,c)&&(this.h-=this.g.get(c).length),this.g.set(c,[x]),this.h+=1,this},t.get=function(c,x){return c?(c=this.V(c),0<c.length?String(c[0]):x):x};function wr(c,x,v){Xa(c,x),0<v.length&&(c.i=null,c.g.set(Yr(c,x),B(v)),c.h+=v.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const c=[],x=Array.from(this.g.keys());for(var v=0;v<x.length;v++){var S=x[v];const Q=encodeURIComponent(String(S)),ue=this.V(S);for(S=0;S<ue.length;S++){var G=Q;ue[S]!==""&&(G+="="+encodeURIComponent(String(ue[S]))),c.push(G)}}return this.i=c.join("&")};function Yr(c,x){return x=String(x),c.j&&(x=x.toLowerCase()),x}function ki(c,x){x&&!c.j&&(Rr(c),c.i=null,c.g.forEach(function(v,S){var G=S.toLowerCase();S!=G&&(Xa(this,S),wr(this,G,v))},c)),c.j=x}function $t(c,x){const v=new oe;if(h.Image){const S=new Image;S.onload=k(Nt,v,"TestLoadImage: loaded",!0,x,S),S.onerror=k(Nt,v,"TestLoadImage: error",!1,x,S),S.onabort=k(Nt,v,"TestLoadImage: abort",!1,x,S),S.ontimeout=k(Nt,v,"TestLoadImage: timeout",!1,x,S),h.setTimeout(function(){S.ontimeout&&S.ontimeout()},1e4),S.src=c}else x(!1)}function qd(c,x){const v=new oe,S=new AbortController,G=setTimeout(()=>{S.abort(),Nt(v,"TestPingServer: timeout",!1,x)},1e4);fetch(c,{signal:S.signal}).then(Q=>{clearTimeout(G),Q.ok?Nt(v,"TestPingServer: ok",!0,x):Nt(v,"TestPingServer: server error",!1,x)}).catch(()=>{clearTimeout(G),Nt(v,"TestPingServer: error",!1,x)})}function Nt(c,x,v,S,G){try{G&&(G.onload=null,G.onerror=null,G.onabort=null,G.ontimeout=null),S(v)}catch{}}function Or(){this.g=new wt}function Kd(c,x,v){const S=v||"";try{nr(c,function(G,Q){let ue=G;y(G)&&(ue=Tt(G)),x.push(S+Q+"="+encodeURIComponent(ue))})}catch(G){throw x.push(S+"type="+encodeURIComponent("_badmap")),G}}function mi(c){this.l=c.Ub||null,this.j=c.eb||!1}L(mi,bt),mi.prototype.g=function(){return new Di(this.l,this.j)},mi.prototype.i=function(c){return function(){return c}}({});function Di(c,x){tt.call(this),this.D=c,this.o=x,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}L(Di,tt),t=Di.prototype,t.open=function(c,x){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=c,this.A=x,this.readyState=1,ds(this)},t.send=function(c){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const x={headers:this.u,method:this.B,credentials:this.m,cache:void 0};c&&(x.body=c),(this.D||h).fetch(new Request(this.A,x)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,gi(this)),this.readyState=0},t.Sa=function(c){if(this.g&&(this.l=c,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=c.headers,this.readyState=2,ds(this)),this.g&&(this.readyState=3,ds(this),this.g)))if(this.responseType==="arraybuffer")c.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof h.ReadableStream<"u"&&"body"in c){if(this.j=c.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;pi(this)}else c.text().then(this.Ra.bind(this),this.ga.bind(this))};function pi(c){c.j.read().then(c.Pa.bind(c)).catch(c.ga.bind(c))}t.Pa=function(c){if(this.g){if(this.o&&c.value)this.response.push(c.value);else if(!this.o){var x=c.value?c.value:new Uint8Array(0);(x=this.v.decode(x,{stream:!c.done}))&&(this.response=this.responseText+=x)}c.done?gi(this):ds(this),this.readyState==3&&pi(this)}},t.Ra=function(c){this.g&&(this.response=this.responseText=c,gi(this))},t.Qa=function(c){this.g&&(this.response=c,gi(this))},t.ga=function(){this.g&&gi(this)};function gi(c){c.readyState=4,c.l=null,c.j=null,c.v=null,ds(c)}t.setRequestHeader=function(c,x){this.u.append(c,x)},t.getResponseHeader=function(c){return this.h&&this.h.get(c.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const c=[],x=this.h.entries();for(var v=x.next();!v.done;)v=v.value,c.push(v[0]+": "+v[1]),v=x.next();return c.join(`\r
`)};function ds(c){c.onreadystatechange&&c.onreadystatechange.call(c)}Object.defineProperty(Di.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(c){this.m=c?"include":"same-origin"}});function Gi(c){let x="";return Z(c,function(v,S){x+=S,x+=":",x+=v,x+=`\r
`}),x}function yi(c,x,v){e:{for(S in v){var S=!1;break e}S=!0}S||(v=Gi(v),typeof c=="string"?v!=null&&encodeURIComponent(String(v)):Pe(c,x,v))}function Zt(c){tt.call(this),this.headers=new Map,this.o=c||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}L(Zt,tt);var Qa=/^https?$/i,Ya=["POST","PUT"];t=Zt.prototype,t.Ha=function(c){this.J=c},t.ea=function(c,x,v,S){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+c);x=x?x.toUpperCase():"GET",this.D=c,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Je.g(),this.v=this.o?ce(this.o):ce(Je),this.g.onreadystatechange=T(this.Ea,this);try{this.B=!0,this.g.open(x,String(c),!0),this.B=!1}catch(Q){$r(this,Q);return}if(c=v||"",v=new Map(this.headers),S)if(Object.getPrototypeOf(S)===Object.prototype)for(var G in S)v.set(G,S[G]);else if(typeof S.keys=="function"&&typeof S.get=="function")for(const Q of S.keys())v.set(Q,S.get(Q));else throw Error("Unknown input type for opt_headers: "+String(S));S=Array.from(v.keys()).find(Q=>Q.toLowerCase()=="content-type"),G=h.FormData&&c instanceof h.FormData,!(0<=Array.prototype.indexOf.call(Ya,x,void 0))||S||G||v.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Q,ue]of v)this.g.setRequestHeader(Q,ue);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Zl(this),this.u=!0,this.g.send(c),this.u=!1}catch(Q){$r(this,Q)}};function $r(c,x){c.h=!1,c.g&&(c.j=!0,c.g.abort(),c.j=!1),c.l=x,c.m=5,$o(c),Oi(c)}function $o(c){c.A||(c.A=!0,ot(c,"complete"),ot(c,"error"))}t.abort=function(c){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=c||7,ot(this,"complete"),ot(this,"abort"),Oi(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Oi(this,!0)),Zt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?zo(this):this.bb())},t.bb=function(){zo(this)};function zo(c){if(c.h&&typeof l<"u"&&(!c.v[1]||Mr(c)!=4||c.Z()!=2)){if(c.u&&Mr(c)==4)Kt(c.Ea,0,c);else if(ot(c,"readystatechange"),Mr(c)==4){c.h=!1;try{const ue=c.Z();e:switch(ue){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var x=!0;break e;default:x=!1}var v;if(!(v=x)){var S;if(S=ue===0){var G=String(c.D).match(Xs)[1]||null;!G&&h.self&&h.self.location&&(G=h.self.location.protocol.slice(0,-1)),S=!Qa.test(G?G.toLowerCase():"")}v=S}if(v)ot(c,"complete"),ot(c,"success");else{c.m=6;try{var Q=2<Mr(c)?c.g.statusText:""}catch{Q=""}c.l=Q+" ["+c.Z()+"]",$o(c)}}finally{Oi(c)}}}}function Oi(c,x){if(c.g){Zl(c);const v=c.g,S=c.v[0]?()=>{}:null;c.g=null,c.v=null,x||ot(c,"ready");try{v.onreadystatechange=S}catch{}}}function Zl(c){c.I&&(h.clearTimeout(c.I),c.I=null)}t.isActive=function(){return!!this.g};function Mr(c){return c.g?c.g.readyState:0}t.Z=function(){try{return 2<Mr(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(c){if(this.g){var x=this.g.responseText;return c&&x.indexOf(c)==0&&(x=x.substring(c.length)),Rt(x)}};function Jl(c){try{if(!c.g)return null;if("response"in c.g)return c.g.response;switch(c.H){case"":case"text":return c.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in c.g)return c.g.mozResponseArrayBuffer}return null}catch{return null}}function $n(c){const x={};c=(c.g&&2<=Mr(c)&&c.g.getAllResponseHeaders()||"").split(`\r
`);for(let S=0;S<c.length;S++){if(M(c[S]))continue;var v=O(c[S]);const G=v[0];if(v=v[1],typeof v!="string")continue;v=v.trim();const Q=x[G]||[];x[G]=Q,Q.push(v)}A(x,function(S){return S.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Qs(c,x,v){return v&&v.internalChannelParams&&v.internalChannelParams[c]||x}function pa(c){this.Aa=0,this.i=[],this.j=new oe,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Qs("failFast",!1,c),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Qs("baseRetryDelayMs",5e3,c),this.cb=Qs("retryDelaySeedMs",1e4,c),this.Wa=Qs("forwardChannelMaxRetries",2,c),this.wa=Qs("forwardChannelRequestTimeoutMs",2e4,c),this.pa=c&&c.xmlHttpFactory||void 0,this.Xa=c&&c.Tb||void 0,this.Ca=c&&c.useFetchStreams||!1,this.L=void 0,this.J=c&&c.supportsCrossDomainXhr||!1,this.K="",this.h=new ct(c&&c.concurrentRequestLimit),this.Da=new Or,this.P=c&&c.fastHandshake||!1,this.O=c&&c.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=c&&c.Rb||!1,c&&c.xa&&this.j.xa(),c&&c.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&c&&c.detectBufferingProxy||!1,this.ja=void 0,c&&c.longPollingTimeout&&0<c.longPollingTimeout&&(this.ja=c.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=pa.prototype,t.la=8,t.G=1,t.connect=function(c,x,v,S){nt(0),this.W=c,this.H=x||{},v&&S!==void 0&&(this.H.OSID=v,this.H.OAID=S),this.F=this.X,this.I=Dt(this,null,this.W),Qt(this)};function Es(c){if(he(c),c.G==3){var x=c.U++,v=tn(c.I);if(Pe(v,"SID",c.K),Pe(v,"RID",x),Pe(v,"TYPE","terminate"),Ys(c,v),x=new St(c,c.j,x),x.L=2,x.v=er(tn(v)),v=!1,h.navigator&&h.navigator.sendBeacon)try{v=h.navigator.sendBeacon(x.v.toString(),"")}catch{}!v&&h.Image&&(new Image().src=x.v,v=!0),v||(x.g=nc(x.j,null),x.g.ea(x.v)),x.F=Date.now(),vn(x)}Fn(c)}function qi(c){c.g&&(Ki(c),c.g.cancel(),c.g=null)}function he(c){qi(c),c.u&&(h.clearTimeout(c.u),c.u=null),xi(c),c.h.cancel(),c.s&&(typeof c.s=="number"&&h.clearTimeout(c.s),c.s=null)}function Qt(c){if(!It(c.h)&&!c.s){c.s=!0;var x=c.Ga;We||et(),Ee||(We(),Ee=!0),qe.add(x,c),c.B=0}}function Lr(c,x){return Ut(c.h)>=c.h.j-(c.s?1:0)?!1:c.s?(c.i=x.D.concat(c.i),!0):c.G==1||c.G==2||c.B>=(c.Va?0:c.Wa)?!1:(c.s=J(T(c.Ga,c,x),ya(c,c.B)),c.B++,!0)}t.Ga=function(c){if(this.s)if(this.s=null,this.G==1){if(!c){this.U=Math.floor(1e5*Math.random()),c=this.U++;const G=new St(this,this.j,c);let Q=this.o;if(this.S&&(Q?(Q=C(Q),D(Q,this.S)):Q=this.S),this.m!==null||this.O||(G.H=Q,Q=null),this.P)e:{for(var x=0,v=0;v<this.i.length;v++){t:{var S=this.i[v];if("__data__"in S.map&&(S=S.map.__data__,typeof S=="string")){S=S.length;break t}S=void 0}if(S===void 0)break;if(x+=S,4096<x){x=v;break e}if(x===4096||v===this.i.length-1){x=v+1;break e}}x=1e3}else x=1e3;x=ec(this,G,x),v=tn(this.I),Pe(v,"RID",c),Pe(v,"CVER",22),this.D&&Pe(v,"X-HTTP-Session-Id",this.D),Ys(this,v),Q&&(this.O?x="headers="+encodeURIComponent(String(Gi(Q)))+"&"+x:this.m&&yi(v,this.m,Q)),hr(this.h,G),this.Ua&&Pe(v,"TYPE","init"),this.P?(Pe(v,"$req",x),Pe(v,"SID","null"),G.T=!0,Pt(G,v,null)):Pt(G,v,x),this.G=2}}else this.G==3&&(c?ga(this,c):this.i.length==0||It(this.h)||ga(this))};function ga(c,x){var v;x?v=x.l:v=c.U++;const S=tn(c.I);Pe(S,"SID",c.K),Pe(S,"RID",v),Pe(S,"AID",c.T),Ys(c,S),c.m&&c.o&&yi(S,c.m,c.o),v=new St(c,c.j,v,c.B+1),c.m===null&&(v.H=c.o),x&&(c.i=x.D.concat(c.i)),x=ec(c,v,1e3),v.I=Math.round(.5*c.wa)+Math.round(.5*c.wa*Math.random()),hr(c.h,v),Pt(v,S,x)}function Ys(c,x){c.H&&Z(c.H,function(v,S){Pe(x,S,v)}),c.l&&nr({},function(v,S){Pe(x,S,v)})}function ec(c,x,v){v=Math.min(c.i.length,v);var S=c.l?T(c.l.Na,c.l,c):null;e:{var G=c.i;let Q=-1;for(;;){const ue=["count="+v];Q==-1?0<v?(Q=G[0].g,ue.push("ofs="+Q)):Q=0:ue.push("ofs="+Q);let Ot=!0;for(let gn=0;gn<v;gn++){let mt=G[gn].g;const fn=G[gn].map;if(mt-=Q,0>mt)Q=Math.max(0,G[gn].g-100),Ot=!1;else try{Kd(fn,ue,"req"+mt+"_")}catch{S&&S(fn)}}if(Ot){S=ue.join("&");break e}}}return c=c.i.splice(0,v),x.D=c,S}function tc(c){if(!c.g&&!c.u){c.Y=1;var x=c.Fa;We||et(),Ee||(We(),Ee=!0),qe.add(x,c),c.v=0}}function Za(c){return c.g||c.u||3<=c.v?!1:(c.Y++,c.u=J(T(c.Fa,c),ya(c,c.v)),c.v++,!0)}t.Fa=function(){if(this.u=null,fr(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var c=2*this.R;this.j.info("BP detection timer enabled: "+c),this.A=J(T(this.ab,this),c)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,nt(10),qi(this),fr(this))};function Ki(c){c.A!=null&&(h.clearTimeout(c.A),c.A=null)}function fr(c){c.g=new St(c,c.j,"rpc",c.Y),c.m===null&&(c.g.H=c.o),c.g.O=0;var x=tn(c.qa);Pe(x,"RID","rpc"),Pe(x,"SID",c.K),Pe(x,"AID",c.T),Pe(x,"CI",c.F?"0":"1"),!c.F&&c.ja&&Pe(x,"TO",c.ja),Pe(x,"TYPE","xmlhttp"),Ys(c,x),c.m&&c.o&&yi(x,c.m,c.o),c.L&&(c.g.I=c.L);var v=c.g;c=c.ia,v.L=1,v.v=er(tn(x)),v.m=null,v.P=!0,bn(v,c)}t.Za=function(){this.C!=null&&(this.C=null,qi(this),Za(this),nt(19))};function xi(c){c.C!=null&&(h.clearTimeout(c.C),c.C=null)}function tr(c,x){var v=null;if(c.g==x){xi(c),Ki(c),c.g=null;var S=2}else if(pn(c.h,x))v=x.D,qs(c.h,x),S=1;else return;if(c.G!=0){if(x.o)if(S==1){v=x.m?x.m.length:0,x=Date.now()-x.F;var G=c.B;S=wn(),ot(S,new ee(S,v)),Qt(c)}else tc(c);else if(G=x.s,G==3||G==0&&0<x.X||!(S==1&&Lr(c,x)||S==2&&Za(c)))switch(v&&0<v.length&&(x=c.h,x.i=x.i.concat(v)),G){case 1:br(c,5);break;case 4:br(c,10);break;case 3:br(c,6);break;default:br(c,2)}}}function ya(c,x){let v=c.Ta+Math.floor(Math.random()*c.cb);return c.isActive()||(v*=2),v*x}function br(c,x){if(c.j.info("Error code "+x),x==2){var v=T(c.fb,c),S=c.Xa;const G=!S;S=new Nr(S||"//www.google.com/images/cleardot.gif"),h.location&&h.location.protocol=="http"||or(S,"https"),er(S),G?$t(S.toString(),v):qd(S.toString(),v)}else nt(2);c.G=0,c.l&&c.l.sa(x),Fn(c),he(c)}t.fb=function(c){c?(this.j.info("Successfully pinged google.com"),nt(2)):(this.j.info("Failed to ping google.com"),nt(1))};function Fn(c){if(c.G=0,c.ka=[],c.l){const x=Hn(c.h);(x.length!=0||c.i.length!=0)&&(H(c.ka,x),H(c.ka,c.i),c.h.i.length=0,B(c.i),c.i.length=0),c.l.ra()}}function Dt(c,x,v){var S=v instanceof Nr?tn(v):new Nr(v);if(S.g!="")x&&(S.g=x+"."+S.g),le(S,S.s);else{var G=h.location;S=G.protocol,x=x?x+"."+G.hostname:G.hostname,G=+G.port;var Q=new Nr(null);S&&or(Q,S),x&&(Q.g=x),G&&le(Q,G),v&&(Q.l=v),S=Q}return v=c.D,x=c.ya,v&&x&&Pe(S,v,x),Pe(S,"VER",c.la),Ys(c,S),S}function nc(c,x,v){if(x&&!c.J)throw Error("Can't create secondary domain capable XhrIo object.");return x=c.Ca&&!c.pa?new Zt(new mi({eb:v})):new Zt(c.pa),x.Ha(c.J),x}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Gn(){}t=Gn.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function hs(){}hs.prototype.g=function(c,x){return new On(c,x)};function On(c,x){tt.call(this),this.g=new pa(x),this.l=c,this.h=x&&x.messageUrlParams||null,c=x&&x.messageHeaders||null,x&&x.clientProtocolHeaderRequired&&(c?c["X-Client-Protocol"]="webchannel":c={"X-Client-Protocol":"webchannel"}),this.g.o=c,c=x&&x.initMessageHeaders||null,x&&x.messageContentType&&(c?c["X-WebChannel-Content-Type"]=x.messageContentType:c={"X-WebChannel-Content-Type":x.messageContentType}),x&&x.va&&(c?c["X-WebChannel-Client-Profile"]=x.va:c={"X-WebChannel-Client-Profile":x.va}),this.g.S=c,(c=x&&x.Sb)&&!M(c)&&(this.g.m=c),this.v=x&&x.supportsCrossDomainXhr||!1,this.u=x&&x.sendRawJson||!1,(x=x&&x.httpSessionIdParam)&&!M(x)&&(this.g.D=x,c=this.h,c!==null&&x in c&&(c=this.h,x in c&&delete c[x])),this.j=new fs(this)}L(On,tt),On.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},On.prototype.close=function(){Es(this.g)},On.prototype.o=function(c){var x=this.g;if(typeof c=="string"){var v={};v.__data__=c,c=v}else this.u&&(v={},v.__data__=Tt(c),c=v);x.i.push(new en(x.Ya++,c)),x.G==3&&Qt(x)},On.prototype.N=function(){this.g.l=null,delete this.j,Es(this.g),delete this.g,On.aa.N.call(this)};function rc(c){Ce.call(this),c.__headers__&&(this.headers=c.__headers__,this.statusCode=c.__status__,delete c.__headers__,delete c.__status__);var x=c.__sm__;if(x){e:{for(const v in x){c=v;break e}c=void 0}(this.i=c)&&(c=this.i,x=x!==null&&c in x?x[c]:void 0),this.data=x}else this.data=c}L(rc,Ce);function bs(){it.call(this),this.status=1}L(bs,it);function fs(c){this.g=c}L(fs,Gn),fs.prototype.ua=function(){ot(this.g,"a")},fs.prototype.ta=function(c){ot(this.g,new rc(c))},fs.prototype.sa=function(c){ot(this.g,new bs)},fs.prototype.ra=function(){ot(this.g,"b")},hs.prototype.createWebChannel=hs.prototype.g,On.prototype.send=On.prototype.o,On.prototype.open=On.prototype.m,On.prototype.close=On.prototype.close,t3=function(){return new hs},e3=function(){return wn()},JP=He,Sw={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Ze.NO_ERROR=0,Ze.TIMEOUT=8,Ze.HTTP_ERROR=6,Fp=Ze,Fe.COMPLETE="complete",ZP=Fe,Ie.EventType=be,be.OPEN="a",be.CLOSE="b",be.ERROR="c",be.MESSAGE="d",tt.prototype.listen=tt.prototype.K,Ch=Ie,Zt.prototype.listenOnce=Zt.prototype.L,Zt.prototype.getLastError=Zt.prototype.Ka,Zt.prototype.getLastErrorCode=Zt.prototype.Ba,Zt.prototype.getStatus=Zt.prototype.Z,Zt.prototype.getResponseJson=Zt.prototype.Oa,Zt.prototype.getResponseText=Zt.prototype.oa,Zt.prototype.send=Zt.prototype.ea,Zt.prototype.setWithCredentials=Zt.prototype.Ha,YP=Zt}).apply(typeof tp<"u"?tp:typeof self<"u"?self:typeof window<"u"?window:{});const dA="@firebase/firestore";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Rs=class{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}};Rs.UNAUTHENTICATED=new Rs(null),Rs.GOOGLE_CREDENTIALS=new Rs("google-credentials-uid"),Rs.FIRST_PARTY=new Rs("first-party-uid"),Rs.MOCK_USER=new Rs("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Vd="10.14.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gc=new Wv("@firebase/firestore");function ch(){return Gc.logLevel}function vt(t,...e){if(Gc.logLevel<=Dn.DEBUG){const n=e.map(qv);Gc.debug(`Firestore (${Vd}): ${t}`,...n)}}function ko(t,...e){if(Gc.logLevel<=Dn.ERROR){const n=e.map(qv);Gc.error(`Firestore (${Vd}): ${t}`,...n)}}function _d(t,...e){if(Gc.logLevel<=Dn.WARN){const n=e.map(qv);Gc.warn(`Firestore (${Vd}): ${t}`,...n)}}function qv(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function an(t="Unexpected state"){const e=`FIRESTORE (${Vd}) INTERNAL ASSERTION FAILED: `+t;throw ko(e),new Error(e)}function Zn(t,e){t||an()}function cn(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Re={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class dt extends qa{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wo{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class n3{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class A${getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(Rs.UNAUTHENTICATED))}shutdown(){}}class T${constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class C${constructor(e){this.t=e,this.currentUser=Rs.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Zn(this.o===void 0);let r=this.i;const s=p=>this.i!==r?(r=this.i,n(p)):Promise.resolve();let i=new wo;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new wo,e.enqueueRetryable(()=>s(this.currentUser))};const l=()=>{const p=i;e.enqueueRetryable(async()=>{await p.promise,await s(this.currentUser)})},h=p=>{vt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=p,this.o&&(this.auth.addAuthTokenListener(this.o),l())};this.t.onInit(p=>h(p)),setTimeout(()=>{if(!this.auth){const p=this.t.getImmediate({optional:!0});p?h(p):(vt("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new wo)}},0),l()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(vt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Zn(typeof r.accessToken=="string"),new n3(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Zn(e===null||typeof e=="string"),new Rs(e)}}class S${constructor(e,n,r){this.l=e,this.h=n,this.P=r,this.type="FirstParty",this.user=Rs.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class N${constructor(e,n,r){this.l=e,this.h=n,this.P=r}getToken(){return Promise.resolve(new S$(this.l,this.h,this.P))}start(e,n){e.enqueueRetryable(()=>n(Rs.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class R${constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class P${constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,n){Zn(this.o===void 0);const r=i=>{i.error!=null&&vt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const l=i.token!==this.R;return this.R=i.token,vt("FirebaseAppCheckTokenProvider",`Received ${l?"new":"existing"} token.`),l?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{vt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.A.getImmediate({optional:!0});i?s(i):vt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Zn(typeof n.token=="string"),this.R=n.token,new R$(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function k$(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r3{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length;let r="";for(;r.length<20;){const s=k$(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%e.length))}return r}}function Wn(t,e){return t<e?-1:t>e?1:0}function vd(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xn{constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new dt(Re.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new dt(Re.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new dt(Re.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new dt(Re.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Xn.fromMillis(Date.now())}static fromDate(e){return Xn.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor(1e6*(e-1e3*n));return new Xn(n,r)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?Wn(this.nanoseconds,e.nanoseconds):Wn(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class on{constructor(e){this.timestamp=e}static fromTimestamp(e){return new on(e)}static min(){return new on(new Xn(0,0))}static max(){return new on(new Xn(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mf{constructor(e,n,r){n===void 0?n=0:n>e.length&&an(),r===void 0?r=e.length-n:r>e.length-n&&an(),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Mf.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Mf?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=e.get(s),l=n.get(s);if(i<l)return-1;if(i>l)return 1}return e.length<n.length?-1:e.length>n.length?1:0}}class gr extends Mf{construct(e,n,r){return new gr(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new dt(Re.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new gr(n)}static emptyPath(){return new gr([])}}const D$=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class ys extends Mf{construct(e,n,r){return new ys(e,n,r)}static isValidIdentifier(e){return D$.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),ys.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new ys(["__name__"])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new dt(Re.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let l=!1;for(;s<e.length;){const h=e[s];if(h==="\\"){if(s+1===e.length)throw new dt(Re.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const p=e[s+1];if(p!=="\\"&&p!=="."&&p!=="`")throw new dt(Re.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=p,s+=2}else h==="`"?(l=!l,s++):h!=="."||l?(r+=h,s++):(i(),s++)}if(i(),l)throw new dt(Re.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new ys(n)}static emptyPath(){return new ys([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ft{constructor(e){this.path=e}static fromPath(e){return new Ft(gr.fromString(e))}static fromName(e){return new Ft(gr.fromString(e).popFirst(5))}static empty(){return new Ft(gr.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&gr.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return gr.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ft(new gr(e.slice()))}}function O$(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=on.fromTimestamp(r===1e9?new Xn(n+1,0):new Xn(n,r));return new jl(s,Ft.empty(),e)}function M$(t){return new jl(t.readTime,t.key,-1)}class jl{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new jl(on.min(),Ft.empty(),-1)}static max(){return new jl(on.max(),Ft.empty(),-1)}}function L$(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=Ft.comparator(t.documentKey,e.documentKey),n!==0?n:Wn(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j$="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class F${constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function gm(t){if(t.code!==Re.FAILED_PRECONDITION||t.message!==j$)throw t;vt("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Le{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&an(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new Le((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof Le?n:Le.resolve(n)}catch(n){return Le.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):Le.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):Le.reject(n)}static resolve(e){return new Le((n,r)=>{n(e)})}static reject(e){return new Le((n,r)=>{r(e)})}static waitFor(e){return new Le((n,r)=>{let s=0,i=0,l=!1;e.forEach(h=>{++s,h.next(()=>{++i,l&&i===s&&n()},p=>r(p))}),l=!0,i===s&&n()})}static or(e){let n=Le.resolve(!1);for(const r of e)n=n.next(s=>s?Le.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new Le((r,s)=>{const i=e.length,l=new Array(i);let h=0;for(let p=0;p<i;p++){const y=p;n(e[y]).next(_=>{l[y]=_,++h,h===i&&r(l)},_=>s(_))}})}static doWhile(e,n){return new Le((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}function V$(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function ym(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kv{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ie(r),this.se=r=>n.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}Kv.oe=-1;function s1(t){return t==null}function $0(t){return t===0&&1/t==-1/0}function B$(t){return typeof t=="number"&&Number.isInteger(t)&&!$0(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hA(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function ou(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function s3(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sr{constructor(e,n){this.comparator=e,this.root=n||gs.EMPTY}insert(e,n){return new Sr(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,gs.BLACK,null,null))}remove(e){return new Sr(this.comparator,this.root.remove(e,this.comparator).copy(null,null,gs.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new np(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new np(this.root,e,this.comparator,!1)}getReverseIterator(){return new np(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new np(this.root,e,this.comparator,!0)}}class np{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class gs{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??gs.RED,this.left=s??gs.EMPTY,this.right=i??gs.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new gs(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return gs.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return gs.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,gs.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,gs.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw an();const e=this.left.check();if(e!==this.right.check())throw an();return e+(this.isRed()?0:1)}}gs.EMPTY=null,gs.RED=!0,gs.BLACK=!1;gs.EMPTY=new class{constructor(){this.size=0}get key(){throw an()}get value(){throw an()}get color(){throw an()}get left(){throw an()}get right(){throw an()}copy(e,n,r,s,i){return this}insert(e,n,r){return new gs(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ws{constructor(e){this.comparator=e,this.data=new Sr(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new fA(this.data.getIterator())}getIteratorFrom(e){return new fA(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof ws)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new ws(this.comparator);return n.data=e,n}}class fA{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ti{constructor(e){this.fields=e,e.sort(ys.comparator)}static empty(){return new Ti([])}unionWith(e){let n=new ws(ys.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Ti(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return vd(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i3 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vs{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new i3("Invalid base64 string: "+i):i}}(e);return new vs(n)}static fromUint8Array(e){const n=function(s){let i="";for(let l=0;l<s.length;++l)i+=String.fromCharCode(s[l]);return i}(e);return new vs(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Wn(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}vs.EMPTY_BYTE_STRING=new vs("");const U$=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Fl(t){if(Zn(!!t),typeof t=="string"){let e=0;const n=U$.exec(t);if(Zn(!!n),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:Fr(t.seconds),nanos:Fr(t.nanos)}}function Fr(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function qc(t){return typeof t=="string"?vs.fromBase64String(t):vs.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xv(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function Qv(t){const e=t.mapValue.fields.__previous_value__;return Xv(e)?Qv(e):e}function Lf(t){const e=Fl(t.mapValue.fields.__local_write_time__.timestampValue);return new Xn(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $${constructor(e,n,r,s,i,l,h,p,y){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=l,this.autoDetectLongPolling=h,this.longPollingOptions=p,this.useFetchStreams=y}}class jf{constructor(e,n){this.projectId=e,this.database=n||"(default)"}static empty(){return new jf("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(e){return e instanceof jf&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rp={mapValue:{}};function Kc(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Xv(t)?4:W$(t)?9007199254740991:z$(t)?10:11:an()}function Ha(t,e){if(t===e)return!0;const n=Kc(t);if(n!==Kc(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Lf(t).isEqual(Lf(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const l=Fl(s.timestampValue),h=Fl(i.timestampValue);return l.seconds===h.seconds&&l.nanos===h.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return qc(s.bytesValue).isEqual(qc(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return Fr(s.geoPointValue.latitude)===Fr(i.geoPointValue.latitude)&&Fr(s.geoPointValue.longitude)===Fr(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return Fr(s.integerValue)===Fr(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const l=Fr(s.doubleValue),h=Fr(i.doubleValue);return l===h?$0(l)===$0(h):isNaN(l)&&isNaN(h)}return!1}(t,e);case 9:return vd(t.arrayValue.values||[],e.arrayValue.values||[],Ha);case 10:case 11:return function(s,i){const l=s.mapValue.fields||{},h=i.mapValue.fields||{};if(hA(l)!==hA(h))return!1;for(const p in l)if(l.hasOwnProperty(p)&&(h[p]===void 0||!Ha(l[p],h[p])))return!1;return!0}(t,e);default:return an()}}function Ff(t,e){return(t.values||[]).find(n=>Ha(n,e))!==void 0}function Ed(t,e){if(t===e)return 0;const n=Kc(t),r=Kc(e);if(n!==r)return Wn(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Wn(t.booleanValue,e.booleanValue);case 2:return function(i,l){const h=Fr(i.integerValue||i.doubleValue),p=Fr(l.integerValue||l.doubleValue);return h<p?-1:h>p?1:h===p?0:isNaN(h)?isNaN(p)?0:-1:1}(t,e);case 3:return mA(t.timestampValue,e.timestampValue);case 4:return mA(Lf(t),Lf(e));case 5:return Wn(t.stringValue,e.stringValue);case 6:return function(i,l){const h=qc(i),p=qc(l);return h.compareTo(p)}(t.bytesValue,e.bytesValue);case 7:return function(i,l){const h=i.split("/"),p=l.split("/");for(let y=0;y<h.length&&y<p.length;y++){const _=Wn(h[y],p[y]);if(_!==0)return _}return Wn(h.length,p.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,l){const h=Wn(Fr(i.latitude),Fr(l.latitude));return h!==0?h:Wn(Fr(i.longitude),Fr(l.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return pA(t.arrayValue,e.arrayValue);case 10:return function(i,l){var h,p,y,_;const E=i.fields||{},T=l.fields||{},k=(h=E.value)===null||h===void 0?void 0:h.arrayValue,L=(p=T.value)===null||p===void 0?void 0:p.arrayValue,B=Wn(((y=k==null?void 0:k.values)===null||y===void 0?void 0:y.length)||0,((_=L==null?void 0:L.values)===null||_===void 0?void 0:_.length)||0);return B!==0?B:pA(k,L)}(t.mapValue,e.mapValue);case 11:return function(i,l){if(i===rp.mapValue&&l===rp.mapValue)return 0;if(i===rp.mapValue)return 1;if(l===rp.mapValue)return-1;const h=i.fields||{},p=Object.keys(h),y=l.fields||{},_=Object.keys(y);p.sort(),_.sort();for(let E=0;E<p.length&&E<_.length;++E){const T=Wn(p[E],_[E]);if(T!==0)return T;const k=Ed(h[p[E]],y[_[E]]);if(k!==0)return k}return Wn(p.length,_.length)}(t.mapValue,e.mapValue);default:throw an()}}function mA(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Wn(t,e);const n=Fl(t),r=Fl(e),s=Wn(n.seconds,r.seconds);return s!==0?s:Wn(n.nanos,r.nanos)}function pA(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=Ed(n[s],r[s]);if(i)return i}return Wn(n.length,r.length)}function bd(t){return Nw(t)}function Nw(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Fl(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return qc(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return Ft.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=Nw(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const l of r)i?i=!1:s+=",",s+=`${l}:${Nw(n.fields[l])}`;return s+"}"}(t.mapValue):an()}function gA(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Rw(t){return!!t&&"integerValue"in t}function Yv(t){return!!t&&"arrayValue"in t}function yA(t){return!!t&&"nullValue"in t}function xA(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Vp(t){return!!t&&"mapValue"in t}function z$(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="__vector__"}function Hh(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return ou(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=Hh(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=Hh(t.arrayValue.values[n]);return e}return Object.assign({},t)}function W$(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class si{constructor(e){this.value=e}static empty(){return new si({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Vp(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Hh(n)}setAll(e){let n=ys.emptyPath(),r={},s=[];e.forEach((l,h)=>{if(!n.isImmediateParentOf(h)){const p=this.getFieldsMap(n);this.applyChanges(p,r,s),r={},s=[],n=h.popLast()}l?r[h.lastSegment()]=Hh(l):s.push(h.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());Vp(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Ha(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];Vp(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){ou(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new si(Hh(this.value))}}function a3(t){const e=[];return ou(t.fields,(n,r)=>{const s=new ys([n]);if(Vp(r)){const i=a3(r.mapValue).fields;if(i.length===0)e.push(s);else for(const l of i)e.push(s.child(l))}else e.push(s)}),new Ti(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ks{constructor(e,n,r,s,i,l,h){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=l,this.documentState=h}static newInvalidDocument(e){return new ks(e,0,on.min(),on.min(),on.min(),si.empty(),0)}static newFoundDocument(e,n,r,s){return new ks(e,1,n,on.min(),r,s,0)}static newNoDocument(e,n){return new ks(e,2,n,on.min(),on.min(),si.empty(),0)}static newUnknownDocument(e,n){return new ks(e,3,n,on.min(),on.min(),si.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(on.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=si.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=si.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=on.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof ks&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new ks(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z0{constructor(e,n){this.position=e,this.inclusive=n}}function wA(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],l=t.position[s];if(i.field.isKeyField()?r=Ft.comparator(Ft.fromName(l.referenceValue),n.key):r=Ed(l,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function _A(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Ha(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W0{constructor(e,n="asc"){this.field=e,this.dir=n}}function H$(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o3{}class Kr extends o3{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new q$(e,n,r):n==="array-contains"?new Q$(e,r):n==="in"?new Y$(e,r):n==="not-in"?new Z$(e,r):n==="array-contains-any"?new J$(e,r):new Kr(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new K$(e,r):new X$(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&this.matchesComparison(Ed(n,this.value)):n!==null&&Kc(this.value)===Kc(n)&&this.matchesComparison(Ed(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return an()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class ha extends o3{constructor(e,n){super(),this.filters=e,this.op=n,this.ae=null}static create(e,n){return new ha(e,n)}matches(e){return l3(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function l3(t){return t.op==="and"}function c3(t){return G$(t)&&l3(t)}function G$(t){for(const e of t.filters)if(e instanceof ha)return!1;return!0}function Pw(t){if(t instanceof Kr)return t.field.canonicalString()+t.op.toString()+bd(t.value);if(c3(t))return t.filters.map(e=>Pw(e)).join(",");{const e=t.filters.map(n=>Pw(n)).join(",");return`${t.op}(${e})`}}function u3(t,e){return t instanceof Kr?function(r,s){return s instanceof Kr&&r.op===s.op&&r.field.isEqual(s.field)&&Ha(r.value,s.value)}(t,e):t instanceof ha?function(r,s){return s instanceof ha&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,l,h)=>i&&u3(l,s.filters[h]),!0):!1}(t,e):void an()}function d3(t){return t instanceof Kr?function(n){return`${n.field.canonicalString()} ${n.op} ${bd(n.value)}`}(t):t instanceof ha?function(n){return n.op.toString()+" {"+n.getFilters().map(d3).join(" ,")+"}"}(t):"Filter"}class q$ extends Kr{constructor(e,n,r){super(e,n,r),this.key=Ft.fromName(r.referenceValue)}matches(e){const n=Ft.comparator(e.key,this.key);return this.matchesComparison(n)}}class K$ extends Kr{constructor(e,n){super(e,"in",n),this.keys=h3("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class X$ extends Kr{constructor(e,n){super(e,"not-in",n),this.keys=h3("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function h3(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>Ft.fromName(r.referenceValue))}class Q$ extends Kr{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return Yv(n)&&Ff(n.arrayValue,this.value)}}class Y$ extends Kr{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Ff(this.value.arrayValue,n)}}class Z$ extends Kr{constructor(e,n){super(e,"not-in",n)}matches(e){if(Ff(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&!Ff(this.value.arrayValue,n)}}class J$ extends Kr{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!Yv(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Ff(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ez{constructor(e,n=null,r=[],s=[],i=null,l=null,h=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=l,this.endAt=h,this.ue=null}}function vA(t,e=null,n=[],r=[],s=null,i=null,l=null){return new ez(t,e,n,r,s,i,l)}function Zv(t){const e=cn(t);if(e.ue===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Pw(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),s1(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>bd(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>bd(r)).join(",")),e.ue=n}return e.ue}function Jv(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!H$(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!u3(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!_A(t.startAt,e.startAt)&&_A(t.endAt,e.endAt)}function kw(t){return Ft.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xm{constructor(e,n=null,r=[],s=[],i=null,l="F",h=null,p=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=l,this.startAt=h,this.endAt=p,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function tz(t,e,n,r,s,i,l,h){return new xm(t,e,n,r,s,i,l,h)}function e2(t){return new xm(t)}function EA(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function f3(t){return t.collectionGroup!==null}function Gh(t){const e=cn(t);if(e.ce===null){e.ce=[];const n=new Set;for(const i of e.explicitOrderBy)e.ce.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(l){let h=new ws(ys.comparator);return l.filters.forEach(p=>{p.getFlattenedFilters().forEach(y=>{y.isInequality()&&(h=h.add(y.field))})}),h})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.ce.push(new W0(i,r))}),n.has(ys.keyField().canonicalString())||e.ce.push(new W0(ys.keyField(),r))}return e.ce}function Fa(t){const e=cn(t);return e.le||(e.le=nz(e,Gh(t))),e.le}function nz(t,e){if(t.limitType==="F")return vA(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new W0(s.field,i)});const n=t.endAt?new z0(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new z0(t.startAt.position,t.startAt.inclusive):null;return vA(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Dw(t,e){const n=t.filters.concat([e]);return new xm(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Ow(t,e,n){return new xm(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function i1(t,e){return Jv(Fa(t),Fa(e))&&t.limitType===e.limitType}function m3(t){return`${Zv(Fa(t))}|lt:${t.limitType}`}function Iu(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>d3(s)).join(", ")}]`),s1(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(l){return`${l.field.canonicalString()} (${l.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>bd(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>bd(s)).join(",")),`Target(${r})`}(Fa(t))}; limitType=${t.limitType})`}function a1(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):Ft.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of Gh(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(l,h,p){const y=wA(l,h,p);return l.inclusive?y<=0:y<0}(r.startAt,Gh(r),s)||r.endAt&&!function(l,h,p){const y=wA(l,h,p);return l.inclusive?y>=0:y>0}(r.endAt,Gh(r),s))}(t,e)}function rz(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function p3(t){return(e,n)=>{let r=!1;for(const s of Gh(t)){const i=sz(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function sz(t,e,n){const r=t.field.isKeyField()?Ft.comparator(e.key,n.key):function(i,l,h){const p=l.data.field(i),y=h.data.field(i);return p!==null&&y!==null?Ed(p,y):an()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return an()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bd{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){ou(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return s3(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iz=new Sr(Ft.comparator);function Do(){return iz}const g3=new Sr(Ft.comparator);function Sh(...t){let e=g3;for(const n of t)e=e.insert(n.key,n);return e}function y3(t){let e=g3;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function _c(){return qh()}function x3(){return qh()}function qh(){return new Bd(t=>t.toString(),(t,e)=>t.isEqual(e))}const az=new Sr(Ft.comparator),oz=new ws(Ft.comparator);function Nn(...t){let e=oz;for(const n of t)e=e.add(n);return e}const lz=new ws(Wn);function cz(){return lz}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function t2(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:$0(e)?"-0":e}}function w3(t){return{integerValue:""+t}}function uz(t,e){return B$(e)?w3(e):t2(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o1{constructor(){this._=void 0}}function dz(t,e,n){return t instanceof H0?function(s,i){const l={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&Xv(i)&&(i=Qv(i)),i&&(l.fields.__previous_value__=i),{mapValue:l}}(n,e):t instanceof Vf?v3(t,e):t instanceof Bf?E3(t,e):function(s,i){const l=_3(s,i),h=bA(l)+bA(s.Pe);return Rw(l)&&Rw(s.Pe)?w3(h):t2(s.serializer,h)}(t,e)}function hz(t,e,n){return t instanceof Vf?v3(t,e):t instanceof Bf?E3(t,e):n}function _3(t,e){return t instanceof G0?function(r){return Rw(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class H0 extends o1{}class Vf extends o1{constructor(e){super(),this.elements=e}}function v3(t,e){const n=b3(e);for(const r of t.elements)n.some(s=>Ha(s,r))||n.push(r);return{arrayValue:{values:n}}}class Bf extends o1{constructor(e){super(),this.elements=e}}function E3(t,e){let n=b3(e);for(const r of t.elements)n=n.filter(s=>!Ha(s,r));return{arrayValue:{values:n}}}class G0 extends o1{constructor(e,n){super(),this.serializer=e,this.Pe=n}}function bA(t){return Fr(t.integerValue||t.doubleValue)}function b3(t){return Yv(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function fz(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof Vf&&s instanceof Vf||r instanceof Bf&&s instanceof Bf?vd(r.elements,s.elements,Ha):r instanceof G0&&s instanceof G0?Ha(r.Pe,s.Pe):r instanceof H0&&s instanceof H0}(t.transform,e.transform)}class mz{constructor(e,n){this.version=e,this.transformResults=n}}class di{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new di}static exists(e){return new di(void 0,e)}static updateTime(e){return new di(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Bp(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class l1{}function I3(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new c1(t.key,di.none()):new wm(t.key,t.data,di.none());{const n=t.data,r=si.empty();let s=new ws(ys.comparator);for(let i of e.fields)if(!s.has(i)){let l=n.field(i);l===null&&i.length>1&&(i=i.popLast(),l=n.field(i)),l===null?r.delete(i):r.set(i,l),s=s.add(i)}return new ql(t.key,r,new Ti(s.toArray()),di.none())}}function pz(t,e,n){t instanceof wm?function(s,i,l){const h=s.value.clone(),p=AA(s.fieldTransforms,i,l.transformResults);h.setAll(p),i.convertToFoundDocument(l.version,h).setHasCommittedMutations()}(t,e,n):t instanceof ql?function(s,i,l){if(!Bp(s.precondition,i))return void i.convertToUnknownDocument(l.version);const h=AA(s.fieldTransforms,i,l.transformResults),p=i.data;p.setAll(A3(s)),p.setAll(h),i.convertToFoundDocument(l.version,p).setHasCommittedMutations()}(t,e,n):function(s,i,l){i.convertToNoDocument(l.version).setHasCommittedMutations()}(0,e,n)}function Kh(t,e,n,r){return t instanceof wm?function(i,l,h,p){if(!Bp(i.precondition,l))return h;const y=i.value.clone(),_=TA(i.fieldTransforms,p,l);return y.setAll(_),l.convertToFoundDocument(l.version,y).setHasLocalMutations(),null}(t,e,n,r):t instanceof ql?function(i,l,h,p){if(!Bp(i.precondition,l))return h;const y=TA(i.fieldTransforms,p,l),_=l.data;return _.setAll(A3(i)),_.setAll(y),l.convertToFoundDocument(l.version,_).setHasLocalMutations(),h===null?null:h.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(E=>E.field))}(t,e,n,r):function(i,l,h){return Bp(i.precondition,l)?(l.convertToNoDocument(l.version).setHasLocalMutations(),null):h}(t,e,n)}function gz(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=_3(r.transform,s||null);i!=null&&(n===null&&(n=si.empty()),n.set(r.field,i))}return n||null}function IA(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&vd(r,s,(i,l)=>fz(i,l))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class wm extends l1{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class ql extends l1{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function A3(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function AA(t,e,n){const r=new Map;Zn(t.length===n.length);for(let s=0;s<n.length;s++){const i=t[s],l=i.transform,h=e.data.field(i.field);r.set(i.field,hz(l,h,n[s]))}return r}function TA(t,e,n){const r=new Map;for(const s of t){const i=s.transform,l=n.data.field(s.field);r.set(s.field,dz(i,l,e))}return r}class c1 extends l1{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class yz extends l1{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xz{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&pz(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=Kh(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=Kh(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=x3();return this.mutations.forEach(s=>{const i=e.get(s.key),l=i.overlayedDocument;let h=this.applyToLocalView(l,i.mutatedFields);h=n.has(s.key)?null:h;const p=I3(l,h);p!==null&&r.set(s.key,p),l.isValidDocument()||l.convertToNoDocument(on.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Nn())}isEqual(e){return this.batchId===e.batchId&&vd(this.mutations,e.mutations,(n,r)=>IA(n,r))&&vd(this.baseMutations,e.baseMutations,(n,r)=>IA(n,r))}}class n2{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){Zn(e.mutations.length===r.length);let s=function(){return az}();const i=e.mutations;for(let l=0;l<i.length;l++)s=s.insert(i[l].key,r[l].version);return new n2(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wz{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _z{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Hr,Ln;function vz(t){switch(t){default:return an();case Re.CANCELLED:case Re.UNKNOWN:case Re.DEADLINE_EXCEEDED:case Re.RESOURCE_EXHAUSTED:case Re.INTERNAL:case Re.UNAVAILABLE:case Re.UNAUTHENTICATED:return!1;case Re.INVALID_ARGUMENT:case Re.NOT_FOUND:case Re.ALREADY_EXISTS:case Re.PERMISSION_DENIED:case Re.FAILED_PRECONDITION:case Re.ABORTED:case Re.OUT_OF_RANGE:case Re.UNIMPLEMENTED:case Re.DATA_LOSS:return!0}}function T3(t){if(t===void 0)return ko("GRPC error has no .code"),Re.UNKNOWN;switch(t){case Hr.OK:return Re.OK;case Hr.CANCELLED:return Re.CANCELLED;case Hr.UNKNOWN:return Re.UNKNOWN;case Hr.DEADLINE_EXCEEDED:return Re.DEADLINE_EXCEEDED;case Hr.RESOURCE_EXHAUSTED:return Re.RESOURCE_EXHAUSTED;case Hr.INTERNAL:return Re.INTERNAL;case Hr.UNAVAILABLE:return Re.UNAVAILABLE;case Hr.UNAUTHENTICATED:return Re.UNAUTHENTICATED;case Hr.INVALID_ARGUMENT:return Re.INVALID_ARGUMENT;case Hr.NOT_FOUND:return Re.NOT_FOUND;case Hr.ALREADY_EXISTS:return Re.ALREADY_EXISTS;case Hr.PERMISSION_DENIED:return Re.PERMISSION_DENIED;case Hr.FAILED_PRECONDITION:return Re.FAILED_PRECONDITION;case Hr.ABORTED:return Re.ABORTED;case Hr.OUT_OF_RANGE:return Re.OUT_OF_RANGE;case Hr.UNIMPLEMENTED:return Re.UNIMPLEMENTED;case Hr.DATA_LOSS:return Re.DATA_LOSS;default:return an()}}(Ln=Hr||(Hr={}))[Ln.OK=0]="OK",Ln[Ln.CANCELLED=1]="CANCELLED",Ln[Ln.UNKNOWN=2]="UNKNOWN",Ln[Ln.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Ln[Ln.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Ln[Ln.NOT_FOUND=5]="NOT_FOUND",Ln[Ln.ALREADY_EXISTS=6]="ALREADY_EXISTS",Ln[Ln.PERMISSION_DENIED=7]="PERMISSION_DENIED",Ln[Ln.UNAUTHENTICATED=16]="UNAUTHENTICATED",Ln[Ln.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Ln[Ln.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Ln[Ln.ABORTED=10]="ABORTED",Ln[Ln.OUT_OF_RANGE=11]="OUT_OF_RANGE",Ln[Ln.UNIMPLEMENTED=12]="UNIMPLEMENTED",Ln[Ln.INTERNAL=13]="INTERNAL",Ln[Ln.UNAVAILABLE=14]="UNAVAILABLE",Ln[Ln.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ez(){return new TextEncoder}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bz=new Pc([4294967295,4294967295],0);function CA(t){const e=Ez().encode(t),n=new QP;return n.update(e),new Uint8Array(n.digest())}function SA(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new Pc([n,r],0),new Pc([s,i],0)]}class r2{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Nh(`Invalid padding: ${n}`);if(r<0)throw new Nh(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Nh(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Nh(`Invalid padding when bitmap length is 0: ${n}`);this.Ie=8*e.length-n,this.Te=Pc.fromNumber(this.Ie)}Ee(e,n,r){let s=e.add(n.multiply(Pc.fromNumber(r)));return s.compare(bz)===1&&(s=new Pc([s.getBits(0),s.getBits(1)],0)),s.modulo(this.Te).toNumber()}de(e){return(this.bitmap[Math.floor(e/8)]&1<<e%8)!=0}mightContain(e){if(this.Ie===0)return!1;const n=CA(e),[r,s]=SA(n);for(let i=0;i<this.hashCount;i++){const l=this.Ee(r,s,i);if(!this.de(l))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),l=new r2(i,s,n);return r.forEach(h=>l.insert(h)),l}insert(e){if(this.Ie===0)return;const n=CA(e),[r,s]=SA(n);for(let i=0;i<this.hashCount;i++){const l=this.Ee(r,s,i);this.Ae(l)}}Ae(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Nh extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class u1{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,_m.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new u1(on.min(),s,new Sr(Wn),Do(),Nn())}}class _m{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new _m(r,n,Nn(),Nn(),Nn())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Up{constructor(e,n,r,s){this.Re=e,this.removedTargetIds=n,this.key=r,this.Ve=s}}class C3{constructor(e,n){this.targetId=e,this.me=n}}class S3{constructor(e,n,r=vs.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class NA{constructor(){this.fe=0,this.ge=PA(),this.pe=vs.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Nn(),n=Nn(),r=Nn();return this.ge.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:an()}}),new _m(this.pe,this.ye,e,n,r)}Ce(){this.we=!1,this.ge=PA()}Fe(e,n){this.we=!0,this.ge=this.ge.insert(e,n)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,Zn(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class Iz{constructor(e){this.Le=e,this.Be=new Map,this.ke=Do(),this.qe=RA(),this.Qe=new Sr(Wn)}Ke(e){for(const n of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(n,e.Ve):this.Ue(n,e.key,e.Ve);for(const n of e.removedTargetIds)this.Ue(n,e.key,e.Ve)}We(e){this.forEachTarget(e,n=>{const r=this.Ge(n);switch(e.state){case 0:this.ze(n)&&r.De(e.resumeToken);break;case 1:r.Oe(),r.Se||r.Ce(),r.De(e.resumeToken);break;case 2:r.Oe(),r.Se||this.removeTarget(n);break;case 3:this.ze(n)&&(r.Ne(),r.De(e.resumeToken));break;case 4:this.ze(n)&&(this.je(n),r.De(e.resumeToken));break;default:an()}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Be.forEach((r,s)=>{this.ze(s)&&n(s)})}He(e){const n=e.targetId,r=e.me.count,s=this.Je(n);if(s){const i=s.target;if(kw(i))if(r===0){const l=new Ft(i.path);this.Ue(n,l,ks.newNoDocument(l,on.min()))}else Zn(r===1);else{const l=this.Ye(n);if(l!==r){const h=this.Ze(e),p=h?this.Xe(h,e,l):1;if(p!==0){this.je(n);const y=p===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(n,y)}}}}}Ze(e){const n=e.me.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let l,h;try{l=qc(r).toUint8Array()}catch(p){if(p instanceof i3)return _d("Decoding the base64 bloom filter in existence filter failed ("+p.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw p}try{h=new r2(l,s,i)}catch(p){return _d(p instanceof Nh?"BloomFilter error: ":"Applying bloom filter failed: ",p),null}return h.Ie===0?null:h}Xe(e,n,r){return n.me.count===r-this.nt(e,n.targetId)?0:2}nt(e,n){const r=this.Le.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const l=this.Le.tt(),h=`projects/${l.projectId}/databases/${l.database}/documents/${i.path.canonicalString()}`;e.mightContain(h)||(this.Ue(n,i,null),s++)}),s}rt(e){const n=new Map;this.Be.forEach((i,l)=>{const h=this.Je(l);if(h){if(i.current&&kw(h.target)){const p=new Ft(h.target.path);this.ke.get(p)!==null||this.it(l,p)||this.Ue(l,p,ks.newNoDocument(p,e))}i.be&&(n.set(l,i.ve()),i.Ce())}});let r=Nn();this.qe.forEach((i,l)=>{let h=!0;l.forEachWhile(p=>{const y=this.Je(p);return!y||y.purpose==="TargetPurposeLimboResolution"||(h=!1,!1)}),h&&(r=r.add(i))}),this.ke.forEach((i,l)=>l.setReadTime(e));const s=new u1(e,n,this.Qe,this.ke,r);return this.ke=Do(),this.qe=RA(),this.Qe=new Sr(Wn),s}$e(e,n){if(!this.ze(e))return;const r=this.it(e,n.key)?2:0;this.Ge(e).Fe(n.key,r),this.ke=this.ke.insert(n.key,n),this.qe=this.qe.insert(n.key,this.st(n.key).add(e))}Ue(e,n,r){if(!this.ze(e))return;const s=this.Ge(e);this.it(e,n)?s.Fe(n,1):s.Me(n),this.qe=this.qe.insert(n,this.st(n).delete(e)),r&&(this.ke=this.ke.insert(n,r))}removeTarget(e){this.Be.delete(e)}Ye(e){const n=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let n=this.Be.get(e);return n||(n=new NA,this.Be.set(e,n)),n}st(e){let n=this.qe.get(e);return n||(n=new ws(Wn),this.qe=this.qe.insert(e,n)),n}ze(e){const n=this.Je(e)!==null;return n||vt("WatchChangeAggregator","Detected inactive target",e),n}Je(e){const n=this.Be.get(e);return n&&n.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new NA),this.Le.getRemoteKeysForTarget(e).forEach(n=>{this.Ue(e,n,null)})}it(e,n){return this.Le.getRemoteKeysForTarget(e).has(n)}}function RA(){return new Sr(Ft.comparator)}function PA(){return new Sr(Ft.comparator)}const Az={asc:"ASCENDING",desc:"DESCENDING"},Tz={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Cz={and:"AND",or:"OR"};class Sz{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Mw(t,e){return t.useProto3Json||s1(e)?e:{value:e}}function q0(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function N3(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function Nz(t,e){return q0(t,e.toTimestamp())}function Va(t){return Zn(!!t),on.fromTimestamp(function(n){const r=Fl(n);return new Xn(r.seconds,r.nanos)}(t))}function s2(t,e){return Lw(t,e).canonicalString()}function Lw(t,e){const n=function(s){return new gr(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function R3(t){const e=gr.fromString(t);return Zn(M3(e)),e}function jw(t,e){return s2(t.databaseId,e.path)}function Ey(t,e){const n=R3(e);if(n.get(1)!==t.databaseId.projectId)throw new dt(Re.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new dt(Re.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Ft(k3(n))}function P3(t,e){return s2(t.databaseId,e)}function Rz(t){const e=R3(t);return e.length===4?gr.emptyPath():k3(e)}function Fw(t){return new gr(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function k3(t){return Zn(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function kA(t,e,n){return{name:jw(t,e),fields:n.value.mapValue.fields}}function Pz(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(y){return y==="NO_CHANGE"?0:y==="ADD"?1:y==="REMOVE"?2:y==="CURRENT"?3:y==="RESET"?4:an()}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(y,_){return y.useProto3Json?(Zn(_===void 0||typeof _=="string"),vs.fromBase64String(_||"")):(Zn(_===void 0||_ instanceof Buffer||_ instanceof Uint8Array),vs.fromUint8Array(_||new Uint8Array))}(t,e.targetChange.resumeToken),l=e.targetChange.cause,h=l&&function(y){const _=y.code===void 0?Re.UNKNOWN:T3(y.code);return new dt(_,y.message||"")}(l);n=new S3(r,s,i,h||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Ey(t,r.document.name),i=Va(r.document.updateTime),l=r.document.createTime?Va(r.document.createTime):on.min(),h=new si({mapValue:{fields:r.document.fields}}),p=ks.newFoundDocument(s,i,l,h),y=r.targetIds||[],_=r.removedTargetIds||[];n=new Up(y,_,p.key,p)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Ey(t,r.document),i=r.readTime?Va(r.readTime):on.min(),l=ks.newNoDocument(s,i),h=r.removedTargetIds||[];n=new Up([],h,l.key,l)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Ey(t,r.document),i=r.removedTargetIds||[];n=new Up([],i,s,null)}else{if(!("filter"in e))return an();{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,l=new _z(s,i),h=r.targetId;n=new C3(h,l)}}return n}function kz(t,e){let n;if(e instanceof wm)n={update:kA(t,e.key,e.value)};else if(e instanceof c1)n={delete:jw(t,e.key)};else if(e instanceof ql)n={update:kA(t,e.key,e.data),updateMask:Uz(e.fieldMask)};else{if(!(e instanceof yz))return an();n={verify:jw(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,l){const h=l.transform;if(h instanceof H0)return{fieldPath:l.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(h instanceof Vf)return{fieldPath:l.field.canonicalString(),appendMissingElements:{values:h.elements}};if(h instanceof Bf)return{fieldPath:l.field.canonicalString(),removeAllFromArray:{values:h.elements}};if(h instanceof G0)return{fieldPath:l.field.canonicalString(),increment:h.Pe};throw an()}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:Nz(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:an()}(t,e.precondition)),n}function Dz(t,e){return t&&t.length>0?(Zn(e!==void 0),t.map(n=>function(s,i){let l=s.updateTime?Va(s.updateTime):Va(i);return l.isEqual(on.min())&&(l=Va(i)),new mz(l,s.transformResults||[])}(n,e))):[]}function Oz(t,e){return{documents:[P3(t,e.path)]}}function Mz(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=P3(t,s);const i=function(y){if(y.length!==0)return O3(ha.create(y,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const l=function(y){if(y.length!==0)return y.map(_=>function(T){return{field:Au(T.field),direction:Fz(T.dir)}}(_))}(e.orderBy);l&&(n.structuredQuery.orderBy=l);const h=Mw(t,e.limit);return h!==null&&(n.structuredQuery.limit=h),e.startAt&&(n.structuredQuery.startAt=function(y){return{before:y.inclusive,values:y.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(y){return{before:!y.inclusive,values:y.position}}(e.endAt)),{_t:n,parent:s}}function Lz(t){let e=Rz(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){Zn(r===1);const _=n.from[0];_.allDescendants?s=_.collectionId:e=e.child(_.collectionId)}let i=[];n.where&&(i=function(E){const T=D3(E);return T instanceof ha&&c3(T)?T.getFilters():[T]}(n.where));let l=[];n.orderBy&&(l=function(E){return E.map(T=>function(L){return new W0(Tu(L.field),function(H){switch(H){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(L.direction))}(T))}(n.orderBy));let h=null;n.limit&&(h=function(E){let T;return T=typeof E=="object"?E.value:E,s1(T)?null:T}(n.limit));let p=null;n.startAt&&(p=function(E){const T=!!E.before,k=E.values||[];return new z0(k,T)}(n.startAt));let y=null;return n.endAt&&(y=function(E){const T=!E.before,k=E.values||[];return new z0(k,T)}(n.endAt)),tz(e,s,l,i,h,"F",p,y)}function jz(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return an()}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function D3(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Tu(n.unaryFilter.field);return Kr.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Tu(n.unaryFilter.field);return Kr.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Tu(n.unaryFilter.field);return Kr.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const l=Tu(n.unaryFilter.field);return Kr.create(l,"!=",{nullValue:"NULL_VALUE"});default:return an()}}(t):t.fieldFilter!==void 0?function(n){return Kr.create(Tu(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return an()}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return ha.create(n.compositeFilter.filters.map(r=>D3(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return an()}}(n.compositeFilter.op))}(t):an()}function Fz(t){return Az[t]}function Vz(t){return Tz[t]}function Bz(t){return Cz[t]}function Au(t){return{fieldPath:t.canonicalString()}}function Tu(t){return ys.fromServerFormat(t.fieldPath)}function O3(t){return t instanceof Kr?function(n){if(n.op==="=="){if(xA(n.value))return{unaryFilter:{field:Au(n.field),op:"IS_NAN"}};if(yA(n.value))return{unaryFilter:{field:Au(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(xA(n.value))return{unaryFilter:{field:Au(n.field),op:"IS_NOT_NAN"}};if(yA(n.value))return{unaryFilter:{field:Au(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Au(n.field),op:Vz(n.op),value:n.value}}}(t):t instanceof ha?function(n){const r=n.getFilters().map(s=>O3(s));return r.length===1?r[0]:{compositeFilter:{op:Bz(n.op),filters:r}}}(t):an()}function Uz(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function M3(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ml{constructor(e,n,r,s,i=on.min(),l=on.min(),h=vs.EMPTY_BYTE_STRING,p=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=l,this.resumeToken=h,this.expectedCount=p}withSequenceNumber(e){return new ml(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new ml(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new ml(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new ml(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $z{constructor(e){this.ct=e}}function zz(t){const e=Lz({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Ow(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wz{constructor(){this.un=new Hz}addToCollectionParentIndex(e,n){return this.un.add(n),Le.resolve()}getCollectionParents(e,n){return Le.resolve(this.un.getEntries(n))}addFieldIndex(e,n){return Le.resolve()}deleteFieldIndex(e,n){return Le.resolve()}deleteAllFieldIndexes(e){return Le.resolve()}createTargetIndexes(e,n){return Le.resolve()}getDocumentsMatchingTarget(e,n){return Le.resolve(null)}getIndexType(e,n){return Le.resolve(0)}getFieldIndexes(e,n){return Le.resolve([])}getNextCollectionGroupToUpdate(e){return Le.resolve(null)}getMinOffset(e,n){return Le.resolve(jl.min())}getMinOffsetFromCollectionGroup(e,n){return Le.resolve(jl.min())}updateCollectionGroup(e,n,r){return Le.resolve()}updateIndexEntries(e,n){return Le.resolve()}}class Hz{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new ws(gr.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new ws(gr.comparator)).toArray()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Id{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Id(0)}static kn(){return new Id(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gz{constructor(){this.changes=new Bd(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,ks.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?Le.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qz{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kz{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&Kh(r.mutation,s,Ti.empty(),Xn.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Nn()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Nn()){const s=_c();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let l=Sh();return i.forEach((h,p)=>{l=l.insert(h,p.overlayedDocument)}),l}))}getOverlayedDocuments(e,n){const r=_c();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Nn()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((l,h)=>{n.set(l,h)})})}computeViews(e,n,r,s){let i=Do();const l=qh(),h=function(){return qh()}();return n.forEach((p,y)=>{const _=r.get(y.key);s.has(y.key)&&(_===void 0||_.mutation instanceof ql)?i=i.insert(y.key,y):_!==void 0?(l.set(y.key,_.mutation.getFieldMask()),Kh(_.mutation,y,_.mutation.getFieldMask(),Xn.now())):l.set(y.key,Ti.empty())}),this.recalculateAndSaveOverlays(e,i).next(p=>(p.forEach((y,_)=>l.set(y,_)),n.forEach((y,_)=>{var E;return h.set(y,new qz(_,(E=l.get(y))!==null&&E!==void 0?E:null))}),h))}recalculateAndSaveOverlays(e,n){const r=qh();let s=new Sr((l,h)=>l-h),i=Nn();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(l=>{for(const h of l)h.keys().forEach(p=>{const y=n.get(p);if(y===null)return;let _=r.get(p)||Ti.empty();_=h.applyToLocalView(y,_),r.set(p,_);const E=(s.get(h.batchId)||Nn()).add(p);s=s.insert(h.batchId,E)})}).next(()=>{const l=[],h=s.getReverseIterator();for(;h.hasNext();){const p=h.getNext(),y=p.key,_=p.value,E=x3();_.forEach(T=>{if(!i.has(T)){const k=I3(n.get(T),r.get(T));k!==null&&E.set(T,k),i=i.add(T)}}),l.push(this.documentOverlayCache.saveOverlays(e,y,E))}return Le.waitFor(l)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(l){return Ft.isDocumentKey(l.path)&&l.collectionGroup===null&&l.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):f3(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const l=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):Le.resolve(_c());let h=-1,p=i;return l.next(y=>Le.forEach(y,(_,E)=>(h<E.largestBatchId&&(h=E.largestBatchId),i.get(_)?Le.resolve():this.remoteDocumentCache.getEntry(e,_).next(T=>{p=p.insert(_,T)}))).next(()=>this.populateOverlays(e,y,i)).next(()=>this.computeViews(e,p,y,Nn())).next(_=>({batchId:h,changes:y3(_)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new Ft(n)).next(r=>{let s=Sh();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let l=Sh();return this.indexManager.getCollectionParents(e,i).next(h=>Le.forEach(h,p=>{const y=function(E,T){return new xm(T,null,E.explicitOrderBy.slice(),E.filters.slice(),E.limit,E.limitType,E.startAt,E.endAt)}(n,p.child(i));return this.getDocumentsMatchingCollectionQuery(e,y,r,s).next(_=>{_.forEach((E,T)=>{l=l.insert(E,T)})})}).next(()=>l))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(l=>(i=l,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(l=>{i.forEach((p,y)=>{const _=y.getKey();l.get(_)===null&&(l=l.insert(_,ks.newInvalidDocument(_)))});let h=Sh();return l.forEach((p,y)=>{const _=i.get(p);_!==void 0&&Kh(_.mutation,y,Ti.empty(),Xn.now()),a1(n,y)&&(h=h.insert(p,y))}),h})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xz{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,n){return Le.resolve(this.hr.get(n))}saveBundleMetadata(e,n){return this.hr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:Va(s.createTime)}}(n)),Le.resolve()}getNamedQuery(e,n){return Le.resolve(this.Pr.get(n))}saveNamedQuery(e,n){return this.Pr.set(n.name,function(s){return{name:s.name,query:zz(s.bundledQuery),readTime:Va(s.readTime)}}(n)),Le.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qz{constructor(){this.overlays=new Sr(Ft.comparator),this.Ir=new Map}getOverlay(e,n){return Le.resolve(this.overlays.get(n))}getOverlays(e,n){const r=_c();return Le.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.ht(e,n,i)}),Le.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Ir.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Ir.delete(r)),Le.resolve()}getOverlaysForCollection(e,n,r){const s=_c(),i=n.length+1,l=new Ft(n.child("")),h=this.overlays.getIteratorFrom(l);for(;h.hasNext();){const p=h.getNext().value,y=p.getKey();if(!n.isPrefixOf(y.path))break;y.path.length===i&&p.largestBatchId>r&&s.set(p.getKey(),p)}return Le.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new Sr((y,_)=>y-_);const l=this.overlays.getIterator();for(;l.hasNext();){const y=l.getNext().value;if(y.getKey().getCollectionGroup()===n&&y.largestBatchId>r){let _=i.get(y.largestBatchId);_===null&&(_=_c(),i=i.insert(y.largestBatchId,_)),_.set(y.getKey(),y)}}const h=_c(),p=i.getIterator();for(;p.hasNext()&&(p.getNext().value.forEach((y,_)=>h.set(y,_)),!(h.size()>=s)););return Le.resolve(h)}ht(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const l=this.Ir.get(s.largestBatchId).delete(r.key);this.Ir.set(s.largestBatchId,l)}this.overlays=this.overlays.insert(r.key,new wz(n,r));let i=this.Ir.get(n);i===void 0&&(i=Nn(),this.Ir.set(n,i)),this.Ir.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yz{constructor(){this.sessionToken=vs.EMPTY_BYTE_STRING}getSessionToken(e){return Le.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,Le.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class i2{constructor(){this.Tr=new ws(ss.Er),this.dr=new ws(ss.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,n){const r=new ss(e,n);this.Tr=this.Tr.add(r),this.dr=this.dr.add(r)}Rr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Vr(new ss(e,n))}mr(e,n){e.forEach(r=>this.removeReference(r,n))}gr(e){const n=new Ft(new gr([])),r=new ss(n,e),s=new ss(n,e+1),i=[];return this.dr.forEachInRange([r,s],l=>{this.Vr(l),i.push(l.key)}),i}pr(){this.Tr.forEach(e=>this.Vr(e))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const n=new Ft(new gr([])),r=new ss(n,e),s=new ss(n,e+1);let i=Nn();return this.dr.forEachInRange([r,s],l=>{i=i.add(l.key)}),i}containsKey(e){const n=new ss(e,0),r=this.Tr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class ss{constructor(e,n){this.key=e,this.wr=n}static Er(e,n){return Ft.comparator(e.key,n.key)||Wn(e.wr,n.wr)}static Ar(e,n){return Wn(e.wr,n.wr)||Ft.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zz{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.Sr=1,this.br=new ws(ss.Er)}checkEmpty(e){return Le.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const l=new xz(i,n,r,s);this.mutationQueue.push(l);for(const h of s)this.br=this.br.add(new ss(h.key,i)),this.indexManager.addToCollectionParentIndex(e,h.key.path.popLast());return Le.resolve(l)}lookupMutationBatch(e,n){return Le.resolve(this.Dr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.vr(r),i=s<0?0:s;return Le.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return Le.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(e){return Le.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new ss(n,0),s=new ss(n,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([r,s],l=>{const h=this.Dr(l.wr);i.push(h)}),Le.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new ws(Wn);return n.forEach(s=>{const i=new ss(s,0),l=new ss(s,Number.POSITIVE_INFINITY);this.br.forEachInRange([i,l],h=>{r=r.add(h.wr)})}),Le.resolve(this.Cr(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;Ft.isDocumentKey(i)||(i=i.child(""));const l=new ss(new Ft(i),0);let h=new ws(Wn);return this.br.forEachWhile(p=>{const y=p.key.path;return!!r.isPrefixOf(y)&&(y.length===s&&(h=h.add(p.wr)),!0)},l),Le.resolve(this.Cr(h))}Cr(e){const n=[];return e.forEach(r=>{const s=this.Dr(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){Zn(this.Fr(n.batchId,"removed")===0),this.mutationQueue.shift();let r=this.br;return Le.forEach(n.mutations,s=>{const i=new ss(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.br=r})}On(e){}containsKey(e,n){const r=new ss(n,0),s=this.br.firstAfterOrEqual(r);return Le.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,Le.resolve()}Fr(e,n){return this.vr(e)}vr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Dr(e){const n=this.vr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jz{constructor(e){this.Mr=e,this.docs=function(){return new Sr(Ft.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,l=this.Mr(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:l}),this.size+=l-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return Le.resolve(r?r.document.mutableCopy():ks.newInvalidDocument(n))}getEntries(e,n){let r=Do();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():ks.newInvalidDocument(s))}),Le.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=Do();const l=n.path,h=new Ft(l.child("")),p=this.docs.getIteratorFrom(h);for(;p.hasNext();){const{key:y,value:{document:_}}=p.getNext();if(!l.isPrefixOf(y.path))break;y.path.length>l.length+1||L$(M$(_),r)<=0||(s.has(_.key)||a1(n,_))&&(i=i.insert(_.key,_.mutableCopy()))}return Le.resolve(i)}getAllFromCollectionGroup(e,n,r,s){an()}Or(e,n){return Le.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new eW(this)}getSize(e){return Le.resolve(this.size)}}class eW extends Gz{constructor(e){super(),this.cr=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.cr.addEntry(e,s)):this.cr.removeEntry(r)}),Le.waitFor(n)}getFromCache(e,n){return this.cr.getEntry(e,n)}getAllFromCache(e,n){return this.cr.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tW{constructor(e){this.persistence=e,this.Nr=new Bd(n=>Zv(n),Jv),this.lastRemoteSnapshotVersion=on.min(),this.highestTargetId=0,this.Lr=0,this.Br=new i2,this.targetCount=0,this.kr=Id.Bn()}forEachTarget(e,n){return this.Nr.forEach((r,s)=>n(s)),Le.resolve()}getLastRemoteSnapshotVersion(e){return Le.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Le.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),Le.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.Lr&&(this.Lr=n),Le.resolve()}Kn(e){this.Nr.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.kr=new Id(n),this.highestTargetId=n),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,n){return this.Kn(n),this.targetCount+=1,Le.resolve()}updateTargetData(e,n){return this.Kn(n),Le.resolve()}removeTargetData(e,n){return this.Nr.delete(n.target),this.Br.gr(n.targetId),this.targetCount-=1,Le.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.Nr.forEach((l,h)=>{h.sequenceNumber<=n&&r.get(h.targetId)===null&&(this.Nr.delete(l),i.push(this.removeMatchingKeysForTargetId(e,h.targetId)),s++)}),Le.waitFor(i).next(()=>s)}getTargetCount(e){return Le.resolve(this.targetCount)}getTargetData(e,n){const r=this.Nr.get(n)||null;return Le.resolve(r)}addMatchingKeys(e,n,r){return this.Br.Rr(n,r),Le.resolve()}removeMatchingKeys(e,n,r){this.Br.mr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(l=>{i.push(s.markPotentiallyOrphaned(e,l))}),Le.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.Br.gr(n),Le.resolve()}getMatchingKeysForTargetId(e,n){const r=this.Br.yr(n);return Le.resolve(r)}containsKey(e,n){return Le.resolve(this.Br.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nW{constructor(e,n){this.qr={},this.overlays={},this.Qr=new Kv(0),this.Kr=!1,this.Kr=!0,this.$r=new Yz,this.referenceDelegate=e(this),this.Ur=new tW(this),this.indexManager=new Wz,this.remoteDocumentCache=function(s){return new Jz(s)}(r=>this.referenceDelegate.Wr(r)),this.serializer=new $z(n),this.Gr=new Xz(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new Qz,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.qr[e.toKey()];return r||(r=new Zz(n,this.referenceDelegate),this.qr[e.toKey()]=r),r}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,n,r){vt("MemoryPersistence","Starting transaction:",e);const s=new rW(this.Qr.next());return this.referenceDelegate.zr(),r(s).next(i=>this.referenceDelegate.jr(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Hr(e,n){return Le.or(Object.values(this.qr).map(r=>()=>r.containsKey(e,n)))}}class rW extends F${constructor(e){super(),this.currentSequenceNumber=e}}class a2{constructor(e){this.persistence=e,this.Jr=new i2,this.Yr=null}static Zr(e){return new a2(e)}get Xr(){if(this.Yr)return this.Yr;throw an()}addReference(e,n,r){return this.Jr.addReference(r,n),this.Xr.delete(r.toString()),Le.resolve()}removeReference(e,n,r){return this.Jr.removeReference(r,n),this.Xr.add(r.toString()),Le.resolve()}markPotentiallyOrphaned(e,n){return this.Xr.add(n.toString()),Le.resolve()}removeTarget(e,n){this.Jr.gr(n.targetId).forEach(s=>this.Xr.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.Xr.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}zr(){this.Yr=new Set}jr(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Le.forEach(this.Xr,r=>{const s=Ft.fromPath(r);return this.ei(e,s).next(i=>{i||n.removeEntry(s,on.min())})}).next(()=>(this.Yr=null,n.apply(e)))}updateLimboDocument(e,n){return this.ei(e,n).next(r=>{r?this.Xr.delete(n.toString()):this.Xr.add(n.toString())})}Wr(e){return 0}ei(e,n){return Le.or([()=>Le.resolve(this.Jr.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Hr(e,n)])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o2{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.$i=r,this.Ui=s}static Wi(e,n){let r=Nn(),s=Nn();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new o2(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sW{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iW{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return lU()?8:V$(Ms())>0?6:4}()}initialize(e,n){this.Ji=e,this.indexManager=n,this.Gi=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.Yi(e,n).next(l=>{i.result=l}).next(()=>{if(!i.result)return this.Zi(e,n,s,r).next(l=>{i.result=l})}).next(()=>{if(i.result)return;const l=new sW;return this.Xi(e,n,l).next(h=>{if(i.result=h,this.zi)return this.es(e,n,l,h.size)})}).next(()=>i.result)}es(e,n,r,s){return r.documentReadCount<this.ji?(ch()<=Dn.DEBUG&&vt("QueryEngine","SDK will not create cache indexes for query:",Iu(n),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),Le.resolve()):(ch()<=Dn.DEBUG&&vt("QueryEngine","Query:",Iu(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.Hi*s?(ch()<=Dn.DEBUG&&vt("QueryEngine","The SDK decides to create cache indexes for query:",Iu(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Fa(n))):Le.resolve())}Yi(e,n){if(EA(n))return Le.resolve(null);let r=Fa(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=Ow(n,null,"F"),r=Fa(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const l=Nn(...i);return this.Ji.getDocuments(e,l).next(h=>this.indexManager.getMinOffset(e,r).next(p=>{const y=this.ts(n,h);return this.ns(n,y,l,p.readTime)?this.Yi(e,Ow(n,null,"F")):this.rs(e,y,n,p)}))})))}Zi(e,n,r,s){return EA(n)||s.isEqual(on.min())?Le.resolve(null):this.Ji.getDocuments(e,r).next(i=>{const l=this.ts(n,i);return this.ns(n,l,r,s)?Le.resolve(null):(ch()<=Dn.DEBUG&&vt("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Iu(n)),this.rs(e,l,n,O$(s,-1)).next(h=>h))})}ts(e,n){let r=new ws(p3(e));return n.forEach((s,i)=>{a1(e,i)&&(r=r.add(i))}),r}ns(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}Xi(e,n,r){return ch()<=Dn.DEBUG&&vt("QueryEngine","Using full collection scan to execute query:",Iu(n)),this.Ji.getDocumentsMatchingQuery(e,n,jl.min(),r)}rs(e,n,r,s){return this.Ji.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(l=>{i=i.insert(l.key,l)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aW{constructor(e,n,r,s){this.persistence=e,this.ss=n,this.serializer=s,this.os=new Sr(Wn),this._s=new Bd(i=>Zv(i),Jv),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(r)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Kz(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.os))}}function oW(t,e,n,r){return new aW(t,e,n,r)}async function L3(t,e){const n=cn(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.ls(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const l=[],h=[];let p=Nn();for(const y of s){l.push(y.batchId);for(const _ of y.mutations)p=p.add(_.key)}for(const y of i){h.push(y.batchId);for(const _ of y.mutations)p=p.add(_.key)}return n.localDocuments.getDocuments(r,p).next(y=>({hs:y,removedBatchIds:l,addedBatchIds:h}))})})}function lW(t,e){const n=cn(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.cs.newChangeBuffer({trackRemovals:!0});return function(h,p,y,_){const E=y.batch,T=E.keys();let k=Le.resolve();return T.forEach(L=>{k=k.next(()=>_.getEntry(p,L)).next(B=>{const H=y.docVersions.get(L);Zn(H!==null),B.version.compareTo(H)<0&&(E.applyToRemoteDocument(B,y),B.isValidDocument()&&(B.setReadTime(y.commitVersion),_.addEntry(B)))})}),k.next(()=>h.mutationQueue.removeMutationBatch(p,E))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(h){let p=Nn();for(let y=0;y<h.mutationResults.length;++y)h.mutationResults[y].transformResults.length>0&&(p=p.add(h.batch.mutations[y].key));return p}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function j3(t){const e=cn(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ur.getLastRemoteSnapshotVersion(n))}function cW(t,e){const n=cn(t),r=e.snapshotVersion;let s=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const l=n.cs.newChangeBuffer({trackRemovals:!0});s=n.os;const h=[];e.targetChanges.forEach((_,E)=>{const T=s.get(E);if(!T)return;h.push(n.Ur.removeMatchingKeys(i,_.removedDocuments,E).next(()=>n.Ur.addMatchingKeys(i,_.addedDocuments,E)));let k=T.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(E)!==null?k=k.withResumeToken(vs.EMPTY_BYTE_STRING,on.min()).withLastLimboFreeSnapshotVersion(on.min()):_.resumeToken.approximateByteSize()>0&&(k=k.withResumeToken(_.resumeToken,r)),s=s.insert(E,k),function(B,H,W){return B.resumeToken.approximateByteSize()===0||H.snapshotVersion.toMicroseconds()-B.snapshotVersion.toMicroseconds()>=3e8?!0:W.addedDocuments.size+W.modifiedDocuments.size+W.removedDocuments.size>0}(T,k,_)&&h.push(n.Ur.updateTargetData(i,k))});let p=Do(),y=Nn();if(e.documentUpdates.forEach(_=>{e.resolvedLimboDocuments.has(_)&&h.push(n.persistence.referenceDelegate.updateLimboDocument(i,_))}),h.push(uW(i,l,e.documentUpdates).next(_=>{p=_.Ps,y=_.Is})),!r.isEqual(on.min())){const _=n.Ur.getLastRemoteSnapshotVersion(i).next(E=>n.Ur.setTargetsMetadata(i,i.currentSequenceNumber,r));h.push(_)}return Le.waitFor(h).next(()=>l.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,p,y)).next(()=>p)}).then(i=>(n.os=s,i))}function uW(t,e,n){let r=Nn(),s=Nn();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let l=Do();return n.forEach((h,p)=>{const y=i.get(h);p.isFoundDocument()!==y.isFoundDocument()&&(s=s.add(h)),p.isNoDocument()&&p.version.isEqual(on.min())?(e.removeEntry(h,p.readTime),l=l.insert(h,p)):!y.isValidDocument()||p.version.compareTo(y.version)>0||p.version.compareTo(y.version)===0&&y.hasPendingWrites?(e.addEntry(p),l=l.insert(h,p)):vt("LocalStore","Ignoring outdated watch update for ",h,". Current version:",y.version," Watch version:",p.version)}),{Ps:l,Is:s}})}function dW(t,e){const n=cn(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function hW(t,e){const n=cn(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Ur.getTargetData(r,e).next(i=>i?(s=i,Le.resolve(s)):n.Ur.allocateTargetId(r).next(l=>(s=new ml(e,l,"TargetPurposeListen",r.currentSequenceNumber),n.Ur.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.os.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.os=n.os.insert(r.targetId,r),n._s.set(e,r.targetId)),r})}async function Vw(t,e,n){const r=cn(t),s=r.os.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,l=>r.persistence.referenceDelegate.removeTarget(l,s))}catch(l){if(!ym(l))throw l;vt("LocalStore",`Failed to update sequence numbers for target ${e}: ${l}`)}r.os=r.os.remove(e),r._s.delete(s.target)}function DA(t,e,n){const r=cn(t);let s=on.min(),i=Nn();return r.persistence.runTransaction("Execute query","readwrite",l=>function(p,y,_){const E=cn(p),T=E._s.get(_);return T!==void 0?Le.resolve(E.os.get(T)):E.Ur.getTargetData(y,_)}(r,l,Fa(e)).next(h=>{if(h)return s=h.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(l,h.targetId).next(p=>{i=p})}).next(()=>r.ss.getDocumentsMatchingQuery(l,e,n?s:on.min(),n?i:Nn())).next(h=>(fW(r,rz(e),h),{documents:h,Ts:i})))}function fW(t,e,n){let r=t.us.get(e)||on.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.us.set(e,r)}class OA{constructor(){this.activeTargetIds=cz()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class mW{constructor(){this.so=new OA,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,n,r){this.oo[e]=n}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new OA,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pW{_o(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MA{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){vt("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){vt("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let sp=null;function by(){return sp===null?sp=function(){return 268435456+Math.round(2147483648*Math.random())}():sp++,"0x"+sp.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gW={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yW{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ss="WebChannelConnection";class xW extends class{constructor(n){this.databaseInfo=n,this.databaseId=n.databaseId;const r=n.ssl?"https":"http",s=encodeURIComponent(this.databaseId.projectId),i=encodeURIComponent(this.databaseId.database);this.Do=r+"://"+n.host,this.vo=`projects/${s}/databases/${i}`,this.Co=this.databaseId.database==="(default)"?`project_id=${s}`:`project_id=${s}&database_id=${i}`}get Fo(){return!1}Mo(n,r,s,i,l){const h=by(),p=this.xo(n,r.toUriEncodedString());vt("RestConnection",`Sending RPC '${n}' ${h}:`,p,s);const y={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(y,i,l),this.No(n,p,y,s).then(_=>(vt("RestConnection",`Received RPC '${n}' ${h}: `,_),_),_=>{throw _d("RestConnection",`RPC '${n}' ${h} failed with error: `,_,"url: ",p,"request:",s),_})}Lo(n,r,s,i,l,h){return this.Mo(n,r,s,i,l)}Oo(n,r,s){n["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Vd}(),n["Content-Type"]="text/plain",this.databaseInfo.appId&&(n["X-Firebase-GMPID"]=this.databaseInfo.appId),r&&r.headers.forEach((i,l)=>n[l]=i),s&&s.headers.forEach((i,l)=>n[l]=i)}xo(n,r){const s=gW[n];return`${this.Do}/v1/${r}:${s}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,n,r,s){const i=by();return new Promise((l,h)=>{const p=new YP;p.setWithCredentials(!0),p.listenOnce(ZP.COMPLETE,()=>{try{switch(p.getLastErrorCode()){case Fp.NO_ERROR:const _=p.getResponseJson();vt(Ss,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(_)),l(_);break;case Fp.TIMEOUT:vt(Ss,`RPC '${e}' ${i} timed out`),h(new dt(Re.DEADLINE_EXCEEDED,"Request time out"));break;case Fp.HTTP_ERROR:const E=p.getStatus();if(vt(Ss,`RPC '${e}' ${i} failed with status:`,E,"response text:",p.getResponseText()),E>0){let T=p.getResponseJson();Array.isArray(T)&&(T=T[0]);const k=T==null?void 0:T.error;if(k&&k.status&&k.message){const L=function(H){const W=H.toLowerCase().replace(/_/g,"-");return Object.values(Re).indexOf(W)>=0?W:Re.UNKNOWN}(k.status);h(new dt(L,k.message))}else h(new dt(Re.UNKNOWN,"Server responded with status "+p.getStatus()))}else h(new dt(Re.UNAVAILABLE,"Connection failed."));break;default:an()}}finally{vt(Ss,`RPC '${e}' ${i} completed.`)}});const y=JSON.stringify(s);vt(Ss,`RPC '${e}' ${i} sending request:`,s),p.send(n,"POST",y,r,15)})}Bo(e,n,r){const s=by(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],l=t3(),h=e3(),p={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},y=this.longPollingOptions.timeoutSeconds;y!==void 0&&(p.longPollingTimeout=Math.round(1e3*y)),this.useFetchStreams&&(p.useFetchStreams=!0),this.Oo(p.initMessageHeaders,n,r),p.encodeInitMessageHeaders=!0;const _=i.join("");vt(Ss,`Creating RPC '${e}' stream ${s}: ${_}`,p);const E=l.createWebChannel(_,p);let T=!1,k=!1;const L=new yW({Io:H=>{k?vt(Ss,`Not sending because RPC '${e}' stream ${s} is closed:`,H):(T||(vt(Ss,`Opening RPC '${e}' stream ${s} transport.`),E.open(),T=!0),vt(Ss,`RPC '${e}' stream ${s} sending:`,H),E.send(H))},To:()=>E.close()}),B=(H,W,M)=>{H.listen(W,U=>{try{M(U)}catch($){setTimeout(()=>{throw $},0)}})};return B(E,Ch.EventType.OPEN,()=>{k||(vt(Ss,`RPC '${e}' stream ${s} transport opened.`),L.yo())}),B(E,Ch.EventType.CLOSE,()=>{k||(k=!0,vt(Ss,`RPC '${e}' stream ${s} transport closed`),L.So())}),B(E,Ch.EventType.ERROR,H=>{k||(k=!0,_d(Ss,`RPC '${e}' stream ${s} transport errored:`,H),L.So(new dt(Re.UNAVAILABLE,"The operation could not be completed")))}),B(E,Ch.EventType.MESSAGE,H=>{var W;if(!k){const M=H.data[0];Zn(!!M);const U=M,$=U.error||((W=U[0])===null||W===void 0?void 0:W.error);if($){vt(Ss,`RPC '${e}' stream ${s} received error:`,$);const K=$.status;let Z=function(N){const D=Hr[N];if(D!==void 0)return T3(D)}(K),A=$.message;Z===void 0&&(Z=Re.INTERNAL,A="Unknown error status: "+K+" with message "+$.message),k=!0,L.So(new dt(Z,A)),E.close()}else vt(Ss,`RPC '${e}' stream ${s} received:`,M),L.bo(M)}}),B(h,JP.STAT_EVENT,H=>{H.stat===Sw.PROXY?vt(Ss,`RPC '${e}' stream ${s} detected buffering proxy`):H.stat===Sw.NOPROXY&&vt(Ss,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{L.wo()},0),L}}function Iy(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function d1(t){return new Sz(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F3{constructor(e,n,r=1e3,s=1.5,i=6e4){this.ui=e,this.timerId=n,this.ko=r,this.qo=s,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const n=Math.floor(this.Ko+this.zo()),r=Math.max(0,Date.now()-this.Uo),s=Math.max(0,n-r);s>0&&vt("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.Ko} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,s,()=>(this.Uo=Date.now(),e())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V3{constructor(e,n,r,s,i,l,h,p){this.ui=e,this.Ho=r,this.Jo=s,this.connection=i,this.authCredentialsProvider=l,this.appCheckCredentialsProvider=h,this.listener=p,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new F3(e,n)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,n){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,e!==4?this.t_.reset():n&&n.code===Re.RESOURCE_EXHAUSTED?(ko(n.toString()),ko("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):n&&n.code===Re.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(n)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),n=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.Yo===n&&this.P_(r,s)},r=>{e(()=>{const s=new dt(Re.UNKNOWN,"Fetching auth token failed: "+r.message);return this.I_(s)})})}P_(e,n){const r=this.h_(this.Yo);this.stream=this.T_(e,n),this.stream.Eo(()=>{r(()=>this.listener.Eo())}),this.stream.Ro(()=>{r(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(s=>{r(()=>this.I_(s))}),this.stream.onMessage(s=>{r(()=>++this.e_==1?this.E_(s):this.onNext(s))})}i_(){this.state=5,this.t_.Go(async()=>{this.state=0,this.start()})}I_(e){return vt("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return n=>{this.ui.enqueueAndForget(()=>this.Yo===e?n():(vt("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class wW extends V3{constructor(e,n,r,s,i,l){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,l),this.serializer=i}T_(e,n){return this.connection.Bo("Listen",e,n)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const n=Pz(this.serializer,e),r=function(i){if(!("targetChange"in i))return on.min();const l=i.targetChange;return l.targetIds&&l.targetIds.length?on.min():l.readTime?Va(l.readTime):on.min()}(e);return this.listener.d_(n,r)}A_(e){const n={};n.database=Fw(this.serializer),n.addTarget=function(i,l){let h;const p=l.target;if(h=kw(p)?{documents:Oz(i,p)}:{query:Mz(i,p)._t},h.targetId=l.targetId,l.resumeToken.approximateByteSize()>0){h.resumeToken=N3(i,l.resumeToken);const y=Mw(i,l.expectedCount);y!==null&&(h.expectedCount=y)}else if(l.snapshotVersion.compareTo(on.min())>0){h.readTime=q0(i,l.snapshotVersion.toTimestamp());const y=Mw(i,l.expectedCount);y!==null&&(h.expectedCount=y)}return h}(this.serializer,e);const r=jz(this.serializer,e);r&&(n.labels=r),this.a_(n)}R_(e){const n={};n.database=Fw(this.serializer),n.removeTarget=e,this.a_(n)}}class _W extends V3{constructor(e,n,r,s,i,l){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,l),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,n){return this.connection.Bo("Write",e,n)}E_(e){return Zn(!!e.streamToken),this.lastStreamToken=e.streamToken,Zn(!e.writeResults||e.writeResults.length===0),this.listener.f_()}onNext(e){Zn(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const n=Dz(e.writeResults,e.commitTime),r=Va(e.commitTime);return this.listener.g_(r,n)}p_(){const e={};e.database=Fw(this.serializer),this.a_(e)}m_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>kz(this.serializer,r))};this.a_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vW extends class{}{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.y_=!1}w_(){if(this.y_)throw new dt(Re.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,n,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,l])=>this.connection.Mo(e,Lw(n,r),s,i,l)).catch(i=>{throw i.name==="FirebaseError"?(i.code===Re.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new dt(Re.UNKNOWN,i.toString())})}Lo(e,n,r,s,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([l,h])=>this.connection.Lo(e,Lw(n,r),s,l,h,i)).catch(l=>{throw l.name==="FirebaseError"?(l.code===Re.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),l):new dt(Re.UNKNOWN,l.toString())})}terminate(){this.y_=!0,this.connection.terminate()}}class EW{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(e){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,e==="Online"&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(ko(n),this.D_=!1):vt("OnlineStateTracker",n)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bW{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o(l=>{r.enqueueAndForget(async()=>{lu(this)&&(vt("RemoteStore","Restarting streams for network reachability change."),await async function(p){const y=cn(p);y.L_.add(4),await vm(y),y.q_.set("Unknown"),y.L_.delete(4),await h1(y)}(this))})}),this.q_=new EW(r,s)}}async function h1(t){if(lu(t))for(const e of t.B_)await e(!0)}async function vm(t){for(const e of t.B_)await e(!1)}function B3(t,e){const n=cn(t);n.N_.has(e.targetId)||(n.N_.set(e.targetId,e),d2(n)?u2(n):Ud(n).r_()&&c2(n,e))}function l2(t,e){const n=cn(t),r=Ud(n);n.N_.delete(e),r.r_()&&U3(n,e),n.N_.size===0&&(r.r_()?r.o_():lu(n)&&n.q_.set("Unknown"))}function c2(t,e){if(t.Q_.xe(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(on.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Ud(t).A_(e)}function U3(t,e){t.Q_.xe(e),Ud(t).R_(e)}function u2(t){t.Q_=new Iz({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),ot:e=>t.N_.get(e)||null,tt:()=>t.datastore.serializer.databaseId}),Ud(t).start(),t.q_.v_()}function d2(t){return lu(t)&&!Ud(t).n_()&&t.N_.size>0}function lu(t){return cn(t).L_.size===0}function $3(t){t.Q_=void 0}async function IW(t){t.q_.set("Online")}async function AW(t){t.N_.forEach((e,n)=>{c2(t,e)})}async function TW(t,e){$3(t),d2(t)?(t.q_.M_(e),u2(t)):t.q_.set("Unknown")}async function CW(t,e,n){if(t.q_.set("Online"),e instanceof S3&&e.state===2&&e.cause)try{await async function(s,i){const l=i.cause;for(const h of i.targetIds)s.N_.has(h)&&(await s.remoteSyncer.rejectListen(h,l),s.N_.delete(h),s.Q_.removeTarget(h))}(t,e)}catch(r){vt("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),await K0(t,r)}else if(e instanceof Up?t.Q_.Ke(e):e instanceof C3?t.Q_.He(e):t.Q_.We(e),!n.isEqual(on.min()))try{const r=await j3(t.localStore);n.compareTo(r)>=0&&await function(i,l){const h=i.Q_.rt(l);return h.targetChanges.forEach((p,y)=>{if(p.resumeToken.approximateByteSize()>0){const _=i.N_.get(y);_&&i.N_.set(y,_.withResumeToken(p.resumeToken,l))}}),h.targetMismatches.forEach((p,y)=>{const _=i.N_.get(p);if(!_)return;i.N_.set(p,_.withResumeToken(vs.EMPTY_BYTE_STRING,_.snapshotVersion)),U3(i,p);const E=new ml(_.target,p,y,_.sequenceNumber);c2(i,E)}),i.remoteSyncer.applyRemoteEvent(h)}(t,n)}catch(r){vt("RemoteStore","Failed to raise snapshot:",r),await K0(t,r)}}async function K0(t,e,n){if(!ym(e))throw e;t.L_.add(1),await vm(t),t.q_.set("Offline"),n||(n=()=>j3(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{vt("RemoteStore","Retrying IndexedDB access"),await n(),t.L_.delete(1),await h1(t)})}function z3(t,e){return e().catch(n=>K0(t,n,e))}async function f1(t){const e=cn(t),n=Vl(e);let r=e.O_.length>0?e.O_[e.O_.length-1].batchId:-1;for(;SW(e);)try{const s=await dW(e.localStore,r);if(s===null){e.O_.length===0&&n.o_();break}r=s.batchId,NW(e,s)}catch(s){await K0(e,s)}W3(e)&&H3(e)}function SW(t){return lu(t)&&t.O_.length<10}function NW(t,e){t.O_.push(e);const n=Vl(t);n.r_()&&n.V_&&n.m_(e.mutations)}function W3(t){return lu(t)&&!Vl(t).n_()&&t.O_.length>0}function H3(t){Vl(t).start()}async function RW(t){Vl(t).p_()}async function PW(t){const e=Vl(t);for(const n of t.O_)e.m_(n.mutations)}async function kW(t,e,n){const r=t.O_.shift(),s=n2.from(r,e,n);await z3(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await f1(t)}async function DW(t,e){e&&Vl(t).V_&&await async function(r,s){if(function(l){return vz(l)&&l!==Re.ABORTED}(s.code)){const i=r.O_.shift();Vl(r).s_(),await z3(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await f1(r)}}(t,e),W3(t)&&H3(t)}async function LA(t,e){const n=cn(t);n.asyncQueue.verifyOperationInProgress(),vt("RemoteStore","RemoteStore received new credentials");const r=lu(n);n.L_.add(3),await vm(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.L_.delete(3),await h1(n)}async function OW(t,e){const n=cn(t);e?(n.L_.delete(2),await h1(n)):e||(n.L_.add(2),await vm(n),n.q_.set("Unknown"))}function Ud(t){return t.K_||(t.K_=function(n,r,s){const i=cn(n);return i.w_(),new wW(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:IW.bind(null,t),Ro:AW.bind(null,t),mo:TW.bind(null,t),d_:CW.bind(null,t)}),t.B_.push(async e=>{e?(t.K_.s_(),d2(t)?u2(t):t.q_.set("Unknown")):(await t.K_.stop(),$3(t))})),t.K_}function Vl(t){return t.U_||(t.U_=function(n,r,s){const i=cn(n);return i.w_(),new _W(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{Eo:()=>Promise.resolve(),Ro:RW.bind(null,t),mo:DW.bind(null,t),f_:PW.bind(null,t),g_:kW.bind(null,t)}),t.B_.push(async e=>{e?(t.U_.s_(),await f1(t)):(await t.U_.stop(),t.O_.length>0&&(vt("RemoteStore",`Stopping write stream with ${t.O_.length} pending writes`),t.O_=[]))})),t.U_}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class h2{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new wo,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(l=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const l=Date.now()+r,h=new h2(e,n,l,s,i);return h.start(r),h}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new dt(Re.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function f2(t,e){if(ko("AsyncQueue",`${e}: ${t}`),ym(t))return new dt(Re.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qu{constructor(e){this.comparator=e?(n,r)=>e(n,r)||Ft.comparator(n.key,r.key):(n,r)=>Ft.comparator(n.key,r.key),this.keyedMap=Sh(),this.sortedSet=new Sr(this.comparator)}static emptySet(e){return new Qu(e.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Qu)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Qu;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jA{constructor(){this.W_=new Sr(Ft.comparator)}track(e){const n=e.doc.key,r=this.W_.get(n);r?e.type!==0&&r.type===3?this.W_=this.W_.insert(n,e):e.type===3&&r.type!==1?this.W_=this.W_.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.W_=this.W_.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.W_=this.W_.remove(n):e.type===1&&r.type===2?this.W_=this.W_.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.W_=this.W_.insert(n,{type:2,doc:e.doc}):an():this.W_=this.W_.insert(n,e)}G_(){const e=[];return this.W_.inorderTraversal((n,r)=>{e.push(r)}),e}}class Ad{constructor(e,n,r,s,i,l,h,p,y){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=l,this.syncStateChanged=h,this.excludesMetadataChanges=p,this.hasCachedResults=y}static fromInitialDocuments(e,n,r,s,i){const l=[];return n.forEach(h=>{l.push({type:0,doc:h})}),new Ad(e,n,Qu.emptySet(n),l,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&i1(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MW{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(e=>e.J_())}}class LW{constructor(){this.queries=FA(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(n,r){const s=cn(n),i=s.queries;s.queries=FA(),i.forEach((l,h)=>{for(const p of h.j_)p.onError(r)})})(this,new dt(Re.ABORTED,"Firestore shutting down"))}}function FA(){return new Bd(t=>m3(t),i1)}async function G3(t,e){const n=cn(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.H_()&&e.J_()&&(r=2):(i=new MW,r=e.J_()?0:1);try{switch(r){case 0:i.z_=await n.onListen(s,!0);break;case 1:i.z_=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(l){const h=f2(l,`Initialization of query '${Iu(e.query)}' failed`);return void e.onError(h)}n.queries.set(s,i),i.j_.push(e),e.Z_(n.onlineState),i.z_&&e.X_(i.z_)&&m2(n)}async function q3(t,e){const n=cn(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const l=i.j_.indexOf(e);l>=0&&(i.j_.splice(l,1),i.j_.length===0?s=e.J_()?0:1:!i.H_()&&e.J_()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function jW(t,e){const n=cn(t);let r=!1;for(const s of e){const i=s.query,l=n.queries.get(i);if(l){for(const h of l.j_)h.X_(s)&&(r=!0);l.z_=s}}r&&m2(n)}function FW(t,e,n){const r=cn(t),s=r.queries.get(e);if(s)for(const i of s.j_)i.onError(n);r.queries.delete(e)}function m2(t){t.Y_.forEach(e=>{e.next()})}var Bw,VA;(VA=Bw||(Bw={})).ea="default",VA.Cache="cache";class K3{constructor(e,n,r){this.query=e,this.ta=n,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=r||{}}X_(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new Ad(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.na?this.ia(e)&&(this.ta.next(e),n=!0):this.sa(e,this.onlineState)&&(this.oa(e),n=!0),this.ra=e,n}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let n=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),n=!0),n}sa(e,n){if(!e.fromCache||!this.J_())return!0;const r=n!=="Offline";return(!this.options._a||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}ia(e){if(e.docChanges.length>0)return!0;const n=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}oa(e){e=Ad.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Bw.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X3{constructor(e){this.key=e}}class Q3{constructor(e){this.key=e}}class VW{constructor(e,n){this.query=e,this.Ta=n,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Nn(),this.mutatedKeys=Nn(),this.Aa=p3(e),this.Ra=new Qu(this.Aa)}get Va(){return this.Ta}ma(e,n){const r=n?n.fa:new jA,s=n?n.Ra:this.Ra;let i=n?n.mutatedKeys:this.mutatedKeys,l=s,h=!1;const p=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,y=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((_,E)=>{const T=s.get(_),k=a1(this.query,E)?E:null,L=!!T&&this.mutatedKeys.has(T.key),B=!!k&&(k.hasLocalMutations||this.mutatedKeys.has(k.key)&&k.hasCommittedMutations);let H=!1;T&&k?T.data.isEqual(k.data)?L!==B&&(r.track({type:3,doc:k}),H=!0):this.ga(T,k)||(r.track({type:2,doc:k}),H=!0,(p&&this.Aa(k,p)>0||y&&this.Aa(k,y)<0)&&(h=!0)):!T&&k?(r.track({type:0,doc:k}),H=!0):T&&!k&&(r.track({type:1,doc:T}),H=!0,(p||y)&&(h=!0)),H&&(k?(l=l.add(k),i=B?i.add(_):i.delete(_)):(l=l.delete(_),i=i.delete(_)))}),this.query.limit!==null)for(;l.size>this.query.limit;){const _=this.query.limitType==="F"?l.last():l.first();l=l.delete(_.key),i=i.delete(_.key),r.track({type:1,doc:_})}return{Ra:l,fa:r,ns:h,mutatedKeys:i}}ga(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const l=e.fa.G_();l.sort((_,E)=>function(k,L){const B=H=>{switch(H){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return an()}};return B(k)-B(L)}(_.type,E.type)||this.Aa(_.doc,E.doc)),this.pa(r),s=s!=null&&s;const h=n&&!s?this.ya():[],p=this.da.size===0&&this.current&&!s?1:0,y=p!==this.Ea;return this.Ea=p,l.length!==0||y?{snapshot:new Ad(this.query,e.Ra,i,l,e.mutatedKeys,p===0,y,!1,!!r&&r.resumeToken.approximateByteSize()>0),wa:h}:{wa:h}}Z_(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new jA,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach(n=>this.Ta=this.Ta.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ta=this.Ta.delete(n)),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Nn(),this.Ra.forEach(r=>{this.Sa(r.key)&&(this.da=this.da.add(r.key))});const n=[];return e.forEach(r=>{this.da.has(r)||n.push(new Q3(r))}),this.da.forEach(r=>{e.has(r)||n.push(new X3(r))}),n}ba(e){this.Ta=e.Ts,this.da=Nn();const n=this.ma(e.documents);return this.applyChanges(n,!0)}Da(){return Ad.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}}class BW{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class UW{constructor(e){this.key=e,this.va=!1}}class $W{constructor(e,n,r,s,i,l){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=l,this.Ca={},this.Fa=new Bd(h=>m3(h),i1),this.Ma=new Map,this.xa=new Set,this.Oa=new Sr(Ft.comparator),this.Na=new Map,this.La=new i2,this.Ba={},this.ka=new Map,this.qa=Id.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}}async function zW(t,e,n=!0){const r=nk(t);let s;const i=r.Fa.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.Da()):s=await Y3(r,e,n,!0),s}async function WW(t,e){const n=nk(t);await Y3(n,e,!0,!1)}async function Y3(t,e,n,r){const s=await hW(t.localStore,Fa(e)),i=s.targetId,l=t.sharedClientState.addLocalQueryTarget(i,n);let h;return r&&(h=await HW(t,e,i,l==="current",s.resumeToken)),t.isPrimaryClient&&n&&B3(t.remoteStore,s),h}async function HW(t,e,n,r,s){t.Ka=(E,T,k)=>async function(B,H,W,M){let U=H.view.ma(W);U.ns&&(U=await DA(B.localStore,H.query,!1).then(({documents:A})=>H.view.ma(A,U)));const $=M&&M.targetChanges.get(H.targetId),K=M&&M.targetMismatches.get(H.targetId)!=null,Z=H.view.applyChanges(U,B.isPrimaryClient,$,K);return UA(B,H.targetId,Z.wa),Z.snapshot}(t,E,T,k);const i=await DA(t.localStore,e,!0),l=new VW(e,i.Ts),h=l.ma(i.documents),p=_m.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),y=l.applyChanges(h,t.isPrimaryClient,p);UA(t,n,y.wa);const _=new BW(e,n,l);return t.Fa.set(e,_),t.Ma.has(n)?t.Ma.get(n).push(e):t.Ma.set(n,[e]),y.snapshot}async function GW(t,e,n){const r=cn(t),s=r.Fa.get(e),i=r.Ma.get(s.targetId);if(i.length>1)return r.Ma.set(s.targetId,i.filter(l=>!i1(l,e))),void r.Fa.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await Vw(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&l2(r.remoteStore,s.targetId),Uw(r,s.targetId)}).catch(gm)):(Uw(r,s.targetId),await Vw(r.localStore,s.targetId,!0))}async function qW(t,e){const n=cn(t),r=n.Fa.get(e),s=n.Ma.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),l2(n.remoteStore,r.targetId))}async function KW(t,e,n){const r=tH(t);try{const s=await function(l,h){const p=cn(l),y=Xn.now(),_=h.reduce((k,L)=>k.add(L.key),Nn());let E,T;return p.persistence.runTransaction("Locally write mutations","readwrite",k=>{let L=Do(),B=Nn();return p.cs.getEntries(k,_).next(H=>{L=H,L.forEach((W,M)=>{M.isValidDocument()||(B=B.add(W))})}).next(()=>p.localDocuments.getOverlayedDocuments(k,L)).next(H=>{E=H;const W=[];for(const M of h){const U=gz(M,E.get(M.key).overlayedDocument);U!=null&&W.push(new ql(M.key,U,a3(U.value.mapValue),di.exists(!0)))}return p.mutationQueue.addMutationBatch(k,y,W,h)}).next(H=>{T=H;const W=H.applyToLocalDocumentSet(E,B);return p.documentOverlayCache.saveOverlays(k,H.batchId,W)})}).then(()=>({batchId:T.batchId,changes:y3(E)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(l,h,p){let y=l.Ba[l.currentUser.toKey()];y||(y=new Sr(Wn)),y=y.insert(h,p),l.Ba[l.currentUser.toKey()]=y}(r,s.batchId,n),await Em(r,s.changes),await f1(r.remoteStore)}catch(s){const i=f2(s,"Failed to persist write");n.reject(i)}}async function Z3(t,e){const n=cn(t);try{const r=await cW(n.localStore,e);e.targetChanges.forEach((s,i)=>{const l=n.Na.get(i);l&&(Zn(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?l.va=!0:s.modifiedDocuments.size>0?Zn(l.va):s.removedDocuments.size>0&&(Zn(l.va),l.va=!1))}),await Em(n,r,e)}catch(r){await gm(r)}}function BA(t,e,n){const r=cn(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.Fa.forEach((i,l)=>{const h=l.view.Z_(e);h.snapshot&&s.push(h.snapshot)}),function(l,h){const p=cn(l);p.onlineState=h;let y=!1;p.queries.forEach((_,E)=>{for(const T of E.j_)T.Z_(h)&&(y=!0)}),y&&m2(p)}(r.eventManager,e),s.length&&r.Ca.d_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function XW(t,e,n){const r=cn(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Na.get(e),i=s&&s.key;if(i){let l=new Sr(Ft.comparator);l=l.insert(i,ks.newNoDocument(i,on.min()));const h=Nn().add(i),p=new u1(on.min(),new Map,new Sr(Wn),l,h);await Z3(r,p),r.Oa=r.Oa.remove(i),r.Na.delete(e),p2(r)}else await Vw(r.localStore,e,!1).then(()=>Uw(r,e,n)).catch(gm)}async function QW(t,e){const n=cn(t),r=e.batch.batchId;try{const s=await lW(n.localStore,e);ek(n,r,null),J3(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Em(n,s)}catch(s){await gm(s)}}async function YW(t,e,n){const r=cn(t);try{const s=await function(l,h){const p=cn(l);return p.persistence.runTransaction("Reject batch","readwrite-primary",y=>{let _;return p.mutationQueue.lookupMutationBatch(y,h).next(E=>(Zn(E!==null),_=E.keys(),p.mutationQueue.removeMutationBatch(y,E))).next(()=>p.mutationQueue.performConsistencyCheck(y)).next(()=>p.documentOverlayCache.removeOverlaysForBatchId(y,_,h)).next(()=>p.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(y,_)).next(()=>p.localDocuments.getDocuments(y,_))})}(r.localStore,e);ek(r,e,n),J3(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Em(r,s)}catch(s){await gm(s)}}function J3(t,e){(t.ka.get(e)||[]).forEach(n=>{n.resolve()}),t.ka.delete(e)}function ek(t,e,n){const r=cn(t);let s=r.Ba[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Ba[r.currentUser.toKey()]=s}}function Uw(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Ma.get(e))t.Fa.delete(r),n&&t.Ca.$a(r,n);t.Ma.delete(e),t.isPrimaryClient&&t.La.gr(e).forEach(r=>{t.La.containsKey(r)||tk(t,r)})}function tk(t,e){t.xa.delete(e.path.canonicalString());const n=t.Oa.get(e);n!==null&&(l2(t.remoteStore,n),t.Oa=t.Oa.remove(e),t.Na.delete(n),p2(t))}function UA(t,e,n){for(const r of n)r instanceof X3?(t.La.addReference(r.key,e),ZW(t,r)):r instanceof Q3?(vt("SyncEngine","Document no longer in limbo: "+r.key),t.La.removeReference(r.key,e),t.La.containsKey(r.key)||tk(t,r.key)):an()}function ZW(t,e){const n=e.key,r=n.path.canonicalString();t.Oa.get(n)||t.xa.has(r)||(vt("SyncEngine","New document in limbo: "+n),t.xa.add(r),p2(t))}function p2(t){for(;t.xa.size>0&&t.Oa.size<t.maxConcurrentLimboResolutions;){const e=t.xa.values().next().value;t.xa.delete(e);const n=new Ft(gr.fromString(e)),r=t.qa.next();t.Na.set(r,new UW(n)),t.Oa=t.Oa.insert(n,r),B3(t.remoteStore,new ml(Fa(e2(n.path)),r,"TargetPurposeLimboResolution",Kv.oe))}}async function Em(t,e,n){const r=cn(t),s=[],i=[],l=[];r.Fa.isEmpty()||(r.Fa.forEach((h,p)=>{l.push(r.Ka(p,e,n).then(y=>{var _;if((y||n)&&r.isPrimaryClient){const E=y?!y.fromCache:(_=n==null?void 0:n.targetChanges.get(p.targetId))===null||_===void 0?void 0:_.current;r.sharedClientState.updateQueryState(p.targetId,E?"current":"not-current")}if(y){s.push(y);const E=o2.Wi(p.targetId,y);i.push(E)}}))}),await Promise.all(l),r.Ca.d_(s),await async function(p,y){const _=cn(p);try{await _.persistence.runTransaction("notifyLocalViewChanges","readwrite",E=>Le.forEach(y,T=>Le.forEach(T.$i,k=>_.persistence.referenceDelegate.addReference(E,T.targetId,k)).next(()=>Le.forEach(T.Ui,k=>_.persistence.referenceDelegate.removeReference(E,T.targetId,k)))))}catch(E){if(!ym(E))throw E;vt("LocalStore","Failed to update sequence numbers: "+E)}for(const E of y){const T=E.targetId;if(!E.fromCache){const k=_.os.get(T),L=k.snapshotVersion,B=k.withLastLimboFreeSnapshotVersion(L);_.os=_.os.insert(T,B)}}}(r.localStore,i))}async function JW(t,e){const n=cn(t);if(!n.currentUser.isEqual(e)){vt("SyncEngine","User change. New user:",e.toKey());const r=await L3(n.localStore,e);n.currentUser=e,function(i,l){i.ka.forEach(h=>{h.forEach(p=>{p.reject(new dt(Re.CANCELLED,l))})}),i.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Em(n,r.hs)}}function eH(t,e){const n=cn(t),r=n.Na.get(e);if(r&&r.va)return Nn().add(r.key);{let s=Nn();const i=n.Ma.get(e);if(!i)return s;for(const l of i){const h=n.Fa.get(l);s=s.unionWith(h.view.Va)}return s}}function nk(t){const e=cn(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=Z3.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=eH.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=XW.bind(null,e),e.Ca.d_=jW.bind(null,e.eventManager),e.Ca.$a=FW.bind(null,e.eventManager),e}function tH(t){const e=cn(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=QW.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=YW.bind(null,e),e}class X0{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=d1(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,n){return null}Ha(e,n){return null}za(e){return oW(this.persistence,new iW,e.initialUser,this.serializer)}Ga(e){return new nW(a2.Zr,this.serializer)}Wa(e){return new mW}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}X0.provider={build:()=>new X0};class $w{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>BA(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=JW.bind(null,this.syncEngine),await OW(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new LW}()}createDatastore(e){const n=d1(e.databaseInfo.databaseId),r=function(i){return new xW(i)}(e.databaseInfo);return function(i,l,h,p){return new vW(i,l,h,p)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,l,h){return new bW(r,s,i,l,h)}(this.localStore,this.datastore,e.asyncQueue,n=>BA(this.syncEngine,n,0),function(){return MA.D()?new MA:new pW}())}createSyncEngine(e,n){return function(s,i,l,h,p,y,_){const E=new $W(s,i,l,h,p,y);return _&&(E.Qa=!0),E}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=cn(s);vt("RemoteStore","RemoteStore shutting down."),i.L_.add(5),await vm(i),i.k_.shutdown(),i.q_.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}$w.provider={build:()=>new $w};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rk{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):ko("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nH{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=Rs.UNAUTHENTICATED,this.clientId=r3.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async l=>{vt("FirestoreClient","Received user=",l.uid),await this.authCredentialListener(l),this.user=l}),this.appCheckCredentials.start(r,l=>(vt("FirestoreClient","Received new app check token=",l),this.appCheckCredentialListener(l,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new wo;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=f2(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function Ay(t,e){t.asyncQueue.verifyOperationInProgress(),vt("FirestoreClient","Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await L3(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function $A(t,e){t.asyncQueue.verifyOperationInProgress();const n=await rH(t);vt("FirestoreClient","Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>LA(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>LA(e.remoteStore,s)),t._onlineComponents=e}async function rH(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){vt("FirestoreClient","Using user provided OfflineComponentProvider");try{await Ay(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===Re.FAILED_PRECONDITION||s.code===Re.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;_d("Error using user provided cache. Falling back to memory cache: "+n),await Ay(t,new X0)}}else vt("FirestoreClient","Using default OfflineComponentProvider"),await Ay(t,new X0);return t._offlineComponents}async function sk(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(vt("FirestoreClient","Using user provided OnlineComponentProvider"),await $A(t,t._uninitializedComponentsProvider._online)):(vt("FirestoreClient","Using default OnlineComponentProvider"),await $A(t,new $w))),t._onlineComponents}function sH(t){return sk(t).then(e=>e.syncEngine)}async function ik(t){const e=await sk(t),n=e.eventManager;return n.onListen=zW.bind(null,e.syncEngine),n.onUnlisten=GW.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=WW.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=qW.bind(null,e.syncEngine),n}function iH(t,e,n={}){const r=new wo;return t.asyncQueue.enqueueAndForget(async()=>function(i,l,h,p,y){const _=new rk({next:T=>{_.Za(),l.enqueueAndForget(()=>q3(i,E));const k=T.docs.has(h);!k&&T.fromCache?y.reject(new dt(Re.UNAVAILABLE,"Failed to get document because the client is offline.")):k&&T.fromCache&&p&&p.source==="server"?y.reject(new dt(Re.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):y.resolve(T)},error:T=>y.reject(T)}),E=new K3(e2(h.path),_,{includeMetadataChanges:!0,_a:!0});return G3(i,E)}(await ik(t),t.asyncQueue,e,n,r)),r.promise}function aH(t,e,n={}){const r=new wo;return t.asyncQueue.enqueueAndForget(async()=>function(i,l,h,p,y){const _=new rk({next:T=>{_.Za(),l.enqueueAndForget(()=>q3(i,E)),T.fromCache&&p.source==="server"?y.reject(new dt(Re.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):y.resolve(T)},error:T=>y.reject(T)}),E=new K3(h,_,{includeMetadataChanges:!0,_a:!0});return G3(i,E)}(await ik(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ak(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zA=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ok(t,e,n){if(!n)throw new dt(Re.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function oH(t,e,n,r){if(e===!0&&r===!0)throw new dt(Re.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function WA(t){if(!Ft.isDocumentKey(t))throw new dt(Re.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function HA(t){if(Ft.isDocumentKey(t))throw new dt(Re.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function m1(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":an()}function fa(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new dt(Re.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=m1(t);throw new dt(Re.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GA{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new dt(Re.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new dt(Re.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}oH("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=ak((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new dt(Re.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new dt(Re.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new dt(Re.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class p1{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new GA({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new dt(Re.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new dt(Re.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new GA(e),e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new A$;switch(r.type){case"firstParty":return new N$(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new dt(Re.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=zA.get(n);r&&(vt("ComponentProvider","Removing Datastore"),zA.delete(n),r.terminate())}(this),Promise.resolve()}}function lH(t,e,n,r={}){var s;const i=(t=fa(t,p1))._getSettings(),l=`${e}:${n}`;if(i.host!=="firestore.googleapis.com"&&i.host!==l&&_d("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),t._setSettings(Object.assign(Object.assign({},i),{host:l,ssl:!1})),r.mockUserToken){let h,p;if(typeof r.mockUserToken=="string")h=r.mockUserToken,p=Rs.MOCK_USER;else{h=WP(r.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const y=r.mockUserToken.sub||r.mockUserToken.user_id;if(!y)throw new dt(Re.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");p=new Rs(y)}t._authCredentials=new T$(new n3(h,p))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $d{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new $d(this.firestore,e,this._query)}}class zs{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Nl(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new zs(this.firestore,e,this._key)}}class Nl extends $d{constructor(e,n,r){super(e,n,e2(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new zs(this.firestore,null,new Ft(e))}withConverter(e){return new Nl(this.firestore,e,this._path)}}function Bs(t,e,...n){if(t=us(t),ok("collection","path",e),t instanceof p1){const r=gr.fromString(e,...n);return HA(r),new Nl(t,null,r)}{if(!(t instanceof zs||t instanceof Nl))throw new dt(Re.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(gr.fromString(e,...n));return HA(r),new Nl(t.firestore,null,r)}}function ii(t,e,...n){if(t=us(t),arguments.length===1&&(e=r3.newId()),ok("doc","path",e),t instanceof p1){const r=gr.fromString(e,...n);return WA(r),new zs(t,null,new Ft(r))}{if(!(t instanceof zs||t instanceof Nl))throw new dt(Re.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(gr.fromString(e,...n));return WA(r),new zs(t.firestore,t instanceof Nl?t.converter:null,new Ft(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qA{constructor(e=Promise.resolve()){this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new F3(this,"async_queue_retry"),this.Vu=()=>{const r=Iy();r&&vt("AsyncQueue","Visibility state changed to "+r.visibilityState),this.t_.jo()},this.mu=e;const n=Iy();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const n=Iy();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise(()=>{});const n=new wo;return this.gu(()=>this.Iu&&this.Au?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Pu.push(e),this.pu()))}async pu(){if(this.Pu.length!==0){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!ym(e))throw e;vt("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go(()=>this.pu())}}gu(e){const n=this.mu.then(()=>(this.du=!0,e().catch(r=>{this.Eu=r,this.du=!1;const s=function(l){let h=l.message||"";return l.stack&&(h=l.stack.includes(l.message)?l.stack:l.message+`
`+l.stack),h}(r);throw ko("INTERNAL UNHANDLED ERROR: ",s),r}).then(r=>(this.du=!1,r))));return this.mu=n,n}enqueueAfterDelay(e,n,r){this.fu(),this.Ru.indexOf(e)>-1&&(n=0);const s=h2.createAndSchedule(this,e,n,r,i=>this.yu(i));return this.Tu.push(s),s}fu(){this.Eu&&an()}verifyOperationInProgress(){}async wu(){let e;do e=this.mu,await e;while(e!==this.mu)}Su(e){for(const n of this.Tu)if(n.timerId===e)return!0;return!1}bu(e){return this.wu().then(()=>{this.Tu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Tu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.wu()})}Du(e){this.Ru.push(e)}yu(e){const n=this.Tu.indexOf(e);this.Tu.splice(n,1)}}class cu extends p1{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new qA,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new qA(e),this._firestoreClient=void 0,await e}}}function cH(t,e){const n=typeof t=="object"?t:Gv(),r=typeof t=="string"?t:"(default)",s=r1(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=UP("firestore");i&&lH(s,...i)}return s}function g1(t){if(t._terminated)throw new dt(Re.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||uH(t),t._firestoreClient}function uH(t){var e,n,r;const s=t._freezeSettings(),i=function(h,p,y,_){return new $$(h,p,y,_.host,_.ssl,_.experimentalForceLongPolling,_.experimentalAutoDetectLongPolling,ak(_.experimentalLongPollingOptions),_.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new nH(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(h){const p=h==null?void 0:h._online.build();return{_offline:h==null?void 0:h._offline.build(p),_online:p}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Td{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Td(vs.fromBase64String(e))}catch(n){throw new dt(Re.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new Td(vs.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bm{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new dt(Re.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ys(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g2{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y2{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new dt(Re.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new dt(Re.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Wn(this._lat,e._lat)||Wn(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x2{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dH=/^__.*__$/;class hH{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new ql(e,this.data,this.fieldMask,n,this.fieldTransforms):new wm(e,this.data,n,this.fieldTransforms)}}class lk{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new ql(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function ck(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw an()}}class w2{constructor(e,n,r,s,i,l){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=l||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new w2(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.Ou(e),s}Nu(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Fu({path:r,xu:!1});return s.vu(),s}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return Q0(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(e.length===0)throw this.Bu("Document fields must not be empty");if(ck(this.Cu)&&dH.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class fH{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||d1(e)}Qu(e,n,r,s=!1){return new w2({Cu:e,methodName:n,qu:r,path:ys.emptyPath(),xu:!1,ku:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function y1(t){const e=t._freezeSettings(),n=d1(t._databaseId);return new fH(t._databaseId,!!e.ignoreUndefinedProperties,n)}function uk(t,e,n,r,s,i={}){const l=t.Qu(i.merge||i.mergeFields?2:0,e,n,s);_2("Data must be an object, but it was:",l,r);const h=fk(r,l);let p,y;if(i.merge)p=new Ti(l.fieldMask),y=l.fieldTransforms;else if(i.mergeFields){const _=[];for(const E of i.mergeFields){const T=zw(e,E,n);if(!l.contains(T))throw new dt(Re.INVALID_ARGUMENT,`Field '${T}' is specified in your field mask but missing from your input data.`);pk(_,T)||_.push(T)}p=new Ti(_),y=l.fieldTransforms.filter(E=>p.covers(E.field))}else p=null,y=l.fieldTransforms;return new hH(new si(h),p,y)}class x1 extends g2{_toFieldTransform(e){if(e.Cu!==2)throw e.Cu===1?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof x1}}function dk(t,e,n,r){const s=t.Qu(1,e,n);_2("Data must be an object, but it was:",s,r);const i=[],l=si.empty();ou(r,(p,y)=>{const _=v2(e,p,n);y=us(y);const E=s.Nu(_);if(y instanceof x1)i.push(_);else{const T=Im(y,E);T!=null&&(i.push(_),l.set(_,T))}});const h=new Ti(i);return new lk(l,h,s.fieldTransforms)}function hk(t,e,n,r,s,i){const l=t.Qu(1,e,n),h=[zw(e,r,n)],p=[s];if(i.length%2!=0)throw new dt(Re.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let T=0;T<i.length;T+=2)h.push(zw(e,i[T])),p.push(i[T+1]);const y=[],_=si.empty();for(let T=h.length-1;T>=0;--T)if(!pk(y,h[T])){const k=h[T];let L=p[T];L=us(L);const B=l.Nu(k);if(L instanceof x1)y.push(k);else{const H=Im(L,B);H!=null&&(y.push(k),_.set(k,H))}}const E=new Ti(y);return new lk(_,E,l.fieldTransforms)}function mH(t,e,n,r=!1){return Im(n,t.Qu(r?4:3,e))}function Im(t,e){if(mk(t=us(t)))return _2("Unsupported field value:",e,t),fk(t,e);if(t instanceof g2)return function(r,s){if(!ck(s.Cu))throw s.Bu(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Bu(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.xu&&e.Cu!==4)throw e.Bu("Nested arrays are not supported");return function(r,s){const i=[];let l=0;for(const h of r){let p=Im(h,s.Lu(l));p==null&&(p={nullValue:"NULL_VALUE"}),i.push(p),l++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=us(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return uz(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=Xn.fromDate(r);return{timestampValue:q0(s.serializer,i)}}if(r instanceof Xn){const i=new Xn(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:q0(s.serializer,i)}}if(r instanceof y2)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof Td)return{bytesValue:N3(s.serializer,r._byteString)};if(r instanceof zs){const i=s.databaseId,l=r.firestore._databaseId;if(!l.isEqual(i))throw s.Bu(`Document reference is for database ${l.projectId}/${l.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:s2(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof x2)return function(l,h){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:l.toArray().map(p=>{if(typeof p!="number")throw h.Bu("VectorValues must only contain numeric values.");return t2(h.serializer,p)})}}}}}}(r,s);throw s.Bu(`Unsupported field value: ${m1(r)}`)}(t,e)}function fk(t,e){const n={};return s3(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):ou(t,(r,s)=>{const i=Im(s,e.Mu(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function mk(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Xn||t instanceof y2||t instanceof Td||t instanceof zs||t instanceof g2||t instanceof x2)}function _2(t,e,n){if(!mk(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const r=m1(n);throw r==="an object"?e.Bu(t+" a custom object"):e.Bu(t+" "+r)}}function zw(t,e,n){if((e=us(e))instanceof bm)return e._internalPath;if(typeof e=="string")return v2(t,e);throw Q0("Field path arguments must be of type string or ",t,!1,void 0,n)}const pH=new RegExp("[~\\*/\\[\\]]");function v2(t,e,n){if(e.search(pH)>=0)throw Q0(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new bm(...e.split("."))._internalPath}catch{throw Q0(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Q0(t,e,n,r,s){const i=r&&!r.isEmpty(),l=s!==void 0;let h=`Function ${e}() called with invalid data`;n&&(h+=" (via `toFirestore()`)"),h+=". ";let p="";return(i||l)&&(p+=" (found",i&&(p+=` in field ${r}`),l&&(p+=` in document ${s}`),p+=")"),new dt(Re.INVALID_ARGUMENT,h+t+p)}function pk(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gk{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new zs(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new gH(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(E2("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class gH extends gk{data(){return super.data()}}function E2(t,e){return typeof e=="string"?v2(t,e):e instanceof bm?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yH(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new dt(Re.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class b2{}class xH extends b2{}function Ca(t,e,...n){let r=[];e instanceof b2&&r.push(e),r=r.concat(n),function(i){const l=i.filter(p=>p instanceof I2).length,h=i.filter(p=>p instanceof w1).length;if(l>1||l>0&&h>0)throw new dt(Re.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class w1 extends xH{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new w1(e,n,r)}_apply(e){const n=this._parse(e);return yk(e._query,n),new $d(e.firestore,e.converter,Dw(e._query,n))}_parse(e){const n=y1(e.firestore);return function(i,l,h,p,y,_,E){let T;if(y.isKeyField()){if(_==="array-contains"||_==="array-contains-any")throw new dt(Re.INVALID_ARGUMENT,`Invalid Query. You can't perform '${_}' queries on documentId().`);if(_==="in"||_==="not-in"){XA(E,_);const k=[];for(const L of E)k.push(KA(p,i,L));T={arrayValue:{values:k}}}else T=KA(p,i,E)}else _!=="in"&&_!=="not-in"&&_!=="array-contains-any"||XA(E,_),T=mH(h,l,E,_==="in"||_==="not-in");return Kr.create(y,_,T)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function Sa(t,e,n){const r=e,s=E2("where",t);return w1._create(s,r,n)}class I2 extends b2{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new I2(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:ha.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let l=s;const h=i.getFlattenedFilters();for(const p of h)yk(l,p),l=Dw(l,p)}(e._query,n),new $d(e.firestore,e.converter,Dw(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function KA(t,e,n){if(typeof(n=us(n))=="string"){if(n==="")throw new dt(Re.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!f3(e)&&n.indexOf("/")!==-1)throw new dt(Re.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(gr.fromString(n));if(!Ft.isDocumentKey(r))throw new dt(Re.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return gA(t,new Ft(r))}if(n instanceof zs)return gA(t,n._key);throw new dt(Re.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${m1(n)}.`)}function XA(t,e){if(!Array.isArray(t)||t.length===0)throw new dt(Re.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function yk(t,e){const n=function(s,i){for(const l of s)for(const h of l.getFlattenedFilters())if(i.indexOf(h.op)>=0)return h.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new dt(Re.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new dt(Re.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class wH{convertValue(e,n="none"){switch(Kc(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Fr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(qc(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw an()}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return ou(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var n,r,s;const i=(s=(r=(n=e.fields)===null||n===void 0?void 0:n.value.arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(l=>Fr(l.doubleValue));return new x2(i)}convertGeoPoint(e){return new y2(Fr(e.latitude),Fr(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Qv(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Lf(e));default:return null}}convertTimestamp(e){const n=Fl(e);return new Xn(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=gr.fromString(e);Zn(M3(r));const s=new jf(r.get(1),r.get(3)),i=new Ft(r.popFirst(5));return s.isEqual(n)||ko(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xk(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rh{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class wk extends gk{constructor(e,n,r,s,i,l){super(e,n,r,s,l),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new $p(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(E2("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class $p extends wk{data(e={}){return super.data(e)}}class _H{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new Rh(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new $p(this._firestore,this._userDataWriter,r.key,r,new Rh(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new dt(Re.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let l=0;return s._snapshot.docChanges.map(h=>{const p=new $p(s._firestore,s._userDataWriter,h.doc.key,h.doc,new Rh(s._snapshot.mutatedKeys.has(h.doc.key),s._snapshot.fromCache),s.query.converter);return h.doc,{type:"added",doc:p,oldIndex:-1,newIndex:l++}})}{let l=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(h=>i||h.type!==3).map(h=>{const p=new $p(s._firestore,s._userDataWriter,h.doc.key,h.doc,new Rh(s._snapshot.mutatedKeys.has(h.doc.key),s._snapshot.fromCache),s.query.converter);let y=-1,_=-1;return h.type!==0&&(y=l.indexOf(h.doc.key),l=l.delete(h.doc.key)),h.type!==1&&(l=l.add(h.doc),_=l.indexOf(h.doc.key)),{type:vH(h.type),doc:p,oldIndex:y,newIndex:_}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function vH(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return an()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A2(t){t=fa(t,zs);const e=fa(t.firestore,cu);return iH(g1(e),t._key).then(n=>EH(e,t,n))}class _k extends wH{constructor(e){super(),this.firestore=e}convertBytes(e){return new Td(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new zs(this.firestore,null,n)}}function Bi(t){t=fa(t,$d);const e=fa(t.firestore,cu),n=g1(e),r=new _k(e);return yH(t._query),aH(n,t._query).then(s=>new _H(e,r,t,s))}function _1(t,e,n){t=fa(t,zs);const r=fa(t.firestore,cu),s=xk(t.converter,e,n);return v1(r,[uk(y1(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,di.none())])}function Ww(t,e,n,...r){t=fa(t,zs);const s=fa(t.firestore,cu),i=y1(s);let l;return l=typeof(e=us(e))=="string"||e instanceof bm?hk(i,"updateDoc",t._key,e,n,r):dk(i,"updateDoc",t._key,e),v1(s,[l.toMutation(t._key,di.exists(!0))])}function T2(t){return v1(fa(t.firestore,cu),[new c1(t._key,di.none())])}function v1(t,e){return function(r,s){const i=new wo;return r.asyncQueue.enqueueAndForget(async()=>KW(await sH(r),s,i)),i.promise}(g1(t),e)}function EH(t,e,n){const r=n.docs.get(e._key),s=new _k(t);return new wk(t,s,e._key,r,new Rh(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bH{constructor(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=y1(e)}set(e,n,r){this._verifyNotCommitted();const s=Ty(e,this._firestore),i=xk(s.converter,n,r),l=uk(this._dataReader,"WriteBatch.set",s._key,i,s.converter!==null,r);return this._mutations.push(l.toMutation(s._key,di.none())),this}update(e,n,r,...s){this._verifyNotCommitted();const i=Ty(e,this._firestore);let l;return l=typeof(n=us(n))=="string"||n instanceof bm?hk(this._dataReader,"WriteBatch.update",i._key,n,r,s):dk(this._dataReader,"WriteBatch.update",i._key,n),this._mutations.push(l.toMutation(i._key,di.exists(!0))),this}delete(e){this._verifyNotCommitted();const n=Ty(e,this._firestore);return this._mutations=this._mutations.concat(new c1(n._key,di.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new dt(Re.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Ty(t,e){if((t=us(t)).firestore!==e)throw new dt(Re.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IH(t){return g1(t=fa(t,cu)),new bH(t,e=>v1(t,e))}(function(e,n=!0){(function(s){Vd=s})(au),Hc(new Ll("firestore",(r,{instanceIdentifier:s,options:i})=>{const l=r.getProvider("app").getImmediate(),h=new cu(new C$(r.getProvider("auth-internal")),new P$(r.getProvider("app-check-internal")),function(y,_){if(!Object.prototype.hasOwnProperty.apply(y.options,["projectId"]))throw new dt(Re.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new jf(y.options.projectId,_)}(l,s),l);return i=Object.assign({useFetchStreams:n},i),h._setSettings(i),h},"PUBLIC").setMultipleInstances(!0)),ja(dA,"4.7.3",e),ja(dA,"4.7.3","esm2017")})();var AH="firebase",TH="10.14.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */ja(AH,TH,"app");function C2(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function vk(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const CH=vk,Ek=new mm("auth","Firebase",vk());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y0=new Wv("@firebase/auth");function SH(t,...e){Y0.logLevel<=Dn.WARN&&Y0.warn(`Auth (${au}): ${t}`,...e)}function zp(t,...e){Y0.logLevel<=Dn.ERROR&&Y0.error(`Auth (${au}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oo(t,...e){throw S2(t,...e)}function Ba(t,...e){return S2(t,...e)}function bk(t,e,n){const r=Object.assign(Object.assign({},CH()),{[e]:n});return new mm("auth","Firebase",r).create(e,{appName:t.name})}function kc(t){return bk(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function S2(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return Ek.create(t,...e)}function rn(t,e,...n){if(!t)throw S2(e,...n)}function ho(t){const e="INTERNAL ASSERTION FAILED: "+t;throw zp(e),new Error(e)}function Mo(t,e){t||ho(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hw(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function NH(){return QA()==="http:"||QA()==="https:"}function QA(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RH(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(NH()||iU()||"connection"in navigator)?navigator.onLine:!0}function PH(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Am{constructor(e,n){this.shortDelay=e,this.longDelay=n,Mo(n>e,"Short delay should be less than long delay!"),this.isMobile=nU()||aU()}get(){return RH()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function N2(t,e){Mo(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ik{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;ho("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;ho("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;ho("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kH={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DH=new Am(3e4,6e4);function R2(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function zd(t,e,n,r,s={}){return Ak(t,s,async()=>{let i={},l={};r&&(e==="GET"?l=r:i={body:JSON.stringify(r)});const h=pm(Object.assign({key:t.config.apiKey},l)).slice(1),p=await t._getAdditionalHeaders();p["Content-Type"]="application/json",t.languageCode&&(p["X-Firebase-Locale"]=t.languageCode);const y=Object.assign({method:e,headers:p},i);return sU()||(y.referrerPolicy="no-referrer"),Ik.fetch()(Tk(t,t.config.apiHost,n,h),y)})}async function Ak(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},kH),e);try{const s=new MH(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const l=await i.json();if("needConfirmation"in l)throw ip(t,"account-exists-with-different-credential",l);if(i.ok&&!("errorMessage"in l))return l;{const h=i.ok?l.errorMessage:l.error.message,[p,y]=h.split(" : ");if(p==="FEDERATED_USER_ID_ALREADY_LINKED")throw ip(t,"credential-already-in-use",l);if(p==="EMAIL_EXISTS")throw ip(t,"email-already-in-use",l);if(p==="USER_DISABLED")throw ip(t,"user-disabled",l);const _=r[p]||p.toLowerCase().replace(/[_\s]+/g,"-");if(y)throw bk(t,_,y);Oo(t,_)}}catch(s){if(s instanceof qa)throw s;Oo(t,"network-request-failed",{message:String(s)})}}async function OH(t,e,n,r,s={}){const i=await zd(t,e,n,r,s);return"mfaPendingCredential"in i&&Oo(t,"multi-factor-auth-required",{_serverResponse:i}),i}function Tk(t,e,n,r){const s=`${e}${n}?${r}`;return t.config.emulator?N2(t.config,s):`${t.config.apiScheme}://${s}`}class MH{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Ba(this.auth,"network-request-failed")),DH.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function ip(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=Ba(t,e,r);return s.customData._tokenResponse=n,s}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function LH(t,e){return zd(t,"POST","/v1/accounts:delete",e)}async function Ck(t,e){return zd(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xh(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function jH(t,e=!1){const n=us(t),r=await n.getIdToken(e),s=P2(r);rn(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,l=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:Xh(Cy(s.auth_time)),issuedAtTime:Xh(Cy(s.iat)),expirationTime:Xh(Cy(s.exp)),signInProvider:l||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function Cy(t){return Number(t)*1e3}function P2(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return zp("JWT malformed, contained fewer than 3 sections"),null;try{const s=VP(n);return s?JSON.parse(s):(zp("Failed to decode base64 JWT payload"),null)}catch(s){return zp("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function YA(t){const e=P2(t);return rn(e,"internal-error"),rn(typeof e.exp<"u","internal-error"),rn(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Uf(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof qa&&FH(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function FH({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VH{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gw{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=Xh(this.lastLoginAt),this.creationTime=Xh(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Z0(t){var e;const n=t.auth,r=await t.getIdToken(),s=await Uf(t,Ck(n,{idToken:r}));rn(s==null?void 0:s.users.length,n,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const l=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?Sk(i.providerUserInfo):[],h=UH(t.providerData,l),p=t.isAnonymous,y=!(t.email&&i.passwordHash)&&!(h!=null&&h.length),_=p?y:!1,E={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:h,metadata:new Gw(i.createdAt,i.lastLoginAt),isAnonymous:_};Object.assign(t,E)}async function BH(t){const e=us(t);await Z0(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function UH(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function Sk(t){return t.map(e=>{var{providerId:n}=e,r=C2(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $H(t,e){const n=await Ak(t,{},async()=>{const r=pm({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,l=Tk(t,s,"/v1/token",`key=${i}`),h=await t._getAdditionalHeaders();return h["Content-Type"]="application/x-www-form-urlencoded",Ik.fetch()(l,{method:"POST",headers:h,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function zH(t,e){return zd(t,"POST","/v2/accounts:revokeToken",R2(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yu{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){rn(e.idToken,"internal-error"),rn(typeof e.idToken<"u","internal-error"),rn(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):YA(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){rn(e.length!==0,"internal-error");const n=YA(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(rn(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await $H(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,l=new Yu;return r&&(rn(typeof r=="string","internal-error",{appName:e}),l.refreshToken=r),s&&(rn(typeof s=="string","internal-error",{appName:e}),l.accessToken=s),i&&(rn(typeof i=="number","internal-error",{appName:e}),l.expirationTime=i),l}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Yu,this.toJSON())}_performRefresh(){return ho("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Go(t,e){rn(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class fo{constructor(e){var{uid:n,auth:r,stsTokenManager:s}=e,i=C2(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new VH(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new Gw(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await Uf(this,this.stsTokenManager.getToken(this.auth,e));return rn(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return jH(this,e)}reload(){return BH(this)}_assign(e){this!==e&&(rn(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new fo(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){rn(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await Z0(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(fl(this.auth.app))return Promise.reject(kc(this.auth));const e=await this.getIdToken();return await Uf(this,LH(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,s,i,l,h,p,y,_;const E=(r=n.displayName)!==null&&r!==void 0?r:void 0,T=(s=n.email)!==null&&s!==void 0?s:void 0,k=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,L=(l=n.photoURL)!==null&&l!==void 0?l:void 0,B=(h=n.tenantId)!==null&&h!==void 0?h:void 0,H=(p=n._redirectEventId)!==null&&p!==void 0?p:void 0,W=(y=n.createdAt)!==null&&y!==void 0?y:void 0,M=(_=n.lastLoginAt)!==null&&_!==void 0?_:void 0,{uid:U,emailVerified:$,isAnonymous:K,providerData:Z,stsTokenManager:A}=n;rn(U&&A,e,"internal-error");const C=Yu.fromJSON(this.name,A);rn(typeof U=="string",e,"internal-error"),Go(E,e.name),Go(T,e.name),rn(typeof $=="boolean",e,"internal-error"),rn(typeof K=="boolean",e,"internal-error"),Go(k,e.name),Go(L,e.name),Go(B,e.name),Go(H,e.name),Go(W,e.name),Go(M,e.name);const N=new fo({uid:U,auth:e,email:T,emailVerified:$,displayName:E,isAnonymous:K,photoURL:L,phoneNumber:k,tenantId:B,stsTokenManager:C,createdAt:W,lastLoginAt:M});return Z&&Array.isArray(Z)&&(N.providerData=Z.map(D=>Object.assign({},D))),H&&(N._redirectEventId=H),N}static async _fromIdTokenResponse(e,n,r=!1){const s=new Yu;s.updateFromServerResponse(n);const i=new fo({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await Z0(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];rn(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?Sk(s.providerUserInfo):[],l=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),h=new Yu;h.updateFromIdToken(r);const p=new fo({uid:s.localId,auth:e,stsTokenManager:h,isAnonymous:l}),y={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new Gw(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(p,y),p}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZA=new Map;function mo(t){Mo(t instanceof Function,"Expected a class definition");let e=ZA.get(t);return e?(Mo(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,ZA.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nk{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}Nk.type="NONE";const JA=Nk;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Wp(t,e,n){return`firebase:${t}:${e}:${n}`}class Zu{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Wp(this.userKey,s.apiKey,i),this.fullPersistenceKey=Wp("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?fo._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Zu(mo(JA),e,r);const s=(await Promise.all(n.map(async y=>{if(await y._isAvailable())return y}))).filter(y=>y);let i=s[0]||mo(JA);const l=Wp(r,e.config.apiKey,e.name);let h=null;for(const y of n)try{const _=await y._get(l);if(_){const E=fo._fromJSON(e,_);y!==i&&(h=E),i=y;break}}catch{}const p=s.filter(y=>y._shouldAllowMigration);return!i._shouldAllowMigration||!p.length?new Zu(i,e,r):(i=p[0],h&&await i._set(l,h.toJSON()),await Promise.all(n.map(async y=>{if(y!==i)try{await y._remove(l)}catch{}})),new Zu(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eT(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(Dk(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Rk(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Mk(e))return"Blackberry";if(Lk(e))return"Webos";if(Pk(e))return"Safari";if((e.includes("chrome/")||kk(e))&&!e.includes("edge/"))return"Chrome";if(Ok(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function Rk(t=Ms()){return/firefox\//i.test(t)}function Pk(t=Ms()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function kk(t=Ms()){return/crios\//i.test(t)}function Dk(t=Ms()){return/iemobile/i.test(t)}function Ok(t=Ms()){return/android/i.test(t)}function Mk(t=Ms()){return/blackberry/i.test(t)}function Lk(t=Ms()){return/webos/i.test(t)}function k2(t=Ms()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function WH(t=Ms()){var e;return k2(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function HH(){return oU()&&document.documentMode===10}function jk(t=Ms()){return k2(t)||Ok(t)||Lk(t)||Mk(t)||/windows phone/i.test(t)||Dk(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fk(t,e=[]){let n;switch(t){case"Browser":n=eT(Ms());break;case"Worker":n=`${eT(Ms())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${au}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GH{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((l,h)=>{try{const p=e(i);l(p)}catch(p){h(p)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qH(t,e={}){return zd(t,"GET","/v2/passwordPolicy",R2(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KH=6;class XH{constructor(e){var n,r,s,i;const l=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=l.minPasswordLength)!==null&&n!==void 0?n:KH,l.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=l.maxPasswordLength),l.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=l.containsLowercaseCharacter),l.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=l.containsUppercaseCharacter),l.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=l.containsNumericCharacter),l.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=l.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,s,i,l,h;const p={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,p),this.validatePasswordCharacterOptions(e,p),p.isValid&&(p.isValid=(n=p.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),p.isValid&&(p.isValid=(r=p.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),p.isValid&&(p.isValid=(s=p.containsLowercaseLetter)!==null&&s!==void 0?s:!0),p.isValid&&(p.isValid=(i=p.containsUppercaseLetter)!==null&&i!==void 0?i:!0),p.isValid&&(p.isValid=(l=p.containsNumericCharacter)!==null&&l!==void 0?l:!0),p.isValid&&(p.isValid=(h=p.containsNonAlphanumericCharacter)!==null&&h!==void 0?h:!0),p}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QH{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new tT(this),this.idTokenSubscription=new tT(this),this.beforeStateQueue=new GH(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=Ek,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=mo(n)),this._initializationPromise=this.queue(async()=>{var r,s;if(!this._deleted&&(this.persistenceManager=await Zu.create(this,e),!this._deleted)){if(!((r=this._popupRedirectResolver)===null||r===void 0)&&r._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((s=this.currentUser)===null||s===void 0?void 0:s.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await Ck(this,{idToken:e}),r=await fo._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(fl(this.app)){const l=this.app.settings.authIdToken;return l?new Promise(h=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(l).then(h,h))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const l=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,h=s==null?void 0:s._redirectEventId,p=await this.tryRedirectSignIn(e);(!l||l===h)&&(p!=null&&p.user)&&(s=p.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(l){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(l))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return rn(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await Z0(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=PH()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(fl(this.app))return Promise.reject(kc(this));const n=e?us(e):null;return n&&rn(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&rn(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return fl(this.app)?Promise.reject(kc(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return fl(this.app)?Promise.reject(kc(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(mo(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await qH(this),n=new XH(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new mm("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await zH(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&mo(e)||this._popupRedirectResolver;rn(n,this,"argument-error"),this.redirectPersistenceManager=await Zu.create(this,[mo(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let l=!1;const h=this._isInitialized?Promise.resolve():this._initializationPromise;if(rn(h,this,"internal-error"),h.then(()=>{l||i(this.currentUser)}),typeof n=="function"){const p=e.addObserver(n,r,s);return()=>{l=!0,p()}}else{const p=e.addObserver(n);return()=>{l=!0,p()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return rn(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Fk(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(n["X-Firebase-AppCheck"]=s),n}async _getAppCheckToken(){var e;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&SH(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function D2(t){return us(t)}class tT{constructor(e){this.auth=e,this.observer=null,this.addObserver=pU(n=>this.observer=n)}get next(){return rn(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let O2={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function YH(t){O2=t}function ZH(t){return O2.loadJS(t)}function JH(){return O2.gapiScript}function eG(t){return`__${t}${Math.floor(Math.random()*1e6)}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tG(t,e){const n=r1(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(U0(i,e??{}))return s;Oo(s,"already-initialized")}return n.initialize({options:e})}function nG(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(mo);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function rG(t,e,n){const r=D2(t);rn(r._canInitEmulator,r,"emulator-config-failed"),rn(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!1,i=Vk(e),{host:l,port:h}=sG(e),p=h===null?"":`:${h}`;r.config.emulator={url:`${i}//${l}${p}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:l,port:h,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})}),iG()}function Vk(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function sG(t){const e=Vk(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:nT(r.substr(i.length+1))}}else{const[i,l]=r.split(":");return{host:i,port:nT(l)}}}function nT(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function iG(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bk{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return ho("not implemented")}_getIdTokenResponse(e){return ho("not implemented")}_linkToIdToken(e,n){return ho("not implemented")}_getReauthenticationResolver(e){return ho("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ju(t,e){return OH(t,"POST","/v1/accounts:signInWithIdp",R2(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aG="http://localhost";class Xc extends Bk{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Xc(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):Oo("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=n,i=C2(n,["providerId","signInMethod"]);if(!r||!s)return null;const l=new Xc(r,s);return l.idToken=i.idToken||void 0,l.accessToken=i.accessToken||void 0,l.secret=i.secret,l.nonce=i.nonce,l.pendingToken=i.pendingToken||null,l}_getIdTokenResponse(e){const n=this.buildRequest();return Ju(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Ju(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Ju(e,n)}buildRequest(){const e={requestUri:aG,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=pm(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uk{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tm extends Uk{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class el extends Tm{constructor(){super("facebook.com")}static credential(e){return Xc._fromParams({providerId:el.PROVIDER_ID,signInMethod:el.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return el.credentialFromTaggedObject(e)}static credentialFromError(e){return el.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return el.credential(e.oauthAccessToken)}catch{return null}}}el.FACEBOOK_SIGN_IN_METHOD="facebook.com";el.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tl extends Tm{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Xc._fromParams({providerId:tl.PROVIDER_ID,signInMethod:tl.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return tl.credentialFromTaggedObject(e)}static credentialFromError(e){return tl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return tl.credential(n,r)}catch{return null}}}tl.GOOGLE_SIGN_IN_METHOD="google.com";tl.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nl extends Tm{constructor(){super("github.com")}static credential(e){return Xc._fromParams({providerId:nl.PROVIDER_ID,signInMethod:nl.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return nl.credentialFromTaggedObject(e)}static credentialFromError(e){return nl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return nl.credential(e.oauthAccessToken)}catch{return null}}}nl.GITHUB_SIGN_IN_METHOD="github.com";nl.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rl extends Tm{constructor(){super("twitter.com")}static credential(e,n){return Xc._fromParams({providerId:rl.PROVIDER_ID,signInMethod:rl.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return rl.credentialFromTaggedObject(e)}static credentialFromError(e){return rl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return rl.credential(n,r)}catch{return null}}}rl.TWITTER_SIGN_IN_METHOD="twitter.com";rl.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cd{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await fo._fromIdTokenResponse(e,r,s),l=rT(r);return new Cd({user:i,providerId:l,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=rT(r);return new Cd({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function rT(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class J0 extends qa{constructor(e,n,r,s){var i;super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,J0.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new J0(e,n,r,s)}}function $k(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?J0._fromErrorAndOperation(t,i,e,r):i})}async function oG(t,e,n=!1){const r=await Uf(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Cd._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function lG(t,e,n=!1){const{auth:r}=t;if(fl(r.app))return Promise.reject(kc(r));const s="reauthenticate";try{const i=await Uf(t,$k(r,s,e,t),n);rn(i.idToken,r,"internal-error");const l=P2(i.idToken);rn(l,r,"internal-error");const{sub:h}=l;return rn(t.uid===h,r,"user-mismatch"),Cd._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&Oo(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cG(t,e,n=!1){if(fl(t.app))return Promise.reject(kc(t));const r="signIn",s=await $k(t,r,e),i=await Cd._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}function uG(t,e,n,r){return us(t).onIdTokenChanged(e,n,r)}function dG(t,e,n){return us(t).beforeAuthStateChanged(e,n)}const eg="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zk{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(eg,"1"),this.storage.removeItem(eg),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hG=1e3,fG=10;class Wk extends zk{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=jk(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((l,h,p)=>{this.notifyListeners(l,p)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const l=this.storage.getItem(r);!n&&this.localCache[r]===l||this.notifyListeners(r,l)},i=this.storage.getItem(r);HH()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,fG):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},hG)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}Wk.type="LOCAL";const mG=Wk;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hk extends zk{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}Hk.type="SESSION";const Gk=Hk;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pG(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E1{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new E1(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,l=this.handlersMap[s];if(!(l!=null&&l.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const h=Array.from(l).map(async y=>y(n.origin,i)),p=await pG(h);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:p})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}E1.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M2(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gG{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,l;return new Promise((h,p)=>{const y=M2("",20);s.port1.start();const _=setTimeout(()=>{p(new Error("unsupported_event"))},r);l={messageChannel:s,onMessage(E){const T=E;if(T.data.eventId===y)switch(T.data.status){case"ack":clearTimeout(_),i=setTimeout(()=>{p(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),h(T.data.response);break;default:clearTimeout(_),clearTimeout(i),p(new Error("invalid_response"));break}}},this.handlers.add(l),s.port1.addEventListener("message",l.onMessage),this.target.postMessage({eventType:e,eventId:y,data:n},[s.port2])}).finally(()=>{l&&this.removeMessageHandler(l)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ua(){return window}function yG(t){Ua().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qk(){return typeof Ua().WorkerGlobalScope<"u"&&typeof Ua().importScripts=="function"}async function xG(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function wG(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function _G(){return qk()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kk="firebaseLocalStorageDb",vG=1,tg="firebaseLocalStorage",Xk="fbase_key";class Cm{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function b1(t,e){return t.transaction([tg],e?"readwrite":"readonly").objectStore(tg)}function EG(){const t=indexedDB.deleteDatabase(Kk);return new Cm(t).toPromise()}function qw(){const t=indexedDB.open(Kk,vG);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(tg,{keyPath:Xk})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(tg)?e(r):(r.close(),await EG(),e(await qw()))})})}async function sT(t,e,n){const r=b1(t,!0).put({[Xk]:e,value:n});return new Cm(r).toPromise()}async function bG(t,e){const n=b1(t,!1).get(e),r=await new Cm(n).toPromise();return r===void 0?null:r.value}function iT(t,e){const n=b1(t,!0).delete(e);return new Cm(n).toPromise()}const IG=800,AG=3;class Qk{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await qw(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>AG)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return qk()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=E1._getInstance(_G()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await xG(),!this.activeServiceWorker)return;this.sender=new gG(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||wG()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await qw();return await sT(e,eg,"1"),await iT(e,eg),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>sT(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>bG(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>iT(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=b1(s,!1).getAll();return new Cm(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),IG)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}Qk.type="LOCAL";const TG=Qk;new Am(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function CG(t,e){return e?mo(e):(rn(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L2 extends Bk{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ju(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Ju(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Ju(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function SG(t){return cG(t.auth,new L2(t),t.bypassAuthState)}function NG(t){const{auth:e,user:n}=t;return rn(n,e,"internal-error"),lG(n,new L2(t),t.bypassAuthState)}async function RG(t){const{auth:e,user:n}=t;return rn(n,e,"internal-error"),oG(n,new L2(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yk{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:l,type:h}=e;if(l){this.reject(l);return}const p={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(h)(p))}catch(y){this.reject(y)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return SG;case"linkViaPopup":case"linkViaRedirect":return RG;case"reauthViaPopup":case"reauthViaRedirect":return NG;default:Oo(this.auth,"internal-error")}}resolve(e){Mo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Mo(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const PG=new Am(2e3,1e4);class Vu extends Yk{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,Vu.currentPopupAction&&Vu.currentPopupAction.cancel(),Vu.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return rn(e,this.auth,"internal-error"),e}async onExecution(){Mo(this.filter.length===1,"Popup operations only handle one event");const e=M2();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Ba(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Ba(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Vu.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Ba(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,PG.get())};e()}}Vu.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kG="pendingRedirect",Hp=new Map;class DG extends Yk{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Hp.get(this.auth._key());if(!e){try{const r=await OG(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Hp.set(this.auth._key(),e)}return this.bypassAuthState||Hp.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function OG(t,e){const n=jG(e),r=LG(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function MG(t,e){Hp.set(t._key(),e)}function LG(t){return mo(t._redirectPersistence)}function jG(t){return Wp(kG,t.config.apiKey,t.name)}async function FG(t,e,n=!1){if(fl(t.app))return Promise.reject(kc(t));const r=D2(t),s=CG(r,e),l=await new DG(r,s,n).execute();return l&&!n&&(delete l.user._redirectEventId,await r._persistUserIfCurrent(l.user),await r._setRedirectUser(null,e)),l}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const VG=10*60*1e3;class BG{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!UG(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!Zk(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(Ba(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=VG&&this.cachedEventUids.clear(),this.cachedEventUids.has(aT(e))}saveEventToCache(e){this.cachedEventUids.add(aT(e)),this.lastProcessedEventTime=Date.now()}}function aT(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function Zk({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function UG(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Zk(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function $G(t,e={}){return zd(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zG=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,WG=/^https?/;async function HG(t){if(t.config.emulator)return;const{authorizedDomains:e}=await $G(t);for(const n of e)try{if(GG(n))return}catch{}Oo(t,"unauthorized-domain")}function GG(t){const e=Hw(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const l=new URL(t);return l.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&l.hostname===r}if(!WG.test(n))return!1;if(zG.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qG=new Am(3e4,6e4);function oT(){const t=Ua().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function KG(t){return new Promise((e,n)=>{var r,s,i;function l(){oT(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{oT(),n(Ba(t,"network-request-failed"))},timeout:qG.get()})}if(!((s=(r=Ua().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=Ua().gapi)===null||i===void 0)&&i.load)l();else{const h=eG("iframefcb");return Ua()[h]=()=>{gapi.load?l():n(Ba(t,"network-request-failed"))},ZH(`${JH()}?onload=${h}`).catch(p=>n(p))}}).catch(e=>{throw Gp=null,e})}let Gp=null;function XG(t){return Gp=Gp||KG(t),Gp}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const QG=new Am(5e3,15e3),YG="__/auth/iframe",ZG="emulator/auth/iframe",JG={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},eq=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function tq(t){const e=t.config;rn(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?N2(e,ZG):`https://${t.config.authDomain}/${YG}`,r={apiKey:e.apiKey,appName:t.name,v:au},s=eq.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${pm(r).slice(1)}`}async function nq(t){const e=await XG(t),n=Ua().gapi;return rn(n,t,"internal-error"),e.open({where:document.body,url:tq(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:JG,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const l=Ba(t,"network-request-failed"),h=Ua().setTimeout(()=>{i(l)},QG.get());function p(){Ua().clearTimeout(h),s(r)}r.ping(p).then(p,()=>{i(l)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rq={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},sq=500,iq=600,aq="_blank",oq="http://localhost";class lT{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function lq(t,e,n,r=sq,s=iq){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),l=Math.max((window.screen.availWidth-r)/2,0).toString();let h="";const p=Object.assign(Object.assign({},rq),{width:r.toString(),height:s.toString(),top:i,left:l}),y=Ms().toLowerCase();n&&(h=kk(y)?aq:n),Rk(y)&&(e=e||oq,p.scrollbars="yes");const _=Object.entries(p).reduce((T,[k,L])=>`${T}${k}=${L},`,"");if(WH(y)&&h!=="_self")return cq(e||"",h),new lT(null);const E=window.open(e||"",h,_);rn(E,t,"popup-blocked");try{E.focus()}catch{}return new lT(E)}function cq(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uq="__/auth/handler",dq="emulator/auth/handler",hq=encodeURIComponent("fac");async function cT(t,e,n,r,s,i){rn(t.config.authDomain,t,"auth-domain-config-required"),rn(t.config.apiKey,t,"invalid-api-key");const l={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:au,eventId:s};if(e instanceof Uk){e.setDefaultLanguage(t.languageCode),l.providerId=e.providerId||"",mU(e.getCustomParameters())||(l.customParameters=JSON.stringify(e.getCustomParameters()));for(const[_,E]of Object.entries({}))l[_]=E}if(e instanceof Tm){const _=e.getScopes().filter(E=>E!=="");_.length>0&&(l.scopes=_.join(","))}t.tenantId&&(l.tid=t.tenantId);const h=l;for(const _ of Object.keys(h))h[_]===void 0&&delete h[_];const p=await t._getAppCheckToken(),y=p?`#${hq}=${encodeURIComponent(p)}`:"";return`${fq(t)}?${pm(h).slice(1)}${y}`}function fq({config:t}){return t.emulator?N2(t,dq):`https://${t.authDomain}/${uq}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Sy="webStorageSupport";class mq{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Gk,this._completeRedirectFn=FG,this._overrideRedirectResult=MG}async _openPopup(e,n,r,s){var i;Mo((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const l=await cT(e,n,r,Hw(),s);return lq(e,l,M2())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await cT(e,n,r,Hw(),s);return yG(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(Mo(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await nq(e),r=new BG(e);return n.register("authEvent",s=>(rn(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(Sy,{type:Sy},s=>{var i;const l=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[Sy];l!==void 0&&n(!!l),Oo(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=HG(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return jk()||Pk()||k2()}}const pq=mq;var uT="@firebase/auth",dT="1.7.9";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gq{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){rn(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yq(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function xq(t){Hc(new Ll("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:l,authDomain:h}=r.options;rn(l&&!l.includes(":"),"invalid-api-key",{appName:r.name});const p={apiKey:l,authDomain:h,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Fk(t)},y=new QH(r,s,i,p);return nG(y,n),y},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Hc(new Ll("auth-internal",e=>{const n=D2(e.getProvider("auth").getImmediate());return(r=>new gq(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),ja(uT,dT,yq(t)),ja(uT,dT,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wq=5*60,_q=zP("authIdTokenMaxAge")||wq;let hT=null;const vq=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>_q)return;const s=n==null?void 0:n.token;hT!==s&&(hT=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function Eq(t=Gv()){const e=r1(t,"auth");if(e.isInitialized())return e.getImmediate();const n=tG(t,{popupRedirectResolver:pq,persistence:[TG,mG,Gk]}),r=zP("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const l=vq(i.toString());dG(n,l,()=>l(n.currentUser)),uG(n,h=>l(h))}}const s=BP("auth");return s&&rG(n,`http://${s}`),n}function bq(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}YH({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=Ba("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",bq().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});xq("Browser");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jk="firebasestorage.googleapis.com",Iq="storageBucket",Aq=2*60*1e3,Tq=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ka extends qa{constructor(e,n,r=0){super(Ny(e),`Firebase Storage: ${n} (${Ny(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Ka.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return Ny(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Ga;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Ga||(Ga={}));function Ny(t){return"storage/"+t}function Cq(){const t="An unknown error occurred, please check the error payload for server response.";return new Ka(Ga.UNKNOWN,t)}function Sq(){return new Ka(Ga.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function Nq(){return new Ka(Ga.CANCELED,"User canceled the upload/download.")}function Rq(t){return new Ka(Ga.INVALID_URL,"Invalid URL '"+t+"'.")}function Pq(t){return new Ka(Ga.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function fT(t){return new Ka(Ga.INVALID_ARGUMENT,t)}function eD(){return new Ka(Ga.APP_DELETED,"The Firebase app was deleted.")}function kq(t){return new Ka(Ga.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ia{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=ia.makeFromUrl(e,n)}catch{return new ia(e,"")}if(r.path==="")return r;throw Pq(e)}static makeFromUrl(e,n){let r=null;const s="([A-Za-z0-9.\\-_]+)";function i($){$.path.charAt($.path.length-1)==="/"&&($.path_=$.path_.slice(0,-1))}const l="(/(.*))?$",h=new RegExp("^gs://"+s+l,"i"),p={bucket:1,path:3};function y($){$.path_=decodeURIComponent($.path)}const _="v[A-Za-z0-9_]+",E=n.replace(/[.]/g,"\\."),T="(/([^?#]*).*)?$",k=new RegExp(`^https?://${E}/${_}/b/${s}/o${T}`,"i"),L={bucket:1,path:3},B=n===Jk?"(?:storage.googleapis.com|storage.cloud.google.com)":n,H="([^?#]*)",W=new RegExp(`^https?://${B}/${s}/${H}`,"i"),U=[{regex:h,indices:p,postModify:i},{regex:k,indices:L,postModify:y},{regex:W,indices:{bucket:1,path:2},postModify:y}];for(let $=0;$<U.length;$++){const K=U[$],Z=K.regex.exec(e);if(Z){const A=Z[K.indices.bucket];let C=Z[K.indices.path];C||(C=""),r=new ia(A,C),K.postModify(r);break}}if(r==null)throw Rq(e);return r}}class Dq{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Oq(t,e,n){let r=1,s=null,i=null,l=!1,h=0;function p(){return h===2}let y=!1;function _(...H){y||(y=!0,e.apply(null,H))}function E(H){s=setTimeout(()=>{s=null,t(k,p())},H)}function T(){i&&clearTimeout(i)}function k(H,...W){if(y){T();return}if(H){T(),_.call(null,H,...W);return}if(p()||l){T(),_.call(null,H,...W);return}r<64&&(r*=2);let U;h===1?(h=2,U=0):U=(r+Math.random())*1e3,E(U)}let L=!1;function B(H){L||(L=!0,T(),!y&&(s!==null?(H||(h=2),clearTimeout(s),E(0)):H||(h=1)))}return E(0),i=setTimeout(()=>{l=!0,B(!0)},n),B}function Mq(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lq(t){return t!==void 0}function mT(t,e,n,r){if(r<e)throw fT(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw fT(`Invalid value for '${t}'. Expected ${n} or less.`)}function jq(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const s=e(r)+"="+e(t[r]);n=n+s+"&"}return n=n.slice(0,-1),n}var ng;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(ng||(ng={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fq(t,e){const n=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return n||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vq{constructor(e,n,r,s,i,l,h,p,y,_,E,T=!0){this.url_=e,this.method_=n,this.headers_=r,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=l,this.callback_=h,this.errorCallback_=p,this.timeout_=y,this.progressCallback_=_,this.connectionFactory_=E,this.retry=T,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((k,L)=>{this.resolve_=k,this.reject_=L,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new ap(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const l=h=>{const p=h.loaded,y=h.lengthComputable?h.total:-1;this.progressCallback_!==null&&this.progressCallback_(p,y)};this.progressCallback_!==null&&i.addUploadProgressListener(l),i.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(l),this.pendingConnection_=null;const h=i.getErrorCode()===ng.NO_ERROR,p=i.getStatus();if(!h||Fq(p,this.additionalRetryCodes_)&&this.retry){const _=i.getErrorCode()===ng.ABORT;r(!1,new ap(!1,null,_));return}const y=this.successCodes_.indexOf(p)!==-1;r(!0,new ap(y,i))})},n=(r,s)=>{const i=this.resolve_,l=this.reject_,h=s.connection;if(s.wasSuccessCode)try{const p=this.callback_(h,h.getResponse());Lq(p)?i(p):i()}catch(p){l(p)}else if(h!==null){const p=Cq();p.serverResponse=h.getErrorText(),this.errorCallback_?l(this.errorCallback_(h,p)):l(p)}else if(s.canceled){const p=this.appDelete_?eD():Nq();l(p)}else{const p=Sq();l(p)}};this.canceled_?n(!1,new ap(!1,null,!0)):this.backoffId_=Oq(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&Mq(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class ap{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function Bq(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function Uq(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function $q(t,e){e&&(t["X-Firebase-GMPID"]=e)}function zq(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function Wq(t,e,n,r,s,i,l=!0){const h=jq(t.urlParams),p=t.url+h,y=Object.assign({},t.headers);return $q(y,e),Bq(y,n),Uq(y,i),zq(y,r),new Vq(p,t.method,y,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,l)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hq(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function Gq(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rg{constructor(e,n){this._service=e,n instanceof ia?this._location=n:this._location=ia.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new rg(e,n)}get root(){const e=new ia(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Gq(this._location.path)}get storage(){return this._service}get parent(){const e=Hq(this._location.path);if(e===null)return null;const n=new ia(this._location.bucket,e);return new rg(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw kq(e)}}function pT(t,e){const n=e==null?void 0:e[Iq];return n==null?null:ia.makeFromBucketSpec(n,t)}function qq(t,e,n,r={}){t.host=`${e}:${n}`,t._protocol="http";const{mockUserToken:s}=r;s&&(t._overrideAuthToken=typeof s=="string"?s:WP(s,t.app.options.projectId))}class Kq{constructor(e,n,r,s,i){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=s,this._firebaseVersion=i,this._bucket=null,this._host=Jk,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=Aq,this._maxUploadRetryTime=Tq,this._requests=new Set,s!=null?this._bucket=ia.makeFromBucketSpec(s,this._host):this._bucket=pT(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=ia.makeFromBucketSpec(this._url,e):this._bucket=pT(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){mT("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){mT("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new rg(this,e)}_makeRequest(e,n,r,s,i=!0){if(this._deleted)return new Dq(eD());{const l=Wq(e,this._appId,r,s,n,this._firebaseVersion,i);return this._requests.add(l),l.getPromise().then(()=>this._requests.delete(l),()=>this._requests.delete(l)),l}}async makeRequestWithTokens(e,n){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,s).getPromise()}}const gT="@firebase/storage",yT="0.13.2";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tD="storage";function Xq(t=Gv(),e){t=us(t);const r=r1(t,tD).getImmediate({identifier:e}),s=UP("storage");return s&&Qq(r,...s),r}function Qq(t,e,n,r={}){qq(t,e,n,r)}function Yq(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new Kq(n,r,s,e,au)}function Zq(){Hc(new Ll(tD,Yq,"PUBLIC").setMultipleInstances(!0)),ja(gT,yT,""),ja(gT,yT,"esm2017")}Zq();const Jq={apiKey:"AIzaSyC-ls1TrvSkrw71KqmB_kHYgPoj0H550a8",authDomain:"madas-store.firebaseapp.com",projectId:"madas-store",storageBucket:"madas-store.firebasestorage.app",messagingSenderId:"527071300010",appId:"1:527071300010:web:7470e2204065b4590583d3"},j2=aA().length?aA()[0]:qP(Jq);Eq(j2);const ir=cH(j2);Xq(j2);const ur={USERS:"users",ROLES:"roles",PERMISSIONS:"permissions",ROLE_PERMISSIONS:"role_permissions"},xT={async create(t){const e=ii(Bs(ir,ur.USERS)),n={...t,id:e.id,created_at:Xn.now().toDate().toISOString(),updated_at:Xn.now().toDate().toISOString()};return await _1(e,n),n},async getById(t){const e=await A2(ii(ir,ur.USERS,t));return e.exists()?e.data():null},async getByEmail(t){if(!t||t.trim()==="")return null;const e=Ca(Bs(ir,ur.USERS),Sa("email","==",t)),n=await Bi(e);return n.empty?null:n.docs[0].data()},async getByFirebaseUid(t){if(!t||t.trim()==="")return null;const e=Ca(Bs(ir,ur.USERS),Sa("firebase_uid","==",t)),n=await Bi(e);return n.empty?null:n.docs[0].data()},async getByTenantId(t){if(!t)return[];const e=Ca(Bs(ir,ur.USERS),Sa("tenant_id","==",t));return(await Bi(e)).docs.map(r=>r.data())},async getSuperAdminUsers(){const t=Ca(Bs(ir,ur.USERS),Sa("type","==","super_admin"));return(await Bi(t)).docs.map(n=>n.data())},async update(t,e){const n=ii(ir,ur.USERS,t);await Ww(n,{...e,updated_at:Xn.now().toDate().toISOString()})},async delete(t){await T2(ii(ir,ur.USERS,t))},async updateLastLogin(t){const e=ii(ir,ur.USERS,t);await Ww(e,{last_login_at:Xn.now().toDate().toISOString()})}},vc={async create(t){const e=ii(Bs(ir,ur.ROLES)),n={...t,id:e.id,created_at:Xn.now().toDate().toISOString(),updated_at:Xn.now().toDate().toISOString()};return await _1(e,n),n},async getById(t){const e=await A2(ii(ir,ur.ROLES,t));return e.exists()?e.data():null},async getByTenantId(t){const e=t===void 0?null:t,n=Ca(Bs(ir,ur.ROLES),Sa("tenant_id","==",e));return(await Bi(n)).docs.map(s=>s.data())},async getAll(){return(await Bi(Bs(ir,ur.ROLES))).docs.map(e=>e.data())},async update(t,e){const n=ii(ir,ur.ROLES,t);await Ww(n,{...e,updated_at:Xn.now().toDate().toISOString()})},async delete(t){await T2(ii(ir,ur.ROLES,t))}},F2={async create(t){const e=ii(Bs(ir,ur.PERMISSIONS)),n={...t,id:e.id,created_at:Xn.now().toDate().toISOString()};return await _1(e,n),n},async getById(t){const e=await A2(ii(ir,ur.PERMISSIONS,t));return e.exists()?e.data():null},async getByKey(t){const e=Ca(Bs(ir,ur.PERMISSIONS),Sa("key","==",t)),n=await Bi(e);return n.empty?null:n.docs[0].data()},async getAll(){return(await Bi(Bs(ir,ur.PERMISSIONS))).docs.map(e=>e.data())},async getByCategory(t){const e=Ca(Bs(ir,ur.PERMISSIONS),Sa("category","==",t));return(await Bi(e)).docs.map(r=>r.data())}},Rl={async assignPermission(t,e){const n=`${t}_${e}`,r=ii(ir,ur.ROLE_PERMISSIONS,n),s={role_id:t,permission_id:e,created_at:Xn.now().toDate().toISOString()};await _1(r,s)},async removePermission(t,e){const n=`${t}_${e}`;await T2(ii(ir,ur.ROLE_PERMISSIONS,n))},async getPermissionsByRoleId(t){if(!t||t.trim()==="")return[];const e=Ca(Bs(ir,ur.ROLE_PERMISSIONS),Sa("role_id","==",t)),r=(await Bi(e)).docs.map(i=>i.data().permission_id),s=[];for(const i of r){const l=await F2.getById(i);l&&s.push(l)}return s},async getPermissionKeysByRoleId(t){return!t||t.trim()===""?[]:(await this.getPermissionsByRoleId(t)).map(n=>n.key)},async updateRolePermissions(t,e){if(!t||t.trim()==="")throw new Error("roleId is required");const n=IH(ir),r=Ca(Bs(ir,ur.ROLE_PERMISSIONS),Sa("role_id","==",t)),s=await Bi(r),i=new Set(s.docs.map(h=>h.data().permission_id)),l=new Set(e);for(const h of s.docs){const p=h.data();l.has(p.permission_id)||n.delete(h.ref)}for(const h of e)if(!i.has(h)){const p=`${t}_${h}`,y=ii(ir,ur.ROLE_PERMISSIONS,p),_={role_id:t,permission_id:h,created_at:Xn.now().toDate().toISOString()};n.set(y,_)}await n.commit()},async getRolesByPermissionId(t){if(!t||t.trim()==="")return[];const e=Ca(Bs(ir,ur.ROLE_PERMISSIONS),Sa("permission_id","==",t)),r=(await Bi(e)).docs.map(i=>i.data().role_id),s=[];for(const i of r){const l=await vc.getById(i);l&&s.push(l)}return s}};async function eK(t,e,n){try{return(await Rl.getPermissionKeysByRoleId(t)).includes(e)?{allowed:!0}:{allowed:!1,reason:`User does not have permission: ${e}`}}catch(r){return console.error("[checkPermission] Error:",r),{allowed:!1,reason:"Error checking permissions"}}}async function tK(t,e){try{const n=await Rl.getPermissionKeysByRoleId(t);return e.some(s=>n.includes(s))?{allowed:!0}:{allowed:!1,reason:`User does not have any of the required permissions: ${e.join(", ")}`}}catch(n){return console.error("[checkAnyPermission] Error:",n),{allowed:!1,reason:"Error checking permissions"}}}async function nK(t,e){try{const n=await Rl.getPermissionKeysByRoleId(t);return e.every(i=>n.includes(i))?{allowed:!0}:{allowed:!1,reason:`User missing required permissions: ${e.filter(i=>!n.includes(i)).join(", ")}`}}catch(n){return console.error("[checkAllPermissions] Error:",n),{allowed:!1,reason:"Error checking permissions"}}}function rK(t,e){return t.type==="super_admin"?!0:t.type==="tenant_staff"?t.tenant_id===e:!1}function sK(t,e){return t.id===e.id?!1:t.type==="super_admin"?!0:t.type==="tenant_staff"&&e.type==="tenant_staff"?t.tenant_id===e.tenant_id:!1}async function iK(t){return Rl.getPermissionKeysByRoleId(t)}const nD=q.createContext(void 0),aK=({children:t})=>{const{user:e}=fm(),[n,r]=q.useState(null),[s,i]=q.useState([]),[l,h]=q.useState(!0),p=q.useCallback(async()=>{if(!e){r(null),i([]),h(!1);return}try{if(h(!0),!e.uid){console.warn("[RBACProvider] Firebase user missing UID"),r(null),i([]),h(!1);return}let M=await xT.getByFirebaseUid(e.uid);if(!M&&e.email&&(M=await xT.getByEmail(e.email)),!M){console.warn("[RBACProvider] No RBAC user found for Firebase user",{uid:e.uid,email:e.email}),r(null),i([]),h(!1);return}if(r(M),M.role_id)try{const U=await iK(M.role_id);i(U)}catch(U){console.error("[RBACProvider] Error loading permissions:",U),i([])}else console.warn("[RBACProvider] User has no role_id assigned"),i([])}catch(M){console.error("[RBACProvider] Error loading user data:",M),r(null),i([])}finally{h(!1)}},[e]);q.useEffect(()=>{p()},[p]);const y=q.useCallback(async M=>n?(await eK(n.role_id,M,n.type)).allowed:!1,[n]),_=q.useCallback(async M=>n?(await tK(n.role_id,M)).allowed:!1,[n]),E=q.useCallback(async M=>n?(await nK(n.role_id,M)).allowed:!1,[n]),T=q.useCallback(M=>n?rK(n,M):!1,[n]),k=q.useCallback(M=>n?sK(n,M):!1,[n]),L=q.useCallback(async()=>{if(!n)return[];try{if(n.type==="super_admin")return vc.getAll();if(n.tenant_id){const M=n.tenant_id===void 0?null:n.tenant_id;return vc.getByTenantId(M)}return[]}catch(M){return console.error("[RBACContext] Error getting roles:",M),[]}},[n]),B=q.useCallback(async()=>F2.getAll(),[]),H=q.useCallback(async M=>Rl.getPermissionKeysByRoleId(M),[]),W=q.useMemo(()=>({user:n,loading:l,permissions:s,hasPermission:y,hasAnyPermission:_,hasAllPermissions:E,canAccessTenant:T,canManageUser:k,getRoles:L,getPermissions:B,getUserPermissions:H,refresh:p}),[n,l,s,y,_,E,T,k,L,B,H,p]);return d.jsx(nD.Provider,{value:W,children:t})},Gs=()=>{const t=q.useContext(nD);if(!t)throw new Error("useRBAC must be used within RBACProvider");return t},oK=q.createContext(void 0),wT="dark-mode",lK=({children:t})=>{const[e,n]=q.useState(()=>{const s=localStorage.getItem(wT);return s!==null?s==="1":window.matchMedia("(prefers-color-scheme: dark)").matches});q.useEffect(()=>{e?(document.documentElement.classList.add("dark"),document.body.classList.add("dark-mode")):(document.documentElement.classList.remove("dark"),document.body.classList.remove("dark-mode")),localStorage.setItem(wT,e?"1":"0")},[e]);const r=()=>{n(s=>!s)};return d.jsx(oK.Provider,{value:{isDark:e,toggle:r},children:t})};class cK extends q.Component{constructor(){super(...arguments);G2(this,"state",{hasError:!1,error:null})}static getDerivedStateFromError(n){return{hasError:!0,error:n}}componentDidCatch(n,r){console.error("Uncaught error:",n,r)}render(){var n,r;return this.state.hasError?d.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 dark:bg-gray-900 p-4",children:d.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg p-6 max-w-md w-full",children:[d.jsx("h1",{className:"text-2xl font-bold text-red-600 mb-4",children:"Something went wrong"}),d.jsx("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:((n=this.state.error)==null?void 0:n.message)||"An unexpected error occurred"}),d.jsx("button",{onClick:()=>{this.setState({hasError:!1,error:null}),window.location.reload()},className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark",children:"Reload Page"}),d.jsxs("details",{className:"mt-4",children:[d.jsx("summary",{className:"cursor-pointer text-sm text-gray-500",children:"Error Details"}),d.jsx("pre",{className:"mt-2 text-xs bg-gray-100 dark:bg-gray-700 p-2 rounded overflow-auto",children:(r=this.state.error)==null?void 0:r.stack})]})]})}):this.props.children}}const Kw=({message:t="Loading..."})=>d.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-[#0a0b1a] relative",children:[d.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[d.jsx("div",{className:"absolute top-1/4 left-1/4 w-96 h-96 bg-amber-500/5 rounded-full blur-3xl animate-pulse"}),d.jsx("div",{className:"absolute bottom-1/4 right-1/4 w-80 h-80 bg-purple-500/5 rounded-full blur-3xl animate-pulse",style:{animationDelay:"1s"}})]}),d.jsxs("div",{className:"relative z-10 flex flex-col items-center gap-6",children:[d.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-amber-400 to-amber-600 rounded-2xl flex items-center justify-center shadow-lg shadow-amber-500/30 animate-pulse",children:d.jsx("span",{className:"text-[#0a0b1a] text-2xl font-black",children:"X"})}),d.jsx("div",{className:"relative",children:d.jsx("div",{className:"w-12 h-12 border-3 border-white/10 border-t-amber-400 rounded-full animate-spin"})}),d.jsx("p",{className:"text-gray-400 text-sm",children:t})]})]});/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uK=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),rD=(...t)=>t.filter((e,n,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===n).join(" ").trim();/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var dK={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hK=q.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:s="",children:i,iconNode:l,...h},p)=>q.createElement("svg",{ref:p,...dK,width:e,height:e,stroke:t,strokeWidth:r?Number(n)*24/Number(e):n,className:rD("lucide",s),...h},[...l.map(([y,_])=>q.createElement(y,_)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zt=(t,e)=>{const n=q.forwardRef(({className:r,...s},i)=>q.createElement(hK,{ref:i,iconNode:e,className:rD(`lucide-${uK(t)}`,r),...s}));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _T=zt("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sD=zt("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fK=zt("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zi=zt("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iD=zt("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mK=zt("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vT=zt("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pK=zt("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ui=zt("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ur=zt("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Na=zt("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sg=zt("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qh=zt("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gK=zt("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aD=zt("EyeOff",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qc=zt("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I1=zt("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ET=zt("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ig=zt("KeyRound",[["path",{d:"M2.586 17.414A2 2 0 0 0 2 18.828V21a1 1 0 0 0 1 1h3a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h1a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1h.172a2 2 0 0 0 1.414-.586l.814-.814a6.5 6.5 0 1 0-4-4z",key:"1s6t7t"}],["circle",{cx:"16.5",cy:"7.5",r:".5",fill:"currentColor",key:"w0ekpg"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yh=zt("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zh=zt("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ag=zt("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yK=zt("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xK=zt("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sd=zt("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wK=zt("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bi=zt("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nd=zt("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V2=zt("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bT=zt("PowerOff",[["path",{d:"M18.36 6.64A9 9 0 0 1 20.77 15",key:"dxknvb"}],["path",{d:"M6.16 6.16a9 9 0 1 0 12.68 12.68",key:"1x7qb5"}],["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IT=zt("Power",[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wd=zt("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AT=zt("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const og=zt("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _K=zt("ScanLine",[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}],["path",{d:"M7 12h10",key:"b7w52i"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bu=zt("Scan",[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kl=zt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TT=zt("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $f=zt("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vK=zt("ShieldAlert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lg=zt("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EK=zt("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CT=zt("ToggleLeft",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"8",cy:"12",r:"2",key:"1nvbw3"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ST=zt("ToggleRight",[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"6",ry:"6",key:"f2vt7d"}],["circle",{cx:"16",cy:"12",r:"2",key:"4ma0v8"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zf=zt("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NT=zt("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oD=zt("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fi=zt("Truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RT=zt("UserCog",[["circle",{cx:"18",cy:"15",r:"3",key:"gjjjvw"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M10 15H6a4 4 0 0 0-4 4v2",key:"1nfge6"}],["path",{d:"m21.7 16.4-.9-.3",key:"12j9ji"}],["path",{d:"m15.2 13.9-.9-.3",key:"1fdjdi"}],["path",{d:"m16.6 18.7.3-.9",key:"heedtr"}],["path",{d:"m19.1 12.2.3-.9",key:"1af3ki"}],["path",{d:"m19.6 18.7-.4-1",key:"1x9vze"}],["path",{d:"m16.8 12.3-.4-1",key:"vqeiwj"}],["path",{d:"m14.3 16.6 1-.4",key:"1qlj63"}],["path",{d:"m20.7 13.8 1-.4",key:"1v5t8k"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lD=zt("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B2=zt("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yc=zt("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ar=zt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),bK=({onToggleSidebar:t})=>{const{logout:e,user:n}=fm(),{user:r}=Gs();Vo();const[s,i]=q.useState(!1),[l,h]=q.useState(!1),p=q.useRef(null),y=q.useMemo(()=>{var T;return{name:(r==null?void 0:r.name)||(n==null?void 0:n.displayName)||((T=n==null?void 0:n.email)==null?void 0:T.split("@")[0])||"Admin",email:(r==null?void 0:r.email)||(n==null?void 0:n.email)||"",initials:((r==null?void 0:r.name)||(n==null?void 0:n.displayName)||(n==null?void 0:n.email)||"A").charAt(0).toUpperCase()}},[r,n]);q.useEffect(()=>{const T=k=>{p.current&&!p.current.contains(k.target)&&i(!1)};return s&&document.addEventListener("mousedown",T),()=>{document.removeEventListener("mousedown",T)}},[s]);const _=q.useCallback(()=>{i(T=>!T)},[]),E=q.useCallback(async()=>{i(!1),await e()},[e]);return d.jsx("header",{className:"bg-[#1a1b3e]/95 backdrop-blur-xl border-b border-white/5 fixed top-0 left-0 right-0 z-40 h-16",children:d.jsxs("div",{className:"flex items-center justify-between h-full px-4 lg:px-6",children:[d.jsxs("div",{className:"flex items-center gap-4",children:[d.jsx("button",{type:"button","aria-label":"Toggle navigation",className:"lg:hidden p-2 rounded-xl text-gray-400 hover:text-white hover:bg-white/5 transition-all",onClick:t,children:d.jsx(wK,{className:"w-6 h-6"})}),d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-amber-400 to-amber-600 rounded-xl flex items-center justify-center shadow-lg shadow-amber-500/20",children:d.jsx("span",{className:"text-[#0a0b1a] font-black text-lg",children:"X"})}),d.jsxs("div",{className:"hidden sm:block",children:[d.jsxs("h1",{className:"text-lg font-bold text-white",children:["XDIGIX ",d.jsx("span",{className:"text-amber-400",children:"Admin"})]}),d.jsx("p",{className:"text-xs text-gray-500",children:"System Control Panel"})]})]})]}),d.jsx("div",{className:"hidden md:flex flex-1 max-w-md mx-8",children:d.jsxs("div",{className:`relative w-full transition-all duration-300 ${l?"scale-105":""}`,children:[d.jsx(Kl,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-500"}),d.jsx("input",{type:"text",placeholder:"Search clients, staff...",className:"w-full pl-10 pr-4 py-2 bg-white/5 border border-white/10 rounded-xl text-sm text-white placeholder-gray-500 focus:outline-none focus:border-amber-500/50 focus:bg-white/10 transition-all",onFocus:()=>h(!0),onBlur:()=>h(!1)}),d.jsx("kbd",{className:"absolute right-3 top-1/2 -translate-y-1/2 hidden lg:inline-flex items-center gap-1 px-2 py-0.5 text-xs text-gray-500 bg-white/5 rounded border border-white/10",children:"K"})]})}),d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsxs("button",{type:"button",className:"relative p-2 rounded-xl text-gray-400 hover:text-white hover:bg-white/5 transition-all",children:[d.jsx(fK,{className:"w-5 h-5"}),d.jsx("span",{className:"absolute top-1.5 right-1.5 w-2 h-2 bg-amber-400 rounded-full"})]}),d.jsxs("div",{className:"relative",ref:p,children:[d.jsxs("button",{type:"button",className:"flex items-center gap-3 p-1.5 pr-3 rounded-xl hover:bg-white/5 transition-all",onClick:_,children:[d.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-amber-400 to-amber-600 rounded-lg flex items-center justify-center",children:d.jsx("span",{className:"text-[#0a0b1a] font-bold text-sm",children:y.initials})}),d.jsxs("div",{className:"hidden md:block text-left",children:[d.jsx("p",{className:"text-sm font-medium text-white leading-none",children:y.name}),d.jsx("p",{className:"text-xs text-gray-500 mt-0.5",children:"Super Admin"})]}),d.jsx(pK,{className:`w-4 h-4 text-gray-500 hidden md:block transition-transform ${s?"rotate-180":""}`})]}),s&&d.jsxs("div",{className:"absolute right-0 mt-2 w-64 rounded-xl border border-white/10 bg-[#1a1b3e] shadow-xl z-50 overflow-hidden animate-fade-in",children:[d.jsxs("div",{className:"p-4 border-b border-white/5 bg-gradient-to-r from-amber-500/5 to-transparent",children:[d.jsx("p",{className:"text-sm font-medium text-white",children:y.name}),d.jsx("p",{className:"text-xs text-gray-400 truncate",children:y.email}),d.jsx("span",{className:"inline-block mt-2 px-2 py-0.5 text-xs font-medium bg-amber-500/20 text-amber-400 rounded-full",children:"Super Administrator"})]}),d.jsxs("div",{className:"py-1",children:[d.jsxs("button",{type:"button",className:"w-full flex items-center gap-3 px-4 py-2.5 text-sm text-gray-300 hover:bg-white/5 transition-colors",children:[d.jsx(B2,{className:"w-4 h-4"}),d.jsx("span",{children:"Profile"})]}),d.jsxs("button",{type:"button",className:"w-full flex items-center gap-3 px-4 py-2.5 text-sm text-gray-300 hover:bg-white/5 transition-colors",children:[d.jsx($f,{className:"w-4 h-4"}),d.jsx("span",{children:"Settings"})]})]}),d.jsx("div",{className:"border-t border-white/5 py-1",children:d.jsxs("button",{type:"button",onClick:E,className:"w-full flex items-center gap-3 px-4 py-2.5 text-sm text-red-400 hover:bg-red-500/10 transition-colors",children:[d.jsx(xK,{className:"w-4 h-4"}),d.jsx("span",{children:"Sign Out"})]})})]})]})]})]})})};function cD(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var s=t.length;for(e=0;e<s;e++)t[e]&&(n=cD(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function Ry(){for(var t,e,n=0,r="",s=arguments.length;n<s;n++)(t=arguments[n])&&(e=cD(t))&&(r&&(r+=" "),r+=e);return r}const IK=[{title:"Overview",items:[{type:"link",label:"Dashboard",icon:d.jsx(Yh,{className:"w-5 h-5"}),to:"/"}]},{title:"Management",items:[{type:"link",label:"Clients",icon:d.jsx(zi,{className:"w-5 h-5"}),to:"/clients"},{type:"link",label:"Company Staff",icon:d.jsx(Yc,{className:"w-5 h-5"}),to:"/staff"},{type:"link",label:"Subscriptions",icon:d.jsx(sg,{className:"w-5 h-5"}),to:"/subscriptions"}]},{title:"Fulfillment",items:[{type:"link",label:"All Orders",icon:d.jsx(bi,{className:"w-5 h-5"}),to:"/fulfillment"},{type:"link",label:"Pending",icon:d.jsx(Na,{className:"w-5 h-5"}),to:"/pending-orders"},{type:"link",label:"Ready for Pickup",icon:d.jsx(Ur,{className:"w-5 h-5"}),to:"/ready-for-pickup"},{type:"link",label:"Shipping",icon:d.jsx(Fi,{className:"w-5 h-5"}),to:"/shipping"}]},{title:"Security",items:[{type:"link",label:"Plan Permissions",icon:d.jsx(sg,{className:"w-5 h-5"}),to:"/plan-permissions"},{type:"link",label:"Client Staff Permissions",icon:d.jsx(Yc,{className:"w-5 h-5"}),to:"/client-staff-permissions"}]},{title:"Insights",items:[{type:"link",label:"Analytics",icon:d.jsx(mK,{className:"w-5 h-5"}),to:"/analytics"}]}],AK=({isOpen:t,onClose:e})=>{const n=Vo(),r=[{label:"Add Client",icon:d.jsx(V2,{className:"w-4 h-4"}),onClick:()=>{n("/clients"),e()}},{label:"Add Staff",icon:d.jsx(lD,{className:"w-4 h-4"}),onClick:()=>{n("/staff"),e()}}];return d.jsxs(q.Fragment,{children:[d.jsx("div",{className:Ry("fixed inset-0 bg-black/50 backdrop-blur-sm lg:hidden transition-opacity z-20",t?"opacity-100 pointer-events-auto":"opacity-0 pointer-events-none"),onClick:e}),d.jsxs("aside",{className:Ry("fixed lg:static left-0 top-16 h-[calc(100vh-4rem)] lg:h-full w-72 bg-[#1a1b3e]/95 backdrop-blur-xl border-r border-white/5 z-30 transform transition-transform duration-300 ease-in-out",t?"translate-x-0":"-translate-x-full lg:translate-x-0"),children:[d.jsx("button",{className:"lg:hidden absolute top-4 right-4 p-2 rounded-lg text-gray-400 hover:text-white hover:bg-white/10 transition-all",onClick:e,children:d.jsx(Ar,{className:"w-5 h-5"})}),d.jsxs("div",{className:"flex flex-col h-full overflow-hidden",children:[d.jsx("nav",{className:"flex-1 min-h-0 px-4 py-6 space-y-6 overflow-y-auto",children:IK.map((s,i)=>d.jsxs("div",{children:[s.title&&d.jsx("p",{className:"text-xs uppercase tracking-wider text-gray-500 font-medium px-3 mb-3",children:s.title}),d.jsx("div",{className:"space-y-1",children:s.items.map((l,h)=>d.jsxs(OM,{to:l.to,className:({isActive:p})=>Ry("flex items-center gap-3 px-3 py-2.5 rounded-xl text-sm font-medium transition-all duration-200",p?"bg-amber-500/10 text-amber-400 border-l-2 border-amber-400":"text-gray-400 hover:text-white hover:bg-white/5"),onClick:e,children:[l.icon,d.jsx("span",{children:l.label})]},h))})]},i))}),d.jsxs("div",{className:"flex-shrink-0 p-4 border-t border-white/5",children:[d.jsxs("div",{className:"bg-gradient-to-br from-amber-500/10 to-amber-600/5 rounded-xl p-4 border border-amber-500/10",children:[d.jsx("h3",{className:"text-xs font-semibold text-amber-400 uppercase tracking-wider mb-3",children:"Quick Actions"}),d.jsx("div",{className:"space-y-2",children:r.map(s=>d.jsxs("button",{type:"button",className:"w-full flex items-center gap-2 text-sm text-gray-400 hover:text-white px-3 py-2 rounded-lg hover:bg-white/5 transition-all",onClick:s.onClick,children:[s.icon,d.jsx("span",{children:s.label})]},s.label))})]}),d.jsxs("div",{className:"mt-4 flex items-center gap-2 px-3",children:[d.jsx("span",{className:"w-2 h-2 bg-emerald-400 rounded-full animate-pulse"}),d.jsx("span",{className:"text-xs text-gray-500",children:"System operational"})]})]})]})]})]})},TK=()=>{const[t,e]=q.useState(!1),{user:n,loading:r,error:s}=fm(),{user:i,loading:l,hasPermission:h}=Gs(),[p,y]=q.useState(null);return q.useEffect(()=>{l?y(!0):(async()=>{if(!i){y(!0);return}if(i.type==="super_admin")try{const E=await h("super_admin.view_analytics");y(E)}catch(E){console.error("[AppShell] Error checking permission:",E),y(!0)}else y(!1)})()},[i,l,h]),r||l?d.jsx(Kw,{message:"Initializing..."}):s?d.jsx("div",{className:"min-h-screen bg-[#0a0b1a] flex items-center justify-center p-4",children:d.jsxs("div",{className:"bg-red-500/10 border border-red-500/30 rounded-xl p-6 max-w-md text-center",children:[d.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-full bg-red-500/20 flex items-center justify-center",children:d.jsx("span",{className:"text-3xl",children:""})}),d.jsx("h2",{className:"text-xl font-bold text-red-400 mb-2",children:"Authentication Error"}),d.jsx("p",{className:"text-gray-400 mb-4",children:s}),d.jsx("p",{className:"text-sm text-gray-500",children:"Please add this domain to Firebase Console  Authentication  Settings  Authorized Domains"})]})}):n?p===null?d.jsx(Kw,{message:"Checking access..."}):p===!1&&i&&i.type!=="super_admin"?d.jsx(wf,{to:"/no-access",replace:!0}):(i||console.warn("[AppShell] No RBAC user found - allowing access for setup"),d.jsxs("div",{className:"min-h-screen bg-[#0a0b1a]",children:[d.jsxs("div",{className:"fixed inset-0 overflow-hidden pointer-events-none",children:[d.jsx("div",{className:"absolute top-0 left-1/4 w-96 h-96 bg-amber-500/5 rounded-full blur-3xl"}),d.jsx("div",{className:"absolute bottom-0 right-1/4 w-80 h-80 bg-purple-500/5 rounded-full blur-3xl"})]}),d.jsx("div",{className:"fixed inset-0 bg-[linear-gradient(rgba(255,255,255,0.02)_1px,transparent_1px),linear-gradient(90deg,rgba(255,255,255,0.02)_1px,transparent_1px)] bg-[size:50px_50px] pointer-events-none"}),d.jsx(bK,{onToggleSidebar:()=>e(_=>!_)}),d.jsxs("div",{className:"flex h-screen pt-16",children:[d.jsx(AK,{isOpen:t,onClose:()=>e(!1)}),d.jsx("main",{className:"flex-1 overflow-y-auto relative",children:d.jsx(dM,{})})]})]})):d.jsx(wf,{to:"/login",replace:!0})},cs=({children:t,permission:e,permissions:n,allPermissions:r,fallback:s=null,showError:i=!1})=>{const{hasPermission:l,hasAnyPermission:h,hasAllPermissions:p,loading:y,user:_}=Gs(),[E,T]=q.useState(!0),[k,L]=q.useState(!1);return q.useEffect(()=>{y?(T(!0),L(!1)):(async()=>{if((_==null?void 0:_.type)==="super_admin"){T(!0),L(!0);return}if(!e&&(!n||n.length===0)&&(!r||r.length===0)){T(!0),L(!0);return}let H=!0;try{e?H=await l(e):n&&n.length>0?H=await h(n):r&&r.length>0&&(H=await p(r))}catch(W){console.error("[PermissionGuard] Error checking permissions:",W),H=!0}T(H),L(!0)})()},[e,n,r,l,h,p,y,_]),k&&!E?i?d.jsx("div",{className:"p-6 flex items-center justify-center min-h-[60vh]",children:d.jsxs("div",{className:"bg-[#1a1b3e] border border-red-500/20 rounded-2xl p-8 max-w-md text-center",children:[d.jsx("div",{className:"w-16 h-16 bg-red-500/20 text-red-400 rounded-full flex items-center justify-center mx-auto mb-4",children:d.jsx("svg",{className:"w-8 h-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:d.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),d.jsx("h2",{className:"text-xl font-bold text-white mb-2",children:"Access Denied"}),d.jsx("p",{className:"text-gray-400",children:"You don't have permission to access this content."})]})}):d.jsx(d.Fragment,{children:s}):d.jsx(d.Fragment,{children:t})};function CK(){var y;const{user:t}=Gs(),e=Vo(),[n,r]=q.useState({totalClients:0,activeClients:0,trialClients:0,suspendedClients:0,totalStaff:0,activeStaff:0,totalRevenue:0,mrr:0}),[s,i]=q.useState(!0);q.useEffect(()=>{l()},[]);const l=async()=>{try{i(!0);let _=[],E=[];try{_=(await Cn(In(at,"tenants"))).docs.map(K=>({id:K.id,...K.data()}))}catch($){console.warn("[SuperAdminOverviewPage] Could not load from tenants collection:",$)}try{(await Cn(In(at,"businesses"))).docs.map(Z=>{var C,N;const A=Z.data();return{id:Z.id,name:A.businessName||A.name||"Unnamed Business",status:((C=A.plan)==null?void 0:C.status)||A.status||"active",plan:((N=A.plan)==null?void 0:N.type)||A.plan||"basic"}}).forEach(Z=>{_.find(A=>A.id===Z.id)||_.push(Z)})}catch($){console.warn("[SuperAdminOverviewPage] Could not load from businesses collection:",$)}const T=_.length,k=_.filter($=>$.status==="active").length,L=_.filter($=>$.status==="trial").length,B=_.filter($=>$.status==="suspended").length;try{const $=Ii(In(at,"users"),hc("type","==","super_admin"));E=(await Cn($)).docs.map(Z=>Z.data())}catch($){console.warn("[SuperAdminOverviewPage] Could not load staff:",$);try{E=(await Cn(In(at,"users"))).docs.map(Z=>Z.data()).filter(Z=>Z.type==="super_admin")}catch(K){console.error("[SuperAdminOverviewPage] Could not load users at all:",K)}}const H=E.length,W=E.filter($=>$.status==="active").length;r({totalClients:T,activeClients:k,trialClients:L,suspendedClients:B,totalStaff:H,activeStaff:W,totalRevenue:0,mrr:0})}catch(_){console.error("[SuperAdminOverviewPage] Error loading stats:",_),console.error("Error code:",_.code),console.error("Error message:",_.message),_.code==="permission-denied"&&(console.error(`
 SOLUTION:`),console.error("   Deploy Firestore rules from sys/firestore.rules"),console.error("   Go to: https://console.firebase.google.com/project/madas-store/firestore/rules"))}finally{i(!1)}},h=[{title:"Total Clients",value:n.totalClients,icon:d.jsx(zi,{className:"w-6 h-6"}),color:"from-blue-500 to-blue-600",bgColor:"bg-blue-500/10",textColor:"text-blue-400",onClick:()=>e("/clients")},{title:"Active Clients",value:n.activeClients,icon:d.jsx(NT,{className:"w-6 h-6"}),color:"from-emerald-500 to-emerald-600",bgColor:"bg-emerald-500/10",textColor:"text-emerald-400",onClick:()=>e("/clients?status=active")},{title:"Trial Clients",value:n.trialClients,icon:d.jsx(Na,{className:"w-6 h-6"}),color:"from-amber-500 to-amber-600",bgColor:"bg-amber-500/10",textColor:"text-amber-400",onClick:()=>e("/clients?status=trial")},{title:"Company Staff",value:n.totalStaff,icon:d.jsx(Yc,{className:"w-6 h-6"}),color:"from-purple-500 to-purple-600",bgColor:"bg-purple-500/10",textColor:"text-purple-400",onClick:()=>e("/staff")},{title:"Active Staff",value:n.activeStaff,icon:d.jsx(lg,{className:"w-6 h-6"}),color:"from-indigo-500 to-indigo-600",bgColor:"bg-indigo-500/10",textColor:"text-indigo-400",onClick:()=>e("/staff")},{title:"Monthly Revenue",value:`$${n.mrr.toLocaleString()}`,icon:d.jsx(Qh,{className:"w-6 h-6"}),color:"from-emerald-500 to-teal-600",bgColor:"bg-emerald-500/10",textColor:"text-emerald-400",onClick:()=>e("/subscriptions")}],p=[{title:"Manage Clients",description:"Add, edit, or remove client businesses",icon:d.jsx(zi,{className:"w-6 h-6"}),to:"/clients",color:"from-blue-500 to-blue-600"},{title:"Manage Staff",description:"Add or remove company staff members",icon:d.jsx(Yc,{className:"w-6 h-6"}),to:"/staff",color:"from-purple-500 to-purple-600"},{title:"Access Control",description:"Manage roles and permissions",icon:d.jsx(lg,{className:"w-6 h-6"}),to:"/access",color:"from-indigo-500 to-indigo-600"},{title:"Subscriptions",description:"Manage client subscription plans",icon:d.jsx(sg,{className:"w-6 h-6"}),to:"/subscriptions",color:"from-emerald-500 to-teal-600"}];return d.jsx(cs,{permission:"super_admin.view_analytics",showError:!0,children:d.jsxs("div",{className:"p-6 lg:p-8",children:[d.jsxs("div",{className:"mb-8",children:[d.jsxs("h1",{className:"text-3xl font-bold text-white mb-2",children:["Welcome back, ",d.jsx("span",{className:"text-amber-400",children:((y=t==null?void 0:t.name)==null?void 0:y.split(" ")[0])||"Admin"})]}),d.jsx("p",{className:"text-gray-400",children:"Here's what's happening with your platform today."})]}),d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-8",children:h.map((_,E)=>d.jsxs("div",{onClick:_.onClick,className:"group bg-[#1a1b3e] border border-[#2d2f5a] rounded-2xl p-6 cursor-pointer hover:border-amber-500/30 transition-all duration-300 hover:shadow-lg hover:shadow-amber-500/5",children:[d.jsxs("div",{className:"flex items-center justify-between mb-4",children:[d.jsx("div",{className:`${_.bgColor} p-3 rounded-xl`,children:d.jsx("div",{className:_.textColor,children:_.icon})}),d.jsx(sD,{className:"w-5 h-5 text-gray-600 group-hover:text-amber-400 group-hover:translate-x-1 transition-all"})]}),d.jsx("p",{className:"text-sm font-medium text-gray-400 mb-1",children:_.title}),d.jsx("p",{className:"text-2xl font-bold text-white",children:_.value})]},E))}),d.jsxs("div",{className:"mb-8",children:[d.jsx("h2",{className:"text-xl font-semibold text-white mb-4",children:"Quick Actions"}),d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:p.map((_,E)=>d.jsxs("div",{onClick:()=>e(_.to),className:"group bg-[#1a1b3e] border border-[#2d2f5a] rounded-2xl p-6 cursor-pointer hover:border-amber-500/30 transition-all duration-300",children:[d.jsx("div",{className:`bg-gradient-to-br ${_.color} p-3 rounded-xl w-fit mb-4 group-hover:scale-110 transition-transform`,children:d.jsx("div",{className:"text-white",children:_.icon})}),d.jsx("h3",{className:"font-semibold text-white text-lg mb-2",children:_.title}),d.jsx("p",{className:"text-sm text-gray-400",children:_.description})]},E))})]}),d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[d.jsxs("div",{className:"bg-[#1a1b3e] border border-[#2d2f5a] rounded-2xl p-6",children:[d.jsxs("div",{className:"flex items-center justify-between mb-4",children:[d.jsx("h2",{className:"text-lg font-semibold text-white",children:"Recent Activity"}),d.jsx(_T,{className:"w-5 h-5 text-gray-500"})]}),d.jsx("div",{className:"space-y-4",children:[1,2,3].map((_,E)=>d.jsxs("div",{className:"flex items-center gap-4 p-3 rounded-xl bg-white/5",children:[d.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-amber-500/20 to-amber-600/20 flex items-center justify-center",children:d.jsx(_T,{className:"w-5 h-5 text-amber-400"})}),d.jsxs("div",{className:"flex-1",children:[d.jsx("p",{className:"text-sm text-gray-300",children:"Activity log coming soon..."}),d.jsx("p",{className:"text-xs text-gray-500",children:"Just now"})]})]},E))})]}),d.jsxs("div",{className:"bg-[#1a1b3e] border border-[#2d2f5a] rounded-2xl p-6",children:[d.jsxs("div",{className:"flex items-center justify-between mb-4",children:[d.jsx("h2",{className:"text-lg font-semibold text-white",children:"System Alerts"}),d.jsx(Ui,{className:"w-5 h-5 text-gray-500"})]}),d.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[d.jsx("div",{className:"w-16 h-16 rounded-full bg-emerald-500/10 flex items-center justify-center mb-4",children:d.jsx(NT,{className:"w-8 h-8 text-emerald-400"})}),d.jsx("p",{className:"text-gray-300 font-medium",children:"All systems operational"}),d.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"No alerts at this time"})]})]})]})]})})}function SK(){var et,Lt,Qe,rt,pe,ve,fe,ke,Ve,Vt,qt,yt,xe,se,De,Oe,Ge,ht,Et,st;const{user:t}=Gs(),[e,n]=q.useState([]),[r,s]=q.useState(!0),[i,l]=q.useState(!1),[h,p]=q.useState(!1),[y,_]=q.useState(!1),[E,T]=q.useState(null),[k,L]=q.useState(""),[B,H]=q.useState(""),[W,M]=q.useState("all"),[U,$]=q.useState("all"),[K,Z]=q.useState({name:"",plan:"basic",status:"trial",ownerEmail:"",brandEmail:"",password:"",systemAccess:{dashboard:!0,finance:!0}}),[A,C]=q.useState(!1);q.useEffect(()=>{N()},[]);const N=async()=>{try{s(!0);const[me,ae]=await Promise.all([Cn(In(at,"businesses")).catch(()=>null),Cn(In(at,"tenants")).catch(()=>null)]),ft=[];me&&!me.empty&&me.docs.forEach(At=>{var tt,ot,jt,Kt,ar,Xt,xn,Mt,we,Tt,Rt,wt,bt,ce,Ie,be;const Ke=At.data(),dn={id:At.id,name:Ke.businessName||Ke.name||"Unnamed Business",plan:((tt=Ke.plan)==null?void 0:tt.type)||Ke.plan||"basic",status:((ot=Ke.plan)==null?void 0:ot.status)||Ke.status||"active",created_at:((ar=(Kt=(jt=Ke.createdAt)==null?void 0:jt.toDate)==null?void 0:Kt.call(jt))==null?void 0:ar.toISOString())||Ke.created_at||((Xt=Ke.metadata)==null?void 0:Xt.createdAt)||new Date().toISOString(),updated_at:((we=(Mt=(xn=Ke.updatedAt)==null?void 0:xn.toDate)==null?void 0:Mt.call(xn))==null?void 0:we.toISOString())||Ke.updated_at||((Tt=Ke.metadata)==null?void 0:Tt.updatedAt)||new Date().toISOString(),_source:"businesses",ownerEmail:((Rt=Ke.owner)==null?void 0:Rt.email)||((wt=Ke.contact)==null?void 0:wt.email)||"N/A",contactEmail:((bt=Ke.contact)==null?void 0:bt.email)||((ce=Ke.owner)==null?void 0:ce.email)||"N/A",phone:((Ie=Ke.contact)==null?void 0:Ie.phone)||((be=Ke.settings)==null?void 0:be.phone)||"N/A",systemAccess:Ke.systemAccess||{dashboard:!0,finance:!0},features:Ke.features||{},suspensionReason:Ke.suspensionReason||null};ft.push(dn)}),ae&&!ae.empty&&ae.docs.forEach(At=>{const Ke=At.data();ft.find(dn=>dn.id===At.id)||ft.push({id:At.id,name:Ke.name||"Unnamed Tenant",plan:Ke.plan||"basic",status:Ke.status||"active",created_at:Ke.created_at||new Date().toISOString(),updated_at:Ke.updated_at||new Date().toISOString()})}),n(ft)}catch(me){console.error("[ClientsPage] Error loading clients:",me)}finally{s(!1)}},[D,O]=q.useState(!1),F=async()=>{if(!K.name.trim()){alert("Please enter a client name");return}if(!K.ownerEmail.trim()){alert("Please enter an owner email");return}if(!K.password||K.password.length<6){alert("Please enter a password with at least 6 characters");return}O(!0);try{const ft=await(await fetch("https://us-central1-madas-store.cloudfunctions.net/api/api/create-client",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({businessName:K.name,ownerEmail:K.ownerEmail,ownerPassword:K.password,ownerName:K.name+" Owner",brandEmail:K.brandEmail||K.ownerEmail,plan:K.plan,status:K.status,systemAccess:K.systemAccess||{dashboard:!0,finance:!0}})})).json();ft.success?(alert(` Client "${K.name}" created successfully!

Owner account: ${K.ownerEmail}
A welcome email has been sent.`),l(!1),Z({name:"",plan:"basic",status:"trial",ownerEmail:"",brandEmail:"",password:"",systemAccess:{dashboard:!0,finance:!0}}),C(!1),N()):alert(` Failed to create client: ${ft.message}`)}catch(me){console.error("[ClientsPage] Error creating client:",me),alert("Failed to create client. Please try again.")}finally{O(!1)}},R=async(me,ae)=>{var ft,At,Ke,dn,tt,ot,jt,Kt,ar,Xt,xn,Mt,we,Tt,Rt,wt;try{const bt=e.find(it=>it.id===me);if(!bt)throw new Error("Client not found");let ce,Ie,be;try{if(Ie=await ri(Bn(at,"businesses",me)),Ie.exists())ce="businesses",be=Ie.data();else if(Ie=await ri(Bn(at,"tenants",me)),Ie.exists())ce="tenants",be=Ie.data();else throw new Error("Client document not found in businesses or tenants collections")}catch{if(ce=bt._source==="businesses"?"businesses":"tenants",Ie=await ri(Bn(at,ce,me)),Ie.exists())be=Ie.data();else{const He=ce==="businesses"?"tenants":"businesses",un=await ri(Bn(at,He,me));if(un.exists())ce=He,Ie=un,be=un.data();else throw new Error(`Client document not found in ${ce} or ${He} collections`)}}let Ce={updated_at:new Date().toISOString()};if(ce==="businesses"){if(ae.status!==void 0){Ce.status=ae.status;const it=(be==null?void 0:be.plan)||{};Ce.plan={...it,status:ae.status}}if(ae.plan!==void 0){const it=(be==null?void 0:be.plan)||{};Ce.plan={...it,type:ae.plan}}if(ae.name!==void 0&&(Ce.businessName=ae.name,Ce.name=ae.name),ae.ownerEmail!==void 0&&(Ce.owner={...(be==null?void 0:be.owner)||{},email:ae.ownerEmail}),ae.brandEmail!==void 0||ae.contactEmail!==void 0){const it=ae.brandEmail||ae.contactEmail;Ce.contact={...(be==null?void 0:be.contact)||{},email:it}}ae.systemAccess!==void 0&&(Ce.systemAccess=ae.systemAccess),ae.features!==void 0&&(Ce.features={...(be==null?void 0:be.features)||{},...ae.features}),ae.suspensionReason!==void 0&&(Ce.suspensionReason=ae.suspensionReason)}else ae.status!==void 0&&(Ce.status=ae.status),ae.plan!==void 0&&(Ce.plan=ae.plan),ae.name!==void 0&&(Ce.name=ae.name),ae.systemAccess!==void 0&&(Ce.systemAccess=ae.systemAccess),ae.features!==void 0&&(Ce.features={...(be==null?void 0:be.features)||{},...ae.features}),ae.suspensionReason!==void 0&&(Ce.suspensionReason=ae.suspensionReason);if(await ls(Bn(at,ce,me),Ce),await N(),E&&E.id===me){const it=await ri(Bn(at,ce,me));if(it.exists()){const He=it.data(),un={id:it.id,name:He.businessName||He.name||"Unnamed Business",plan:((ft=He.plan)==null?void 0:ft.type)||He.plan||"basic",status:((At=He.plan)==null?void 0:At.status)||He.status||"active",created_at:((tt=(dn=(Ke=He.createdAt)==null?void 0:Ke.toDate)==null?void 0:dn.call(Ke))==null?void 0:tt.toISOString())||He.created_at||((ot=He.metadata)==null?void 0:ot.createdAt)||new Date().toISOString(),updated_at:((ar=(Kt=(jt=He.updatedAt)==null?void 0:jt.toDate)==null?void 0:Kt.call(jt))==null?void 0:ar.toISOString())||He.updated_at||((Xt=He.metadata)==null?void 0:Xt.updatedAt)||new Date().toISOString(),_source:ce==="businesses"?"businesses":"tenants",ownerEmail:((xn=He.owner)==null?void 0:xn.email)||((Mt=He.contact)==null?void 0:Mt.email)||"N/A",contactEmail:((we=He.contact)==null?void 0:we.email)||((Tt=He.owner)==null?void 0:Tt.email)||"N/A",phone:((Rt=He.contact)==null?void 0:Rt.phone)||((wt=He.settings)==null?void 0:wt.phone)||"N/A",systemAccess:He.systemAccess||{dashboard:!0,finance:!0},features:He.features||{},suspensionReason:He.suspensionReason||null};T(un)}}ae.status==="suspended"?alert(` Client "${bt.name}" has been suspended.`):ae.status==="active"&&bt.status==="suspended"&&alert(` Client "${bt.name}" has been activated.`)}catch(bt){console.error("[ClientsPage] Error updating client:",bt),alert("Failed to update client: "+bt.message)}},ie=async(me,ae)=>{const ft=e.find(ot=>ot.id===me);if(!ft)return;const At=ft,Ke=At.systemAccess||{dashboard:!0,finance:!0},dn={...Ke,[ae]:!Ke[ae]},tt=E;E&&E.id===me&&T({...E,...At,systemAccess:dn}),n(ot=>ot.map(jt=>jt.id===me?{...jt,...At,systemAccess:dn}:jt));try{await R(me,{systemAccess:dn})}catch(ot){tt&&tt.id===me&&T(tt),n(jt=>jt.map(Kt=>Kt.id===me?ft:Kt)),console.error("[ClientsPage] Error updating system access:",ot),alert("Failed to update system access. Please try again.")}},te=async me=>{await R(me,{status:"active",suspensionReason:null})},je=async me=>{if(confirm("Are you sure you want to delete this client? This action cannot be undone."))try{const ae=e.find(At=>At.id===me);if(!ae)throw new Error("Client not found");const ft=ae._source==="businesses"?"businesses":"tenants";await vw(Bn(at,ft,me)),N()}catch(ae){console.error("[ClientsPage] Error deleting client:",ae),alert("Failed to delete client: "+ae.message)}},We=me=>typeof me=="string"?me:me&&typeof me=="object"&&(me.type||me.plan)||"basic",Ee=e.filter(me=>{const ae=me.name.toLowerCase().includes(B.toLowerCase()),ft=W==="all"||me.status===W,At=We(me.plan);return ae&&ft&&(U==="all"||At===U)}),qe={total:e.length,active:e.filter(me=>me.status==="active").length,trial:e.filter(me=>me.status==="trial").length,suspended:e.filter(me=>me.status==="suspended").length};return d.jsx(cs,{permission:"super_admin.manage_all_tenants",showError:!0,children:d.jsxs("div",{className:"p-6 lg:p-8",children:[d.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-8",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"text-2xl font-bold text-white",children:"Clients Management"}),d.jsx("p",{className:"text-gray-400 mt-1",children:"Manage all client businesses on your platform"})]}),d.jsx(cs,{permission:"super_admin.manage_all_tenants",children:d.jsxs("button",{onClick:()=>{T(null),l(!0)},className:"inline-flex items-center gap-2 px-5 py-2.5 bg-gradient-to-r from-amber-400 to-amber-500 text-[#0a0b1a] font-semibold rounded-xl hover:from-amber-300 hover:to-amber-400 transition-all duration-300 shadow-lg shadow-amber-500/25",children:[d.jsx(V2,{className:"w-5 h-5"}),"Add Client"]})})]}),d.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:[d.jsxs("div",{className:"bg-[#1a1b3e] border border-[#2d2f5a] rounded-xl p-5",children:[d.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[d.jsx("div",{className:"p-2 rounded-lg bg-blue-500/10",children:d.jsx(zi,{className:"w-5 h-5 text-blue-400"})}),d.jsx("span",{className:"text-sm text-gray-400",children:"Total Clients"})]}),d.jsx("p",{className:"text-2xl font-bold text-white",children:qe.total})]}),d.jsxs("div",{className:"bg-[#1a1b3e] border border-[#2d2f5a] rounded-xl p-5",children:[d.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[d.jsx("div",{className:"p-2 rounded-lg bg-emerald-500/10",children:d.jsx(Ur,{className:"w-5 h-5 text-emerald-400"})}),d.jsx("span",{className:"text-sm text-gray-400",children:"Active"})]}),d.jsx("p",{className:"text-2xl font-bold text-emerald-400",children:qe.active})]}),d.jsxs("div",{className:"bg-[#1a1b3e] border border-[#2d2f5a] rounded-xl p-5",children:[d.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[d.jsx("div",{className:"p-2 rounded-lg bg-amber-500/10",children:d.jsx(Na,{className:"w-5 h-5 text-amber-400"})}),d.jsx("span",{className:"text-sm text-gray-400",children:"Trial"})]}),d.jsx("p",{className:"text-2xl font-bold text-amber-400",children:qe.trial})]}),d.jsxs("div",{className:"bg-[#1a1b3e] border border-[#2d2f5a] rounded-xl p-5",children:[d.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[d.jsx("div",{className:"p-2 rounded-lg bg-red-500/10",children:d.jsx(Ui,{className:"w-5 h-5 text-red-400"})}),d.jsx("span",{className:"text-sm text-gray-400",children:"Suspended"})]}),d.jsx("p",{className:"text-2xl font-bold text-red-400",children:qe.suspended})]})]}),d.jsx("div",{className:"bg-[#1a1b3e] border border-[#2d2f5a] rounded-xl p-5 mb-6",children:d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[d.jsxs("div",{className:"relative",children:[d.jsx(Kl,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-500"}),d.jsx("input",{type:"text",value:B,onChange:me=>H(me.target.value),placeholder:"Search clients...",className:"w-full pl-10 pr-4 py-2.5 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:border-amber-500/50"})]}),d.jsxs("select",{value:W,onChange:me=>M(me.target.value),className:"px-4 py-2.5 bg-white/5 border border-white/10 rounded-xl text-gray-300 focus:outline-none focus:border-amber-500/50",children:[d.jsx("option",{value:"all",children:"All Statuses"}),d.jsx("option",{value:"active",children:"Active"}),d.jsx("option",{value:"trial",children:"Trial"}),d.jsx("option",{value:"suspended",children:"Suspended"}),d.jsx("option",{value:"cancelled",children:"Cancelled"})]}),d.jsxs("select",{value:U,onChange:me=>$(me.target.value),className:"px-4 py-2.5 bg-white/5 border border-white/10 rounded-xl text-gray-300 focus:outline-none focus:border-amber-500/50",children:[d.jsx("option",{value:"all",children:"All Plans"}),d.jsx("option",{value:"basic",children:"Basic"}),d.jsx("option",{value:"professional",children:"Professional"}),d.jsx("option",{value:"enterprise",children:"Enterprise"})]})]})}),d.jsx("div",{className:"bg-[#1a1b3e] border border-[#2d2f5a] rounded-xl overflow-hidden",children:d.jsx("div",{className:"overflow-x-auto",children:d.jsxs("table",{className:"w-full",children:[d.jsx("thead",{children:d.jsxs("tr",{className:"bg-white/5",children:[d.jsx("th",{className:"text-left text-xs font-medium text-gray-400 uppercase px-6 py-4",children:"Client Name"}),d.jsx("th",{className:"text-left text-xs font-medium text-gray-400 uppercase px-6 py-4",children:"Owner Email"}),d.jsx("th",{className:"text-left text-xs font-medium text-gray-400 uppercase px-6 py-4",children:"Plan"}),d.jsx("th",{className:"text-left text-xs font-medium text-gray-400 uppercase px-6 py-4",children:"Status"}),d.jsx("th",{className:"text-left text-xs font-medium text-gray-400 uppercase px-6 py-4",children:"System Access"}),d.jsx("th",{className:"text-left text-xs font-medium text-gray-400 uppercase px-6 py-4",children:"Created"}),d.jsx("th",{className:"text-left text-xs font-medium text-gray-400 uppercase px-6 py-4",children:"Actions"})]})}),d.jsx("tbody",{className:"divide-y divide-white/5",children:Ee.length===0?d.jsx("tr",{children:d.jsx("td",{colSpan:7,className:"px-6 py-12 text-center text-gray-500",children:"No clients found"})}):Ee.map(me=>{var At,Ke,dn,tt;const ae=me,ft=We(me.plan);return d.jsxs("tr",{className:"hover:bg-white/5 transition-colors",children:[d.jsx("td",{className:"px-6 py-4",children:d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-amber-500/20 to-amber-600/20 flex items-center justify-center",children:d.jsx(zi,{className:"w-5 h-5 text-amber-400"})}),d.jsx("span",{className:"font-medium text-white",children:me.name})]})}),d.jsx("td",{className:"px-6 py-4 text-gray-400",children:ae.ownerEmail||"N/A"}),d.jsx("td",{className:"px-6 py-4",children:d.jsx("span",{className:`px-3 py-1 text-xs font-medium rounded-full ${ft==="enterprise"?"bg-purple-500/20 text-purple-400":ft==="professional"?"bg-blue-500/20 text-blue-400":"bg-emerald-500/20 text-emerald-400"}`,children:ft.charAt(0).toUpperCase()+ft.slice(1)})}),d.jsx("td",{className:"px-6 py-4",children:d.jsxs("select",{value:me.status,onChange:async ot=>{await R(me.id,{status:ot.target.value})},className:`px-3 py-1 text-xs font-medium rounded-full border-0 cursor-pointer ${me.status==="active"?"bg-emerald-500/20 text-emerald-400":me.status==="trial"?"bg-amber-500/20 text-amber-400":me.status==="suspended"?"bg-red-500/20 text-red-400":"bg-gray-500/20 text-gray-400"}`,children:[d.jsx("option",{value:"active",children:"Active"}),d.jsx("option",{value:"trial",children:"Trial"}),d.jsx("option",{value:"suspended",children:"Suspended"}),d.jsx("option",{value:"cancelled",children:"Cancelled"})]})}),d.jsx("td",{className:"px-6 py-4",children:d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsxs("button",{onClick:()=>ie(me.id,"dashboard"),className:`flex items-center gap-1.5 px-2.5 py-1 rounded-lg text-xs font-medium transition-all ${((At=ae.systemAccess)==null?void 0:At.dashboard)!==!1?"bg-blue-500/20 text-blue-400 border border-blue-500/30":"bg-gray-500/10 text-gray-500 border border-gray-500/20"}`,title:((Ke=ae.systemAccess)==null?void 0:Ke.dashboard)!==!1?"Dashboard Access Enabled":"Dashboard Access Disabled",children:[d.jsx(Yh,{className:"w-3.5 h-3.5"}),d.jsx("span",{children:"Dashboard"})]}),d.jsxs("button",{onClick:()=>ie(me.id,"finance"),className:`flex items-center gap-1.5 px-2.5 py-1 rounded-lg text-xs font-medium transition-all ${((dn=ae.systemAccess)==null?void 0:dn.finance)!==!1?"bg-emerald-500/20 text-emerald-400 border border-emerald-500/30":"bg-gray-500/10 text-gray-500 border border-gray-500/20"}`,title:((tt=ae.systemAccess)==null?void 0:tt.finance)!==!1?"Finance Access Enabled":"Finance Access Disabled",children:[d.jsx(Qh,{className:"w-3.5 h-3.5"}),d.jsx("span",{children:"Finance"})]})]})}),d.jsx("td",{className:"px-6 py-4 text-gray-400",children:me.created_at?new Date(me.created_at).toLocaleDateString():"N/A"}),d.jsx("td",{className:"px-6 py-4",children:d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("button",{onClick:()=>{const ot=me.id,jt=me.name;sessionStorage.setItem("supportMode","true"),sessionStorage.setItem("supportBusinessId",ot),sessionStorage.setItem("supportBusinessName",jt),sessionStorage.setItem("supportAdminEmail",(t==null?void 0:t.email)||""),sessionStorage.setItem("supportAdminName",(t==null?void 0:t.name)||"Support Staff"),window.open(`/dashboard?business=${ot}&support=true`,"_blank")},className:"p-2 rounded-lg text-gray-400 hover:text-emerald-400 hover:bg-emerald-500/10 transition-all",title:"Join Business for Support",children:d.jsx(RT,{className:"w-4 h-4"})}),d.jsx("button",{onClick:()=>{T(me),p(!0)},className:"p-2 rounded-lg text-gray-400 hover:text-blue-400 hover:bg-blue-500/10 transition-all",title:"View Details",children:d.jsx(Qc,{className:"w-4 h-4"})}),d.jsx("button",{onClick:()=>{T(me),l(!0)},className:"p-2 rounded-lg text-gray-400 hover:text-amber-400 hover:bg-amber-500/10 transition-all",title:"Edit",children:d.jsx(Nd,{className:"w-4 h-4"})}),me.status==="suspended"?d.jsx("button",{onClick:()=>te(me.id),className:"p-2 rounded-lg text-gray-400 hover:text-emerald-400 hover:bg-emerald-500/10 transition-all",title:"Activate",children:d.jsx(IT,{className:"w-4 h-4"})}):d.jsx("button",{onClick:()=>{T(me),_(!0)},className:"p-2 rounded-lg text-gray-400 hover:text-red-400 hover:bg-red-500/10 transition-all",title:"Suspend",children:d.jsx(bT,{className:"w-4 h-4"})}),d.jsx("button",{onClick:()=>je(me.id),className:"p-2 rounded-lg text-gray-400 hover:text-red-400 hover:bg-red-500/10 transition-all",title:"Delete",children:d.jsx(zf,{className:"w-4 h-4"})})]})})]},me.id)})})]})})}),i&&d.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:d.jsxs("div",{className:"bg-[#1a1b3e] border border-white/10 rounded-2xl p-6 max-w-md w-full animate-fade-in",children:[d.jsxs("div",{className:"flex items-center justify-between mb-6",children:[d.jsx("h2",{className:"text-xl font-bold text-white",children:E?"Edit Client":"Add New Client"}),d.jsx("button",{onClick:()=>{l(!1),T(null),C(!1)},className:"p-2 rounded-lg text-gray-400 hover:text-white hover:bg-white/10 transition-all",children:d.jsx(Ar,{className:"w-5 h-5"})})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Client Name"}),d.jsx("input",{type:"text",value:(E==null?void 0:E.name)||K.name,onChange:me=>E?T({...E,name:me.target.value}):Z({...K,name:me.target.value}),className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:border-amber-500/50",placeholder:"e.g., Acme Corporation"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Owner Email"}),d.jsx("input",{type:"email",value:E?E.ownerEmail||"":K.ownerEmail,onChange:me=>E?T({...E,ownerEmail:me.target.value}):Z({...K,ownerEmail:me.target.value}),className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:border-amber-500/50",placeholder:"owner@example.com"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Brand Email"}),d.jsx("input",{type:"email",value:E?E.contactEmail||"":K.brandEmail,onChange:me=>E?T({...E,contactEmail:me.target.value}):Z({...K,brandEmail:me.target.value}),className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:border-amber-500/50",placeholder:"contact@example.com"})]}),!E&&d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(ag,{className:"w-4 h-4"}),"Password"]})}),d.jsxs("div",{className:"relative",children:[d.jsx("input",{type:A?"text":"password",value:K.password,onChange:me=>Z({...K,password:me.target.value}),className:"w-full px-4 py-3 pr-12 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:border-amber-500/50",placeholder:"",minLength:6}),d.jsx("button",{type:"button",onClick:()=>C(!A),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-300 transition-colors",children:A?d.jsx(aD,{className:"w-5 h-5"}):d.jsx(Qc,{className:"w-5 h-5"})})]}),d.jsx("p",{className:"mt-1.5 text-xs text-gray-500",children:"Minimum 6 characters for client owner account"})]}),d.jsxs("div",{className:"pt-2 border-t border-white/10",children:[d.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-3",children:"System Access"}),d.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[d.jsxs("button",{type:"button",onClick:()=>{const me=E,ae=(me==null?void 0:me.systemAccess)||{dashboard:!0,finance:!0},ft={...ae,dashboard:!ae.dashboard};E?R(E.id,{systemAccess:ft}):Z({...K,systemAccess:ft})},className:`flex items-center justify-center gap-2 px-4 py-3 rounded-xl border transition-all ${(E?((et=E.systemAccess)==null?void 0:et.dashboard)!==!1:((Lt=K.systemAccess)==null?void 0:Lt.dashboard)!==!1)?"bg-blue-500/20 text-blue-400 border-blue-500/30":"bg-gray-500/10 text-gray-500 border-gray-500/20"}`,children:[d.jsx(Yh,{className:"w-4 h-4"}),d.jsx("span",{className:"text-sm font-medium",children:"Dashboard"}),(E?((Qe=E.systemAccess)==null?void 0:Qe.dashboard)!==!1:((rt=K.systemAccess)==null?void 0:rt.dashboard)!==!1)?d.jsx(ST,{className:"w-5 h-5"}):d.jsx(CT,{className:"w-5 h-5"})]}),d.jsxs("button",{type:"button",onClick:()=>{const me=E,ae=(me==null?void 0:me.systemAccess)||{dashboard:!0,finance:!0},ft={...ae,finance:!ae.finance};E?R(E.id,{systemAccess:ft}):Z({...K,systemAccess:ft})},className:`flex items-center justify-center gap-2 px-4 py-3 rounded-xl border transition-all ${(E?((pe=E.systemAccess)==null?void 0:pe.finance)!==!1:((ve=K.systemAccess)==null?void 0:ve.finance)!==!1)?"bg-emerald-500/20 text-emerald-400 border-emerald-500/30":"bg-gray-500/10 text-gray-500 border-gray-500/20"}`,children:[d.jsx(Qh,{className:"w-4 h-4"}),d.jsx("span",{className:"text-sm font-medium",children:"Finance"}),(E?((fe=E.systemAccess)==null?void 0:fe.finance)!==!1:((ke=K.systemAccess)==null?void 0:ke.finance)!==!1)?d.jsx(ST,{className:"w-5 h-5"}):d.jsx(CT,{className:"w-5 h-5"})]})]}),d.jsx("p",{className:"mt-2 text-xs text-gray-500",children:"Toggle access to Dashboard and Finance systems"})]}),d.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Plan"}),d.jsxs("select",{value:E?We(E.plan):K.plan,onChange:me=>E?T({...E,plan:me.target.value}):Z({...K,plan:me.target.value}),className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-gray-300 focus:outline-none focus:border-amber-500/50",children:[d.jsx("option",{value:"basic",children:"Basic"}),d.jsx("option",{value:"professional",children:"Professional"}),d.jsx("option",{value:"enterprise",children:"Enterprise"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Status"}),d.jsxs("select",{value:(E==null?void 0:E.status)||K.status,onChange:me=>E?R(E.id,{status:me.target.value}):Z({...K,status:me.target.value}),className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-gray-300 focus:outline-none focus:border-amber-500/50",children:[d.jsx("option",{value:"active",children:"Active"}),d.jsx("option",{value:"trial",children:"Trial"}),d.jsx("option",{value:"suspended",children:"Suspended"}),d.jsx("option",{value:"cancelled",children:"Cancelled"})]})]})]}),d.jsxs("div",{className:"flex gap-3 pt-4",children:[d.jsx("button",{onClick:()=>{l(!1),T(null),C(!1)},className:"flex-1 px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-gray-300 hover:bg-white/10 transition-all",children:"Cancel"}),E?d.jsx("button",{onClick:()=>{const me=E;R(E.id,{name:E.name,plan:We(E.plan),status:E.status,ownerEmail:me.ownerEmail,contactEmail:me.contactEmail}),l(!1),T(null)},className:"flex-1 px-4 py-3 bg-gradient-to-r from-amber-400 to-amber-500 text-[#0a0b1a] font-semibold rounded-xl hover:from-amber-300 hover:to-amber-400 transition-all",children:"Update Client"}):d.jsx("button",{onClick:F,disabled:D,className:"flex-1 px-4 py-3 bg-gradient-to-r from-amber-400 to-amber-500 text-[#0a0b1a] font-semibold rounded-xl hover:from-amber-300 hover:to-amber-400 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:D?d.jsxs("span",{className:"flex items-center justify-center gap-2",children:[d.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[d.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),d.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Creating..."]}):"Create Client"})]})]})]})}),h&&E&&d.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:d.jsxs("div",{className:"bg-[#1a1b3e] border border-white/10 rounded-2xl p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto animate-fade-in",children:[d.jsxs("div",{className:"flex items-center justify-between mb-6",children:[d.jsxs("div",{children:[d.jsx("h2",{className:"text-2xl font-bold text-white",children:E.name}),d.jsx("p",{className:"text-gray-400 mt-1",children:"Client Details & Control"})]}),d.jsx("button",{onClick:()=>{p(!1),T(null)},className:"p-2 rounded-lg text-gray-400 hover:text-white hover:bg-white/10 transition-all",children:d.jsx(Ar,{className:"w-5 h-5"})})]}),d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"bg-white/5 rounded-xl p-5 border border-white/10",children:[d.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center gap-2",children:[d.jsx(zi,{className:"w-5 h-5 text-amber-400"}),"Basic Information"]}),d.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"text-xs text-gray-400 uppercase tracking-wide mb-1 block",children:"Owner Email"}),d.jsx("p",{className:"text-white",children:E.ownerEmail||"N/A"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-xs text-gray-400 uppercase tracking-wide mb-1 block",children:"Contact Email"}),d.jsx("p",{className:"text-white",children:E.contactEmail||"N/A"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-xs text-gray-400 uppercase tracking-wide mb-1 block",children:"Plan"}),d.jsx("span",{className:`inline-block px-3 py-1 text-xs font-medium rounded-full ${We(E.plan)==="enterprise"?"bg-purple-500/20 text-purple-400":We(E.plan)==="professional"?"bg-blue-500/20 text-blue-400":"bg-emerald-500/20 text-emerald-400"}`,children:We(E.plan).charAt(0).toUpperCase()+We(E.plan).slice(1)})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-xs text-gray-400 uppercase tracking-wide mb-1 block",children:"Status"}),d.jsx("span",{className:`inline-block px-3 py-1 text-xs font-medium rounded-full ${E.status==="active"?"bg-emerald-500/20 text-emerald-400":E.status==="trial"?"bg-amber-500/20 text-amber-400":E.status==="suspended"?"bg-red-500/20 text-red-400":"bg-gray-500/20 text-gray-400"}`,children:E.status.charAt(0).toUpperCase()+E.status.slice(1)})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-xs text-gray-400 uppercase tracking-wide mb-1 block",children:"Created"}),d.jsx("p",{className:"text-white text-sm",children:E.created_at?new Date(E.created_at).toLocaleDateString():"N/A"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-xs text-gray-400 uppercase tracking-wide mb-1 block",children:"Last Updated"}),d.jsx("p",{className:"text-white text-sm",children:E.updated_at?new Date(E.updated_at).toLocaleDateString():"N/A"})]})]})]}),d.jsxs("div",{className:"bg-white/5 rounded-xl p-5 border border-white/10",children:[d.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center gap-2",children:[d.jsx($f,{className:"w-5 h-5 text-amber-400"}),"System Access Control"]}),d.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"Control which systems this client can access"}),d.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[d.jsxs("div",{className:"bg-white/5 rounded-xl p-4 border border-white/10",children:[d.jsxs("div",{className:"flex items-center justify-between mb-3",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx(Yh,{className:"w-5 h-5 text-blue-400"}),d.jsx("span",{className:"font-medium text-white",children:"Dashboard"})]}),d.jsx("button",{onClick:()=>ie(E.id,"dashboard"),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${((Ve=E.systemAccess)==null?void 0:Ve.dashboard)!==!1?"bg-blue-500":"bg-gray-600"}`,children:d.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${((Vt=E.systemAccess)==null?void 0:Vt.dashboard)!==!1?"translate-x-6":"translate-x-1"}`})})]}),d.jsx("p",{className:"text-xs text-gray-500",children:((qt=E.systemAccess)==null?void 0:qt.dashboard)!==!1?"Client has access to Dashboard system":"Client cannot access Dashboard system"})]}),d.jsxs("div",{className:"bg-white/5 rounded-xl p-4 border border-white/10",children:[d.jsxs("div",{className:"flex items-center justify-between mb-3",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx(Qh,{className:"w-5 h-5 text-emerald-400"}),d.jsx("span",{className:"font-medium text-white",children:"Finance"})]}),d.jsx("button",{onClick:()=>ie(E.id,"finance"),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${((yt=E.systemAccess)==null?void 0:yt.finance)!==!1?"bg-emerald-500":"bg-gray-600"}`,children:d.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${((xe=E.systemAccess)==null?void 0:xe.finance)!==!1?"translate-x-6":"translate-x-1"}`})})]}),d.jsx("p",{className:"text-xs text-gray-500",children:((se=E.systemAccess)==null?void 0:se.finance)!==!1?"Client has access to Finance system":"Client cannot access Finance system"})]})]})]}),d.jsxs("div",{className:"bg-white/5 rounded-xl p-5 border border-white/10",children:[d.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center gap-2",children:[d.jsx(bi,{className:"w-5 h-5 text-amber-400"}),"Business Features"]}),d.jsx("p",{className:"text-sm text-gray-400 mb-4",children:"Enable or disable features for this business"}),d.jsx("div",{className:"space-y-3",children:d.jsxs("label",{className:"flex items-center justify-between p-4 rounded-xl bg-white/5 border border-white/10 hover:bg-white/10 transition-all cursor-pointer",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx(Fi,{className:"w-5 h-5 text-purple-400"}),d.jsxs("div",{children:[d.jsx("div",{className:"font-medium text-white",children:"Fulfillment Service"}),d.jsx("div",{className:"text-xs text-gray-500",children:"Enable order fulfillment management"})]})]}),d.jsx("button",{onClick:async()=>{const me=E,ae=me.features||{},ft=ae.fulfillment||ae.fulfillment_service||ae.fulfillmentService,At={...ae,fulfillment:!ft,fulfillment_service:!ft,fulfillmentService:!ft},Ke={...E,...me,features:At};T(Ke);try{await R(E.id,{features:At});const dn=E._source==="businesses"?"businesses":"tenants",tt=await ri(Bn(at,dn,E.id));if(tt.exists()){const ot={id:tt.id,...tt.data()};T(ot)}}catch(dn){T(E),console.error("[ClientsPage] Error updating fulfillment feature:",dn),alert("Failed to update fulfillment feature. Please try again.")}},className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${(De=E.features)!=null&&De.fulfillment||(Oe=E.features)!=null&&Oe.fulfillment_service||(Ge=E.features)!=null&&Ge.fulfillmentService?"bg-purple-500":"bg-gray-600"}`,children:d.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${(ht=E.features)!=null&&ht.fulfillment||(Et=E.features)!=null&&Et.fulfillment_service||(st=E.features)!=null&&st.fulfillmentService?"translate-x-6":"translate-x-1"}`})})]})}),d.jsx("p",{className:"text-xs text-gray-500 mt-3",children:"When enabled, orders from this business will appear in the Fulfillment Management page"})]}),E.suspensionReason&&d.jsxs("div",{className:"bg-red-500/10 border border-red-500/20 rounded-xl p-5",children:[d.jsxs("h3",{className:"text-lg font-semibold text-red-400 mb-2 flex items-center gap-2",children:[d.jsx(Ui,{className:"w-5 h-5"}),"Suspension Details"]}),d.jsx("p",{className:"text-white text-sm",children:E.suspensionReason})]}),d.jsxs("div",{className:"bg-white/5 rounded-xl p-5 border border-white/10",children:[d.jsx("h3",{className:"text-lg font-semibold text-white mb-4",children:"Quick Actions"}),d.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[E.status==="suspended"?d.jsxs("button",{onClick:()=>{te(E.id),p(!1)},className:"px-4 py-3 bg-emerald-500/20 text-emerald-400 border border-emerald-500/30 rounded-xl hover:bg-emerald-500/30 transition-all font-medium",children:[d.jsx(IT,{className:"w-4 h-4 inline mr-2"}),"Activate Client"]}):d.jsxs("button",{onClick:()=>{_(!0),p(!1)},className:"px-4 py-3 bg-red-500/20 text-red-400 border border-red-500/30 rounded-xl hover:bg-red-500/30 transition-all font-medium",children:[d.jsx(bT,{className:"w-4 h-4 inline mr-2"}),"Suspend Client"]}),d.jsxs("button",{onClick:()=>{p(!1),l(!0)},className:"px-4 py-3 bg-amber-500/20 text-amber-400 border border-amber-500/30 rounded-xl hover:bg-amber-500/30 transition-all font-medium",children:[d.jsx(Nd,{className:"w-4 h-4 inline mr-2"}),"Edit Client"]}),d.jsxs("button",{onClick:()=>{confirm("Are you sure you want to delete this client? This action cannot be undone.")&&(je(E.id),p(!1))},className:"px-4 py-3 bg-red-500/20 text-red-400 border border-red-500/30 rounded-xl hover:bg-red-500/30 transition-all font-medium",children:[d.jsx(zf,{className:"w-4 h-4 inline mr-2"}),"Delete Client"]}),d.jsxs("button",{onClick:()=>{const me=E.id,ae=E.name;sessionStorage.setItem("supportMode","true"),sessionStorage.setItem("supportBusinessId",me),sessionStorage.setItem("supportBusinessName",ae),sessionStorage.setItem("supportAdminEmail",(t==null?void 0:t.email)||""),sessionStorage.setItem("supportAdminName",(t==null?void 0:t.name)||"Support Staff"),window.open(`/dashboard?business=${me}&support=true`,"_blank")},className:"px-4 py-3 bg-emerald-500/20 text-emerald-400 border border-emerald-500/30 rounded-xl hover:bg-emerald-500/30 transition-all font-medium w-full",children:[d.jsx(RT,{className:"w-4 h-4 inline mr-2"}),"Join Business for Support"]}),d.jsxs("a",{href:`/dashboard?business=${E.id}`,target:"_blank",rel:"noopener noreferrer",className:"px-4 py-3 bg-blue-500/20 text-blue-400 border border-blue-500/30 rounded-xl hover:bg-blue-500/30 transition-all font-medium text-center",children:[d.jsx(gK,{className:"w-4 h-4 inline mr-2"}),"View Dashboard"]})]})]})]})]})})]})})}const op={dashboard:{label:"Dashboard",permissions:{"dashboard.view":"View Dashboard","dashboard.analytics":"View Analytics","dashboard.reports":"View Reports"}},clients:{label:"Clients/Tenants",permissions:{"clients.view":"View Clients","clients.create":"Create Clients","clients.update":"Update Clients","clients.delete":"Delete Clients","clients.manage_subscription":"Manage Subscriptions"}},orders:{label:"Orders",permissions:{"orders.view":"View Orders","orders.create":"Create Orders","orders.update":"Update Orders","orders.delete":"Delete Orders","orders.view_scan_log":"View Scan Log"}},fulfillment:{label:"Fulfillment",permissions:{"fulfillment.view":"View Fulfillment","fulfillment.pending_orders":"Manage Pending Orders","fulfillment.ready_for_pickup":"Manage Ready for Pickup","fulfillment.shipping":"Manage Shipping","fulfillment.scan_items":"Scan Items"}},staff:{label:"Staff Management",permissions:{"staff.view":"View Staff","staff.invite":"Invite Staff","staff.update":"Update Staff","staff.delete":"Delete Staff","staff.manage_permissions":"Manage Permissions"}},roles:{label:"Roles & Access Control",permissions:{"roles.view":"View Roles","roles.create":"Create Roles","roles.update":"Update Roles","roles.delete":"Delete Roles","roles.assign":"Assign Roles"}},settings:{label:"System Settings",permissions:{"settings.view":"View Settings","settings.update":"Update Settings","settings.billing":"Manage Billing","settings.integrations":"Manage Integrations"}}},NK="https://api-erl4dkfzua-uc.a.run.app";function RK(){const{canManageUser:t,getRoles:e}=Gs(),[n,r]=q.useState([]),[s,i]=q.useState([]),[l,h]=q.useState([]),[p,y]=q.useState(!0),[_,E]=q.useState(!1),[T,k]=q.useState(null),[L,B]=q.useState(!1),[H,W]=q.useState(null),[M,U]=q.useState(!1),[$,K]=q.useState(null),[Z,A]=q.useState(null),[C,N]=q.useState(!1),[D,O]=q.useState(null),[F,R]=q.useState({}),[ie,te]=q.useState(!1),[je,We]=q.useState({name:"",email:"",role_id:"",status:"active"});q.useEffect(()=>{Ee()},[]);const Ee=async()=>{try{y(!0);const se=Ii(In(at,"users"),hc("type","==","super_admin")),Oe=(await Cn(se)).docs.map(ae=>({id:ae.id,...ae.data()}));r(Oe);const Ge=Ii(In(at,"superAdminInvites"),hc("status","==","pending")),Et=(await Cn(Ge)).docs.map(ae=>({id:ae.id,...ae.data()}));i(Et);const me=(await e()).filter(ae=>ae.tenant_id===null);h(me)}catch(se){console.error("[CompanyStaffPage] Error loading data:",se)}finally{y(!1)}},qe=async(se,De,Oe,Ge)=>{var ae;const ht=((ae=l.find(ft=>ft.id===Oe))==null?void 0:ae.name)||"Staff",st=`${window.location.origin.includes("xdigix.com")?"https://xdigix.com":"https://madas-store.web.app"}/admin/setup-password?email=${encodeURIComponent(se)}&invite=${encodeURIComponent(Ge)}&type=super_admin`,me=await fetch(`${NK}/api/send-invitation`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({toEmail:se,staffName:De,businessName:"XDIGIX Admin",role:ht,inviterName:"XDIGIX Team",businessId:"xdigix-admin",setupUrl:st})});if(!me.ok){const ft=await me.json();throw new Error(ft.message||"Failed to send invitation email")}return me.json()},et=async()=>{if(!je.name||!je.email||!je.role_id){K("Please fill in all required fields");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(je.email)){K("Please enter a valid email address");return}U(!0),K(null),A(null);try{const De=Ii(In(at,"users"),hc("email","==",je.email.toLowerCase()));if(!(await Cn(De)).empty){K("A user with this email already exists"),U(!1);return}const Ge=Ii(In(at,"superAdminInvites"),hc("email","==",je.email.toLowerCase()),hc("status","==","pending"));if(!(await Cn(Ge)).empty){K("An invitation has already been sent to this email"),U(!1);return}const Et=await Wc(In(at,"superAdminInvites"),{email:je.email.toLowerCase(),name:je.name,role_id:je.role_id,status:"pending",invitedBy:"admin",invitedAt:new Date().toISOString(),expiresAt:new Date(Date.now()+7*24*60*60*1e3).toISOString()});console.log("[CompanyStaffPage] Created invitation:",Et.id),await qe(je.email,je.name,je.role_id,Et.id),A(`Invitation sent successfully to ${je.email}`),E(!1),We({name:"",email:"",role_id:"",status:"active"}),Ee()}catch(De){console.error("[CompanyStaffPage] Error creating staff invitation:",De),K(De.message||"Failed to send invitation. Please try again.")}finally{U(!1)}},Lt=async se=>{U(!0),K(null),A(null);try{await qe(se.email,se.name,se.role_id,se.id),await ls(Bn(at,"superAdminInvites",se.id),{invitedAt:new Date().toISOString(),expiresAt:new Date(Date.now()+7*24*60*60*1e3).toISOString()}),A(`Invitation resent to ${se.email}`),Ee()}catch(De){console.error("[CompanyStaffPage] Error resending invitation:",De),K(De.message||"Failed to resend invitation")}finally{U(!1)}},Qe=async se=>{if(confirm("Are you sure you want to cancel this invitation?"))try{await vw(Bn(at,"superAdminInvites",se)),A("Invitation cancelled"),Ee()}catch(De){console.error("[CompanyStaffPage] Error cancelling invitation:",De),K("Failed to cancel invitation")}},rt=async(se,De)=>{try{await ls(Bn(at,"users",se),{...De,updated_at:new Date().toISOString()}),Ee()}catch(Oe){console.error("[CompanyStaffPage] Error updating staff:",Oe),alert("Failed to update staff member")}},pe=async se=>{if(confirm("Are you sure you want to delete this staff member? This action cannot be undone."))try{await vw(Bn(at,"users",se)),Ee()}catch(De){console.error("[CompanyStaffPage] Error deleting staff:",De),alert("Failed to delete staff member")}},ve=se=>{const De=l.find(Oe=>Oe.id===se);return(De==null?void 0:De.name)||"Unknown"},fe=se=>{O(se);const De=se.permissions||{};R(De),N(!0)},ke=se=>{R(De=>({...De,[se]:!De[se]}))},Ve=(se,De)=>{const Oe=op[se];if(!Oe)return;const Ge={};Object.keys(Oe.permissions).forEach(ht=>{Ge[ht]=De}),R(ht=>({...ht,...Ge}))},Vt=se=>{const De=op[se];return De?Object.keys(De.permissions).every(Oe=>F[Oe]):!1},qt=se=>{const De=op[se];if(!De)return!1;const Oe=Object.keys(De.permissions).filter(Ge=>F[Ge]);return Oe.length>0&&Oe.length<Object.keys(De.permissions).length},yt=async()=>{if(D){te(!0);try{await ls(Bn(at,"users",D.id),{permissions:F,updated_at:new Date().toISOString()}),A(`Permissions updated for ${D.name}`),N(!1),O(null),Ee()}catch(se){console.error("[CompanyStaffPage] Error saving permissions:",se),K("Failed to save permissions")}finally{te(!1)}}},xe={total:n.length,active:n.filter(se=>se.status==="active").length,pending:s.length,inactive:n.filter(se=>se.status!=="active").length};return d.jsx(cs,{permission:"super_admin.manage_staff",showError:!0,children:d.jsxs("div",{className:"p-6 lg:p-8",children:[d.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-8",children:[d.jsxs("div",{children:[d.jsx("h1",{className:"text-2xl font-bold text-white",children:"Company Staff"}),d.jsx("p",{className:"text-gray-400 mt-1",children:"Manage your company's internal staff and their access"})]}),d.jsxs("div",{className:"flex gap-3",children:[d.jsx(cs,{permission:"super_admin.manage_roles",children:d.jsxs("button",{onClick:()=>B(!0),className:"inline-flex items-center gap-2 px-4 py-2.5 bg-white/5 border border-white/10 text-white rounded-xl hover:bg-white/10 transition-all",children:[d.jsx(ig,{className:"w-5 h-5"}),d.jsx("span",{className:"hidden sm:inline",children:"Manage Roles"})]})}),d.jsx(cs,{permission:"super_admin.manage_staff",children:d.jsxs("button",{onClick:()=>{k(null),K(null),E(!0)},className:"inline-flex items-center gap-2 px-5 py-2.5 bg-gradient-to-r from-amber-400 to-amber-500 text-[#0a0b1a] font-semibold rounded-xl hover:from-amber-300 hover:to-amber-400 transition-all duration-300 shadow-lg shadow-amber-500/25",children:[d.jsx(lD,{className:"w-5 h-5"}),"Invite Staff"]})})]})]}),d.jsxs("div",{className:"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:[d.jsxs("div",{className:"bg-[#1a1b3e] border border-[#2d2f5a] rounded-xl p-5",children:[d.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[d.jsx("div",{className:"p-2 rounded-lg bg-blue-500/10",children:d.jsx(Yc,{className:"w-5 h-5 text-blue-400"})}),d.jsx("span",{className:"text-sm text-gray-400",children:"Total Staff"})]}),d.jsx("p",{className:"text-2xl font-bold text-white",children:xe.total})]}),d.jsxs("div",{className:"bg-[#1a1b3e] border border-[#2d2f5a] rounded-xl p-5",children:[d.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[d.jsx("div",{className:"p-2 rounded-lg bg-emerald-500/10",children:d.jsx(Ur,{className:"w-5 h-5 text-emerald-400"})}),d.jsx("span",{className:"text-sm text-gray-400",children:"Active"})]}),d.jsx("p",{className:"text-2xl font-bold text-emerald-400",children:xe.active})]}),d.jsxs("div",{className:"bg-[#1a1b3e] border border-[#2d2f5a] rounded-xl p-5",children:[d.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[d.jsx("div",{className:"p-2 rounded-lg bg-amber-500/10",children:d.jsx(Sd,{className:"w-5 h-5 text-amber-400"})}),d.jsx("span",{className:"text-sm text-gray-400",children:"Pending Invites"})]}),d.jsx("p",{className:"text-2xl font-bold text-amber-400",children:xe.pending})]}),d.jsxs("div",{className:"bg-[#1a1b3e] border border-[#2d2f5a] rounded-xl p-5",children:[d.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[d.jsx("div",{className:"p-2 rounded-lg bg-gray-500/10",children:d.jsx(Na,{className:"w-5 h-5 text-gray-400"})}),d.jsx("span",{className:"text-sm text-gray-400",children:"Inactive"})]}),d.jsx("p",{className:"text-2xl font-bold text-gray-400",children:xe.inactive})]})]}),Z&&d.jsxs("div",{className:"mb-6 p-4 bg-emerald-500/10 border border-emerald-500/20 rounded-xl flex items-center gap-3",children:[d.jsx(Ur,{className:"w-5 h-5 text-emerald-400 shrink-0"}),d.jsx("span",{className:"text-emerald-400",children:Z}),d.jsx("button",{onClick:()=>A(null),className:"ml-auto p-1 text-emerald-400 hover:text-emerald-300",children:d.jsx(Ar,{className:"w-4 h-4"})})]}),$&&d.jsxs("div",{className:"mb-6 p-4 bg-red-500/10 border border-red-500/20 rounded-xl flex items-center gap-3",children:[d.jsx(Ui,{className:"w-5 h-5 text-red-400 shrink-0"}),d.jsx("span",{className:"text-red-400",children:$}),d.jsx("button",{onClick:()=>K(null),className:"ml-auto p-1 text-red-400 hover:text-red-300",children:d.jsx(Ar,{className:"w-4 h-4"})})]}),s.length>0&&d.jsxs("div",{className:"bg-[#1a1b3e] border border-amber-500/20 rounded-xl overflow-hidden mb-6",children:[d.jsx("div",{className:"px-6 py-4 bg-amber-500/5 border-b border-amber-500/20",children:d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx(Sd,{className:"w-5 h-5 text-amber-400"}),d.jsx("h2",{className:"text-lg font-semibold text-white",children:"Pending Invitations"}),d.jsx("span",{className:"px-2 py-0.5 bg-amber-500/20 text-amber-400 text-xs font-medium rounded-full",children:s.length})]})}),d.jsx("div",{className:"overflow-x-auto",children:d.jsxs("table",{className:"w-full",children:[d.jsx("thead",{children:d.jsxs("tr",{className:"bg-white/5",children:[d.jsx("th",{className:"text-left text-xs font-medium text-gray-400 uppercase px-6 py-3",children:"Name"}),d.jsx("th",{className:"text-left text-xs font-medium text-gray-400 uppercase px-6 py-3",children:"Email"}),d.jsx("th",{className:"text-left text-xs font-medium text-gray-400 uppercase px-6 py-3",children:"Role"}),d.jsx("th",{className:"text-left text-xs font-medium text-gray-400 uppercase px-6 py-3",children:"Invited"}),d.jsx("th",{className:"text-left text-xs font-medium text-gray-400 uppercase px-6 py-3",children:"Actions"})]})}),d.jsx("tbody",{className:"divide-y divide-white/5",children:s.map(se=>{var De;return d.jsxs("tr",{className:"hover:bg-white/5 transition-colors",children:[d.jsx("td",{className:"px-6 py-4",children:d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-amber-500/20 to-amber-600/20 flex items-center justify-center",children:d.jsx("span",{className:"text-amber-400 font-semibold",children:((De=se.name)==null?void 0:De.charAt(0))||"?"})}),d.jsx("span",{className:"font-medium text-white",children:se.name})]})}),d.jsx("td",{className:"px-6 py-4 text-gray-400",children:se.email}),d.jsx("td",{className:"px-6 py-4",children:d.jsx("span",{className:"px-3 py-1 text-xs font-medium rounded-full bg-amber-500/20 text-amber-400",children:ve(se.role_id)})}),d.jsx("td",{className:"px-6 py-4 text-gray-400",children:new Date(se.invitedAt).toLocaleDateString()}),d.jsx("td",{className:"px-6 py-4",children:d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsxs("button",{onClick:()=>Lt(se),disabled:M,className:"inline-flex items-center gap-1.5 px-3 py-1.5 text-xs font-medium rounded-lg bg-amber-500/10 text-amber-400 hover:bg-amber-500/20 transition-all disabled:opacity-50",children:[M?d.jsx(Zh,{className:"w-3.5 h-3.5 animate-spin"}):d.jsx(Wd,{className:"w-3.5 h-3.5"}),"Resend"]}),d.jsx("button",{onClick:()=>Qe(se.id),className:"p-1.5 rounded-lg text-gray-400 hover:text-red-400 hover:bg-red-500/10 transition-all",children:d.jsx(zf,{className:"w-4 h-4"})})]})})]},se.id)})})]})})]}),d.jsx("div",{className:"bg-[#1a1b3e] border border-[#2d2f5a] rounded-xl overflow-hidden",children:d.jsx("div",{className:"overflow-x-auto",children:d.jsxs("table",{className:"w-full",children:[d.jsx("thead",{children:d.jsxs("tr",{className:"bg-white/5",children:[d.jsx("th",{className:"text-left text-xs font-medium text-gray-400 uppercase px-6 py-4",children:"Name"}),d.jsx("th",{className:"text-left text-xs font-medium text-gray-400 uppercase px-6 py-4",children:"Email"}),d.jsx("th",{className:"text-left text-xs font-medium text-gray-400 uppercase px-6 py-4",children:"Role"}),d.jsx("th",{className:"text-left text-xs font-medium text-gray-400 uppercase px-6 py-4",children:"Status"}),d.jsx("th",{className:"text-left text-xs font-medium text-gray-400 uppercase px-6 py-4",children:"Last Login"}),d.jsx("th",{className:"text-left text-xs font-medium text-gray-400 uppercase px-6 py-4",children:"Actions"})]})}),d.jsx("tbody",{className:"divide-y divide-white/5",children:n.length===0?d.jsx("tr",{children:d.jsx("td",{colSpan:6,className:"px-6 py-12 text-center text-gray-500",children:"No staff members found"})}):n.map(se=>{var Oe;const De=t(se);return d.jsxs("tr",{className:"hover:bg-white/5 transition-colors",children:[d.jsx("td",{className:"px-6 py-4",children:d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-purple-500/20 to-purple-600/20 flex items-center justify-center",children:d.jsx("span",{className:"text-purple-400 font-semibold",children:((Oe=se.name)==null?void 0:Oe.charAt(0))||"?"})}),d.jsx("span",{className:"font-medium text-white",children:se.name})]})}),d.jsx("td",{className:"px-6 py-4 text-gray-400",children:se.email}),d.jsx("td",{className:"px-6 py-4",children:d.jsx("span",{className:"px-3 py-1 text-xs font-medium rounded-full bg-purple-500/20 text-purple-400",children:ve(se.role_id)})}),d.jsx("td",{className:"px-6 py-4",children:d.jsxs("select",{value:se.status,onChange:Ge=>rt(se.id,{status:Ge.target.value}),className:`px-3 py-1 text-xs font-medium rounded-full border-0 cursor-pointer ${se.status==="active"?"bg-emerald-500/20 text-emerald-400":se.status==="inactive"?"bg-gray-500/20 text-gray-400":"bg-red-500/20 text-red-400"}`,children:[d.jsx("option",{value:"active",children:"Active"}),d.jsx("option",{value:"inactive",children:"Inactive"}),d.jsx("option",{value:"suspended",children:"Suspended"})]})}),d.jsx("td",{className:"px-6 py-4 text-gray-400",children:se.last_login_at?new Date(se.last_login_at).toLocaleDateString():"Never"}),d.jsx("td",{className:"px-6 py-4",children:De&&d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("button",{onClick:()=>fe(se),className:"p-2 rounded-lg text-gray-400 hover:text-purple-400 hover:bg-purple-500/10 transition-all",title:"Edit Permissions",children:d.jsx($f,{className:"w-4 h-4"})}),d.jsx("button",{onClick:()=>{k(se),E(!0)},className:"p-2 rounded-lg text-gray-400 hover:text-amber-400 hover:bg-amber-500/10 transition-all",title:"Edit Staff",children:d.jsx(Nd,{className:"w-4 h-4"})}),d.jsx("button",{onClick:()=>pe(se.id),className:"p-2 rounded-lg text-gray-400 hover:text-red-400 hover:bg-red-500/10 transition-all",title:"Delete Staff",children:d.jsx(zf,{className:"w-4 h-4"})})]})})]},se.id)})})]})})}),_&&d.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:d.jsxs("div",{className:"bg-[#1a1b3e] border border-white/10 rounded-2xl p-6 max-w-md w-full animate-fade-in",children:[d.jsxs("div",{className:"flex items-center justify-between mb-6",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[T?d.jsx(Nd,{className:"w-6 h-6 text-amber-400"}):d.jsx(TT,{className:"w-6 h-6 text-amber-400"}),d.jsx("h2",{className:"text-xl font-bold text-white",children:T?"Edit Staff Member":"Invite New Staff"})]}),d.jsx("button",{onClick:()=>{E(!1),k(null),K(null)},className:"p-2 rounded-lg text-gray-400 hover:text-white hover:bg-white/10 transition-all",children:d.jsx(Ar,{className:"w-5 h-5"})})]}),!T&&d.jsx("div",{className:"mb-6 p-4 bg-amber-500/10 border border-amber-500/20 rounded-xl",children:d.jsxs("p",{className:"text-sm text-amber-200",children:[d.jsx("strong",{children:" Invitation Email:"})," An email will be sent to the staff member with a link to set up their account and password."]})}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Full Name *"}),d.jsx("input",{type:"text",value:(T==null?void 0:T.name)||je.name,onChange:se=>T?k({...T,name:se.target.value}):We({...je,name:se.target.value}),className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:border-amber-500/50",placeholder:"John Doe",disabled:M})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Email Address *"}),d.jsx("input",{type:"email",value:(T==null?void 0:T.email)||je.email,onChange:se=>T?k({...T,email:se.target.value}):We({...je,email:se.target.value}),className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:border-amber-500/50 disabled:opacity-50",placeholder:"john@company.com",disabled:!!T||M})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Role *"}),d.jsxs("select",{value:(T==null?void 0:T.role_id)||je.role_id,onChange:se=>T?k({...T,role_id:se.target.value}):We({...je,role_id:se.target.value}),className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-gray-300 focus:outline-none focus:border-amber-500/50",disabled:M,children:[d.jsx("option",{value:"",children:"Select a role"}),l.map(se=>d.jsxs("option",{value:se.id,children:[se.name," - ",se.description]},se.id))]})]}),T&&d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Status"}),d.jsxs("select",{value:T.status,onChange:se=>k({...T,status:se.target.value}),className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-gray-300 focus:outline-none focus:border-amber-500/50",children:[d.jsx("option",{value:"active",children:"Active"}),d.jsx("option",{value:"inactive",children:"Inactive"}),d.jsx("option",{value:"suspended",children:"Suspended"})]})]}),$&&!T&&d.jsx("div",{className:"p-3 bg-red-500/10 border border-red-500/20 rounded-lg",children:d.jsxs("p",{className:"text-sm text-red-400 flex items-center gap-2",children:[d.jsx(Ui,{className:"w-4 h-4 shrink-0"}),$]})}),d.jsxs("div",{className:"flex gap-3 pt-4",children:[d.jsx("button",{onClick:()=>{E(!1),k(null),K(null)},disabled:M,className:"flex-1 px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-gray-300 hover:bg-white/10 transition-all disabled:opacity-50",children:"Cancel"}),T?d.jsx("button",{onClick:()=>{rt(T.id,{name:T.name,role_id:T.role_id,status:T.status}),E(!1),k(null)},className:"flex-1 px-4 py-3 bg-gradient-to-r from-amber-400 to-amber-500 text-[#0a0b1a] font-semibold rounded-xl hover:from-amber-300 hover:to-amber-400 transition-all",children:"Update Staff"}):d.jsx("button",{onClick:et,disabled:M,className:"flex-1 px-4 py-3 bg-gradient-to-r from-amber-400 to-amber-500 text-[#0a0b1a] font-semibold rounded-xl hover:from-amber-300 hover:to-amber-400 transition-all disabled:opacity-70 inline-flex items-center justify-center gap-2",children:M?d.jsxs(d.Fragment,{children:[d.jsx(Zh,{className:"w-4 h-4 animate-spin"}),"Sending..."]}):d.jsxs(d.Fragment,{children:[d.jsx(TT,{className:"w-4 h-4"}),"Send Invitation"]})})]})]})]})}),L&&d.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:d.jsxs("div",{className:"bg-[#1a1b3e] border border-white/10 rounded-2xl p-6 max-w-2xl w-full max-h-[80vh] overflow-y-auto animate-fade-in",children:[d.jsxs("div",{className:"flex items-center justify-between mb-6",children:[d.jsx("h2",{className:"text-xl font-bold text-white",children:"Roles & Permissions"}),d.jsx("button",{onClick:()=>{B(!1),W(null)},className:"p-2 rounded-lg text-gray-400 hover:text-white hover:bg-white/10 transition-all",children:d.jsx(Ar,{className:"w-5 h-5"})})]}),d.jsx("p",{className:"text-gray-400 mb-6",children:"Manage roles and permissions for your company staff."}),d.jsx("div",{className:"space-y-3 mb-6",children:l.map(se=>d.jsxs("div",{className:"p-4 bg-white/5 border border-white/10 rounded-xl hover:border-amber-500/30 cursor-pointer transition-all",onClick:()=>{W(se),window.location.href="/roles"},children:[d.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[d.jsx(lg,{className:"w-5 h-5 text-amber-400"}),d.jsx("span",{className:"font-medium text-white",children:se.name})]}),d.jsx("p",{className:"text-sm text-gray-400 ml-8",children:se.description})]},se.id))}),d.jsx("button",{onClick:()=>window.location.href="/roles",className:"w-full py-3 bg-gradient-to-r from-amber-400 to-amber-500 text-[#0a0b1a] font-semibold rounded-xl hover:from-amber-300 hover:to-amber-400 transition-all",children:"Go to Roles & Permissions"})]})}),C&&D&&d.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:d.jsxs("div",{className:"bg-[#1a1b3e] border border-white/10 rounded-2xl w-full max-w-3xl max-h-[90vh] overflow-hidden animate-fade-in flex flex-col",children:[d.jsx("div",{className:"p-6 border-b border-white/10 shrink-0",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"w-12 h-12 rounded-xl bg-gradient-to-br from-purple-500/20 to-purple-600/20 flex items-center justify-center",children:d.jsx($f,{className:"w-6 h-6 text-purple-400"})}),d.jsxs("div",{children:[d.jsx("h2",{className:"text-xl font-bold text-white",children:"Edit Permissions"}),d.jsxs("p",{className:"text-gray-400 text-sm",children:[D.name,"  ",D.email]})]})]}),d.jsx("button",{onClick:()=>{N(!1),O(null)},className:"p-2 rounded-lg text-gray-400 hover:text-white hover:bg-white/10 transition-all",children:d.jsx(Ar,{className:"w-5 h-5"})})]})}),d.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:Object.entries(op).map(([se,De])=>{const Oe=Vt(se),Ge=qt(se);return d.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-xl p-4",children:[d.jsxs("label",{className:"flex items-center gap-3 cursor-pointer mb-3 pb-3 border-b border-white/10",children:[d.jsx("div",{className:`w-5 h-5 rounded border-2 flex items-center justify-center transition-all cursor-pointer ${Oe?"bg-purple-500 border-purple-500":Ge?"bg-purple-500/50 border-purple-500":"border-gray-500 hover:border-purple-400"}`,onClick:()=>Ve(se,!Oe),children:(Oe||Ge)&&d.jsx(vT,{className:"w-3.5 h-3.5 text-white"})}),d.jsx("span",{className:"font-semibold text-white",children:De.label}),d.jsx("span",{className:"text-xs text-gray-500 ml-auto",children:"(Select all)"})]}),d.jsx("div",{className:"space-y-2 ml-2",children:Object.entries(De.permissions).map(([ht,Et])=>d.jsxs("label",{className:"flex items-center gap-3 cursor-pointer py-1.5 hover:bg-white/5 rounded-lg px-2 -mx-2 transition-colors",children:[d.jsx("div",{className:`w-5 h-5 rounded border-2 flex items-center justify-center transition-all ${F[ht]?"bg-purple-500 border-purple-500":"border-gray-500 hover:border-purple-400"}`,onClick:()=>ke(ht),children:F[ht]&&d.jsx(vT,{className:"w-3.5 h-3.5 text-white"})}),d.jsx("span",{className:"text-gray-300 text-sm",children:Et})]},ht))})]},se)})})}),d.jsx("div",{className:"p-6 border-t border-white/10 shrink-0",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("p",{className:"text-sm text-gray-400",children:[Object.values(F).filter(Boolean).length," permissions selected"]}),d.jsxs("div",{className:"flex gap-3",children:[d.jsx("button",{onClick:()=>{N(!1),O(null)},className:"px-5 py-2.5 bg-white/5 border border-white/10 rounded-xl text-gray-300 hover:bg-white/10 transition-all",children:"Cancel"}),d.jsx("button",{onClick:yt,disabled:ie,className:"px-5 py-2.5 bg-gradient-to-r from-purple-500 to-purple-600 text-white font-semibold rounded-xl hover:from-purple-400 hover:to-purple-500 transition-all disabled:opacity-50 inline-flex items-center gap-2",children:ie?d.jsxs(d.Fragment,{children:[d.jsx(Zh,{className:"w-4 h-4 animate-spin"}),"Saving..."]}):d.jsxs(d.Fragment,{children:[d.jsx(Ur,{className:"w-4 h-4"}),"Save Permissions"]})})]})]})})]})})]})})}function PK(){const{user:t}=Gs(),[e,n]=q.useState([]),[r,s]=q.useState(!0),[i,l]=q.useState("all"),[h,p]=q.useState("all");q.useEffect(()=>{y()},[]);const y=async()=>{try{s(!0);const B=(await Cn(In(at,"tenants"))).docs.map(H=>({id:H.id,...H.data()}));n(B)}catch(L){console.error("[SubscriptionsPage] Error loading subscriptions:",L)}finally{s(!1)}},_=async(L,B)=>{try{await ls(Bn(at,"tenants",L),{plan:B,updated_at:new Date().toISOString()}),y()}catch(H){console.error("[SubscriptionsPage] Error updating plan:",H),alert("Failed to update subscription plan")}},E=async(L,B)=>{try{await ls(Bn(at,"tenants",L),{status:B,updated_at:new Date().toISOString()}),y()}catch(H){console.error("[SubscriptionsPage] Error updating status:",H),alert("Failed to update subscription status")}},T=e.filter(L=>{const B=i==="all"||L.plan===i,H=h==="all"||L.status===h;return B&&H}),k={basic:e.filter(L=>L.plan==="basic").length,professional:e.filter(L=>L.plan==="professional").length,enterprise:e.filter(L=>L.plan==="enterprise").length};return e.filter(L=>L.status==="active").length,e.filter(L=>L.status==="trial").length,e.filter(L=>L.status==="suspended").length,e.filter(L=>L.status==="cancelled").length,d.jsx(cs,{permission:"super_admin.manage_subscriptions",showError:!0,children:d.jsxs("div",{className:"p-6",children:[d.jsxs("div",{className:"mb-6",children:[d.jsx("h1",{className:"text-2xl font-bold",children:"Subscriptions Management"}),d.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Manage tenant subscription plans and status"})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[d.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-4 border border-gray-200 dark:border-gray-700",children:[d.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Basic Plan"}),d.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:k.basic})]}),d.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-4 border border-gray-200 dark:border-gray-700",children:[d.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Professional Plan"}),d.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:k.professional})]}),d.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-4 border border-gray-200 dark:border-gray-700",children:[d.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Enterprise Plan"}),d.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:k.enterprise})]}),d.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-4 border border-gray-200 dark:border-gray-700",children:[d.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Total Tenants"}),d.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:e.length})]})]}),d.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-4 mb-6",children:d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium mb-1",children:"Plan"}),d.jsxs("select",{value:i,onChange:L=>l(L.target.value),className:"w-full px-3 py-2 border rounded-lg",children:[d.jsx("option",{value:"all",children:"All Plans"}),d.jsx("option",{value:"basic",children:"Basic"}),d.jsx("option",{value:"professional",children:"Professional"}),d.jsx("option",{value:"enterprise",children:"Enterprise"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium mb-1",children:"Status"}),d.jsxs("select",{value:h,onChange:L=>p(L.target.value),className:"w-full px-3 py-2 border rounded-lg",children:[d.jsx("option",{value:"all",children:"All Statuses"}),d.jsx("option",{value:"active",children:"Active"}),d.jsx("option",{value:"trial",children:"Trial"}),d.jsx("option",{value:"suspended",children:"Suspended"}),d.jsx("option",{value:"cancelled",children:"Cancelled"})]})]})]})}),d.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow overflow-hidden",children:d.jsxs("table",{className:"min-w-full divide-y divide-gray-200 dark:divide-gray-700",children:[d.jsx("thead",{className:"bg-gray-50 dark:bg-gray-700",children:d.jsxs("tr",{children:[d.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Tenant"}),d.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Current Plan"}),d.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Status"}),d.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Created"}),d.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 dark:text-gray-300 uppercase",children:"Actions"})]})}),d.jsx("tbody",{className:"bg-white dark:bg-gray-800 divide-y divide-gray-200 dark:divide-gray-700",children:T.length===0?d.jsx("tr",{children:d.jsx("td",{colSpan:5,className:"px-6 py-4 text-center text-gray-500",children:"No subscriptions found"})}):T.map(L=>d.jsxs("tr",{className:"hover:bg-gray-50 dark:hover:bg-gray-700",children:[d.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:d.jsx("div",{className:"text-sm font-medium text-gray-900 dark:text-gray-100",children:L.name})}),d.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:d.jsxs("select",{value:L.plan,onChange:B=>_(L.id,B.target.value),className:`text-xs rounded-full px-2 py-1 border-0 ${L.plan==="enterprise"?"bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200":L.plan==="professional"?"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200":"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200"}`,children:[d.jsx("option",{value:"basic",children:"Basic"}),d.jsx("option",{value:"professional",children:"Professional"}),d.jsx("option",{value:"enterprise",children:"Enterprise"})]})}),d.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:d.jsxs("select",{value:L.status,onChange:B=>E(L.id,B.target.value),className:`text-xs rounded-full px-2 py-1 border-0 ${L.status==="active"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":L.status==="trial"?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200":L.status==="suspended"?"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200":"bg-gray-100 text-gray-800 dark:bg-gray-700 dark:text-gray-200"}`,children:[d.jsx("option",{value:"active",children:"Active"}),d.jsx("option",{value:"trial",children:"Trial"}),d.jsx("option",{value:"suspended",children:"Suspended"}),d.jsx("option",{value:"cancelled",children:"Cancelled"})]})}),d.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500 dark:text-gray-400",children:L.created_at?new Date(L.created_at).toLocaleDateString():"N/A"}),d.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:d.jsx("a",{href:"/tenants",className:"text-primary hover:text-primary-dark",children:"View Details"})})]},L.id))})]})})]})})}function kK(){const{user:t}=Gs(),[e,n]=q.useState({totalClients:0,activeClients:0,trialClients:0,suspendedClients:0,totalUsers:0,superAdminUsers:0,tenantStaff:0,revenue:{mrr:0,arr:0,total:0},growth:{newClientsThisMonth:0,newClientsLastMonth:0,growthRate:0}}),[r,s]=q.useState(!0);q.useEffect(()=>{i()},[]);const i=async()=>{try{s(!0);const h=(await Cn(In(at,"tenants"))).docs.map(R=>({id:R.id,...R.data()})),p=h.length,y=h.filter(R=>R.status==="active").length,_=h.filter(R=>R.status==="trial").length,E=h.filter(R=>R.status==="suspended").length,k=(await Cn(In(at,"users"))).docs.map(R=>R.data()),L=k.length,B=k.filter(R=>R.type==="super_admin").length,H=k.filter(R=>R.type==="tenant_staff").length,W=new Date,M=new Date(W.getFullYear(),W.getMonth(),1),U=new Date(W.getFullYear(),W.getMonth()-1,1),$=M.getTime(),K=U.getTime(),Z=$,A=h.filter(R=>(R.created_at?new Date(R.created_at).getTime():0)>=$).length,C=h.filter(R=>{const ie=R.created_at?new Date(R.created_at).getTime():0;return ie>=K&&ie<Z}).length,N=C>0?(A-C)/C*100:0,D=0,O=D*12;n({totalClients:p,activeClients:y,trialClients:_,suspendedClients:E,totalUsers:L,superAdminUsers:B,tenantStaff:H,revenue:{mrr:D,arr:O,total:0},growth:{newClientsThisMonth:A,newClientsLastMonth:C,growthRate:N}})}catch(l){console.error("[AnalyticsPage] Error loading analytics:",l)}finally{s(!1)}};return d.jsx(cs,{permission:"super_admin.view_analytics",showError:!0,children:d.jsxs("div",{className:"p-6",children:[d.jsxs("div",{className:"mb-6",children:[d.jsx("h1",{className:"text-3xl font-bold text-gray-900 dark:text-gray-100",children:"Platform Analytics"}),d.jsx("p",{className:"text-gray-600 dark:text-gray-400 mt-1",children:"Comprehensive platform metrics and insights"})]}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[d.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 border border-gray-200 dark:border-gray-700",children:[d.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"Total Clients"}),d.jsx("div",{className:"text-3xl font-bold text-gray-900 dark:text-gray-100",children:e.totalClients})]}),d.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 border border-gray-200 dark:border-gray-700",children:[d.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"Monthly Revenue (MRR)"}),d.jsxs("div",{className:"text-3xl font-bold text-emerald-600",children:["$",e.revenue.mrr.toLocaleString()]})]}),d.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 border border-gray-200 dark:border-gray-700",children:[d.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"Total Users"}),d.jsx("div",{className:"text-3xl font-bold text-purple-600",children:e.totalUsers})]}),d.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 border border-gray-200 dark:border-gray-700",children:[d.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"Growth Rate"}),d.jsxs("div",{className:"text-3xl font-bold text-blue-600",children:[e.growth.growthRate>0?"+":"",e.growth.growthRate.toFixed(1),"%"]})]})]}),d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[d.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 border border-gray-200 dark:border-gray-700",children:[d.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Client Status Breakdown"}),d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Active"}),d.jsx("span",{className:"font-semibold text-green-600",children:e.activeClients})]}),d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Trial"}),d.jsx("span",{className:"font-semibold text-yellow-600",children:e.trialClients})]}),d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Suspended"}),d.jsx("span",{className:"font-semibold text-red-600",children:e.suspendedClients})]})]})]}),d.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 border border-gray-200 dark:border-gray-700",children:[d.jsx("h2",{className:"text-lg font-semibold mb-4",children:"User Breakdown"}),d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Super Admins"}),d.jsx("span",{className:"font-semibold text-purple-600",children:e.superAdminUsers})]}),d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Tenant Staff"}),d.jsx("span",{className:"font-semibold text-blue-600",children:e.tenantStaff})]}),d.jsxs("div",{className:"flex justify-between items-center",children:[d.jsx("span",{className:"text-gray-600 dark:text-gray-400",children:"Total Users"}),d.jsx("span",{className:"font-semibold",children:e.totalUsers})]})]})]})]}),d.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6 border border-gray-200 dark:border-gray-700",children:[d.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Growth Metrics"}),d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[d.jsxs("div",{children:[d.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"New Clients (This Month)"}),d.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:e.growth.newClientsThisMonth})]}),d.jsxs("div",{children:[d.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"New Clients (Last Month)"}),d.jsx("div",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:e.growth.newClientsLastMonth})]}),d.jsxs("div",{children:[d.jsx("div",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Growth Rate"}),d.jsxs("div",{className:`text-2xl font-bold ${e.growth.growthRate>=0?"text-green-600":"text-red-600"}`,children:[e.growth.growthRate>0?"+":"",e.growth.growthRate.toFixed(1),"%"]})]})]})]})]})})}function DK(){const{user:t,getRoles:e,getPermissions:n,getUserPermissions:r}=Gs(),[s,i]=q.useState([]),[l,h]=q.useState([]),[p,y]=q.useState(null),[_,E]=q.useState([]),[T,k]=q.useState(!0),[L,B]=q.useState(!1),[H,W]=q.useState({name:"",description:"",tenant_id:null});q.useEffect(()=>{M()},[]);const M=async()=>{try{k(!0);const[A,C]=await Promise.all([e(),n()]);i(A),h(C)}catch(A){console.error("[RolesPage] Error loading data:",A)}finally{k(!1)}},U=async A=>{y(A);const C=await r(A.id);E(C)},$=async A=>{if(!p)return;const N=_.includes(A)?_.filter(D=>D!==A):[..._,A];E(N)},K=async()=>{!H.name||!H.description||(B(!1),W({name:"",description:"",tenant_id:null}),M())},Z=l.reduce((A,C)=>(A[C.category]||(A[C.category]=[]),A[C.category].push(C),A),{});return d.jsx(cs,{permission:"super_admin.manage_roles",showError:!0,children:d.jsxs("div",{className:"p-6",children:[d.jsxs("div",{className:"flex justify-between items-center mb-6",children:[d.jsx("h1",{className:"text-2xl font-bold",children:"Roles & Permissions"}),d.jsx(cs,{permission:"super_admin.manage_roles",children:d.jsx("button",{onClick:()=>B(!0),className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark",children:"Create Role"})})]}),d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[d.jsx("div",{className:"lg:col-span-1",children:d.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-4",children:[d.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Roles"}),d.jsx("div",{className:"space-y-2",children:s.map(A=>d.jsxs("button",{onClick:()=>U(A),className:`w-full text-left p-3 rounded-lg border transition-colors ${(p==null?void 0:p.id)===A.id?"bg-primary text-white border-primary":"bg-gray-50 dark:bg-gray-700 border-gray-200 dark:border-gray-600 hover:bg-gray-100 dark:hover:bg-gray-600"}`,children:[d.jsx("div",{className:"font-medium",children:A.name}),d.jsx("div",{className:"text-sm opacity-75 mt-1",children:A.description}),A.is_system&&d.jsx("span",{className:"text-xs bg-yellow-100 text-yellow-800 px-2 py-0.5 rounded mt-1 inline-block",children:"System"})]},A.id))})]})}),p&&d.jsx("div",{className:"lg:col-span-2",children:d.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow p-6",children:[d.jsxs("div",{className:"mb-4",children:[d.jsx("h2",{className:"text-xl font-semibold",children:p.name}),d.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:p.description})]}),d.jsx(cs,{permission:"super_admin.manage_roles",children:d.jsx("div",{className:"space-y-4",children:Object.entries(Z).map(([A,C])=>d.jsxs("div",{children:[d.jsx("h3",{className:"font-medium text-gray-700 dark:text-gray-300 mb-2 capitalize",children:A.replace("_"," ")}),d.jsx("div",{className:"space-y-2",children:C.map(N=>d.jsxs("label",{className:"flex items-center space-x-2 p-2 hover:bg-gray-50 dark:hover:bg-gray-700 rounded cursor-pointer",children:[d.jsx("input",{type:"checkbox",checked:_.includes(N.key),onChange:()=>$(N.key),className:"rounded border-gray-300 text-primary focus:ring-primary"}),d.jsxs("div",{className:"flex-1",children:[d.jsx("div",{className:"text-sm font-medium",children:N.key}),d.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400",children:N.description})]})]},N.id))})]},A))})})]})})]}),L&&d.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:d.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-6 max-w-md w-full",children:[d.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Create New Role"}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium mb-1",children:"Role Name"}),d.jsx("input",{type:"text",value:H.name,onChange:A=>W({...H,name:A.target.value}),className:"w-full px-3 py-2 border rounded-lg",placeholder:"e.g., Manager, Sales"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium mb-1",children:"Description"}),d.jsx("textarea",{value:H.description,onChange:A=>W({...H,description:A.target.value}),className:"w-full px-3 py-2 border rounded-lg",rows:3,placeholder:"Describe this role's responsibilities"})]}),d.jsxs("div",{className:"flex justify-end space-x-2",children:[d.jsx("button",{onClick:()=>B(!1),className:"px-4 py-2 border rounded-lg hover:bg-gray-50",children:"Cancel"}),d.jsx("button",{onClick:K,className:"px-4 py-2 bg-primary text-white rounded-lg hover:bg-primary-dark",children:"Create"})]})]})]})})]})})}function OK(){const{user:t}=Gs(),[e,n]=q.useState(!0);return q.useEffect(()=>{n(!1)},[]),e?d.jsx("div",{className:"flex items-center justify-center min-h-[50vh]",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-amber-400"})}):d.jsx(cs,{permission:"super_admin.manage_roles",showError:!0,children:d.jsxs("div",{className:"p-6 lg:p-8",children:[d.jsx("div",{className:"mb-8",children:d.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[d.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-amber-500/20 to-amber-600/20 rounded-xl flex items-center justify-center",children:d.jsx(ig,{className:"w-6 h-6 text-amber-400"})}),d.jsxs("div",{children:[d.jsx("h1",{className:"text-2xl font-bold text-white",children:"Roles & Permissions"}),d.jsx("p",{className:"text-gray-400 mt-1",children:"Manage roles and their associated permissions"})]})]})}),d.jsx("div",{className:"bg-[#1a1b3e] border border-[#2d2f5a] rounded-2xl p-6",children:d.jsxs("div",{className:"text-center py-12",children:[d.jsx(ig,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),d.jsx("h2",{className:"text-xl font-semibold text-white mb-2",children:"Roles & Permissions"}),d.jsx("p",{className:"text-gray-400",children:"Create and manage roles with specific permission sets."})]})})]})})}const PT=[{name:"Core Features",icon:Yh,features:[{key:"pos",name:"Point of Sale",description:"Access to the POS system for sales"},{key:"inventory",name:"Inventory Management",description:"Manage product stock and variants"},{key:"orders",name:"Order Management",description:"Process and track customer orders"},{key:"customers",name:"Customer Management",description:"Manage customer profiles and history"},{key:"analytics",name:"Basic Analytics",description:"View essential business performance metrics"},{key:"reports",name:"Basic Reports",description:"Generate standard business reports"}]},{name:"Advanced Features",icon:EK,features:[{key:"advanced_analytics",name:"Advanced Analytics",description:"Detailed insights and custom dashboards"},{key:"advanced_reports",name:"Advanced Reports",description:"Custom reports and data exports"},{key:"multi_location",name:"Multi-Location",description:"Manage multiple business locations"},{key:"api_access",name:"API Access",description:"Access to API for integrations"},{key:"fulfillment",name:"Fulfillment Service",description:"Access to XDIGIX fulfillment services"}]},{name:"Team & Access",icon:Yc,features:[{key:"staff_management",name:"Staff Management",description:"Add and manage staff members"},{key:"roles_permissions",name:"Roles & Permissions",description:"Custom roles and access control"},{key:"audit_logs",name:"Audit Logs",description:"Track all system activities"}]},{name:"Finance",icon:sg,features:[{key:"finance_dashboard",name:"Finance Dashboard",description:"Access to finance management system"},{key:"invoicing",name:"Invoicing",description:"Create and manage invoices"},{key:"expenses",name:"Expense Tracking",description:"Track business expenses"},{key:"tax_reports",name:"Tax Reports",description:"Generate tax-related reports"}]}];function MK(){const[t,e]=q.useState([]),[n,r]=q.useState(null),[s,i]=q.useState([]),[l,h]=q.useState(""),[p,y]=q.useState("all"),[_,E]=q.useState(!1),[T,k]=q.useState(!0),L=q.useCallback(async()=>{k(!0);try{const K=(await Cn(In(at,"plans"))).docs.map(Z=>({id:Z.id,...Z.data()}));e(K.sort((Z,A)=>(Z.order||0)-(A.order||0)))}catch($){console.error("[PlanPermissionsPage] Error loading plans:",$)}finally{k(!1)}},[]);q.useEffect(()=>{L()},[L]),q.useEffect(()=>{i(n?n.features||[]:[])},[n]);const B=q.useMemo(()=>PT.map($=>$.name),[]),H=q.useMemo(()=>PT.flatMap(K=>K.features.map(Z=>({...Z,category:K.name}))).filter(K=>{const Z=!l||K.name.toLowerCase().includes(l.toLowerCase())||K.description.toLowerCase().includes(l.toLowerCase()),A=p==="all"||K.category===p;return Z&&A}),[l,p]),W=$=>{i(K=>K.includes($)?K.filter(Z=>Z!==$):[...K,$])},M=async()=>{if(n){E(!0);try{await ls(Bn(at,"plans",n.id),{features:s}),r($=>$?{...$,features:s}:null),e($=>$.map(K=>K.id===n.id?{...K,features:s}:K)),alert(" Plan features saved successfully!")}catch($){console.error("[PlanPermissionsPage] Error saving features:",$),alert(" Failed to save features")}finally{E(!1)}}},U=q.useMemo(()=>{if(!n)return!1;const $=n.features||[];return $.length!==s.length?!0:!$.every(K=>s.includes(K))},[n,s]);return d.jsx(cs,{permission:"super_admin.manage_subscriptions",showError:!0,children:d.jsxs("div",{className:"p-6 space-y-6",children:[d.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[d.jsxs("div",{children:[d.jsxs("h1",{className:"text-2xl font-bold text-white flex items-center gap-3",children:[d.jsx(Qh,{className:"w-7 h-7 text-amber-400"}),"Plan Features Management"]}),d.jsx("p",{className:"text-gray-400 mt-1",children:"Configure which features are available for each subscription plan"})]}),n&&U&&d.jsxs("button",{onClick:M,disabled:_,className:"flex items-center gap-2 px-4 py-2.5 bg-gradient-to-r from-amber-400 to-amber-500 text-[#0a0b1a] font-semibold rounded-xl hover:from-amber-300 hover:to-amber-400 transition-all disabled:opacity-50",children:[d.jsx(og,{className:"w-5 h-5"}),_?"Saving...":"Save Changes"]})]}),d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[d.jsxs("div",{className:"bg-[#1a1b3e]/80 backdrop-blur-xl border border-white/10 rounded-2xl p-5",children:[d.jsxs("h2",{className:"text-lg font-semibold text-white mb-4 flex items-center gap-2",children:[d.jsx(bi,{className:"w-5 h-5 text-amber-400"}),"Subscription Plans"]}),T?d.jsx("div",{className:"flex items-center justify-center py-8",children:d.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-amber-400"})}):d.jsx("div",{className:"space-y-2",children:t.length===0?d.jsx("p",{className:"text-gray-500 text-sm py-4 text-center",children:"No plans found"}):t.map($=>d.jsx("div",{onClick:()=>r($),className:`p-4 rounded-xl cursor-pointer transition-all border ${(n==null?void 0:n.id)===$.id?"bg-amber-500/20 border-amber-500/30":"bg-white/5 border-transparent hover:bg-white/10 hover:border-white/10"}`,children:d.jsx("div",{className:"flex items-center justify-between",children:d.jsxs("div",{children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("h3",{className:"font-medium text-white",children:$.displayName||$.name}),$.isPopular&&d.jsx("span",{className:"px-2 py-0.5 bg-amber-500/20 text-amber-400 text-xs rounded-full",children:"Popular"})]}),d.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[($.features||[]).length," features enabled"]})]})})},$.id))})]}),d.jsx("div",{className:"lg:col-span-2 bg-[#1a1b3e]/80 backdrop-blur-xl border border-white/10 rounded-2xl p-5",children:n?d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"flex flex-col gap-4 mb-6",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("h2",{className:"text-lg font-semibold text-white",children:['Features for "',n.displayName||n.name,'"']}),d.jsxs("span",{className:"text-xs text-gray-500",children:[s.length," features enabled"]})]}),d.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[d.jsxs("div",{className:"relative flex-1",children:[d.jsx(Kl,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-500"}),d.jsx("input",{type:"text",value:l,onChange:$=>h($.target.value),placeholder:"Search features...",className:"w-full pl-10 pr-4 py-2.5 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-amber-500/50"})]}),d.jsxs("select",{value:p,onChange:$=>y($.target.value),className:"px-4 py-2.5 bg-white/5 border border-white/10 rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-amber-500/50",children:[d.jsx("option",{value:"all",children:"All Categories"}),B.map($=>d.jsx("option",{value:$,children:$},$))]})]})]}),d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 max-h-[500px] overflow-y-auto pr-2",children:H.map($=>{const K=s.includes($.key);return d.jsxs("label",{className:`flex items-start gap-3 p-3 rounded-xl transition-all cursor-pointer border ${K?"bg-amber-500/10 border-amber-500/30 hover:bg-amber-500/20":"bg-white/5 border-transparent hover:bg-white/10 hover:border-white/10"}`,children:[d.jsx("div",{className:"flex items-center pt-0.5",children:d.jsx("input",{type:"checkbox",checked:K,onChange:()=>W($.key),className:"w-5 h-5 rounded border-white/20 bg-white/5 text-amber-500 focus:ring-amber-500 focus:ring-offset-0"})}),d.jsxs("div",{className:"flex-1",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("span",{className:"text-sm font-medium text-white",children:$.name}),K&&d.jsx(Ur,{className:"w-4 h-4 text-emerald-400"})]}),d.jsx("p",{className:"text-xs text-gray-500 mt-1",children:$.description}),d.jsx("span",{className:"text-xs text-gray-600 mt-1",children:$.category})]})]},$.key)})})]}):d.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-gray-500",children:[d.jsx(bi,{className:"w-12 h-12 mb-4 text-gray-600"}),d.jsx("p",{children:"Select a plan to manage its features"})]})})]})]})})}function LK(){const[t,e]=q.useState([]),[n,r]=q.useState([]),[s,i]=q.useState(null),[l,h]=q.useState([]),[p,y]=q.useState(""),[_,E]=q.useState("all"),[T,k]=q.useState(!1),[L,B]=q.useState(!1),[H,W]=q.useState(!1),[M,U]=q.useState({name:"",description:"",tenant_id:"template",is_system:!1}),$=q.useCallback(async()=>{try{const te=(await vc.getAll()).filter(je=>je.tenant_id==="template");e(te)}catch(ie){console.error("[ClientStaffPermissionsPage] Error loading roles:",ie)}},[]),K=q.useCallback(async()=>{try{const te=(await F2.getAll()).filter(je=>je.category==="tenant"||je.category==="client"||je.category==="staff");r(te)}catch(ie){console.error("[ClientStaffPermissionsPage] Error loading permissions:",ie)}},[]),Z=q.useCallback(async ie=>{try{const te=await Rl.getByRole(ie);h(te.map(je=>je.permission_id))}catch(te){console.error("[ClientStaffPermissionsPage] Error loading role permissions:",te)}},[]);q.useEffect(()=>{$(),K()},[$,K]),q.useEffect(()=>{s?Z(s.id):h([])},[s,Z]);const A=q.useMemo(()=>{const ie=new Set;return n.forEach(te=>{te.category&&ie.add(te.category)}),Array.from(ie)},[n]),C=q.useMemo(()=>n.filter(ie=>{const te=!p||ie.key.toLowerCase().includes(p.toLowerCase())||ie.description&&ie.description.toLowerCase().includes(p.toLowerCase()),je=_==="all"||ie.category===_;return te&&je}),[n,p,_]),N=async ie=>{if(!s)return;const te=l.includes(ie);try{te?(await Rl.removePermission(s.id,ie),h(je=>je.filter(We=>We!==ie))):(await Rl.addPermission(s.id,ie),h(je=>[...je,ie]))}catch(je){console.error("[ClientStaffPermissionsPage] Error toggling permission:",je)}},D=async()=>{if(M.name.trim()){W(!0);try{await vc.create({name:M.name,description:M.description,tenant_id:"template",is_system:!1}),await $(),k(!1),U({name:"",description:"",tenant_id:"template",is_system:!1})}catch(ie){console.error("[ClientStaffPermissionsPage] Error creating role:",ie)}finally{W(!1)}}},O=async()=>{if(!(!s||!M.name.trim())){W(!0);try{await vc.update(s.id,{name:M.name,description:M.description}),await $(),B(!1),i(ie=>ie?{...ie,name:M.name,description:M.description}:null)}catch(ie){console.error("[ClientStaffPermissionsPage] Error updating role:",ie)}finally{W(!1)}}},F=async ie=>{if(confirm("Are you sure you want to delete this role template?"))try{await vc.delete(ie),await $(),(s==null?void 0:s.id)===ie&&i(null)}catch(te){console.error("[ClientStaffPermissionsPage] Error deleting role:",te)}},R=ie=>{U({name:ie.name,description:ie.description||"",tenant_id:"template",is_system:ie.is_system}),B(!0)};return d.jsx(cs,{permission:"super_admin.manage_roles",showError:!0,children:d.jsxs("div",{className:"p-6 space-y-6",children:[d.jsxs("div",{className:"flex flex-col gap-4 md:flex-row md:items-center md:justify-between",children:[d.jsxs("div",{children:[d.jsxs("h1",{className:"text-2xl font-bold text-white flex items-center gap-3",children:[d.jsx(Yc,{className:"w-7 h-7 text-amber-400"}),"Client Staff Role Templates"]}),d.jsx("p",{className:"text-gray-400 mt-1",children:"Create role templates that clients can assign to their staff members"})]}),d.jsxs("button",{onClick:()=>{U({name:"",description:"",tenant_id:"template",is_system:!1}),k(!0)},className:"flex items-center gap-2 px-4 py-2.5 bg-gradient-to-r from-amber-400 to-amber-500 text-[#0a0b1a] font-semibold rounded-xl hover:from-amber-300 hover:to-amber-400 transition-all",children:[d.jsx(V2,{className:"w-5 h-5"}),"Create Role Template"]})]}),d.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[d.jsxs("div",{className:"bg-[#1a1b3e]/80 backdrop-blur-xl border border-white/10 rounded-2xl p-5",children:[d.jsxs("h2",{className:"text-lg font-semibold text-white mb-4 flex items-center gap-2",children:[d.jsx(zi,{className:"w-5 h-5 text-amber-400"}),"Role Templates"]}),d.jsx("div",{className:"space-y-2",children:t.length===0?d.jsx("p",{className:"text-gray-500 text-sm py-4 text-center",children:"No role templates found"}):t.map(ie=>d.jsx("div",{onClick:()=>i(ie),className:`p-4 rounded-xl cursor-pointer transition-all border ${(s==null?void 0:s.id)===ie.id?"bg-amber-500/20 border-amber-500/30":"bg-white/5 border-transparent hover:bg-white/10 hover:border-white/10"}`,children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("h3",{className:"font-medium text-white",children:ie.name}),d.jsx("p",{className:"text-xs text-gray-500 mt-1",children:ie.description||"No description"})]}),d.jsx("div",{className:"flex items-center gap-1",children:!ie.is_system&&d.jsxs(d.Fragment,{children:[d.jsx("button",{onClick:te=>{te.stopPropagation(),i(ie),R(ie)},className:"p-1.5 text-gray-400 hover:text-amber-400 hover:bg-amber-500/10 rounded-lg transition-colors",children:d.jsx(Nd,{className:"w-4 h-4"})}),d.jsx("button",{onClick:te=>{te.stopPropagation(),F(ie.id)},className:"p-1.5 text-gray-400 hover:text-red-400 hover:bg-red-500/10 rounded-lg transition-colors",children:d.jsx(zf,{className:"w-4 h-4"})})]})})]})},ie.id))})]}),d.jsx("div",{className:"lg:col-span-2 bg-[#1a1b3e]/80 backdrop-blur-xl border border-white/10 rounded-2xl p-5",children:s?d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"flex flex-col gap-4 mb-6",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("h2",{className:"text-lg font-semibold text-white",children:['Permissions for "',s.name,'"']}),d.jsxs("span",{className:"text-xs text-gray-500",children:[l.length," permissions enabled"]})]}),d.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[d.jsxs("div",{className:"relative flex-1",children:[d.jsx(Kl,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-500"}),d.jsx("input",{type:"text",value:p,onChange:ie=>y(ie.target.value),placeholder:"Search permissions...",className:"w-full pl-10 pr-4 py-2.5 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-amber-500/50"})]}),d.jsxs("select",{value:_,onChange:ie=>E(ie.target.value),className:"px-4 py-2.5 bg-white/5 border border-white/10 rounded-xl text-white focus:outline-none focus:ring-2 focus:ring-amber-500/50",children:[d.jsx("option",{value:"all",children:"All Categories"}),A.map(ie=>d.jsx("option",{value:ie,children:ie},ie))]})]})]}),d.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 max-h-[500px] overflow-y-auto pr-2",children:C.map(ie=>{const te=l.includes(ie.id);return d.jsxs("label",{className:`flex items-start gap-3 p-3 rounded-xl transition-all cursor-pointer border ${te?"bg-amber-500/10 border-amber-500/30 hover:bg-amber-500/20":"bg-white/5 border-transparent hover:bg-white/10 hover:border-white/10"}`,children:[d.jsx("div",{className:"flex items-center pt-0.5",children:d.jsx("input",{type:"checkbox",checked:te,onChange:()=>N(ie.id),className:"w-5 h-5 rounded border-white/20 bg-white/5 text-amber-500 focus:ring-amber-500 focus:ring-offset-0"})}),d.jsxs("div",{className:"flex-1",children:[d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("span",{className:"text-sm font-medium text-white",children:ie.key}),te&&d.jsx(Ur,{className:"w-4 h-4 text-emerald-400"})]}),d.jsx("p",{className:"text-xs text-gray-500 mt-1",children:ie.description})]})]},ie.id)})})]}):d.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-gray-500",children:[d.jsx(Ui,{className:"w-12 h-12 mb-4 text-gray-600"}),d.jsx("p",{children:"Select a role template to manage its permissions"})]})})]}),T&&d.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 p-4",children:d.jsxs("div",{className:"bg-[#1a1b3e] border border-white/10 rounded-2xl p-6 w-full max-w-md",children:[d.jsxs("div",{className:"flex items-center justify-between mb-6",children:[d.jsx("h2",{className:"text-xl font-semibold text-white",children:"Create Role Template"}),d.jsx("button",{onClick:()=>k(!1),className:"p-2 text-gray-400 hover:text-white hover:bg-white/10 rounded-lg transition-colors",children:d.jsx(Ar,{className:"w-5 h-5"})})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Role Name"}),d.jsx("input",{type:"text",value:M.name,onChange:ie=>U(te=>({...te,name:ie.target.value})),placeholder:"e.g., Sales Manager",className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-amber-500/50"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Description"}),d.jsx("textarea",{value:M.description,onChange:ie=>U(te=>({...te,description:ie.target.value})),placeholder:"Describe what this role can do...",rows:3,className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-amber-500/50 resize-none"})]})]}),d.jsxs("div",{className:"flex items-center gap-3 mt-6",children:[d.jsx("button",{onClick:()=>k(!1),className:"flex-1 px-4 py-2.5 bg-white/5 border border-white/10 rounded-xl text-gray-300 hover:bg-white/10 transition-colors",children:"Cancel"}),d.jsxs("button",{onClick:D,disabled:H||!M.name.trim(),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2.5 bg-gradient-to-r from-amber-400 to-amber-500 text-[#0a0b1a] font-semibold rounded-xl hover:from-amber-300 hover:to-amber-400 transition-all disabled:opacity-50",children:[d.jsx(og,{className:"w-4 h-4"}),H?"Creating...":"Create Template"]})]})]})}),L&&s&&d.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/60 p-4",children:d.jsxs("div",{className:"bg-[#1a1b3e] border border-white/10 rounded-2xl p-6 w-full max-w-md",children:[d.jsxs("div",{className:"flex items-center justify-between mb-6",children:[d.jsx("h2",{className:"text-xl font-semibold text-white",children:"Edit Role Template"}),d.jsx("button",{onClick:()=>B(!1),className:"p-2 text-gray-400 hover:text-white hover:bg-white/10 rounded-lg transition-colors",children:d.jsx(Ar,{className:"w-5 h-5"})})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Role Name"}),d.jsx("input",{type:"text",value:M.name,onChange:ie=>U(te=>({...te,name:ie.target.value})),placeholder:"e.g., Sales Manager",className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-amber-500/50"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-400 mb-2",children:"Description"}),d.jsx("textarea",{value:M.description,onChange:ie=>U(te=>({...te,description:ie.target.value})),placeholder:"Describe what this role can do...",rows:3,className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-amber-500/50 resize-none"})]})]}),d.jsxs("div",{className:"flex items-center gap-3 mt-6",children:[d.jsx("button",{onClick:()=>B(!1),className:"flex-1 px-4 py-2.5 bg-white/5 border border-white/10 rounded-xl text-gray-300 hover:bg-white/10 transition-colors",children:"Cancel"}),d.jsxs("button",{onClick:O,disabled:H||!M.name.trim(),className:"flex-1 flex items-center justify-center gap-2 px-4 py-2.5 bg-gradient-to-r from-amber-400 to-amber-500 text-[#0a0b1a] font-semibold rounded-xl hover:from-amber-300 hover:to-amber-400 transition-all disabled:opacity-50",children:[d.jsx(og,{className:"w-4 h-4"}),H?"Saving...":"Save Changes"]})]})]})})]})})}var pt;(function(t){t[t.QR_CODE=0]="QR_CODE",t[t.AZTEC=1]="AZTEC",t[t.CODABAR=2]="CODABAR",t[t.CODE_39=3]="CODE_39",t[t.CODE_93=4]="CODE_93",t[t.CODE_128=5]="CODE_128",t[t.DATA_MATRIX=6]="DATA_MATRIX",t[t.MAXICODE=7]="MAXICODE",t[t.ITF=8]="ITF",t[t.EAN_13=9]="EAN_13",t[t.EAN_8=10]="EAN_8",t[t.PDF_417=11]="PDF_417",t[t.RSS_14=12]="RSS_14",t[t.RSS_EXPANDED=13]="RSS_EXPANDED",t[t.UPC_A=14]="UPC_A",t[t.UPC_E=15]="UPC_E",t[t.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(pt||(pt={}));var kT=new Map([[pt.QR_CODE,"QR_CODE"],[pt.AZTEC,"AZTEC"],[pt.CODABAR,"CODABAR"],[pt.CODE_39,"CODE_39"],[pt.CODE_93,"CODE_93"],[pt.CODE_128,"CODE_128"],[pt.DATA_MATRIX,"DATA_MATRIX"],[pt.MAXICODE,"MAXICODE"],[pt.ITF,"ITF"],[pt.EAN_13,"EAN_13"],[pt.EAN_8,"EAN_8"],[pt.PDF_417,"PDF_417"],[pt.RSS_14,"RSS_14"],[pt.RSS_EXPANDED,"RSS_EXPANDED"],[pt.UPC_A,"UPC_A"],[pt.UPC_E,"UPC_E"],[pt.UPC_EAN_EXTENSION,"UPC_EAN_EXTENSION"]]),DT;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.URL=1]="URL"})(DT||(DT={}));function jK(t){return Object.values(pt).includes(t)}var cg;(function(t){t[t.SCAN_TYPE_CAMERA=0]="SCAN_TYPE_CAMERA",t[t.SCAN_TYPE_FILE=1]="SCAN_TYPE_FILE"})(cg||(cg={}));var FK=function(){function t(){}return t.GITHUB_PROJECT_URL="https://github.com/mebjas/html5-qrcode",t.SCAN_DEFAULT_FPS=2,t.DEFAULT_DISABLE_FLIP=!1,t.DEFAULT_REMEMBER_LAST_CAMERA_USED=!0,t.DEFAULT_SUPPORTED_SCAN_TYPE=[cg.SCAN_TYPE_CAMERA,cg.SCAN_TYPE_FILE],t}(),uD=function(){function t(e,n){this.format=e,this.formatName=n}return t.prototype.toString=function(){return this.formatName},t.create=function(e){if(!kT.has(e))throw"".concat(e," not in html5QrcodeSupportedFormatsTextMap");return new t(e,kT.get(e))},t}(),OT=function(){function t(){}return t.createFromText=function(e){var n={text:e};return{decodedText:e,result:n}},t.createFromQrcodeResult=function(e){return{decodedText:e.text,result:e}},t}(),Xw;(function(t){t[t.UNKWOWN_ERROR=0]="UNKWOWN_ERROR",t[t.IMPLEMENTATION_ERROR=1]="IMPLEMENTATION_ERROR",t[t.NO_CODE_FOUND_ERROR=2]="NO_CODE_FOUND_ERROR"})(Xw||(Xw={}));var VK=function(){function t(){}return t.createFrom=function(e){return{errorMessage:e,type:Xw.UNKWOWN_ERROR}},t}(),BK=function(){function t(e){this.verbose=e}return t.prototype.log=function(e){this.verbose&&console.log(e)},t.prototype.warn=function(e){this.verbose&&console.warn(e)},t.prototype.logError=function(e,n){(this.verbose||n===!0)&&console.error(e)},t.prototype.logErrors=function(e){if(e.length===0)throw"Logger#logError called without arguments";this.verbose&&console.error(e)},t}();function no(t){return typeof t>"u"||t===null}var Uu=function(){function t(){}return t.codeParseError=function(e){return"QR code parse error, error = ".concat(e)},t.errorGettingUserMedia=function(e){return"Error getting userMedia, error = ".concat(e)},t.onlyDeviceSupportedError=function(){return"The device doesn't support navigator.mediaDevices , only supported cameraIdOrConfig in this case is deviceId parameter (string)."},t.cameraStreamingNotSupported=function(){return"Camera streaming not supported by the browser."},t.unableToQuerySupportedDevices=function(){return"Unable to query supported devices, unknown error."},t.insecureContextCameraQueryError=function(){return"Camera access is only supported in secure context like https or localhost."},t.scannerPaused=function(){return"Scanner paused"},t}(),dD=function(){function t(){}return t.isMediaStreamConstraintsValid=function(e,n){if(typeof e!="object"){var r=typeof e;return n.logError("videoConstraints should be of type object, the "+"object passed is of type ".concat(r,"."),!0),!1}for(var s=["autoGainControl","channelCount","echoCancellation","latency","noiseSuppression","sampleRate","sampleSize","volume"],i=new Set(s),l=Object.keys(e),h=0,p=l;h<p.length;h++){var y=p[h];if(i.has(y))return n.logError("".concat(y," is not supported videoConstaints."),!0),!1}return!0},t}(),Qw={exports:{}};(function(t,e){(function(n,r){r(e)})(Qd,function(n){function r(j){return j==null}var s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(j,a){j.__proto__=a}||function(j,a){for(var o in a)a.hasOwnProperty(o)&&(j[o]=a[o])};function i(j,a){s(j,a);function o(){this.constructor=j}j.prototype=a===null?Object.create(a):(o.prototype=a.prototype,new o)}function l(j,a){var o=Object.setPrototypeOf;o?o(j,a):j.__proto__=a}function h(j,a){a===void 0&&(a=j.constructor);var o=Error.captureStackTrace;o&&o(j,a)}var p=function(j){i(a,j);function a(o){var u=this.constructor,f=j.call(this,o)||this;return Object.defineProperty(f,"name",{value:u.name,enumerable:!1}),l(f,u.prototype),h(f),f}return a}(Error);class y extends p{constructor(a=void 0){super(a),this.message=a}getKind(){return this.constructor.kind}}y.kind="Exception";class _ extends y{}_.kind="ArgumentException";class E extends y{}E.kind="IllegalArgumentException";class T{constructor(a){if(this.binarizer=a,a===null)throw new E("Binarizer must be non-null.")}getWidth(){return this.binarizer.getWidth()}getHeight(){return this.binarizer.getHeight()}getBlackRow(a,o){return this.binarizer.getBlackRow(a,o)}getBlackMatrix(){return(this.matrix===null||this.matrix===void 0)&&(this.matrix=this.binarizer.getBlackMatrix()),this.matrix}isCropSupported(){return this.binarizer.getLuminanceSource().isCropSupported()}crop(a,o,u,f){const m=this.binarizer.getLuminanceSource().crop(a,o,u,f);return new T(this.binarizer.createBinarizer(m))}isRotateSupported(){return this.binarizer.getLuminanceSource().isRotateSupported()}rotateCounterClockwise(){const a=this.binarizer.getLuminanceSource().rotateCounterClockwise();return new T(this.binarizer.createBinarizer(a))}rotateCounterClockwise45(){const a=this.binarizer.getLuminanceSource().rotateCounterClockwise45();return new T(this.binarizer.createBinarizer(a))}toString(){try{return this.getBlackMatrix().toString()}catch{return""}}}class k extends y{static getChecksumInstance(){return new k}}k.kind="ChecksumException";class L{constructor(a){this.source=a}getLuminanceSource(){return this.source}getWidth(){return this.source.getWidth()}getHeight(){return this.source.getHeight()}}class B{static arraycopy(a,o,u,f,m){for(;m--;)u[f++]=a[o++]}static currentTimeMillis(){return Date.now()}}class H extends y{}H.kind="IndexOutOfBoundsException";class W extends H{constructor(a=void 0,o=void 0){super(o),this.index=a,this.message=o}}W.kind="ArrayIndexOutOfBoundsException";class M{static fill(a,o){for(let u=0,f=a.length;u<f;u++)a[u]=o}static fillWithin(a,o,u,f){M.rangeCheck(a.length,o,u);for(let m=o;m<u;m++)a[m]=f}static rangeCheck(a,o,u){if(o>u)throw new E("fromIndex("+o+") > toIndex("+u+")");if(o<0)throw new W(o);if(u>a)throw new W(u)}static asList(...a){return a}static create(a,o,u){return Array.from({length:a}).map(m=>Array.from({length:o}).fill(u))}static createInt32Array(a,o,u){return Array.from({length:a}).map(m=>Int32Array.from({length:o}).fill(u))}static equals(a,o){if(!a||!o||!a.length||!o.length||a.length!==o.length)return!1;for(let u=0,f=a.length;u<f;u++)if(a[u]!==o[u])return!1;return!0}static hashCode(a){if(a===null)return 0;let o=1;for(const u of a)o=31*o+u;return o}static fillUint8Array(a,o){for(let u=0;u!==a.length;u++)a[u]=o}static copyOf(a,o){return a.slice(0,o)}static copyOfUint8Array(a,o){if(a.length<=o){const u=new Uint8Array(o);return u.set(a),u}return a.slice(0,o)}static copyOfRange(a,o,u){const f=u-o,m=new Int32Array(f);return B.arraycopy(a,o,m,0,f),m}static binarySearch(a,o,u){u===void 0&&(u=M.numberComparator);let f=0,m=a.length-1;for(;f<=m;){const g=m+f>>1,w=u(o,a[g]);if(w>0)f=g+1;else if(w<0)m=g-1;else return g}return-f-1}static numberComparator(a,o){return a-o}}class U{static numberOfTrailingZeros(a){let o;if(a===0)return 32;let u=31;return o=a<<16,o!==0&&(u-=16,a=o),o=a<<8,o!==0&&(u-=8,a=o),o=a<<4,o!==0&&(u-=4,a=o),o=a<<2,o!==0&&(u-=2,a=o),u-(a<<1>>>31)}static numberOfLeadingZeros(a){if(a===0)return 32;let o=1;return a>>>16||(o+=16,a<<=16),a>>>24||(o+=8,a<<=8),a>>>28||(o+=4,a<<=4),a>>>30||(o+=2,a<<=2),o-=a>>>31,o}static toHexString(a){return a.toString(16)}static toBinaryString(a){return String(parseInt(String(a),2))}static bitCount(a){return a=a-(a>>>1&1431655765),a=(a&858993459)+(a>>>2&858993459),a=a+(a>>>4)&252645135,a=a+(a>>>8),a=a+(a>>>16),a&63}static truncDivision(a,o){return Math.trunc(a/o)}static parseInt(a,o=void 0){return parseInt(a,o)}}U.MIN_VALUE_32_BITS=-2147483648,U.MAX_VALUE=Number.MAX_SAFE_INTEGER;class ${constructor(a,o){a===void 0?(this.size=0,this.bits=new Int32Array(1)):(this.size=a,o==null?this.bits=$.makeArray(a):this.bits=o)}getSize(){return this.size}getSizeInBytes(){return Math.floor((this.size+7)/8)}ensureCapacity(a){if(a>this.bits.length*32){const o=$.makeArray(a);B.arraycopy(this.bits,0,o,0,this.bits.length),this.bits=o}}get(a){return(this.bits[Math.floor(a/32)]&1<<(a&31))!==0}set(a){this.bits[Math.floor(a/32)]|=1<<(a&31)}flip(a){this.bits[Math.floor(a/32)]^=1<<(a&31)}getNextSet(a){const o=this.size;if(a>=o)return o;const u=this.bits;let f=Math.floor(a/32),m=u[f];m&=~((1<<(a&31))-1);const g=u.length;for(;m===0;){if(++f===g)return o;m=u[f]}const w=f*32+U.numberOfTrailingZeros(m);return w>o?o:w}getNextUnset(a){const o=this.size;if(a>=o)return o;const u=this.bits;let f=Math.floor(a/32),m=~u[f];m&=~((1<<(a&31))-1);const g=u.length;for(;m===0;){if(++f===g)return o;m=~u[f]}const w=f*32+U.numberOfTrailingZeros(m);return w>o?o:w}setBulk(a,o){this.bits[Math.floor(a/32)]=o}setRange(a,o){if(o<a||a<0||o>this.size)throw new E;if(o===a)return;o--;const u=Math.floor(a/32),f=Math.floor(o/32),m=this.bits;for(let g=u;g<=f;g++){const w=g>u?0:a&31,I=(2<<(g<f?31:o&31))-(1<<w);m[g]|=I}}clear(){const a=this.bits.length,o=this.bits;for(let u=0;u<a;u++)o[u]=0}isRange(a,o,u){if(o<a||a<0||o>this.size)throw new E;if(o===a)return!0;o--;const f=Math.floor(a/32),m=Math.floor(o/32),g=this.bits;for(let w=f;w<=m;w++){const b=w>f?0:a&31,P=(2<<(w<m?31:o&31))-(1<<b)&4294967295;if((g[w]&P)!==(u?P:0))return!1}return!0}appendBit(a){this.ensureCapacity(this.size+1),a&&(this.bits[Math.floor(this.size/32)]|=1<<(this.size&31)),this.size++}appendBits(a,o){if(o<0||o>32)throw new E("Num bits must be between 0 and 32");this.ensureCapacity(this.size+o);for(let u=o;u>0;u--)this.appendBit((a>>u-1&1)===1)}appendBitArray(a){const o=a.size;this.ensureCapacity(this.size+o);for(let u=0;u<o;u++)this.appendBit(a.get(u))}xor(a){if(this.size!==a.size)throw new E("Sizes don't match");const o=this.bits;for(let u=0,f=o.length;u<f;u++)o[u]^=a.bits[u]}toBytes(a,o,u,f){for(let m=0;m<f;m++){let g=0;for(let w=0;w<8;w++)this.get(a)&&(g|=1<<7-w),a++;o[u+m]=g}}getBitArray(){return this.bits}reverse(){const a=new Int32Array(this.bits.length),o=Math.floor((this.size-1)/32),u=o+1,f=this.bits;for(let m=0;m<u;m++){let g=f[m];g=g>>1&1431655765|(g&1431655765)<<1,g=g>>2&858993459|(g&858993459)<<2,g=g>>4&252645135|(g&252645135)<<4,g=g>>8&16711935|(g&16711935)<<8,g=g>>16&65535|(g&65535)<<16,a[o-m]=g}if(this.size!==u*32){const m=u*32-this.size;let g=a[0]>>>m;for(let w=1;w<u;w++){const b=a[w];g|=b<<32-m,a[w-1]=g,g=b>>>m}a[u-1]=g}this.bits=a}static makeArray(a){return new Int32Array(Math.floor((a+31)/32))}equals(a){if(!(a instanceof $))return!1;const o=a;return this.size===o.size&&M.equals(this.bits,o.bits)}hashCode(){return 31*this.size+M.hashCode(this.bits)}toString(){let a="";for(let o=0,u=this.size;o<u;o++)o&7||(a+=" "),a+=this.get(o)?"X":".";return a}clone(){return new $(this.size,this.bits.slice())}}var K;(function(j){j[j.OTHER=0]="OTHER",j[j.PURE_BARCODE=1]="PURE_BARCODE",j[j.POSSIBLE_FORMATS=2]="POSSIBLE_FORMATS",j[j.TRY_HARDER=3]="TRY_HARDER",j[j.CHARACTER_SET=4]="CHARACTER_SET",j[j.ALLOWED_LENGTHS=5]="ALLOWED_LENGTHS",j[j.ASSUME_CODE_39_CHECK_DIGIT=6]="ASSUME_CODE_39_CHECK_DIGIT",j[j.ASSUME_GS1=7]="ASSUME_GS1",j[j.RETURN_CODABAR_START_END=8]="RETURN_CODABAR_START_END",j[j.NEED_RESULT_POINT_CALLBACK=9]="NEED_RESULT_POINT_CALLBACK",j[j.ALLOWED_EAN_EXTENSIONS=10]="ALLOWED_EAN_EXTENSIONS"})(K||(K={}));var Z=K;class A extends y{static getFormatInstance(){return new A}}A.kind="FormatException";var C;(function(j){j[j.Cp437=0]="Cp437",j[j.ISO8859_1=1]="ISO8859_1",j[j.ISO8859_2=2]="ISO8859_2",j[j.ISO8859_3=3]="ISO8859_3",j[j.ISO8859_4=4]="ISO8859_4",j[j.ISO8859_5=5]="ISO8859_5",j[j.ISO8859_6=6]="ISO8859_6",j[j.ISO8859_7=7]="ISO8859_7",j[j.ISO8859_8=8]="ISO8859_8",j[j.ISO8859_9=9]="ISO8859_9",j[j.ISO8859_10=10]="ISO8859_10",j[j.ISO8859_11=11]="ISO8859_11",j[j.ISO8859_13=12]="ISO8859_13",j[j.ISO8859_14=13]="ISO8859_14",j[j.ISO8859_15=14]="ISO8859_15",j[j.ISO8859_16=15]="ISO8859_16",j[j.SJIS=16]="SJIS",j[j.Cp1250=17]="Cp1250",j[j.Cp1251=18]="Cp1251",j[j.Cp1252=19]="Cp1252",j[j.Cp1256=20]="Cp1256",j[j.UnicodeBigUnmarked=21]="UnicodeBigUnmarked",j[j.UTF8=22]="UTF8",j[j.ASCII=23]="ASCII",j[j.Big5=24]="Big5",j[j.GB18030=25]="GB18030",j[j.EUC_KR=26]="EUC_KR"})(C||(C={}));class N{constructor(a,o,u,...f){this.valueIdentifier=a,this.name=u,typeof o=="number"?this.values=Int32Array.from([o]):this.values=o,this.otherEncodingNames=f,N.VALUE_IDENTIFIER_TO_ECI.set(a,this),N.NAME_TO_ECI.set(u,this);const m=this.values;for(let g=0,w=m.length;g!==w;g++){const b=m[g];N.VALUES_TO_ECI.set(b,this)}for(const g of f)N.NAME_TO_ECI.set(g,this)}getValueIdentifier(){return this.valueIdentifier}getName(){return this.name}getValue(){return this.values[0]}static getCharacterSetECIByValue(a){if(a<0||a>=900)throw new A("incorect value");const o=N.VALUES_TO_ECI.get(a);if(o===void 0)throw new A("incorect value");return o}static getCharacterSetECIByName(a){const o=N.NAME_TO_ECI.get(a);if(o===void 0)throw new A("incorect value");return o}equals(a){if(!(a instanceof N))return!1;const o=a;return this.getName()===o.getName()}}N.VALUE_IDENTIFIER_TO_ECI=new Map,N.VALUES_TO_ECI=new Map,N.NAME_TO_ECI=new Map,N.Cp437=new N(C.Cp437,Int32Array.from([0,2]),"Cp437"),N.ISO8859_1=new N(C.ISO8859_1,Int32Array.from([1,3]),"ISO-8859-1","ISO88591","ISO8859_1"),N.ISO8859_2=new N(C.ISO8859_2,4,"ISO-8859-2","ISO88592","ISO8859_2"),N.ISO8859_3=new N(C.ISO8859_3,5,"ISO-8859-3","ISO88593","ISO8859_3"),N.ISO8859_4=new N(C.ISO8859_4,6,"ISO-8859-4","ISO88594","ISO8859_4"),N.ISO8859_5=new N(C.ISO8859_5,7,"ISO-8859-5","ISO88595","ISO8859_5"),N.ISO8859_6=new N(C.ISO8859_6,8,"ISO-8859-6","ISO88596","ISO8859_6"),N.ISO8859_7=new N(C.ISO8859_7,9,"ISO-8859-7","ISO88597","ISO8859_7"),N.ISO8859_8=new N(C.ISO8859_8,10,"ISO-8859-8","ISO88598","ISO8859_8"),N.ISO8859_9=new N(C.ISO8859_9,11,"ISO-8859-9","ISO88599","ISO8859_9"),N.ISO8859_10=new N(C.ISO8859_10,12,"ISO-8859-10","ISO885910","ISO8859_10"),N.ISO8859_11=new N(C.ISO8859_11,13,"ISO-8859-11","ISO885911","ISO8859_11"),N.ISO8859_13=new N(C.ISO8859_13,15,"ISO-8859-13","ISO885913","ISO8859_13"),N.ISO8859_14=new N(C.ISO8859_14,16,"ISO-8859-14","ISO885914","ISO8859_14"),N.ISO8859_15=new N(C.ISO8859_15,17,"ISO-8859-15","ISO885915","ISO8859_15"),N.ISO8859_16=new N(C.ISO8859_16,18,"ISO-8859-16","ISO885916","ISO8859_16"),N.SJIS=new N(C.SJIS,20,"SJIS","Shift_JIS"),N.Cp1250=new N(C.Cp1250,21,"Cp1250","windows-1250"),N.Cp1251=new N(C.Cp1251,22,"Cp1251","windows-1251"),N.Cp1252=new N(C.Cp1252,23,"Cp1252","windows-1252"),N.Cp1256=new N(C.Cp1256,24,"Cp1256","windows-1256"),N.UnicodeBigUnmarked=new N(C.UnicodeBigUnmarked,25,"UnicodeBigUnmarked","UTF-16BE","UnicodeBig"),N.UTF8=new N(C.UTF8,26,"UTF8","UTF-8"),N.ASCII=new N(C.ASCII,Int32Array.from([27,170]),"ASCII","US-ASCII"),N.Big5=new N(C.Big5,28,"Big5"),N.GB18030=new N(C.GB18030,29,"GB18030","GB2312","EUC_CN","GBK"),N.EUC_KR=new N(C.EUC_KR,30,"EUC_KR","EUC-KR");class D extends y{}D.kind="UnsupportedOperationException";class O{static decode(a,o){const u=this.encodingName(o);return this.customDecoder?this.customDecoder(a,u):typeof TextDecoder>"u"||this.shouldDecodeOnFallback(u)?this.decodeFallback(a,u):new TextDecoder(u).decode(a)}static shouldDecodeOnFallback(a){return!O.isBrowser()&&a==="ISO-8859-1"}static encode(a,o){const u=this.encodingName(o);return this.customEncoder?this.customEncoder(a,u):typeof TextEncoder>"u"?this.encodeFallback(a):new TextEncoder().encode(a)}static isBrowser(){return typeof window<"u"&&{}.toString.call(window)==="[object Window]"}static encodingName(a){return typeof a=="string"?a:a.getName()}static encodingCharacterSet(a){return a instanceof N?a:N.getCharacterSetECIByName(a)}static decodeFallback(a,o){const u=this.encodingCharacterSet(o);if(O.isDecodeFallbackSupported(u)){let f="";for(let m=0,g=a.length;m<g;m++){let w=a[m].toString(16);w.length<2&&(w="0"+w),f+="%"+w}return decodeURIComponent(f)}if(u.equals(N.UnicodeBigUnmarked))return String.fromCharCode.apply(null,new Uint16Array(a.buffer));throw new D(`Encoding ${this.encodingName(o)} not supported by fallback.`)}static isDecodeFallbackSupported(a){return a.equals(N.UTF8)||a.equals(N.ISO8859_1)||a.equals(N.ASCII)}static encodeFallback(a){const u=btoa(unescape(encodeURIComponent(a))).split(""),f=[];for(let m=0;m<u.length;m++)f.push(u[m].charCodeAt(0));return new Uint8Array(f)}}class F{static castAsNonUtf8Char(a,o=null){const u=o?o.getName():this.ISO88591;return O.decode(new Uint8Array([a]),u)}static guessEncoding(a,o){if(o!=null&&o.get(Z.CHARACTER_SET)!==void 0)return o.get(Z.CHARACTER_SET).toString();const u=a.length;let f=!0,m=!0,g=!0,w=0,b=0,I=0,P=0,V=0,z=0,Y=0,ne=0,re=0,de=0,ye=0;const Ue=a.length>3&&a[0]===239&&a[1]===187&&a[2]===191;for(let ze=0;ze<u&&(f||m||g);ze++){const Me=a[ze]&255;g&&(w>0?Me&128?w--:g=!1:Me&128&&(Me&64?(w++,Me&32?(w++,Me&16?(w++,Me&8?g=!1:P++):I++):b++):g=!1)),f&&(Me>127&&Me<160?f=!1:Me>159&&(Me<192||Me===215||Me===247)&&ye++),m&&(V>0?Me<64||Me===127||Me>252?m=!1:V--:Me===128||Me===160||Me>239?m=!1:Me>160&&Me<224?(z++,ne=0,Y++,Y>re&&(re=Y)):Me>127?(V++,Y=0,ne++,ne>de&&(de=ne)):(Y=0,ne=0))}return g&&w>0&&(g=!1),m&&V>0&&(m=!1),g&&(Ue||b+I+P>0)?F.UTF8:m&&(F.ASSUME_SHIFT_JIS||re>=3||de>=3)?F.SHIFT_JIS:f&&m?re===2&&z===2||ye*10>=u?F.SHIFT_JIS:F.ISO88591:f?F.ISO88591:m?F.SHIFT_JIS:g?F.UTF8:F.PLATFORM_DEFAULT_ENCODING}static format(a,...o){let u=-1;function f(g,w,b,I,P,V){if(g==="%%")return"%";if(o[++u]===void 0)return;g=I?parseInt(I.substr(1)):void 0;let z=P?parseInt(P.substr(1)):void 0,Y;switch(V){case"s":Y=o[u];break;case"c":Y=o[u][0];break;case"f":Y=parseFloat(o[u]).toFixed(g);break;case"p":Y=parseFloat(o[u]).toPrecision(g);break;case"e":Y=parseFloat(o[u]).toExponential(g);break;case"x":Y=parseInt(o[u]).toString(z||16);break;case"d":Y=parseFloat(parseInt(o[u],z||10).toPrecision(g)).toFixed(0);break}Y=typeof Y=="object"?JSON.stringify(Y):(+Y).toString(z);let ne=parseInt(b),re=b&&b[0]+""=="0"?"0":" ";for(;Y.length<ne;)Y=w!==void 0?Y+re:re+Y;return Y}let m=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return a.replace(m,f)}static getBytes(a,o){return O.encode(a,o)}static getCharCode(a,o=0){return a.charCodeAt(o)}static getCharAt(a){return String.fromCharCode(a)}}F.SHIFT_JIS=N.SJIS.getName(),F.GB2312="GB2312",F.ISO88591=N.ISO8859_1.getName(),F.EUC_JP="EUC_JP",F.UTF8=N.UTF8.getName(),F.PLATFORM_DEFAULT_ENCODING=F.UTF8,F.ASSUME_SHIFT_JIS=!1;class R{constructor(a=""){this.value=a}enableDecoding(a){return this.encoding=a,this}append(a){return typeof a=="string"?this.value+=a.toString():this.encoding?this.value+=F.castAsNonUtf8Char(a,this.encoding):this.value+=String.fromCharCode(a),this}appendChars(a,o,u){for(let f=o;o<o+u;f++)this.append(a[f]);return this}length(){return this.value.length}charAt(a){return this.value.charAt(a)}deleteCharAt(a){this.value=this.value.substr(0,a)+this.value.substring(a+1)}setCharAt(a,o){this.value=this.value.substr(0,a)+o+this.value.substr(a+1)}substring(a,o){return this.value.substring(a,o)}setLengthToZero(){this.value=""}toString(){return this.value}insert(a,o){this.value=this.value.substr(0,a)+o+this.value.substr(a+o.length)}}class ie{constructor(a,o,u,f){if(this.width=a,this.height=o,this.rowSize=u,this.bits=f,o==null&&(o=a),this.height=o,a<1||o<1)throw new E("Both dimensions must be greater than 0");u==null&&(u=Math.floor((a+31)/32)),this.rowSize=u,f==null&&(this.bits=new Int32Array(this.rowSize*this.height))}static parseFromBooleanArray(a){const o=a.length,u=a[0].length,f=new ie(u,o);for(let m=0;m<o;m++){const g=a[m];for(let w=0;w<u;w++)g[w]&&f.set(w,m)}return f}static parseFromString(a,o,u){if(a===null)throw new E("stringRepresentation cannot be null");const f=new Array(a.length);let m=0,g=0,w=-1,b=0,I=0;for(;I<a.length;)if(a.charAt(I)===`
`||a.charAt(I)==="\r"){if(m>g){if(w===-1)w=m-g;else if(m-g!==w)throw new E("row lengths do not match");g=m,b++}I++}else if(a.substring(I,I+o.length)===o)I+=o.length,f[m]=!0,m++;else if(a.substring(I,I+u.length)===u)I+=u.length,f[m]=!1,m++;else throw new E("illegal character encountered: "+a.substring(I));if(m>g){if(w===-1)w=m-g;else if(m-g!==w)throw new E("row lengths do not match");b++}const P=new ie(w,b);for(let V=0;V<m;V++)f[V]&&P.set(Math.floor(V%w),Math.floor(V/w));return P}get(a,o){const u=o*this.rowSize+Math.floor(a/32);return(this.bits[u]>>>(a&31)&1)!==0}set(a,o){const u=o*this.rowSize+Math.floor(a/32);this.bits[u]|=1<<(a&31)&4294967295}unset(a,o){const u=o*this.rowSize+Math.floor(a/32);this.bits[u]&=~(1<<(a&31)&4294967295)}flip(a,o){const u=o*this.rowSize+Math.floor(a/32);this.bits[u]^=1<<(a&31)&4294967295}xor(a){if(this.width!==a.getWidth()||this.height!==a.getHeight()||this.rowSize!==a.getRowSize())throw new E("input matrix dimensions do not match");const o=new $(Math.floor(this.width/32)+1),u=this.rowSize,f=this.bits;for(let m=0,g=this.height;m<g;m++){const w=m*u,b=a.getRow(m,o).getBitArray();for(let I=0;I<u;I++)f[w+I]^=b[I]}}clear(){const a=this.bits,o=a.length;for(let u=0;u<o;u++)a[u]=0}setRegion(a,o,u,f){if(o<0||a<0)throw new E("Left and top must be nonnegative");if(f<1||u<1)throw new E("Height and width must be at least 1");const m=a+u,g=o+f;if(g>this.height||m>this.width)throw new E("The region must fit inside the matrix");const w=this.rowSize,b=this.bits;for(let I=o;I<g;I++){const P=I*w;for(let V=a;V<m;V++)b[P+Math.floor(V/32)]|=1<<(V&31)&4294967295}}getRow(a,o){o==null||o.getSize()<this.width?o=new $(this.width):o.clear();const u=this.rowSize,f=this.bits,m=a*u;for(let g=0;g<u;g++)o.setBulk(g*32,f[m+g]);return o}setRow(a,o){B.arraycopy(o.getBitArray(),0,this.bits,a*this.rowSize,this.rowSize)}rotate180(){const a=this.getWidth(),o=this.getHeight();let u=new $(a),f=new $(a);for(let m=0,g=Math.floor((o+1)/2);m<g;m++)u=this.getRow(m,u),f=this.getRow(o-1-m,f),u.reverse(),f.reverse(),this.setRow(m,f),this.setRow(o-1-m,u)}getEnclosingRectangle(){const a=this.width,o=this.height,u=this.rowSize,f=this.bits;let m=a,g=o,w=-1,b=-1;for(let I=0;I<o;I++)for(let P=0;P<u;P++){const V=f[I*u+P];if(V!==0){if(I<g&&(g=I),I>b&&(b=I),P*32<m){let z=0;for(;!(V<<31-z&4294967295);)z++;P*32+z<m&&(m=P*32+z)}if(P*32+31>w){let z=31;for(;!(V>>>z);)z--;P*32+z>w&&(w=P*32+z)}}}return w<m||b<g?null:Int32Array.from([m,g,w-m+1,b-g+1])}getTopLeftOnBit(){const a=this.rowSize,o=this.bits;let u=0;for(;u<o.length&&o[u]===0;)u++;if(u===o.length)return null;const f=u/a;let m=u%a*32;const g=o[u];let w=0;for(;!(g<<31-w&4294967295);)w++;return m+=w,Int32Array.from([m,f])}getBottomRightOnBit(){const a=this.rowSize,o=this.bits;let u=o.length-1;for(;u>=0&&o[u]===0;)u--;if(u<0)return null;const f=Math.floor(u/a);let m=Math.floor(u%a)*32;const g=o[u];let w=31;for(;!(g>>>w);)w--;return m+=w,Int32Array.from([m,f])}getWidth(){return this.width}getHeight(){return this.height}getRowSize(){return this.rowSize}equals(a){if(!(a instanceof ie))return!1;const o=a;return this.width===o.width&&this.height===o.height&&this.rowSize===o.rowSize&&M.equals(this.bits,o.bits)}hashCode(){let a=this.width;return a=31*a+this.width,a=31*a+this.height,a=31*a+this.rowSize,a=31*a+M.hashCode(this.bits),a}toString(a="X ",o="  ",u=`
`){return this.buildToString(a,o,u)}buildToString(a,o,u){let f=new R;for(let m=0,g=this.height;m<g;m++){for(let w=0,b=this.width;w<b;w++)f.append(this.get(w,m)?a:o);f.append(u)}return f.toString()}clone(){return new ie(this.width,this.height,this.rowSize,this.bits.slice())}}class te extends y{static getNotFoundInstance(){return new te}}te.kind="NotFoundException";class je extends L{constructor(a){super(a),this.luminances=je.EMPTY,this.buckets=new Int32Array(je.LUMINANCE_BUCKETS)}getBlackRow(a,o){const u=this.getLuminanceSource(),f=u.getWidth();o==null||o.getSize()<f?o=new $(f):o.clear(),this.initArrays(f);const m=u.getRow(a,this.luminances),g=this.buckets;for(let b=0;b<f;b++)g[(m[b]&255)>>je.LUMINANCE_SHIFT]++;const w=je.estimateBlackPoint(g);if(f<3)for(let b=0;b<f;b++)(m[b]&255)<w&&o.set(b);else{let b=m[0]&255,I=m[1]&255;for(let P=1;P<f-1;P++){const V=m[P+1]&255;(I*4-b-V)/2<w&&o.set(P),b=I,I=V}}return o}getBlackMatrix(){const a=this.getLuminanceSource(),o=a.getWidth(),u=a.getHeight(),f=new ie(o,u);this.initArrays(o);const m=this.buckets;for(let b=1;b<5;b++){const I=Math.floor(u*b/5),P=a.getRow(I,this.luminances),V=Math.floor(o*4/5);for(let z=Math.floor(o/5);z<V;z++){const Y=P[z]&255;m[Y>>je.LUMINANCE_SHIFT]++}}const g=je.estimateBlackPoint(m),w=a.getMatrix();for(let b=0;b<u;b++){const I=b*o;for(let P=0;P<o;P++)(w[I+P]&255)<g&&f.set(P,b)}return f}createBinarizer(a){return new je(a)}initArrays(a){this.luminances.length<a&&(this.luminances=new Uint8ClampedArray(a));const o=this.buckets;for(let u=0;u<je.LUMINANCE_BUCKETS;u++)o[u]=0}static estimateBlackPoint(a){const o=a.length;let u=0,f=0,m=0;for(let P=0;P<o;P++)a[P]>m&&(f=P,m=a[P]),a[P]>u&&(u=a[P]);let g=0,w=0;for(let P=0;P<o;P++){const V=P-f,z=a[P]*V*V;z>w&&(g=P,w=z)}if(f>g){const P=f;f=g,g=P}if(g-f<=o/16)throw new te;let b=g-1,I=-1;for(let P=g-1;P>f;P--){const V=P-f,z=V*V*(g-P)*(u-a[P]);z>I&&(b=P,I=z)}return b<<je.LUMINANCE_SHIFT}}je.LUMINANCE_BITS=5,je.LUMINANCE_SHIFT=8-je.LUMINANCE_BITS,je.LUMINANCE_BUCKETS=1<<je.LUMINANCE_BITS,je.EMPTY=Uint8ClampedArray.from([0]);class We extends je{constructor(a){super(a),this.matrix=null}getBlackMatrix(){if(this.matrix!==null)return this.matrix;const a=this.getLuminanceSource(),o=a.getWidth(),u=a.getHeight();if(o>=We.MINIMUM_DIMENSION&&u>=We.MINIMUM_DIMENSION){const f=a.getMatrix();let m=o>>We.BLOCK_SIZE_POWER;o&We.BLOCK_SIZE_MASK&&m++;let g=u>>We.BLOCK_SIZE_POWER;u&We.BLOCK_SIZE_MASK&&g++;const w=We.calculateBlackPoints(f,m,g,o,u),b=new ie(o,u);We.calculateThresholdForBlock(f,m,g,o,u,w,b),this.matrix=b}else this.matrix=super.getBlackMatrix();return this.matrix}createBinarizer(a){return new We(a)}static calculateThresholdForBlock(a,o,u,f,m,g,w){const b=m-We.BLOCK_SIZE,I=f-We.BLOCK_SIZE;for(let P=0;P<u;P++){let V=P<<We.BLOCK_SIZE_POWER;V>b&&(V=b);const z=We.cap(P,2,u-3);for(let Y=0;Y<o;Y++){let ne=Y<<We.BLOCK_SIZE_POWER;ne>I&&(ne=I);const re=We.cap(Y,2,o-3);let de=0;for(let Ue=-2;Ue<=2;Ue++){const ze=g[z+Ue];de+=ze[re-2]+ze[re-1]+ze[re]+ze[re+1]+ze[re+2]}const ye=de/25;We.thresholdBlock(a,ne,V,ye,f,w)}}}static cap(a,o,u){return a<o?o:a>u?u:a}static thresholdBlock(a,o,u,f,m,g){for(let w=0,b=u*m+o;w<We.BLOCK_SIZE;w++,b+=m)for(let I=0;I<We.BLOCK_SIZE;I++)(a[b+I]&255)<=f&&g.set(o+I,u+w)}static calculateBlackPoints(a,o,u,f,m){const g=m-We.BLOCK_SIZE,w=f-We.BLOCK_SIZE,b=new Array(u);for(let I=0;I<u;I++){b[I]=new Int32Array(o);let P=I<<We.BLOCK_SIZE_POWER;P>g&&(P=g);for(let V=0;V<o;V++){let z=V<<We.BLOCK_SIZE_POWER;z>w&&(z=w);let Y=0,ne=255,re=0;for(let ye=0,Ue=P*f+z;ye<We.BLOCK_SIZE;ye++,Ue+=f){for(let ze=0;ze<We.BLOCK_SIZE;ze++){const Me=a[Ue+ze]&255;Y+=Me,Me<ne&&(ne=Me),Me>re&&(re=Me)}if(re-ne>We.MIN_DYNAMIC_RANGE)for(ye++,Ue+=f;ye<We.BLOCK_SIZE;ye++,Ue+=f)for(let ze=0;ze<We.BLOCK_SIZE;ze++)Y+=a[Ue+ze]&255}let de=Y>>We.BLOCK_SIZE_POWER*2;if(re-ne<=We.MIN_DYNAMIC_RANGE&&(de=ne/2,I>0&&V>0)){const ye=(b[I-1][V]+2*b[I][V-1]+b[I-1][V-1])/4;ne<ye&&(de=ye)}b[I][V]=de}}return b}}We.BLOCK_SIZE_POWER=3,We.BLOCK_SIZE=1<<We.BLOCK_SIZE_POWER,We.BLOCK_SIZE_MASK=We.BLOCK_SIZE-1,We.MINIMUM_DIMENSION=We.BLOCK_SIZE*5,We.MIN_DYNAMIC_RANGE=24;class Ee{constructor(a,o){this.width=a,this.height=o}getWidth(){return this.width}getHeight(){return this.height}isCropSupported(){return!1}crop(a,o,u,f){throw new D("This luminance source does not support cropping.")}isRotateSupported(){return!1}rotateCounterClockwise(){throw new D("This luminance source does not support rotation by 90 degrees.")}rotateCounterClockwise45(){throw new D("This luminance source does not support rotation by 45 degrees.")}toString(){const a=new Uint8ClampedArray(this.width);let o=new R;for(let u=0;u<this.height;u++){const f=this.getRow(u,a);for(let m=0;m<this.width;m++){const g=f[m]&255;let w;g<64?w="#":g<128?w="+":g<192?w=".":w=" ",o.append(w)}o.append(`
`)}return o.toString()}}class qe extends Ee{constructor(a){super(a.getWidth(),a.getHeight()),this.delegate=a}getRow(a,o){const u=this.delegate.getRow(a,o),f=this.getWidth();for(let m=0;m<f;m++)u[m]=255-(u[m]&255);return u}getMatrix(){const a=this.delegate.getMatrix(),o=this.getWidth()*this.getHeight(),u=new Uint8ClampedArray(o);for(let f=0;f<o;f++)u[f]=255-(a[f]&255);return u}isCropSupported(){return this.delegate.isCropSupported()}crop(a,o,u,f){return new qe(this.delegate.crop(a,o,u,f))}isRotateSupported(){return this.delegate.isRotateSupported()}invert(){return this.delegate}rotateCounterClockwise(){return new qe(this.delegate.rotateCounterClockwise())}rotateCounterClockwise45(){return new qe(this.delegate.rotateCounterClockwise45())}}class et extends Ee{constructor(a){super(a.width,a.height),this.canvas=a,this.tempCanvasElement=null,this.buffer=et.makeBufferFromCanvasImageData(a)}static makeBufferFromCanvasImageData(a){const o=a.getContext("2d").getImageData(0,0,a.width,a.height);return et.toGrayscaleBuffer(o.data,a.width,a.height)}static toGrayscaleBuffer(a,o,u){const f=new Uint8ClampedArray(o*u);for(let m=0,g=0,w=a.length;m<w;m+=4,g++){let b;if(a[m+3]===0)b=255;else{const P=a[m],V=a[m+1],z=a[m+2];b=306*P+601*V+117*z+512>>10}f[g]=b}return f}getRow(a,o){if(a<0||a>=this.getHeight())throw new E("Requested row is outside the image: "+a);const u=this.getWidth(),f=a*u;return o===null?o=this.buffer.slice(f,f+u):(o.length<u&&(o=new Uint8ClampedArray(u)),o.set(this.buffer.slice(f,f+u))),o}getMatrix(){return this.buffer}isCropSupported(){return!0}crop(a,o,u,f){return super.crop(a,o,u,f),this}isRotateSupported(){return!0}rotateCounterClockwise(){return this.rotate(-90),this}rotateCounterClockwise45(){return this.rotate(-45),this}getTempCanvasElement(){if(this.tempCanvasElement===null){const a=this.canvas.ownerDocument.createElement("canvas");a.width=this.canvas.width,a.height=this.canvas.height,this.tempCanvasElement=a}return this.tempCanvasElement}rotate(a){const o=this.getTempCanvasElement(),u=o.getContext("2d"),f=a*et.DEGREE_TO_RADIANS,m=this.canvas.width,g=this.canvas.height,w=Math.ceil(Math.abs(Math.cos(f))*m+Math.abs(Math.sin(f))*g),b=Math.ceil(Math.abs(Math.sin(f))*m+Math.abs(Math.cos(f))*g);return o.width=w,o.height=b,u.translate(w/2,b/2),u.rotate(f),u.drawImage(this.canvas,m/-2,g/-2),this.buffer=et.makeBufferFromCanvasImageData(o),this}invert(){return new qe(this)}}et.DEGREE_TO_RADIANS=Math.PI/180;class Lt{constructor(a,o,u){this.deviceId=a,this.label=o,this.kind="videoinput",this.groupId=u||void 0}toJSON(){return{kind:this.kind,groupId:this.groupId,deviceId:this.deviceId,label:this.label}}}var Qe=(globalThis||Qd||self||window||void 0)&&(globalThis||Qd||self||window||void 0).__awaiter||function(j,a,o,u){function f(m){return m instanceof o?m:new o(function(g){g(m)})}return new(o||(o=Promise))(function(m,g){function w(P){try{I(u.next(P))}catch(V){g(V)}}function b(P){try{I(u.throw(P))}catch(V){g(V)}}function I(P){P.done?m(P.value):f(P.value).then(w,b)}I((u=u.apply(j,a||[])).next())})};class rt{constructor(a,o=500,u){this.reader=a,this.timeBetweenScansMillis=o,this._hints=u,this._stopContinuousDecode=!1,this._stopAsyncDecode=!1,this._timeBetweenDecodingAttempts=0}get hasNavigator(){return typeof navigator<"u"}get isMediaDevicesSuported(){return this.hasNavigator&&!!navigator.mediaDevices}get canEnumerateDevices(){return!!(this.isMediaDevicesSuported&&navigator.mediaDevices.enumerateDevices)}get timeBetweenDecodingAttempts(){return this._timeBetweenDecodingAttempts}set timeBetweenDecodingAttempts(a){this._timeBetweenDecodingAttempts=a<0?0:a}set hints(a){this._hints=a||null}get hints(){return this._hints}listVideoInputDevices(){return Qe(this,void 0,void 0,function*(){if(!this.hasNavigator)throw new Error("Can't enumerate devices, navigator is not present.");if(!this.canEnumerateDevices)throw new Error("Can't enumerate devices, method not supported.");const a=yield navigator.mediaDevices.enumerateDevices(),o=[];for(const u of a){const f=u.kind==="video"?"videoinput":u.kind;if(f!=="videoinput")continue;const m=u.deviceId||u.id,g=u.label||`Video device ${o.length+1}`,w=u.groupId,b={deviceId:m,label:g,kind:f,groupId:w};o.push(b)}return o})}getVideoInputDevices(){return Qe(this,void 0,void 0,function*(){return(yield this.listVideoInputDevices()).map(o=>new Lt(o.deviceId,o.label))})}findDeviceById(a){return Qe(this,void 0,void 0,function*(){const o=yield this.listVideoInputDevices();return o?o.find(u=>u.deviceId===a):null})}decodeFromInputVideoDevice(a,o){return Qe(this,void 0,void 0,function*(){return yield this.decodeOnceFromVideoDevice(a,o)})}decodeOnceFromVideoDevice(a,o){return Qe(this,void 0,void 0,function*(){this.reset();let u;a?u={deviceId:{exact:a}}:u={facingMode:"environment"};const f={video:u};return yield this.decodeOnceFromConstraints(f,o)})}decodeOnceFromConstraints(a,o){return Qe(this,void 0,void 0,function*(){const u=yield navigator.mediaDevices.getUserMedia(a);return yield this.decodeOnceFromStream(u,o)})}decodeOnceFromStream(a,o){return Qe(this,void 0,void 0,function*(){this.reset();const u=yield this.attachStreamToVideo(a,o);return yield this.decodeOnce(u)})}decodeFromInputVideoDeviceContinuously(a,o,u){return Qe(this,void 0,void 0,function*(){return yield this.decodeFromVideoDevice(a,o,u)})}decodeFromVideoDevice(a,o,u){return Qe(this,void 0,void 0,function*(){let f;a?f={deviceId:{exact:a}}:f={facingMode:"environment"};const m={video:f};return yield this.decodeFromConstraints(m,o,u)})}decodeFromConstraints(a,o,u){return Qe(this,void 0,void 0,function*(){const f=yield navigator.mediaDevices.getUserMedia(a);return yield this.decodeFromStream(f,o,u)})}decodeFromStream(a,o,u){return Qe(this,void 0,void 0,function*(){this.reset();const f=yield this.attachStreamToVideo(a,o);return yield this.decodeContinuously(f,u)})}stopAsyncDecode(){this._stopAsyncDecode=!0}stopContinuousDecode(){this._stopContinuousDecode=!0}attachStreamToVideo(a,o){return Qe(this,void 0,void 0,function*(){const u=this.prepareVideoElement(o);return this.addVideoSource(u,a),this.videoElement=u,this.stream=a,yield this.playVideoOnLoadAsync(u),u})}playVideoOnLoadAsync(a){return new Promise((o,u)=>this.playVideoOnLoad(a,()=>o()))}playVideoOnLoad(a,o){this.videoEndedListener=()=>this.stopStreams(),this.videoCanPlayListener=()=>this.tryPlayVideo(a),a.addEventListener("ended",this.videoEndedListener),a.addEventListener("canplay",this.videoCanPlayListener),a.addEventListener("playing",o),this.tryPlayVideo(a)}isVideoPlaying(a){return a.currentTime>0&&!a.paused&&!a.ended&&a.readyState>2}tryPlayVideo(a){return Qe(this,void 0,void 0,function*(){if(this.isVideoPlaying(a)){console.warn("Trying to play video that is already playing.");return}try{yield a.play()}catch{console.warn("It was not possible to play the video.")}})}getMediaElement(a,o){const u=document.getElementById(a);if(!u)throw new _(`element with id '${a}' not found`);if(u.nodeName.toLowerCase()!==o.toLowerCase())throw new _(`element with id '${a}' must be an ${o} element`);return u}decodeFromImage(a,o){if(!a&&!o)throw new _("either imageElement with a src set or an url must be provided");return o&&!a?this.decodeFromImageUrl(o):this.decodeFromImageElement(a)}decodeFromVideo(a,o){if(!a&&!o)throw new _("Either an element with a src set or an URL must be provided");return o&&!a?this.decodeFromVideoUrl(o):this.decodeFromVideoElement(a)}decodeFromVideoContinuously(a,o,u){if(a===void 0&&o===void 0)throw new _("Either an element with a src set or an URL must be provided");return o&&!a?this.decodeFromVideoUrlContinuously(o,u):this.decodeFromVideoElementContinuously(a,u)}decodeFromImageElement(a){if(!a)throw new _("An image element must be provided.");this.reset();const o=this.prepareImageElement(a);this.imageElement=o;let u;return this.isImageLoaded(o)?u=this.decodeOnce(o,!1,!0):u=this._decodeOnLoadImage(o),u}decodeFromVideoElement(a){const o=this._decodeFromVideoElementSetup(a);return this._decodeOnLoadVideo(o)}decodeFromVideoElementContinuously(a,o){const u=this._decodeFromVideoElementSetup(a);return this._decodeOnLoadVideoContinuously(u,o)}_decodeFromVideoElementSetup(a){if(!a)throw new _("A video element must be provided.");this.reset();const o=this.prepareVideoElement(a);return this.videoElement=o,o}decodeFromImageUrl(a){if(!a)throw new _("An URL must be provided.");this.reset();const o=this.prepareImageElement();this.imageElement=o;const u=this._decodeOnLoadImage(o);return o.src=a,u}decodeFromVideoUrl(a){if(!a)throw new _("An URL must be provided.");this.reset();const o=this.prepareVideoElement(),u=this.decodeFromVideoElement(o);return o.src=a,u}decodeFromVideoUrlContinuously(a,o){if(!a)throw new _("An URL must be provided.");this.reset();const u=this.prepareVideoElement(),f=this.decodeFromVideoElementContinuously(u,o);return u.src=a,f}_decodeOnLoadImage(a){return new Promise((o,u)=>{this.imageLoadedListener=()=>this.decodeOnce(a,!1,!0).then(o,u),a.addEventListener("load",this.imageLoadedListener)})}_decodeOnLoadVideo(a){return Qe(this,void 0,void 0,function*(){return yield this.playVideoOnLoadAsync(a),yield this.decodeOnce(a)})}_decodeOnLoadVideoContinuously(a,o){return Qe(this,void 0,void 0,function*(){yield this.playVideoOnLoadAsync(a),this.decodeContinuously(a,o)})}isImageLoaded(a){return!(!a.complete||a.naturalWidth===0)}prepareImageElement(a){let o;return typeof a>"u"&&(o=document.createElement("img"),o.width=200,o.height=200),typeof a=="string"&&(o=this.getMediaElement(a,"img")),a instanceof HTMLImageElement&&(o=a),o}prepareVideoElement(a){let o;return!a&&typeof document<"u"&&(o=document.createElement("video"),o.width=200,o.height=200),typeof a=="string"&&(o=this.getMediaElement(a,"video")),a instanceof HTMLVideoElement&&(o=a),o.setAttribute("autoplay","true"),o.setAttribute("muted","true"),o.setAttribute("playsinline","true"),o}decodeOnce(a,o=!0,u=!0){this._stopAsyncDecode=!1;const f=(m,g)=>{if(this._stopAsyncDecode){g(new te("Video stream has ended before any code could be detected.")),this._stopAsyncDecode=void 0;return}try{const w=this.decode(a);m(w)}catch(w){const b=o&&w instanceof te,P=(w instanceof k||w instanceof A)&&u;if(b||P)return setTimeout(f,this._timeBetweenDecodingAttempts,m,g);g(w)}};return new Promise((m,g)=>f(m,g))}decodeContinuously(a,o){this._stopContinuousDecode=!1;const u=()=>{if(this._stopContinuousDecode){this._stopContinuousDecode=void 0;return}try{const f=this.decode(a);o(f,null),setTimeout(u,this.timeBetweenScansMillis)}catch(f){o(null,f);const m=f instanceof k||f instanceof A,g=f instanceof te;(m||g)&&setTimeout(u,this._timeBetweenDecodingAttempts)}};u()}decode(a){const o=this.createBinaryBitmap(a);return this.decodeBitmap(o)}_isHTMLVideoElement(a){return a.videoWidth!==0}drawFrameOnCanvas(a,o,u){o||(o={sx:0,sy:0,sWidth:a.videoWidth,sHeight:a.videoHeight,dx:0,dy:0,dWidth:a.videoWidth,dHeight:a.videoHeight}),u||(u=this.captureCanvasContext),u.drawImage(a,o.sx,o.sy,o.sWidth,o.sHeight,o.dx,o.dy,o.dWidth,o.dHeight)}drawImageOnCanvas(a,o,u=this.captureCanvasContext){o||(o={sx:0,sy:0,sWidth:a.naturalWidth,sHeight:a.naturalHeight,dx:0,dy:0,dWidth:a.naturalWidth,dHeight:a.naturalHeight}),u||(u=this.captureCanvasContext),u.drawImage(a,o.sx,o.sy,o.sWidth,o.sHeight,o.dx,o.dy,o.dWidth,o.dHeight)}createBinaryBitmap(a){this.getCaptureCanvasContext(a),this._isHTMLVideoElement(a)?this.drawFrameOnCanvas(a):this.drawImageOnCanvas(a);const o=this.getCaptureCanvas(a),u=new et(o),f=new We(u);return new T(f)}getCaptureCanvasContext(a){if(!this.captureCanvasContext){const u=this.getCaptureCanvas(a).getContext("2d");this.captureCanvasContext=u}return this.captureCanvasContext}getCaptureCanvas(a){if(!this.captureCanvas){const o=this.createCaptureCanvas(a);this.captureCanvas=o}return this.captureCanvas}decodeBitmap(a){return this.reader.decode(a,this._hints)}createCaptureCanvas(a){if(typeof document>"u")return this._destroyCaptureCanvas(),null;const o=document.createElement("canvas");let u,f;return typeof a<"u"&&(a instanceof HTMLVideoElement?(u=a.videoWidth,f=a.videoHeight):a instanceof HTMLImageElement&&(u=a.naturalWidth||a.width,f=a.naturalHeight||a.height)),o.style.width=u+"px",o.style.height=f+"px",o.width=u,o.height=f,o}stopStreams(){this.stream&&(this.stream.getVideoTracks().forEach(a=>a.stop()),this.stream=void 0),this._stopAsyncDecode===!1&&this.stopAsyncDecode(),this._stopContinuousDecode===!1&&this.stopContinuousDecode()}reset(){this.stopStreams(),this._destroyVideoElement(),this._destroyImageElement(),this._destroyCaptureCanvas()}_destroyVideoElement(){this.videoElement&&(typeof this.videoEndedListener<"u"&&this.videoElement.removeEventListener("ended",this.videoEndedListener),typeof this.videoPlayingEventListener<"u"&&this.videoElement.removeEventListener("playing",this.videoPlayingEventListener),typeof this.videoCanPlayListener<"u"&&this.videoElement.removeEventListener("loadedmetadata",this.videoCanPlayListener),this.cleanVideoSource(this.videoElement),this.videoElement=void 0)}_destroyImageElement(){this.imageElement&&(this.imageLoadedListener!==void 0&&this.imageElement.removeEventListener("load",this.imageLoadedListener),this.imageElement.src=void 0,this.imageElement.removeAttribute("src"),this.imageElement=void 0)}_destroyCaptureCanvas(){this.captureCanvasContext=void 0,this.captureCanvas=void 0}addVideoSource(a,o){try{a.srcObject=o}catch{a.src=URL.createObjectURL(o)}}cleanVideoSource(a){try{a.srcObject=null}catch{a.src=""}this.videoElement.removeAttribute("src")}}class pe{constructor(a,o,u=o==null?0:8*o.length,f,m,g=B.currentTimeMillis()){this.text=a,this.rawBytes=o,this.numBits=u,this.resultPoints=f,this.format=m,this.timestamp=g,this.text=a,this.rawBytes=o,u==null?this.numBits=o==null?0:8*o.length:this.numBits=u,this.resultPoints=f,this.format=m,this.resultMetadata=null,g==null?this.timestamp=B.currentTimeMillis():this.timestamp=g}getText(){return this.text}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}getResultPoints(){return this.resultPoints}getBarcodeFormat(){return this.format}getResultMetadata(){return this.resultMetadata}putMetadata(a,o){this.resultMetadata===null&&(this.resultMetadata=new Map),this.resultMetadata.set(a,o)}putAllMetadata(a){a!==null&&(this.resultMetadata===null?this.resultMetadata=a:this.resultMetadata=new Map(a))}addResultPoints(a){const o=this.resultPoints;if(o===null)this.resultPoints=a;else if(a!==null&&a.length>0){const u=new Array(o.length+a.length);B.arraycopy(o,0,u,0,o.length),B.arraycopy(a,0,u,o.length,a.length),this.resultPoints=u}}getTimestamp(){return this.timestamp}toString(){return this.text}}var ve;(function(j){j[j.AZTEC=0]="AZTEC",j[j.CODABAR=1]="CODABAR",j[j.CODE_39=2]="CODE_39",j[j.CODE_93=3]="CODE_93",j[j.CODE_128=4]="CODE_128",j[j.DATA_MATRIX=5]="DATA_MATRIX",j[j.EAN_8=6]="EAN_8",j[j.EAN_13=7]="EAN_13",j[j.ITF=8]="ITF",j[j.MAXICODE=9]="MAXICODE",j[j.PDF_417=10]="PDF_417",j[j.QR_CODE=11]="QR_CODE",j[j.RSS_14=12]="RSS_14",j[j.RSS_EXPANDED=13]="RSS_EXPANDED",j[j.UPC_A=14]="UPC_A",j[j.UPC_E=15]="UPC_E",j[j.UPC_EAN_EXTENSION=16]="UPC_EAN_EXTENSION"})(ve||(ve={}));var fe=ve,ke;(function(j){j[j.OTHER=0]="OTHER",j[j.ORIENTATION=1]="ORIENTATION",j[j.BYTE_SEGMENTS=2]="BYTE_SEGMENTS",j[j.ERROR_CORRECTION_LEVEL=3]="ERROR_CORRECTION_LEVEL",j[j.ISSUE_NUMBER=4]="ISSUE_NUMBER",j[j.SUGGESTED_PRICE=5]="SUGGESTED_PRICE",j[j.POSSIBLE_COUNTRY=6]="POSSIBLE_COUNTRY",j[j.UPC_EAN_EXTENSION=7]="UPC_EAN_EXTENSION",j[j.PDF417_EXTRA_METADATA=8]="PDF417_EXTRA_METADATA",j[j.STRUCTURED_APPEND_SEQUENCE=9]="STRUCTURED_APPEND_SEQUENCE",j[j.STRUCTURED_APPEND_PARITY=10]="STRUCTURED_APPEND_PARITY"})(ke||(ke={}));var Ve=ke;class Vt{constructor(a,o,u,f,m=-1,g=-1){this.rawBytes=a,this.text=o,this.byteSegments=u,this.ecLevel=f,this.structuredAppendSequenceNumber=m,this.structuredAppendParity=g,this.numBits=a==null?0:8*a.length}getRawBytes(){return this.rawBytes}getNumBits(){return this.numBits}setNumBits(a){this.numBits=a}getText(){return this.text}getByteSegments(){return this.byteSegments}getECLevel(){return this.ecLevel}getErrorsCorrected(){return this.errorsCorrected}setErrorsCorrected(a){this.errorsCorrected=a}getErasures(){return this.erasures}setErasures(a){this.erasures=a}getOther(){return this.other}setOther(a){this.other=a}hasStructuredAppend(){return this.structuredAppendParity>=0&&this.structuredAppendSequenceNumber>=0}getStructuredAppendParity(){return this.structuredAppendParity}getStructuredAppendSequenceNumber(){return this.structuredAppendSequenceNumber}}class qt{exp(a){return this.expTable[a]}log(a){if(a===0)throw new E;return this.logTable[a]}static addOrSubtract(a,o){return a^o}}class yt{constructor(a,o){if(o.length===0)throw new E;this.field=a;const u=o.length;if(u>1&&o[0]===0){let f=1;for(;f<u&&o[f]===0;)f++;f===u?this.coefficients=Int32Array.from([0]):(this.coefficients=new Int32Array(u-f),B.arraycopy(o,f,this.coefficients,0,this.coefficients.length))}else this.coefficients=o}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(a){return this.coefficients[this.coefficients.length-1-a]}evaluateAt(a){if(a===0)return this.getCoefficient(0);const o=this.coefficients;let u;if(a===1){u=0;for(let g=0,w=o.length;g!==w;g++){const b=o[g];u=qt.addOrSubtract(u,b)}return u}u=o[0];const f=o.length,m=this.field;for(let g=1;g<f;g++)u=qt.addOrSubtract(m.multiply(a,u),o[g]);return u}addOrSubtract(a){if(!this.field.equals(a.field))throw new E("GenericGFPolys do not have same GenericGF field");if(this.isZero())return a;if(a.isZero())return this;let o=this.coefficients,u=a.coefficients;if(o.length>u.length){const g=o;o=u,u=g}let f=new Int32Array(u.length);const m=u.length-o.length;B.arraycopy(u,0,f,0,m);for(let g=m;g<u.length;g++)f[g]=qt.addOrSubtract(o[g-m],u[g]);return new yt(this.field,f)}multiply(a){if(!this.field.equals(a.field))throw new E("GenericGFPolys do not have same GenericGF field");if(this.isZero()||a.isZero())return this.field.getZero();const o=this.coefficients,u=o.length,f=a.coefficients,m=f.length,g=new Int32Array(u+m-1),w=this.field;for(let b=0;b<u;b++){const I=o[b];for(let P=0;P<m;P++)g[b+P]=qt.addOrSubtract(g[b+P],w.multiply(I,f[P]))}return new yt(w,g)}multiplyScalar(a){if(a===0)return this.field.getZero();if(a===1)return this;const o=this.coefficients.length,u=this.field,f=new Int32Array(o),m=this.coefficients;for(let g=0;g<o;g++)f[g]=u.multiply(m[g],a);return new yt(u,f)}multiplyByMonomial(a,o){if(a<0)throw new E;if(o===0)return this.field.getZero();const u=this.coefficients,f=u.length,m=new Int32Array(f+a),g=this.field;for(let w=0;w<f;w++)m[w]=g.multiply(u[w],o);return new yt(g,m)}divide(a){if(!this.field.equals(a.field))throw new E("GenericGFPolys do not have same GenericGF field");if(a.isZero())throw new E("Divide by 0");const o=this.field;let u=o.getZero(),f=this;const m=a.getCoefficient(a.getDegree()),g=o.inverse(m);for(;f.getDegree()>=a.getDegree()&&!f.isZero();){const w=f.getDegree()-a.getDegree(),b=o.multiply(f.getCoefficient(f.getDegree()),g),I=a.multiplyByMonomial(w,b),P=o.buildMonomial(w,b);u=u.addOrSubtract(P),f=f.addOrSubtract(I)}return[u,f]}toString(){let a="";for(let o=this.getDegree();o>=0;o--){let u=this.getCoefficient(o);if(u!==0){if(u<0?(a+=" - ",u=-u):a.length>0&&(a+=" + "),o===0||u!==1){const f=this.field.log(u);f===0?a+="1":f===1?a+="a":(a+="a^",a+=f)}o!==0&&(o===1?a+="x":(a+="x^",a+=o))}}return a}}class xe extends y{}xe.kind="ArithmeticException";class se extends qt{constructor(a,o,u){super(),this.primitive=a,this.size=o,this.generatorBase=u;const f=new Int32Array(o);let m=1;for(let w=0;w<o;w++)f[w]=m,m*=2,m>=o&&(m^=a,m&=o-1);this.expTable=f;const g=new Int32Array(o);for(let w=0;w<o-1;w++)g[f[w]]=w;this.logTable=g,this.zero=new yt(this,Int32Array.from([0])),this.one=new yt(this,Int32Array.from([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(a,o){if(a<0)throw new E;if(o===0)return this.zero;const u=new Int32Array(a+1);return u[0]=o,new yt(this,u)}inverse(a){if(a===0)throw new xe;return this.expTable[this.size-this.logTable[a]-1]}multiply(a,o){return a===0||o===0?0:this.expTable[(this.logTable[a]+this.logTable[o])%(this.size-1)]}getSize(){return this.size}getGeneratorBase(){return this.generatorBase}toString(){return"GF(0x"+U.toHexString(this.primitive)+","+this.size+")"}equals(a){return a===this}}se.AZTEC_DATA_12=new se(4201,4096,1),se.AZTEC_DATA_10=new se(1033,1024,1),se.AZTEC_DATA_6=new se(67,64,1),se.AZTEC_PARAM=new se(19,16,1),se.QR_CODE_FIELD_256=new se(285,256,0),se.DATA_MATRIX_FIELD_256=new se(301,256,1),se.AZTEC_DATA_8=se.DATA_MATRIX_FIELD_256,se.MAXICODE_FIELD_64=se.AZTEC_DATA_6;class De extends y{}De.kind="ReedSolomonException";class Oe extends y{}Oe.kind="IllegalStateException";class Ge{constructor(a){this.field=a}decode(a,o){const u=this.field,f=new yt(u,a),m=new Int32Array(o);let g=!0;for(let Y=0;Y<o;Y++){const ne=f.evaluateAt(u.exp(Y+u.getGeneratorBase()));m[m.length-1-Y]=ne,ne!==0&&(g=!1)}if(g)return;const w=new yt(u,m),b=this.runEuclideanAlgorithm(u.buildMonomial(o,1),w,o),I=b[0],P=b[1],V=this.findErrorLocations(I),z=this.findErrorMagnitudes(P,V);for(let Y=0;Y<V.length;Y++){const ne=a.length-1-u.log(V[Y]);if(ne<0)throw new De("Bad error location");a[ne]=se.addOrSubtract(a[ne],z[Y])}}runEuclideanAlgorithm(a,o,u){if(a.getDegree()<o.getDegree()){const Y=a;a=o,o=Y}const f=this.field;let m=a,g=o,w=f.getZero(),b=f.getOne();for(;g.getDegree()>=(u/2|0);){let Y=m,ne=w;if(m=g,w=b,m.isZero())throw new De("r_{i-1} was zero");g=Y;let re=f.getZero();const de=m.getCoefficient(m.getDegree()),ye=f.inverse(de);for(;g.getDegree()>=m.getDegree()&&!g.isZero();){const Ue=g.getDegree()-m.getDegree(),ze=f.multiply(g.getCoefficient(g.getDegree()),ye);re=re.addOrSubtract(f.buildMonomial(Ue,ze)),g=g.addOrSubtract(m.multiplyByMonomial(Ue,ze))}if(b=re.multiply(w).addOrSubtract(ne),g.getDegree()>=m.getDegree())throw new Oe("Division algorithm failed to reduce polynomial?")}const I=b.getCoefficient(0);if(I===0)throw new De("sigmaTilde(0) was zero");const P=f.inverse(I),V=b.multiplyScalar(P),z=g.multiplyScalar(P);return[V,z]}findErrorLocations(a){const o=a.getDegree();if(o===1)return Int32Array.from([a.getCoefficient(1)]);const u=new Int32Array(o);let f=0;const m=this.field;for(let g=1;g<m.getSize()&&f<o;g++)a.evaluateAt(g)===0&&(u[f]=m.inverse(g),f++);if(f!==o)throw new De("Error locator degree does not match number of roots");return u}findErrorMagnitudes(a,o){const u=o.length,f=new Int32Array(u),m=this.field;for(let g=0;g<u;g++){const w=m.inverse(o[g]);let b=1;for(let I=0;I<u;I++)if(g!==I){const P=m.multiply(o[I],w),V=P&1?P&-2:P|1;b=m.multiply(b,V)}f[g]=m.multiply(a.evaluateAt(w),m.inverse(b)),m.getGeneratorBase()!==0&&(f[g]=m.multiply(f[g],w))}return f}}var ht;(function(j){j[j.UPPER=0]="UPPER",j[j.LOWER=1]="LOWER",j[j.MIXED=2]="MIXED",j[j.DIGIT=3]="DIGIT",j[j.PUNCT=4]="PUNCT",j[j.BINARY=5]="BINARY"})(ht||(ht={}));class Et{decode(a){this.ddata=a;let o=a.getBits(),u=this.extractBits(o),f=this.correctBits(u),m=Et.convertBoolArrayToByteArray(f),g=Et.getEncodedData(f),w=new Vt(m,g,null,null);return w.setNumBits(f.length),w}static highLevelDecode(a){return this.getEncodedData(a)}static getEncodedData(a){let o=a.length,u=ht.UPPER,f=ht.UPPER,m="",g=0;for(;g<o;)if(f===ht.BINARY){if(o-g<5)break;let w=Et.readCode(a,g,5);if(g+=5,w===0){if(o-g<11)break;w=Et.readCode(a,g,11)+31,g+=11}for(let b=0;b<w;b++){if(o-g<8){g=o;break}const I=Et.readCode(a,g,8);m+=F.castAsNonUtf8Char(I),g+=8}f=u}else{let w=f===ht.DIGIT?4:5;if(o-g<w)break;let b=Et.readCode(a,g,w);g+=w;let I=Et.getCharacter(f,b);I.startsWith("CTRL_")?(u=f,f=Et.getTable(I.charAt(5)),I.charAt(6)==="L"&&(u=f)):(m+=I,f=u)}return m}static getTable(a){switch(a){case"L":return ht.LOWER;case"P":return ht.PUNCT;case"M":return ht.MIXED;case"D":return ht.DIGIT;case"B":return ht.BINARY;case"U":default:return ht.UPPER}}static getCharacter(a,o){switch(a){case ht.UPPER:return Et.UPPER_TABLE[o];case ht.LOWER:return Et.LOWER_TABLE[o];case ht.MIXED:return Et.MIXED_TABLE[o];case ht.PUNCT:return Et.PUNCT_TABLE[o];case ht.DIGIT:return Et.DIGIT_TABLE[o];default:throw new Oe("Bad table")}}correctBits(a){let o,u;this.ddata.getNbLayers()<=2?(u=6,o=se.AZTEC_DATA_6):this.ddata.getNbLayers()<=8?(u=8,o=se.AZTEC_DATA_8):this.ddata.getNbLayers()<=22?(u=10,o=se.AZTEC_DATA_10):(u=12,o=se.AZTEC_DATA_12);let f=this.ddata.getNbDatablocks(),m=a.length/u;if(m<f)throw new A;let g=a.length%u,w=new Int32Array(m);for(let z=0;z<m;z++,g+=u)w[z]=Et.readCode(a,g,u);try{new Ge(o).decode(w,m-f)}catch(z){throw new A(z)}let b=(1<<u)-1,I=0;for(let z=0;z<f;z++){let Y=w[z];if(Y===0||Y===b)throw new A;(Y===1||Y===b-1)&&I++}let P=new Array(f*u-I),V=0;for(let z=0;z<f;z++){let Y=w[z];if(Y===1||Y===b-1)P.fill(Y>1,V,V+u-1),V+=u-1;else for(let ne=u-1;ne>=0;--ne)P[V++]=(Y&1<<ne)!==0}return P}extractBits(a){let o=this.ddata.isCompact(),u=this.ddata.getNbLayers(),f=(o?11:14)+u*4,m=new Int32Array(f),g=new Array(this.totalBitsInLayer(u,o));if(o)for(let w=0;w<m.length;w++)m[w]=w;else{let w=f+1+2*U.truncDivision(U.truncDivision(f,2)-1,15),b=f/2,I=U.truncDivision(w,2);for(let P=0;P<b;P++){let V=P+U.truncDivision(P,15);m[b-P-1]=I-V-1,m[b+P]=I+V+1}}for(let w=0,b=0;w<u;w++){let I=(u-w)*4+(o?9:12),P=w*2,V=f-1-P;for(let z=0;z<I;z++){let Y=z*2;for(let ne=0;ne<2;ne++)g[b+Y+ne]=a.get(m[P+ne],m[P+z]),g[b+2*I+Y+ne]=a.get(m[P+z],m[V-ne]),g[b+4*I+Y+ne]=a.get(m[V-ne],m[V-z]),g[b+6*I+Y+ne]=a.get(m[V-z],m[P+ne])}b+=I*8}return g}static readCode(a,o,u){let f=0;for(let m=o;m<o+u;m++)f<<=1,a[m]&&(f|=1);return f}static readByte(a,o){let u=a.length-o;return u>=8?Et.readCode(a,o,8):Et.readCode(a,o,u)<<8-u}static convertBoolArrayToByteArray(a){let o=new Uint8Array((a.length+7)/8);for(let u=0;u<o.length;u++)o[u]=Et.readByte(a,8*u);return o}totalBitsInLayer(a,o){return((o?88:112)+16*a)*a}}Et.UPPER_TABLE=["CTRL_PS"," ","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","CTRL_LL","CTRL_ML","CTRL_DL","CTRL_BS"],Et.LOWER_TABLE=["CTRL_PS"," ","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","CTRL_US","CTRL_ML","CTRL_DL","CTRL_BS"],Et.MIXED_TABLE=["CTRL_PS"," ","\\1","\\2","\\3","\\4","\\5","\\6","\\7","\b","	",`
`,"\\13","\f","\r","\\33","\\34","\\35","\\36","\\37","@","\\","^","_","`","|","~","\\177","CTRL_LL","CTRL_UL","CTRL_PL","CTRL_BS"],Et.PUNCT_TABLE=["","\r",`\r
`,". ",", ",": ","!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}","CTRL_UL"],Et.DIGIT_TABLE=["CTRL_PS"," ","0","1","2","3","4","5","6","7","8","9",",",".","CTRL_UL","CTRL_US"];class st{constructor(){}static round(a){return a===NaN?0:a<=Number.MIN_SAFE_INTEGER?Number.MIN_SAFE_INTEGER:a>=Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:a+(a<0?-.5:.5)|0}static distance(a,o,u,f){const m=a-u,g=o-f;return Math.sqrt(m*m+g*g)}static sum(a){let o=0;for(let u=0,f=a.length;u!==f;u++){const m=a[u];o+=m}return o}}class me{static floatToIntBits(a){return a}}me.MAX_VALUE=Number.MAX_SAFE_INTEGER;class ae{constructor(a,o){this.x=a,this.y=o}getX(){return this.x}getY(){return this.y}equals(a){if(a instanceof ae){const o=a;return this.x===o.x&&this.y===o.y}return!1}hashCode(){return 31*me.floatToIntBits(this.x)+me.floatToIntBits(this.y)}toString(){return"("+this.x+","+this.y+")"}static orderBestPatterns(a){const o=this.distance(a[0],a[1]),u=this.distance(a[1],a[2]),f=this.distance(a[0],a[2]);let m,g,w;if(u>=o&&u>=f?(g=a[0],m=a[1],w=a[2]):f>=u&&f>=o?(g=a[1],m=a[0],w=a[2]):(g=a[2],m=a[0],w=a[1]),this.crossProductZ(m,g,w)<0){const b=m;m=w,w=b}a[0]=m,a[1]=g,a[2]=w}static distance(a,o){return st.distance(a.x,a.y,o.x,o.y)}static crossProductZ(a,o,u){const f=o.x,m=o.y;return(u.x-f)*(a.y-m)-(u.y-m)*(a.x-f)}}class ft{constructor(a,o){this.bits=a,this.points=o}getBits(){return this.bits}getPoints(){return this.points}}class At extends ft{constructor(a,o,u,f,m){super(a,o),this.compact=u,this.nbDatablocks=f,this.nbLayers=m}getNbLayers(){return this.nbLayers}getNbDatablocks(){return this.nbDatablocks}isCompact(){return this.compact}}class Ke{constructor(a,o,u,f){this.image=a,this.height=a.getHeight(),this.width=a.getWidth(),o==null&&(o=Ke.INIT_SIZE),u==null&&(u=a.getWidth()/2|0),f==null&&(f=a.getHeight()/2|0);const m=o/2|0;if(this.leftInit=u-m,this.rightInit=u+m,this.upInit=f-m,this.downInit=f+m,this.upInit<0||this.leftInit<0||this.downInit>=this.height||this.rightInit>=this.width)throw new te}detect(){let a=this.leftInit,o=this.rightInit,u=this.upInit,f=this.downInit,m=!1,g=!0,w=!1,b=!1,I=!1,P=!1,V=!1;const z=this.width,Y=this.height;for(;g;){g=!1;let ne=!0;for(;(ne||!b)&&o<z;)ne=this.containsBlackPoint(u,f,o,!1),ne?(o++,g=!0,b=!0):b||o++;if(o>=z){m=!0;break}let re=!0;for(;(re||!I)&&f<Y;)re=this.containsBlackPoint(a,o,f,!0),re?(f++,g=!0,I=!0):I||f++;if(f>=Y){m=!0;break}let de=!0;for(;(de||!P)&&a>=0;)de=this.containsBlackPoint(u,f,a,!1),de?(a--,g=!0,P=!0):P||a--;if(a<0){m=!0;break}let ye=!0;for(;(ye||!V)&&u>=0;)ye=this.containsBlackPoint(a,o,u,!0),ye?(u--,g=!0,V=!0):V||u--;if(u<0){m=!0;break}g&&(w=!0)}if(!m&&w){const ne=o-a;let re=null;for(let ze=1;re===null&&ze<ne;ze++)re=this.getBlackPointOnSegment(a,f-ze,a+ze,f);if(re==null)throw new te;let de=null;for(let ze=1;de===null&&ze<ne;ze++)de=this.getBlackPointOnSegment(a,u+ze,a+ze,u);if(de==null)throw new te;let ye=null;for(let ze=1;ye===null&&ze<ne;ze++)ye=this.getBlackPointOnSegment(o,u+ze,o-ze,u);if(ye==null)throw new te;let Ue=null;for(let ze=1;Ue===null&&ze<ne;ze++)Ue=this.getBlackPointOnSegment(o,f-ze,o-ze,f);if(Ue==null)throw new te;return this.centerEdges(Ue,re,ye,de)}else throw new te}getBlackPointOnSegment(a,o,u,f){const m=st.round(st.distance(a,o,u,f)),g=(u-a)/m,w=(f-o)/m,b=this.image;for(let I=0;I<m;I++){const P=st.round(a+I*g),V=st.round(o+I*w);if(b.get(P,V))return new ae(P,V)}return null}centerEdges(a,o,u,f){const m=a.getX(),g=a.getY(),w=o.getX(),b=o.getY(),I=u.getX(),P=u.getY(),V=f.getX(),z=f.getY(),Y=Ke.CORR;return m<this.width/2?[new ae(V-Y,z+Y),new ae(w+Y,b+Y),new ae(I-Y,P-Y),new ae(m+Y,g-Y)]:[new ae(V+Y,z+Y),new ae(w+Y,b-Y),new ae(I-Y,P+Y),new ae(m-Y,g-Y)]}containsBlackPoint(a,o,u,f){const m=this.image;if(f){for(let g=a;g<=o;g++)if(m.get(g,u))return!0}else for(let g=a;g<=o;g++)if(m.get(u,g))return!0;return!1}}Ke.INIT_SIZE=10,Ke.CORR=1;class dn{static checkAndNudgePoints(a,o){const u=a.getWidth(),f=a.getHeight();let m=!0;for(let g=0;g<o.length&&m;g+=2){const w=Math.floor(o[g]),b=Math.floor(o[g+1]);if(w<-1||w>u||b<-1||b>f)throw new te;m=!1,w===-1?(o[g]=0,m=!0):w===u&&(o[g]=u-1,m=!0),b===-1?(o[g+1]=0,m=!0):b===f&&(o[g+1]=f-1,m=!0)}m=!0;for(let g=o.length-2;g>=0&&m;g-=2){const w=Math.floor(o[g]),b=Math.floor(o[g+1]);if(w<-1||w>u||b<-1||b>f)throw new te;m=!1,w===-1?(o[g]=0,m=!0):w===u&&(o[g]=u-1,m=!0),b===-1?(o[g+1]=0,m=!0):b===f&&(o[g+1]=f-1,m=!0)}}}class tt{constructor(a,o,u,f,m,g,w,b,I){this.a11=a,this.a21=o,this.a31=u,this.a12=f,this.a22=m,this.a32=g,this.a13=w,this.a23=b,this.a33=I}static quadrilateralToQuadrilateral(a,o,u,f,m,g,w,b,I,P,V,z,Y,ne,re,de){const ye=tt.quadrilateralToSquare(a,o,u,f,m,g,w,b);return tt.squareToQuadrilateral(I,P,V,z,Y,ne,re,de).times(ye)}transformPoints(a){const o=a.length,u=this.a11,f=this.a12,m=this.a13,g=this.a21,w=this.a22,b=this.a23,I=this.a31,P=this.a32,V=this.a33;for(let z=0;z<o;z+=2){const Y=a[z],ne=a[z+1],re=m*Y+b*ne+V;a[z]=(u*Y+g*ne+I)/re,a[z+1]=(f*Y+w*ne+P)/re}}transformPointsWithValues(a,o){const u=this.a11,f=this.a12,m=this.a13,g=this.a21,w=this.a22,b=this.a23,I=this.a31,P=this.a32,V=this.a33,z=a.length;for(let Y=0;Y<z;Y++){const ne=a[Y],re=o[Y],de=m*ne+b*re+V;a[Y]=(u*ne+g*re+I)/de,o[Y]=(f*ne+w*re+P)/de}}static squareToQuadrilateral(a,o,u,f,m,g,w,b){const I=a-u+m-w,P=o-f+g-b;if(I===0&&P===0)return new tt(u-a,m-u,a,f-o,g-f,o,0,0,1);{const V=u-m,z=w-m,Y=f-g,ne=b-g,re=V*ne-z*Y,de=(I*ne-z*P)/re,ye=(V*P-I*Y)/re;return new tt(u-a+de*u,w-a+ye*w,a,f-o+de*f,b-o+ye*b,o,de,ye,1)}}static quadrilateralToSquare(a,o,u,f,m,g,w,b){return tt.squareToQuadrilateral(a,o,u,f,m,g,w,b).buildAdjoint()}buildAdjoint(){return new tt(this.a22*this.a33-this.a23*this.a32,this.a23*this.a31-this.a21*this.a33,this.a21*this.a32-this.a22*this.a31,this.a13*this.a32-this.a12*this.a33,this.a11*this.a33-this.a13*this.a31,this.a12*this.a31-this.a11*this.a32,this.a12*this.a23-this.a13*this.a22,this.a13*this.a21-this.a11*this.a23,this.a11*this.a22-this.a12*this.a21)}times(a){return new tt(this.a11*a.a11+this.a21*a.a12+this.a31*a.a13,this.a11*a.a21+this.a21*a.a22+this.a31*a.a23,this.a11*a.a31+this.a21*a.a32+this.a31*a.a33,this.a12*a.a11+this.a22*a.a12+this.a32*a.a13,this.a12*a.a21+this.a22*a.a22+this.a32*a.a23,this.a12*a.a31+this.a22*a.a32+this.a32*a.a33,this.a13*a.a11+this.a23*a.a12+this.a33*a.a13,this.a13*a.a21+this.a23*a.a22+this.a33*a.a23,this.a13*a.a31+this.a23*a.a32+this.a33*a.a33)}}class ot extends dn{sampleGrid(a,o,u,f,m,g,w,b,I,P,V,z,Y,ne,re,de,ye,Ue,ze){const Me=tt.quadrilateralToQuadrilateral(f,m,g,w,b,I,P,V,z,Y,ne,re,de,ye,Ue,ze);return this.sampleGridWithTransform(a,o,u,Me)}sampleGridWithTransform(a,o,u,f){if(o<=0||u<=0)throw new te;const m=new ie(o,u),g=new Float32Array(2*o);for(let w=0;w<u;w++){const b=g.length,I=w+.5;for(let P=0;P<b;P+=2)g[P]=P/2+.5,g[P+1]=I;f.transformPoints(g),dn.checkAndNudgePoints(a,g);try{for(let P=0;P<b;P+=2)a.get(Math.floor(g[P]),Math.floor(g[P+1]))&&m.set(P/2,w)}catch{throw new te}}return m}}class jt{static setGridSampler(a){jt.gridSampler=a}static getInstance(){return jt.gridSampler}}jt.gridSampler=new ot;class Kt{constructor(a,o){this.x=a,this.y=o}toResultPoint(){return new ae(this.getX(),this.getY())}getX(){return this.x}getY(){return this.y}}class ar{constructor(a){this.EXPECTED_CORNER_BITS=new Int32Array([3808,476,2107,1799]),this.image=a}detect(){return this.detectMirror(!1)}detectMirror(a){let o=this.getMatrixCenter(),u=this.getBullsEyeCorners(o);if(a){let g=u[0];u[0]=u[2],u[2]=g}this.extractParameters(u);let f=this.sampleGrid(this.image,u[this.shift%4],u[(this.shift+1)%4],u[(this.shift+2)%4],u[(this.shift+3)%4]),m=this.getMatrixCornerPoints(u);return new At(f,m,this.compact,this.nbDataBlocks,this.nbLayers)}extractParameters(a){if(!this.isValidPoint(a[0])||!this.isValidPoint(a[1])||!this.isValidPoint(a[2])||!this.isValidPoint(a[3]))throw new te;let o=2*this.nbCenterLayers,u=new Int32Array([this.sampleLine(a[0],a[1],o),this.sampleLine(a[1],a[2],o),this.sampleLine(a[2],a[3],o),this.sampleLine(a[3],a[0],o)]);this.shift=this.getRotation(u,o);let f=0;for(let g=0;g<4;g++){let w=u[(this.shift+g)%4];this.compact?(f<<=7,f+=w>>1&127):(f<<=10,f+=(w>>2&992)+(w>>1&31))}let m=this.getCorrectedParameterData(f,this.compact);this.compact?(this.nbLayers=(m>>6)+1,this.nbDataBlocks=(m&63)+1):(this.nbLayers=(m>>11)+1,this.nbDataBlocks=(m&2047)+1)}getRotation(a,o){let u=0;a.forEach((f,m,g)=>{let w=(f>>o-2<<1)+(f&1);u=(u<<3)+w}),u=((u&1)<<11)+(u>>1);for(let f=0;f<4;f++)if(U.bitCount(u^this.EXPECTED_CORNER_BITS[f])<=2)return f;throw new te}getCorrectedParameterData(a,o){let u,f;o?(u=7,f=2):(u=10,f=4);let m=u-f,g=new Int32Array(u);for(let b=u-1;b>=0;--b)g[b]=a&15,a>>=4;try{new Ge(se.AZTEC_PARAM).decode(g,m)}catch{throw new te}let w=0;for(let b=0;b<f;b++)w=(w<<4)+g[b];return w}getBullsEyeCorners(a){let o=a,u=a,f=a,m=a,g=!0;for(this.nbCenterLayers=1;this.nbCenterLayers<9;this.nbCenterLayers++){let V=this.getFirstDifferent(o,g,1,-1),z=this.getFirstDifferent(u,g,1,1),Y=this.getFirstDifferent(f,g,-1,1),ne=this.getFirstDifferent(m,g,-1,-1);if(this.nbCenterLayers>2){let re=this.distancePoint(ne,V)*this.nbCenterLayers/(this.distancePoint(m,o)*(this.nbCenterLayers+2));if(re<.75||re>1.25||!this.isWhiteOrBlackRectangle(V,z,Y,ne))break}o=V,u=z,f=Y,m=ne,g=!g}if(this.nbCenterLayers!==5&&this.nbCenterLayers!==7)throw new te;this.compact=this.nbCenterLayers===5;let w=new ae(o.getX()+.5,o.getY()-.5),b=new ae(u.getX()+.5,u.getY()+.5),I=new ae(f.getX()-.5,f.getY()+.5),P=new ae(m.getX()-.5,m.getY()-.5);return this.expandSquare([w,b,I,P],2*this.nbCenterLayers-3,2*this.nbCenterLayers)}getMatrixCenter(){let a,o,u,f;try{let w=new Ke(this.image).detect();a=w[0],o=w[1],u=w[2],f=w[3]}catch{let b=this.image.getWidth()/2,I=this.image.getHeight()/2;a=this.getFirstDifferent(new Kt(b+7,I-7),!1,1,-1).toResultPoint(),o=this.getFirstDifferent(new Kt(b+7,I+7),!1,1,1).toResultPoint(),u=this.getFirstDifferent(new Kt(b-7,I+7),!1,-1,1).toResultPoint(),f=this.getFirstDifferent(new Kt(b-7,I-7),!1,-1,-1).toResultPoint()}let m=st.round((a.getX()+f.getX()+o.getX()+u.getX())/4),g=st.round((a.getY()+f.getY()+o.getY()+u.getY())/4);try{let w=new Ke(this.image,15,m,g).detect();a=w[0],o=w[1],u=w[2],f=w[3]}catch{a=this.getFirstDifferent(new Kt(m+7,g-7),!1,1,-1).toResultPoint(),o=this.getFirstDifferent(new Kt(m+7,g+7),!1,1,1).toResultPoint(),u=this.getFirstDifferent(new Kt(m-7,g+7),!1,-1,1).toResultPoint(),f=this.getFirstDifferent(new Kt(m-7,g-7),!1,-1,-1).toResultPoint()}return m=st.round((a.getX()+f.getX()+o.getX()+u.getX())/4),g=st.round((a.getY()+f.getY()+o.getY()+u.getY())/4),new Kt(m,g)}getMatrixCornerPoints(a){return this.expandSquare(a,2*this.nbCenterLayers,this.getDimension())}sampleGrid(a,o,u,f,m){let g=jt.getInstance(),w=this.getDimension(),b=w/2-this.nbCenterLayers,I=w/2+this.nbCenterLayers;return g.sampleGrid(a,w,w,b,b,I,b,I,I,b,I,o.getX(),o.getY(),u.getX(),u.getY(),f.getX(),f.getY(),m.getX(),m.getY())}sampleLine(a,o,u){let f=0,m=this.distanceResultPoint(a,o),g=m/u,w=a.getX(),b=a.getY(),I=g*(o.getX()-a.getX())/m,P=g*(o.getY()-a.getY())/m;for(let V=0;V<u;V++)this.image.get(st.round(w+V*I),st.round(b+V*P))&&(f|=1<<u-V-1);return f}isWhiteOrBlackRectangle(a,o,u,f){let m=3;a=new Kt(a.getX()-m,a.getY()+m),o=new Kt(o.getX()-m,o.getY()-m),u=new Kt(u.getX()+m,u.getY()-m),f=new Kt(f.getX()+m,f.getY()+m);let g=this.getColor(f,a);if(g===0)return!1;let w=this.getColor(a,o);return w!==g||(w=this.getColor(o,u),w!==g)?!1:(w=this.getColor(u,f),w===g)}getColor(a,o){let u=this.distancePoint(a,o),f=(o.getX()-a.getX())/u,m=(o.getY()-a.getY())/u,g=0,w=a.getX(),b=a.getY(),I=this.image.get(a.getX(),a.getY()),P=Math.ceil(u);for(let z=0;z<P;z++)w+=f,b+=m,this.image.get(st.round(w),st.round(b))!==I&&g++;let V=g/u;return V>.1&&V<.9?0:V<=.1===I?1:-1}getFirstDifferent(a,o,u,f){let m=a.getX()+u,g=a.getY()+f;for(;this.isValid(m,g)&&this.image.get(m,g)===o;)m+=u,g+=f;for(m-=u,g-=f;this.isValid(m,g)&&this.image.get(m,g)===o;)m+=u;for(m-=u;this.isValid(m,g)&&this.image.get(m,g)===o;)g+=f;return g-=f,new Kt(m,g)}expandSquare(a,o,u){let f=u/(2*o),m=a[0].getX()-a[2].getX(),g=a[0].getY()-a[2].getY(),w=(a[0].getX()+a[2].getX())/2,b=(a[0].getY()+a[2].getY())/2,I=new ae(w+f*m,b+f*g),P=new ae(w-f*m,b-f*g);m=a[1].getX()-a[3].getX(),g=a[1].getY()-a[3].getY(),w=(a[1].getX()+a[3].getX())/2,b=(a[1].getY()+a[3].getY())/2;let V=new ae(w+f*m,b+f*g),z=new ae(w-f*m,b-f*g);return[I,V,P,z]}isValid(a,o){return a>=0&&a<this.image.getWidth()&&o>0&&o<this.image.getHeight()}isValidPoint(a){let o=st.round(a.getX()),u=st.round(a.getY());return this.isValid(o,u)}distancePoint(a,o){return st.distance(a.getX(),a.getY(),o.getX(),o.getY())}distanceResultPoint(a,o){return st.distance(a.getX(),a.getY(),o.getX(),o.getY())}getDimension(){return this.compact?4*this.nbLayers+11:this.nbLayers<=4?4*this.nbLayers+15:4*this.nbLayers+2*(U.truncDivision(this.nbLayers-4,8)+1)+15}}class Xt{decode(a,o=null){let u=null,f=new ar(a.getBlackMatrix()),m=null,g=null;try{let P=f.detectMirror(!1);m=P.getPoints(),this.reportFoundResultPoints(o,m),g=new Et().decode(P)}catch(P){u=P}if(g==null)try{let P=f.detectMirror(!0);m=P.getPoints(),this.reportFoundResultPoints(o,m),g=new Et().decode(P)}catch(P){throw u??P}let w=new pe(g.getText(),g.getRawBytes(),g.getNumBits(),m,fe.AZTEC,B.currentTimeMillis()),b=g.getByteSegments();b!=null&&w.putMetadata(Ve.BYTE_SEGMENTS,b);let I=g.getECLevel();return I!=null&&w.putMetadata(Ve.ERROR_CORRECTION_LEVEL,I),w}reportFoundResultPoints(a,o){if(a!=null){let u=a.get(Z.NEED_RESULT_POINT_CALLBACK);u!=null&&o.forEach((f,m,g)=>{u.foundPossibleResultPoint(f)})}}reset(){}}class xn extends rt{constructor(a=500){super(new Xt,a)}}class Mt{decode(a,o){try{return this.doDecode(a,o)}catch{if(o&&o.get(Z.TRY_HARDER)===!0&&a.isRotateSupported()){const m=a.rotateCounterClockwise(),g=this.doDecode(m,o),w=g.getResultMetadata();let b=270;w!==null&&w.get(Ve.ORIENTATION)===!0&&(b=b+w.get(Ve.ORIENTATION)%360),g.putMetadata(Ve.ORIENTATION,b);const I=g.getResultPoints();if(I!==null){const P=m.getHeight();for(let V=0;V<I.length;V++)I[V]=new ae(P-I[V].getY()-1,I[V].getX())}return g}else throw new te}}reset(){}doDecode(a,o){const u=a.getWidth(),f=a.getHeight();let m=new $(u);const g=o&&o.get(Z.TRY_HARDER)===!0,w=Math.max(1,f>>(g?8:5));let b;g?b=f:b=15;const I=Math.trunc(f/2);for(let P=0;P<b;P++){const V=Math.trunc((P+1)/2),z=(P&1)===0,Y=I+w*(z?V:-V);if(Y<0||Y>=f)break;try{m=a.getBlackRow(Y,m)}catch{continue}for(let ne=0;ne<2;ne++){if(ne===1&&(m.reverse(),o&&o.get(Z.NEED_RESULT_POINT_CALLBACK)===!0)){const re=new Map;o.forEach((de,ye)=>re.set(ye,de)),re.delete(Z.NEED_RESULT_POINT_CALLBACK),o=re}try{const re=this.decodeRow(Y,m,o);if(ne===1){re.putMetadata(Ve.ORIENTATION,180);const de=re.getResultPoints();de!==null&&(de[0]=new ae(u-de[0].getX()-1,de[0].getY()),de[1]=new ae(u-de[1].getX()-1,de[1].getY()))}return re}catch{}}}throw new te}static recordPattern(a,o,u){const f=u.length;for(let I=0;I<f;I++)u[I]=0;const m=a.getSize();if(o>=m)throw new te;let g=!a.get(o),w=0,b=o;for(;b<m;){if(a.get(b)!==g)u[w]++;else{if(++w===f)break;u[w]=1,g=!g}b++}if(!(w===f||w===f-1&&b===m))throw new te}static recordPatternInReverse(a,o,u){let f=u.length,m=a.get(o);for(;o>0&&f>=0;)a.get(--o)!==m&&(f--,m=!m);if(f>=0)throw new te;Mt.recordPattern(a,o+1,u)}static patternMatchVariance(a,o,u){const f=a.length;let m=0,g=0;for(let I=0;I<f;I++)m+=a[I],g+=o[I];if(m<g)return Number.POSITIVE_INFINITY;const w=m/g;u*=w;let b=0;for(let I=0;I<f;I++){const P=a[I],V=o[I]*w,z=P>V?P-V:V-P;if(z>u)return Number.POSITIVE_INFINITY;b+=z}return b/m}}class we extends Mt{static findStartPattern(a){const o=a.getSize(),u=a.getNextSet(0);let f=0,m=Int32Array.from([0,0,0,0,0,0]),g=u,w=!1;const b=6;for(let I=u;I<o;I++)if(a.get(I)!==w)m[f]++;else{if(f===b-1){let P=we.MAX_AVG_VARIANCE,V=-1;for(let z=we.CODE_START_A;z<=we.CODE_START_C;z++){const Y=Mt.patternMatchVariance(m,we.CODE_PATTERNS[z],we.MAX_INDIVIDUAL_VARIANCE);Y<P&&(P=Y,V=z)}if(V>=0&&a.isRange(Math.max(0,g-(I-g)/2),g,!1))return Int32Array.from([g,I,V]);g+=m[0]+m[1],m=m.slice(2,m.length-1),m[f-1]=0,m[f]=0,f--}else f++;m[f]=1,w=!w}throw new te}static decodeCode(a,o,u){Mt.recordPattern(a,u,o);let f=we.MAX_AVG_VARIANCE,m=-1;for(let g=0;g<we.CODE_PATTERNS.length;g++){const w=we.CODE_PATTERNS[g],b=this.patternMatchVariance(o,w,we.MAX_INDIVIDUAL_VARIANCE);b<f&&(f=b,m=g)}if(m>=0)return m;throw new te}decodeRow(a,o,u){const f=u&&u.get(Z.ASSUME_GS1)===!0,m=we.findStartPattern(o),g=m[2];let w=0;const b=new Uint8Array(20);b[w++]=g;let I;switch(g){case we.CODE_START_A:I=we.CODE_CODE_A;break;case we.CODE_START_B:I=we.CODE_CODE_B;break;case we.CODE_START_C:I=we.CODE_CODE_C;break;default:throw new A}let P=!1,V=!1,z="",Y=m[0],ne=m[1];const re=Int32Array.from([0,0,0,0,0,0]);let de=0,ye=0,Ue=g,ze=0,Me=!0,Tn=!1,mn=!1;for(;!P;){const hu=V;switch(V=!1,de=ye,ye=we.decodeCode(o,re,ne),b[w++]=ye,ye!==we.CODE_STOP&&(Me=!0),ye!==we.CODE_STOP&&(ze++,Ue+=ze*ye),Y=ne,ne+=re.reduce((wD,_D)=>wD+_D,0),ye){case we.CODE_START_A:case we.CODE_START_B:case we.CODE_START_C:throw new A}switch(I){case we.CODE_CODE_A:if(ye<64)mn===Tn?z+=String.fromCharCode(32+ye):z+=String.fromCharCode(32+ye+128),mn=!1;else if(ye<96)mn===Tn?z+=String.fromCharCode(ye-64):z+=String.fromCharCode(ye+64),mn=!1;else switch(ye!==we.CODE_STOP&&(Me=!1),ye){case we.CODE_FNC_1:f&&(z.length===0?z+="]C1":z+="");break;case we.CODE_FNC_2:case we.CODE_FNC_3:break;case we.CODE_FNC_4_A:!Tn&&mn?(Tn=!0,mn=!1):Tn&&mn?(Tn=!1,mn=!1):mn=!0;break;case we.CODE_SHIFT:V=!0,I=we.CODE_CODE_B;break;case we.CODE_CODE_B:I=we.CODE_CODE_B;break;case we.CODE_CODE_C:I=we.CODE_CODE_C;break;case we.CODE_STOP:P=!0;break}break;case we.CODE_CODE_B:if(ye<96)mn===Tn?z+=String.fromCharCode(32+ye):z+=String.fromCharCode(32+ye+128),mn=!1;else switch(ye!==we.CODE_STOP&&(Me=!1),ye){case we.CODE_FNC_1:f&&(z.length===0?z+="]C1":z+="");break;case we.CODE_FNC_2:case we.CODE_FNC_3:break;case we.CODE_FNC_4_B:!Tn&&mn?(Tn=!0,mn=!1):Tn&&mn?(Tn=!1,mn=!1):mn=!0;break;case we.CODE_SHIFT:V=!0,I=we.CODE_CODE_A;break;case we.CODE_CODE_A:I=we.CODE_CODE_A;break;case we.CODE_CODE_C:I=we.CODE_CODE_C;break;case we.CODE_STOP:P=!0;break}break;case we.CODE_CODE_C:if(ye<100)ye<10&&(z+="0"),z+=ye;else switch(ye!==we.CODE_STOP&&(Me=!1),ye){case we.CODE_FNC_1:f&&(z.length===0?z+="]C1":z+="");break;case we.CODE_CODE_A:I=we.CODE_CODE_A;break;case we.CODE_CODE_B:I=we.CODE_CODE_B;break;case we.CODE_STOP:P=!0;break}break}hu&&(I=I===we.CODE_CODE_A?we.CODE_CODE_B:we.CODE_CODE_A)}const Zs=ne-Y;if(ne=o.getNextUnset(ne),!o.isRange(ne,Math.min(o.getSize(),ne+(ne-Y)/2),!1))throw new te;if(Ue-=ze*de,Ue%103!==de)throw new k;const Xi=z.length;if(Xi===0)throw new te;Xi>0&&Me&&(I===we.CODE_CODE_C?z=z.substring(0,Xi-2):z=z.substring(0,Xi-1));const Js=(m[1]+m[0])/2,sr=Y+Zs/2,ms=b.length,wi=new Uint8Array(ms);for(let hu=0;hu<ms;hu++)wi[hu]=b[hu];const du=[new ae(Js,a),new ae(sr,a)];return new pe(z,wi,0,du,fe.CODE_128,new Date().getTime())}}we.CODE_PATTERNS=[Int32Array.from([2,1,2,2,2,2]),Int32Array.from([2,2,2,1,2,2]),Int32Array.from([2,2,2,2,2,1]),Int32Array.from([1,2,1,2,2,3]),Int32Array.from([1,2,1,3,2,2]),Int32Array.from([1,3,1,2,2,2]),Int32Array.from([1,2,2,2,1,3]),Int32Array.from([1,2,2,3,1,2]),Int32Array.from([1,3,2,2,1,2]),Int32Array.from([2,2,1,2,1,3]),Int32Array.from([2,2,1,3,1,2]),Int32Array.from([2,3,1,2,1,2]),Int32Array.from([1,1,2,2,3,2]),Int32Array.from([1,2,2,1,3,2]),Int32Array.from([1,2,2,2,3,1]),Int32Array.from([1,1,3,2,2,2]),Int32Array.from([1,2,3,1,2,2]),Int32Array.from([1,2,3,2,2,1]),Int32Array.from([2,2,3,2,1,1]),Int32Array.from([2,2,1,1,3,2]),Int32Array.from([2,2,1,2,3,1]),Int32Array.from([2,1,3,2,1,2]),Int32Array.from([2,2,3,1,1,2]),Int32Array.from([3,1,2,1,3,1]),Int32Array.from([3,1,1,2,2,2]),Int32Array.from([3,2,1,1,2,2]),Int32Array.from([3,2,1,2,2,1]),Int32Array.from([3,1,2,2,1,2]),Int32Array.from([3,2,2,1,1,2]),Int32Array.from([3,2,2,2,1,1]),Int32Array.from([2,1,2,1,2,3]),Int32Array.from([2,1,2,3,2,1]),Int32Array.from([2,3,2,1,2,1]),Int32Array.from([1,1,1,3,2,3]),Int32Array.from([1,3,1,1,2,3]),Int32Array.from([1,3,1,3,2,1]),Int32Array.from([1,1,2,3,1,3]),Int32Array.from([1,3,2,1,1,3]),Int32Array.from([1,3,2,3,1,1]),Int32Array.from([2,1,1,3,1,3]),Int32Array.from([2,3,1,1,1,3]),Int32Array.from([2,3,1,3,1,1]),Int32Array.from([1,1,2,1,3,3]),Int32Array.from([1,1,2,3,3,1]),Int32Array.from([1,3,2,1,3,1]),Int32Array.from([1,1,3,1,2,3]),Int32Array.from([1,1,3,3,2,1]),Int32Array.from([1,3,3,1,2,1]),Int32Array.from([3,1,3,1,2,1]),Int32Array.from([2,1,1,3,3,1]),Int32Array.from([2,3,1,1,3,1]),Int32Array.from([2,1,3,1,1,3]),Int32Array.from([2,1,3,3,1,1]),Int32Array.from([2,1,3,1,3,1]),Int32Array.from([3,1,1,1,2,3]),Int32Array.from([3,1,1,3,2,1]),Int32Array.from([3,3,1,1,2,1]),Int32Array.from([3,1,2,1,1,3]),Int32Array.from([3,1,2,3,1,1]),Int32Array.from([3,3,2,1,1,1]),Int32Array.from([3,1,4,1,1,1]),Int32Array.from([2,2,1,4,1,1]),Int32Array.from([4,3,1,1,1,1]),Int32Array.from([1,1,1,2,2,4]),Int32Array.from([1,1,1,4,2,2]),Int32Array.from([1,2,1,1,2,4]),Int32Array.from([1,2,1,4,2,1]),Int32Array.from([1,4,1,1,2,2]),Int32Array.from([1,4,1,2,2,1]),Int32Array.from([1,1,2,2,1,4]),Int32Array.from([1,1,2,4,1,2]),Int32Array.from([1,2,2,1,1,4]),Int32Array.from([1,2,2,4,1,1]),Int32Array.from([1,4,2,1,1,2]),Int32Array.from([1,4,2,2,1,1]),Int32Array.from([2,4,1,2,1,1]),Int32Array.from([2,2,1,1,1,4]),Int32Array.from([4,1,3,1,1,1]),Int32Array.from([2,4,1,1,1,2]),Int32Array.from([1,3,4,1,1,1]),Int32Array.from([1,1,1,2,4,2]),Int32Array.from([1,2,1,1,4,2]),Int32Array.from([1,2,1,2,4,1]),Int32Array.from([1,1,4,2,1,2]),Int32Array.from([1,2,4,1,1,2]),Int32Array.from([1,2,4,2,1,1]),Int32Array.from([4,1,1,2,1,2]),Int32Array.from([4,2,1,1,1,2]),Int32Array.from([4,2,1,2,1,1]),Int32Array.from([2,1,2,1,4,1]),Int32Array.from([2,1,4,1,2,1]),Int32Array.from([4,1,2,1,2,1]),Int32Array.from([1,1,1,1,4,3]),Int32Array.from([1,1,1,3,4,1]),Int32Array.from([1,3,1,1,4,1]),Int32Array.from([1,1,4,1,1,3]),Int32Array.from([1,1,4,3,1,1]),Int32Array.from([4,1,1,1,1,3]),Int32Array.from([4,1,1,3,1,1]),Int32Array.from([1,1,3,1,4,1]),Int32Array.from([1,1,4,1,3,1]),Int32Array.from([3,1,1,1,4,1]),Int32Array.from([4,1,1,1,3,1]),Int32Array.from([2,1,1,4,1,2]),Int32Array.from([2,1,1,2,1,4]),Int32Array.from([2,1,1,2,3,2]),Int32Array.from([2,3,3,1,1,1,2])],we.MAX_AVG_VARIANCE=.25,we.MAX_INDIVIDUAL_VARIANCE=.7,we.CODE_SHIFT=98,we.CODE_CODE_C=99,we.CODE_CODE_B=100,we.CODE_CODE_A=101,we.CODE_FNC_1=102,we.CODE_FNC_2=97,we.CODE_FNC_3=96,we.CODE_FNC_4_A=101,we.CODE_FNC_4_B=100,we.CODE_START_A=103,we.CODE_START_B=104,we.CODE_START_C=105,we.CODE_STOP=106;class Tt extends Mt{constructor(a=!1,o=!1){super(),this.usingCheckDigit=a,this.extendedMode=o,this.decodeRowResult="",this.counters=new Int32Array(9)}decodeRow(a,o,u){let f=this.counters;f.fill(0),this.decodeRowResult="";let m=Tt.findAsteriskPattern(o,f),g=o.getNextSet(m[1]),w=o.getSize(),b,I;do{Tt.recordPattern(o,g,f);let re=Tt.toNarrowWidePattern(f);if(re<0)throw new te;b=Tt.patternToChar(re),this.decodeRowResult+=b,I=g;for(let de of f)g+=de;g=o.getNextSet(g)}while(b!=="*");this.decodeRowResult=this.decodeRowResult.substring(0,this.decodeRowResult.length-1);let P=0;for(let re of f)P+=re;let V=g-I-P;if(g!==w&&V*2<P)throw new te;if(this.usingCheckDigit){let re=this.decodeRowResult.length-1,de=0;for(let ye=0;ye<re;ye++)de+=Tt.ALPHABET_STRING.indexOf(this.decodeRowResult.charAt(ye));if(this.decodeRowResult.charAt(re)!==Tt.ALPHABET_STRING.charAt(de%43))throw new k;this.decodeRowResult=this.decodeRowResult.substring(0,re)}if(this.decodeRowResult.length===0)throw new te;let z;this.extendedMode?z=Tt.decodeExtended(this.decodeRowResult):z=this.decodeRowResult;let Y=(m[1]+m[0])/2,ne=I+P/2;return new pe(z,null,0,[new ae(Y,a),new ae(ne,a)],fe.CODE_39,new Date().getTime())}static findAsteriskPattern(a,o){let u=a.getSize(),f=a.getNextSet(0),m=0,g=f,w=!1,b=o.length;for(let I=f;I<u;I++)if(a.get(I)!==w)o[m]++;else{if(m===b-1){if(this.toNarrowWidePattern(o)===Tt.ASTERISK_ENCODING&&a.isRange(Math.max(0,g-Math.floor((I-g)/2)),g,!1))return[g,I];g+=o[0]+o[1],o.copyWithin(0,2,2+m-1),o[m-1]=0,o[m]=0,m--}else m++;o[m]=1,w=!w}throw new te}static toNarrowWidePattern(a){let o=a.length,u=0,f;do{let m=2147483647;for(let b of a)b<m&&b>u&&(m=b);u=m,f=0;let g=0,w=0;for(let b=0;b<o;b++){let I=a[b];I>u&&(w|=1<<o-1-b,f++,g+=I)}if(f===3){for(let b=0;b<o&&f>0;b++){let I=a[b];if(I>u&&(f--,I*2>=g))return-1}return w}}while(f>3);return-1}static patternToChar(a){for(let o=0;o<Tt.CHARACTER_ENCODINGS.length;o++)if(Tt.CHARACTER_ENCODINGS[o]===a)return Tt.ALPHABET_STRING.charAt(o);if(a===Tt.ASTERISK_ENCODING)return"*";throw new te}static decodeExtended(a){let o=a.length,u="";for(let f=0;f<o;f++){let m=a.charAt(f);if(m==="+"||m==="$"||m==="%"||m==="/"){let g=a.charAt(f+1),w="\0";switch(m){case"+":if(g>="A"&&g<="Z")w=String.fromCharCode(g.charCodeAt(0)+32);else throw new A;break;case"$":if(g>="A"&&g<="Z")w=String.fromCharCode(g.charCodeAt(0)-64);else throw new A;break;case"%":if(g>="A"&&g<="E")w=String.fromCharCode(g.charCodeAt(0)-38);else if(g>="F"&&g<="J")w=String.fromCharCode(g.charCodeAt(0)-11);else if(g>="K"&&g<="O")w=String.fromCharCode(g.charCodeAt(0)+16);else if(g>="P"&&g<="T")w=String.fromCharCode(g.charCodeAt(0)+43);else if(g==="U")w="\0";else if(g==="V")w="@";else if(g==="W")w="`";else if(g==="X"||g==="Y"||g==="Z")w="";else throw new A;break;case"/":if(g>="A"&&g<="O")w=String.fromCharCode(g.charCodeAt(0)-32);else if(g==="Z")w=":";else throw new A;break}u+=w,f++}else u+=m}return u}}Tt.ALPHABET_STRING="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ-. $/+%",Tt.CHARACTER_ENCODINGS=[52,289,97,352,49,304,112,37,292,100,265,73,328,25,280,88,13,268,76,28,259,67,322,19,274,82,7,262,70,22,385,193,448,145,400,208,133,388,196,168,162,138,42],Tt.ASTERISK_ENCODING=148;class Rt extends Mt{constructor(){super(...arguments),this.narrowLineWidth=-1}decodeRow(a,o,u){let f=this.decodeStart(o),m=this.decodeEnd(o),g=new R;Rt.decodeMiddle(o,f[1],m[0],g);let w=g.toString(),b=null;u!=null&&(b=u.get(Z.ALLOWED_LENGTHS)),b==null&&(b=Rt.DEFAULT_ALLOWED_LENGTHS);let I=w.length,P=!1,V=0;for(let ne of b){if(I===ne){P=!0;break}ne>V&&(V=ne)}if(!P&&I>V&&(P=!0),!P)throw new A;const z=[new ae(f[1],a),new ae(m[0],a)];return new pe(w,null,0,z,fe.ITF,new Date().getTime())}static decodeMiddle(a,o,u,f){let m=new Int32Array(10),g=new Int32Array(5),w=new Int32Array(5);for(m.fill(0),g.fill(0),w.fill(0);o<u;){Mt.recordPattern(a,o,m);for(let I=0;I<5;I++){let P=2*I;g[I]=m[P],w[I]=m[P+1]}let b=Rt.decodeDigit(g);f.append(b.toString()),b=this.decodeDigit(w),f.append(b.toString()),m.forEach(function(I){o+=I})}}decodeStart(a){let o=Rt.skipWhiteSpace(a),u=Rt.findGuardPattern(a,o,Rt.START_PATTERN);return this.narrowLineWidth=(u[1]-u[0])/4,this.validateQuietZone(a,u[0]),u}validateQuietZone(a,o){let u=this.narrowLineWidth*10;u=u<o?u:o;for(let f=o-1;u>0&&f>=0&&!a.get(f);f--)u--;if(u!==0)throw new te}static skipWhiteSpace(a){const o=a.getSize(),u=a.getNextSet(0);if(u===o)throw new te;return u}decodeEnd(a){a.reverse();try{let o=Rt.skipWhiteSpace(a),u;try{u=Rt.findGuardPattern(a,o,Rt.END_PATTERN_REVERSED[0])}catch(m){m instanceof te&&(u=Rt.findGuardPattern(a,o,Rt.END_PATTERN_REVERSED[1]))}this.validateQuietZone(a,u[0]);let f=u[0];return u[0]=a.getSize()-u[1],u[1]=a.getSize()-f,u}finally{a.reverse()}}static findGuardPattern(a,o,u){let f=u.length,m=new Int32Array(f),g=a.getSize(),w=!1,b=0,I=o;m.fill(0);for(let P=o;P<g;P++)if(a.get(P)!==w)m[b]++;else{if(b===f-1){if(Mt.patternMatchVariance(m,u,Rt.MAX_INDIVIDUAL_VARIANCE)<Rt.MAX_AVG_VARIANCE)return[I,P];I+=m[0]+m[1],B.arraycopy(m,2,m,0,b-1),m[b-1]=0,m[b]=0,b--}else b++;m[b]=1,w=!w}throw new te}static decodeDigit(a){let o=Rt.MAX_AVG_VARIANCE,u=-1,f=Rt.PATTERNS.length;for(let m=0;m<f;m++){let g=Rt.PATTERNS[m],w=Mt.patternMatchVariance(a,g,Rt.MAX_INDIVIDUAL_VARIANCE);w<o?(o=w,u=m):w===o&&(u=-1)}if(u>=0)return u%10;throw new te}}Rt.PATTERNS=[Int32Array.from([1,1,2,2,1]),Int32Array.from([2,1,1,1,2]),Int32Array.from([1,2,1,1,2]),Int32Array.from([2,2,1,1,1]),Int32Array.from([1,1,2,1,2]),Int32Array.from([2,1,2,1,1]),Int32Array.from([1,2,2,1,1]),Int32Array.from([1,1,1,2,2]),Int32Array.from([2,1,1,2,1]),Int32Array.from([1,2,1,2,1]),Int32Array.from([1,1,3,3,1]),Int32Array.from([3,1,1,1,3]),Int32Array.from([1,3,1,1,3]),Int32Array.from([3,3,1,1,1]),Int32Array.from([1,1,3,1,3]),Int32Array.from([3,1,3,1,1]),Int32Array.from([1,3,3,1,1]),Int32Array.from([1,1,1,3,3]),Int32Array.from([3,1,1,3,1]),Int32Array.from([1,3,1,3,1])],Rt.MAX_AVG_VARIANCE=.38,Rt.MAX_INDIVIDUAL_VARIANCE=.5,Rt.DEFAULT_ALLOWED_LENGTHS=[6,8,10,12,14],Rt.START_PATTERN=Int32Array.from([1,1,1,1]),Rt.END_PATTERN_REVERSED=[Int32Array.from([1,1,2]),Int32Array.from([1,1,3])];class wt extends Mt{constructor(){super(...arguments),this.decodeRowStringBuffer=""}static findStartGuardPattern(a){let o=!1,u,f=0,m=Int32Array.from([0,0,0]);for(;!o;){m=Int32Array.from([0,0,0]),u=wt.findGuardPattern(a,f,!1,this.START_END_PATTERN,m);let g=u[0];f=u[1];let w=g-(f-g);w>=0&&(o=a.isRange(w,g,!1))}return u}static checkChecksum(a){return wt.checkStandardUPCEANChecksum(a)}static checkStandardUPCEANChecksum(a){let o=a.length;if(o===0)return!1;let u=parseInt(a.charAt(o-1),10);return wt.getStandardUPCEANChecksum(a.substring(0,o-1))===u}static getStandardUPCEANChecksum(a){let o=a.length,u=0;for(let f=o-1;f>=0;f-=2){let m=a.charAt(f).charCodeAt(0)-48;if(m<0||m>9)throw new A;u+=m}u*=3;for(let f=o-2;f>=0;f-=2){let m=a.charAt(f).charCodeAt(0)-48;if(m<0||m>9)throw new A;u+=m}return(1e3-u)%10}static decodeEnd(a,o){return wt.findGuardPattern(a,o,!1,wt.START_END_PATTERN,new Int32Array(wt.START_END_PATTERN.length).fill(0))}static findGuardPatternWithoutCounters(a,o,u,f){return this.findGuardPattern(a,o,u,f,new Int32Array(f.length))}static findGuardPattern(a,o,u,f,m){let g=a.getSize();o=u?a.getNextUnset(o):a.getNextSet(o);let w=0,b=o,I=f.length,P=u;for(let V=o;V<g;V++)if(a.get(V)!==P)m[w]++;else{if(w===I-1){if(Mt.patternMatchVariance(m,f,wt.MAX_INDIVIDUAL_VARIANCE)<wt.MAX_AVG_VARIANCE)return Int32Array.from([b,V]);b+=m[0]+m[1];let z=m.slice(2,m.length-1);for(let Y=0;Y<w-1;Y++)m[Y]=z[Y];m[w-1]=0,m[w]=0,w--}else w++;m[w]=1,P=!P}throw new te}static decodeDigit(a,o,u,f){this.recordPattern(a,u,o);let m=this.MAX_AVG_VARIANCE,g=-1,w=f.length;for(let b=0;b<w;b++){let I=f[b],P=Mt.patternMatchVariance(o,I,wt.MAX_INDIVIDUAL_VARIANCE);P<m&&(m=P,g=b)}if(g>=0)return g;throw new te}}wt.MAX_AVG_VARIANCE=.48,wt.MAX_INDIVIDUAL_VARIANCE=.7,wt.START_END_PATTERN=Int32Array.from([1,1,1]),wt.MIDDLE_PATTERN=Int32Array.from([1,1,1,1,1]),wt.END_PATTERN=Int32Array.from([1,1,1,1,1,1]),wt.L_PATTERNS=[Int32Array.from([3,2,1,1]),Int32Array.from([2,2,2,1]),Int32Array.from([2,1,2,2]),Int32Array.from([1,4,1,1]),Int32Array.from([1,1,3,2]),Int32Array.from([1,2,3,1]),Int32Array.from([1,1,1,4]),Int32Array.from([1,3,1,2]),Int32Array.from([1,2,1,3]),Int32Array.from([3,1,1,2])];class bt{constructor(){this.CHECK_DIGIT_ENCODINGS=[24,20,18,17,12,6,3,10,9,5],this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(a,o,u){let f=this.decodeRowStringBuffer,m=this.decodeMiddle(o,u,f),g=f.toString(),w=bt.parseExtensionString(g),b=[new ae((u[0]+u[1])/2,a),new ae(m,a)],I=new pe(g,null,0,b,fe.UPC_EAN_EXTENSION,new Date().getTime());return w!=null&&I.putAllMetadata(w),I}decodeMiddle(a,o,u){let f=this.decodeMiddleCounters;f[0]=0,f[1]=0,f[2]=0,f[3]=0;let m=a.getSize(),g=o[1],w=0;for(let I=0;I<5&&g<m;I++){let P=wt.decodeDigit(a,f,g,wt.L_AND_G_PATTERNS);u+=String.fromCharCode(48+P%10);for(let V of f)g+=V;P>=10&&(w|=1<<4-I),I!==4&&(g=a.getNextSet(g),g=a.getNextUnset(g))}if(u.length!==5)throw new te;let b=this.determineCheckDigit(w);if(bt.extensionChecksum(u.toString())!==b)throw new te;return g}static extensionChecksum(a){let o=a.length,u=0;for(let f=o-2;f>=0;f-=2)u+=a.charAt(f).charCodeAt(0)-48;u*=3;for(let f=o-1;f>=0;f-=2)u+=a.charAt(f).charCodeAt(0)-48;return u*=3,u%10}determineCheckDigit(a){for(let o=0;o<10;o++)if(a===this.CHECK_DIGIT_ENCODINGS[o])return o;throw new te}static parseExtensionString(a){if(a.length!==5)return null;let o=bt.parseExtension5String(a);return o==null?null:new Map([[Ve.SUGGESTED_PRICE,o]])}static parseExtension5String(a){let o;switch(a.charAt(0)){case"0":o="";break;case"5":o="$";break;case"9":switch(a){case"90000":return null;case"99991":return"0.00";case"99990":return"Used"}o="";break;default:o="";break}let u=parseInt(a.substring(1)),f=(u/100).toString(),m=u%100,g=m<10?"0"+m:m.toString();return o+f+"."+g}}class ce{constructor(){this.decodeMiddleCounters=Int32Array.from([0,0,0,0]),this.decodeRowStringBuffer=""}decodeRow(a,o,u){let f=this.decodeRowStringBuffer,m=this.decodeMiddle(o,u,f),g=f.toString(),w=ce.parseExtensionString(g),b=[new ae((u[0]+u[1])/2,a),new ae(m,a)],I=new pe(g,null,0,b,fe.UPC_EAN_EXTENSION,new Date().getTime());return w!=null&&I.putAllMetadata(w),I}decodeMiddle(a,o,u){let f=this.decodeMiddleCounters;f[0]=0,f[1]=0,f[2]=0,f[3]=0;let m=a.getSize(),g=o[1],w=0;for(let b=0;b<2&&g<m;b++){let I=wt.decodeDigit(a,f,g,wt.L_AND_G_PATTERNS);u+=String.fromCharCode(48+I%10);for(let P of f)g+=P;I>=10&&(w|=1<<1-b),b!==1&&(g=a.getNextSet(g),g=a.getNextUnset(g))}if(u.length!==2)throw new te;if(parseInt(u.toString())%4!==w)throw new te;return g}static parseExtensionString(a){return a.length!==2?null:new Map([[Ve.ISSUE_NUMBER,parseInt(a)]])}}class Ie{static decodeRow(a,o,u){let f=wt.findGuardPattern(o,u,!1,this.EXTENSION_START_PATTERN,new Int32Array(this.EXTENSION_START_PATTERN.length).fill(0));try{return new bt().decodeRow(a,o,f)}catch{return new ce().decodeRow(a,o,f)}}}Ie.EXTENSION_START_PATTERN=Int32Array.from([1,1,2]);class be extends wt{constructor(){super(),this.decodeRowStringBuffer="",be.L_AND_G_PATTERNS=be.L_PATTERNS.map(a=>Int32Array.from(a));for(let a=10;a<20;a++){let o=be.L_PATTERNS[a-10],u=new Int32Array(o.length);for(let f=0;f<o.length;f++)u[f]=o[o.length-f-1];be.L_AND_G_PATTERNS[a]=u}}decodeRow(a,o,u){let f=be.findStartGuardPattern(o),m=u==null?null:u.get(Z.NEED_RESULT_POINT_CALLBACK);if(m!=null){const Me=new ae((f[0]+f[1])/2,a);m.foundPossibleResultPoint(Me)}let g=this.decodeMiddle(o,f,this.decodeRowStringBuffer),w=g.rowOffset,b=g.resultString;if(m!=null){const Me=new ae(w,a);m.foundPossibleResultPoint(Me)}let I=this.decodeEnd(o,w);if(m!=null){const Me=new ae((I[0]+I[1])/2,a);m.foundPossibleResultPoint(Me)}let P=I[1],V=P+(P-I[0]);if(V>=o.getSize()||!o.isRange(P,V,!1))throw new te;let z=b.toString();if(z.length<8)throw new A;if(!be.checkChecksum(z))throw new k;let Y=(f[1]+f[0])/2,ne=(I[1]+I[0])/2,re=this.getBarcodeFormat(),de=[new ae(Y,a),new ae(ne,a)],ye=new pe(z,null,0,de,re,new Date().getTime()),Ue=0;try{let Me=Ie.decodeRow(a,o,I[1]);ye.putMetadata(Ve.UPC_EAN_EXTENSION,Me.getText()),ye.putAllMetadata(Me.getResultMetadata()),ye.addResultPoints(Me.getResultPoints()),Ue=Me.getText().length}catch{}let ze=u==null?null:u.get(Z.ALLOWED_EAN_EXTENSIONS);if(ze!=null){let Me=!1;for(let Tn in ze)if(Ue.toString()===Tn){Me=!0;break}if(!Me)throw new te}return ye}decodeEnd(a,o){return be.findGuardPattern(a,o,!1,be.START_END_PATTERN,new Int32Array(be.START_END_PATTERN.length).fill(0))}static checkChecksum(a){return be.checkStandardUPCEANChecksum(a)}static checkStandardUPCEANChecksum(a){let o=a.length;if(o===0)return!1;let u=parseInt(a.charAt(o-1),10);return be.getStandardUPCEANChecksum(a.substring(0,o-1))===u}static getStandardUPCEANChecksum(a){let o=a.length,u=0;for(let f=o-1;f>=0;f-=2){let m=a.charAt(f).charCodeAt(0)-48;if(m<0||m>9)throw new A;u+=m}u*=3;for(let f=o-2;f>=0;f-=2){let m=a.charAt(f).charCodeAt(0)-48;if(m<0||m>9)throw new A;u+=m}return(1e3-u)%10}}class Ce extends be{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(a,o,u){let f=this.decodeMiddleCounters;f[0]=0,f[1]=0,f[2]=0,f[3]=0;let m=a.getSize(),g=o[1],w=0;for(let I=0;I<6&&g<m;I++){let P=be.decodeDigit(a,f,g,be.L_AND_G_PATTERNS);u+=String.fromCharCode(48+P%10);for(let V of f)g+=V;P>=10&&(w|=1<<5-I)}u=Ce.determineFirstDigit(u,w),g=be.findGuardPattern(a,g,!0,be.MIDDLE_PATTERN,new Int32Array(be.MIDDLE_PATTERN.length).fill(0))[1];for(let I=0;I<6&&g<m;I++){let P=be.decodeDigit(a,f,g,be.L_PATTERNS);u+=String.fromCharCode(48+P);for(let V of f)g+=V}return{rowOffset:g,resultString:u}}getBarcodeFormat(){return fe.EAN_13}static determineFirstDigit(a,o){for(let u=0;u<10;u++)if(o===this.FIRST_DIGIT_ENCODINGS[u])return a=String.fromCharCode(48+u)+a,a;throw new te}}Ce.FIRST_DIGIT_ENCODINGS=[0,11,13,14,19,25,28,21,22,26];class it extends be{constructor(){super(),this.decodeMiddleCounters=Int32Array.from([0,0,0,0])}decodeMiddle(a,o,u){const f=this.decodeMiddleCounters;f[0]=0,f[1]=0,f[2]=0,f[3]=0;let m=a.getSize(),g=o[1];for(let b=0;b<4&&g<m;b++){let I=be.decodeDigit(a,f,g,be.L_PATTERNS);u+=String.fromCharCode(48+I);for(let P of f)g+=P}g=be.findGuardPattern(a,g,!0,be.MIDDLE_PATTERN,new Int32Array(be.MIDDLE_PATTERN.length).fill(0))[1];for(let b=0;b<4&&g<m;b++){let I=be.decodeDigit(a,f,g,be.L_PATTERNS);u+=String.fromCharCode(48+I);for(let P of f)g+=P}return{rowOffset:g,resultString:u}}getBarcodeFormat(){return fe.EAN_8}}class He extends be{constructor(){super(...arguments),this.ean13Reader=new Ce}getBarcodeFormat(){return fe.UPC_A}decode(a,o){return this.maybeReturnResult(this.ean13Reader.decode(a))}decodeRow(a,o,u){return this.maybeReturnResult(this.ean13Reader.decodeRow(a,o,u))}decodeMiddle(a,o,u){return this.ean13Reader.decodeMiddle(a,o,u)}maybeReturnResult(a){let o=a.getText();if(o.charAt(0)==="0"){let u=new pe(o.substring(1),null,null,a.getResultPoints(),fe.UPC_A);return a.getResultMetadata()!=null&&u.putAllMetadata(a.getResultMetadata()),u}else throw new te}reset(){this.ean13Reader.reset()}}class un extends be{constructor(){super(),this.decodeMiddleCounters=new Int32Array(4)}decodeMiddle(a,o,u){const f=this.decodeMiddleCounters.map(I=>I);f[0]=0,f[1]=0,f[2]=0,f[3]=0;const m=a.getSize();let g=o[1],w=0;for(let I=0;I<6&&g<m;I++){const P=un.decodeDigit(a,f,g,un.L_AND_G_PATTERNS);u+=String.fromCharCode(48+P%10);for(let V of f)g+=V;P>=10&&(w|=1<<5-I)}let b=un.determineNumSysAndCheckDigit(u,w);return{rowOffset:g,resultString:b}}decodeEnd(a,o){return un.findGuardPatternWithoutCounters(a,o,!0,un.MIDDLE_END_PATTERN)}checkChecksum(a){return be.checkChecksum(un.convertUPCEtoUPCA(a))}static determineNumSysAndCheckDigit(a,o){for(let u=0;u<=1;u++)for(let f=0;f<10;f++)if(o===this.NUMSYS_AND_CHECK_DIGIT_PATTERNS[u][f]){let m=String.fromCharCode(48+u),g=String.fromCharCode(48+f);return m+a+g}throw te.getNotFoundInstance()}getBarcodeFormat(){return fe.UPC_E}static convertUPCEtoUPCA(a){const o=a.slice(1,7).split("").map(m=>m.charCodeAt(0)),u=new R;u.append(a.charAt(0));let f=o[5];switch(f){case 0:case 1:case 2:u.appendChars(o,0,2),u.append(f),u.append("0000"),u.appendChars(o,2,3);break;case 3:u.appendChars(o,0,3),u.append("00000"),u.appendChars(o,3,2);break;case 4:u.appendChars(o,0,4),u.append("00000"),u.append(o[4]);break;default:u.appendChars(o,0,5),u.append("0000"),u.append(f);break}return a.length>=8&&u.append(a.charAt(7)),u.toString()}}un.MIDDLE_END_PATTERN=Int32Array.from([1,1,1,1,1,1]),un.NUMSYS_AND_CHECK_DIGIT_PATTERNS=[Int32Array.from([56,52,50,49,44,38,35,42,41,37]),Int32Array.from([7,11,13,14,19,25,28,21,22,26])];class wn extends Mt{constructor(a){super();let o=a==null?null:a.get(Z.POSSIBLE_FORMATS),u=[];r(o)?(u.push(new Ce),u.push(new He),u.push(new it),u.push(new un)):(o.indexOf(fe.EAN_13)>-1&&u.push(new Ce),o.indexOf(fe.UPC_A)>-1&&u.push(new He),o.indexOf(fe.EAN_8)>-1&&u.push(new it),o.indexOf(fe.UPC_E)>-1&&u.push(new un)),this.readers=u}decodeRow(a,o,u){for(let f of this.readers)try{const m=f.decodeRow(a,o,u),g=m.getBarcodeFormat()===fe.EAN_13&&m.getText().charAt(0)==="0",w=u==null?null:u.get(Z.POSSIBLE_FORMATS),b=w==null||w.includes(fe.UPC_A);if(g&&b){const I=m.getRawBytes(),P=new pe(m.getText().substring(1),I,I?I.length:null,m.getResultPoints(),fe.UPC_A);return P.putAllMetadata(m.getResultMetadata()),P}return m}catch{}throw new te}reset(){for(let a of this.readers)a.reset()}}class Bt extends Mt{constructor(){super(),this.decodeFinderCounters=new Int32Array(4),this.dataCharacterCounters=new Int32Array(8),this.oddRoundingErrors=new Array(4),this.evenRoundingErrors=new Array(4),this.oddCounts=new Array(this.dataCharacterCounters.length/2),this.evenCounts=new Array(this.dataCharacterCounters.length/2)}getDecodeFinderCounters(){return this.decodeFinderCounters}getDataCharacterCounters(){return this.dataCharacterCounters}getOddRoundingErrors(){return this.oddRoundingErrors}getEvenRoundingErrors(){return this.evenRoundingErrors}getOddCounts(){return this.oddCounts}getEvenCounts(){return this.evenCounts}parseFinderValue(a,o){for(let u=0;u<o.length;u++)if(Mt.patternMatchVariance(a,o[u],Bt.MAX_INDIVIDUAL_VARIANCE)<Bt.MAX_AVG_VARIANCE)return u;throw new te}static count(a){return st.sum(new Int32Array(a))}static increment(a,o){let u=0,f=o[0];for(let m=1;m<a.length;m++)o[m]>f&&(f=o[m],u=m);a[u]++}static decrement(a,o){let u=0,f=o[0];for(let m=1;m<a.length;m++)o[m]<f&&(f=o[m],u=m);a[u]--}static isFinderPattern(a){let o=a[0]+a[1],u=o+a[2]+a[3],f=o/u;if(f>=Bt.MIN_FINDER_PATTERN_RATIO&&f<=Bt.MAX_FINDER_PATTERN_RATIO){let m=Number.MAX_SAFE_INTEGER,g=Number.MIN_SAFE_INTEGER;for(let w of a)w>g&&(g=w),w<m&&(m=w);return g<10*m}return!1}}Bt.MAX_AVG_VARIANCE=.2,Bt.MAX_INDIVIDUAL_VARIANCE=.45,Bt.MIN_FINDER_PATTERN_RATIO=9.5/12,Bt.MAX_FINDER_PATTERN_RATIO=12.5/14;class Ht{constructor(a,o){this.value=a,this.checksumPortion=o}getValue(){return this.value}getChecksumPortion(){return this.checksumPortion}toString(){return this.value+"("+this.checksumPortion+")"}equals(a){if(!(a instanceof Ht))return!1;const o=a;return this.value===o.value&&this.checksumPortion===o.checksumPortion}hashCode(){return this.value^this.checksumPortion}}class Rn{constructor(a,o,u,f,m){this.value=a,this.startEnd=o,this.value=a,this.startEnd=o,this.resultPoints=new Array,this.resultPoints.push(new ae(u,m)),this.resultPoints.push(new ae(f,m))}getValue(){return this.value}getStartEnd(){return this.startEnd}getResultPoints(){return this.resultPoints}equals(a){if(!(a instanceof Rn))return!1;const o=a;return this.value===o.value}hashCode(){return this.value}}class nt{constructor(){}static getRSSvalue(a,o,u){let f=0;for(let b of a)f+=b;let m=0,g=0,w=a.length;for(let b=0;b<w-1;b++){let I;for(I=1,g|=1<<b;I<a[b];I++,g&=~(1<<b)){let P=nt.combins(f-I-1,w-b-2);if(u&&g===0&&f-I-(w-b-1)>=w-b-1&&(P-=nt.combins(f-I-(w-b),w-b-2)),w-b-1>1){let V=0;for(let z=f-I-(w-b-2);z>o;z--)V+=nt.combins(f-I-z-1,w-b-3);P-=V*(w-1-b)}else f-I>o&&P--;m+=P}f-=I}return m}static combins(a,o){let u,f;a-o>o?(f=o,u=a-o):(f=a-o,u=o);let m=1,g=1;for(let w=a;w>u;w--)m*=w,g<=f&&(m/=g,g++);for(;g<=f;)m/=g,g++;return m}}class ee{static buildBitArray(a){let o=a.length*2-1;a[a.length-1].getRightChar()==null&&(o-=1);let u=12*o,f=new $(u),m=0,w=a[0].getRightChar().getValue();for(let b=11;b>=0;--b)w&1<<b&&f.set(m),m++;for(let b=1;b<a.length;++b){let I=a[b],P=I.getLeftChar().getValue();for(let V=11;V>=0;--V)P&1<<V&&f.set(m),m++;if(I.getRightChar()!=null){let V=I.getRightChar().getValue();for(let z=11;z>=0;--z)V&1<<z&&f.set(m),m++}}return f}}class J{constructor(a,o){o?this.decodedInformation=null:(this.finished=a,this.decodedInformation=o)}getDecodedInformation(){return this.decodedInformation}isFinished(){return this.finished}}class oe{constructor(a){this.newPosition=a}getNewPosition(){return this.newPosition}}class _e extends oe{constructor(a,o){super(a),this.value=o}getValue(){return this.value}isFNC1(){return this.value===_e.FNC1}}_e.FNC1="$";class Se extends oe{constructor(a,o,u){super(a),u?(this.remaining=!0,this.remainingValue=this.remainingValue):(this.remaining=!1,this.remainingValue=0),this.newString=o}getNewString(){return this.newString}isRemaining(){return this.remaining}getRemainingValue(){return this.remainingValue}}class $e extends oe{constructor(a,o,u){if(super(a),o<0||o>10||u<0||u>10)throw new A;this.firstDigit=o,this.secondDigit=u}getFirstDigit(){return this.firstDigit}getSecondDigit(){return this.secondDigit}getValue(){return this.firstDigit*10+this.secondDigit}isFirstDigitFNC1(){return this.firstDigit===$e.FNC1}isSecondDigitFNC1(){return this.secondDigit===$e.FNC1}isAnyFNC1(){return this.firstDigit===$e.FNC1||this.secondDigit===$e.FNC1}}$e.FNC1=10;class ge{constructor(){}static parseFieldsInGeneralPurpose(a){if(!a)return null;if(a.length<2)throw new te;let o=a.substring(0,2);for(let m of ge.TWO_DIGIT_DATA_LENGTH)if(m[0]===o)return m[1]===ge.VARIABLE_LENGTH?ge.processVariableAI(2,m[2],a):ge.processFixedAI(2,m[1],a);if(a.length<3)throw new te;let u=a.substring(0,3);for(let m of ge.THREE_DIGIT_DATA_LENGTH)if(m[0]===u)return m[1]===ge.VARIABLE_LENGTH?ge.processVariableAI(3,m[2],a):ge.processFixedAI(3,m[1],a);for(let m of ge.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH)if(m[0]===u)return m[1]===ge.VARIABLE_LENGTH?ge.processVariableAI(4,m[2],a):ge.processFixedAI(4,m[1],a);if(a.length<4)throw new te;let f=a.substring(0,4);for(let m of ge.FOUR_DIGIT_DATA_LENGTH)if(m[0]===f)return m[1]===ge.VARIABLE_LENGTH?ge.processVariableAI(4,m[2],a):ge.processFixedAI(4,m[1],a);throw new te}static processFixedAI(a,o,u){if(u.length<a)throw new te;let f=u.substring(0,a);if(u.length<a+o)throw new te;let m=u.substring(a,a+o),g=u.substring(a+o),w="("+f+")"+m,b=ge.parseFieldsInGeneralPurpose(g);return b==null?w:w+b}static processVariableAI(a,o,u){let f=u.substring(0,a),m;u.length<a+o?m=u.length:m=a+o;let g=u.substring(a,m),w=u.substring(m),b="("+f+")"+g,I=ge.parseFieldsInGeneralPurpose(w);return I==null?b:b+I}}ge.VARIABLE_LENGTH=[],ge.TWO_DIGIT_DATA_LENGTH=[["00",18],["01",14],["02",14],["10",ge.VARIABLE_LENGTH,20],["11",6],["12",6],["13",6],["15",6],["17",6],["20",2],["21",ge.VARIABLE_LENGTH,20],["22",ge.VARIABLE_LENGTH,29],["30",ge.VARIABLE_LENGTH,8],["37",ge.VARIABLE_LENGTH,8],["90",ge.VARIABLE_LENGTH,30],["91",ge.VARIABLE_LENGTH,30],["92",ge.VARIABLE_LENGTH,30],["93",ge.VARIABLE_LENGTH,30],["94",ge.VARIABLE_LENGTH,30],["95",ge.VARIABLE_LENGTH,30],["96",ge.VARIABLE_LENGTH,30],["97",ge.VARIABLE_LENGTH,3],["98",ge.VARIABLE_LENGTH,30],["99",ge.VARIABLE_LENGTH,30]],ge.THREE_DIGIT_DATA_LENGTH=[["240",ge.VARIABLE_LENGTH,30],["241",ge.VARIABLE_LENGTH,30],["242",ge.VARIABLE_LENGTH,6],["250",ge.VARIABLE_LENGTH,30],["251",ge.VARIABLE_LENGTH,30],["253",ge.VARIABLE_LENGTH,17],["254",ge.VARIABLE_LENGTH,20],["400",ge.VARIABLE_LENGTH,30],["401",ge.VARIABLE_LENGTH,30],["402",17],["403",ge.VARIABLE_LENGTH,30],["410",13],["411",13],["412",13],["413",13],["414",13],["420",ge.VARIABLE_LENGTH,20],["421",ge.VARIABLE_LENGTH,15],["422",3],["423",ge.VARIABLE_LENGTH,15],["424",3],["425",3],["426",3]],ge.THREE_DIGIT_PLUS_DIGIT_DATA_LENGTH=[["310",6],["311",6],["312",6],["313",6],["314",6],["315",6],["316",6],["320",6],["321",6],["322",6],["323",6],["324",6],["325",6],["326",6],["327",6],["328",6],["329",6],["330",6],["331",6],["332",6],["333",6],["334",6],["335",6],["336",6],["340",6],["341",6],["342",6],["343",6],["344",6],["345",6],["346",6],["347",6],["348",6],["349",6],["350",6],["351",6],["352",6],["353",6],["354",6],["355",6],["356",6],["357",6],["360",6],["361",6],["362",6],["363",6],["364",6],["365",6],["366",6],["367",6],["368",6],["369",6],["390",ge.VARIABLE_LENGTH,15],["391",ge.VARIABLE_LENGTH,18],["392",ge.VARIABLE_LENGTH,15],["393",ge.VARIABLE_LENGTH,18],["703",ge.VARIABLE_LENGTH,30]],ge.FOUR_DIGIT_DATA_LENGTH=[["7001",13],["7002",ge.VARIABLE_LENGTH,30],["7003",10],["8001",14],["8002",ge.VARIABLE_LENGTH,20],["8003",ge.VARIABLE_LENGTH,30],["8004",ge.VARIABLE_LENGTH,30],["8005",6],["8006",18],["8007",ge.VARIABLE_LENGTH,30],["8008",ge.VARIABLE_LENGTH,12],["8018",18],["8020",ge.VARIABLE_LENGTH,25],["8100",6],["8101",10],["8102",2],["8110",ge.VARIABLE_LENGTH,70],["8200",ge.VARIABLE_LENGTH,70]];class Ye{constructor(a){this.buffer=new R,this.information=a}decodeAllCodes(a,o){let u=o,f=null;do{let m=this.decodeGeneralPurposeField(u,f),g=ge.parseFieldsInGeneralPurpose(m.getNewString());if(g!=null&&a.append(g),m.isRemaining()?f=""+m.getRemainingValue():f=null,u===m.getNewPosition())break;u=m.getNewPosition()}while(!0);return a.toString()}isStillNumeric(a){if(a+7>this.information.getSize())return a+4<=this.information.getSize();for(let o=a;o<a+3;++o)if(this.information.get(o))return!0;return this.information.get(a+3)}decodeNumeric(a){if(a+7>this.information.getSize()){let m=this.extractNumericValueFromBitArray(a,4);return m===0?new $e(this.information.getSize(),$e.FNC1,$e.FNC1):new $e(this.information.getSize(),m-1,$e.FNC1)}let o=this.extractNumericValueFromBitArray(a,7),u=(o-8)/11,f=(o-8)%11;return new $e(a+7,u,f)}extractNumericValueFromBitArray(a,o){return Ye.extractNumericValueFromBitArray(this.information,a,o)}static extractNumericValueFromBitArray(a,o,u){let f=0;for(let m=0;m<u;++m)a.get(o+m)&&(f|=1<<u-m-1);return f}decodeGeneralPurposeField(a,o){this.buffer.setLengthToZero(),o!=null&&this.buffer.append(o),this.current.setPosition(a);let u=this.parseBlocks();return u!=null&&u.isRemaining()?new Se(this.current.getPosition(),this.buffer.toString(),u.getRemainingValue()):new Se(this.current.getPosition(),this.buffer.toString())}parseBlocks(){let a,o;do{let u=this.current.getPosition();if(this.current.isAlpha()?(o=this.parseAlphaBlock(),a=o.isFinished()):this.current.isIsoIec646()?(o=this.parseIsoIec646Block(),a=o.isFinished()):(o=this.parseNumericBlock(),a=o.isFinished()),!(u!==this.current.getPosition())&&!a)break}while(!a);return o.getDecodedInformation()}parseNumericBlock(){for(;this.isStillNumeric(this.current.getPosition());){let a=this.decodeNumeric(this.current.getPosition());if(this.current.setPosition(a.getNewPosition()),a.isFirstDigitFNC1()){let o;return a.isSecondDigitFNC1()?o=new Se(this.current.getPosition(),this.buffer.toString()):o=new Se(this.current.getPosition(),this.buffer.toString(),a.getSecondDigit()),new J(!0,o)}if(this.buffer.append(a.getFirstDigit()),a.isSecondDigitFNC1()){let o=new Se(this.current.getPosition(),this.buffer.toString());return new J(!0,o)}this.buffer.append(a.getSecondDigit())}return this.isNumericToAlphaNumericLatch(this.current.getPosition())&&(this.current.setAlpha(),this.current.incrementPosition(4)),new J(!1)}parseIsoIec646Block(){for(;this.isStillIsoIec646(this.current.getPosition());){let a=this.decodeIsoIec646(this.current.getPosition());if(this.current.setPosition(a.getNewPosition()),a.isFNC1()){let o=new Se(this.current.getPosition(),this.buffer.toString());return new J(!0,o)}this.buffer.append(a.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setAlpha()),new J(!1)}parseAlphaBlock(){for(;this.isStillAlpha(this.current.getPosition());){let a=this.decodeAlphanumeric(this.current.getPosition());if(this.current.setPosition(a.getNewPosition()),a.isFNC1()){let o=new Se(this.current.getPosition(),this.buffer.toString());return new J(!0,o)}this.buffer.append(a.getValue())}return this.isAlphaOr646ToNumericLatch(this.current.getPosition())?(this.current.incrementPosition(3),this.current.setNumeric()):this.isAlphaTo646ToAlphaLatch(this.current.getPosition())&&(this.current.getPosition()+5<this.information.getSize()?this.current.incrementPosition(5):this.current.setPosition(this.information.getSize()),this.current.setIsoIec646()),new J(!1)}isStillIsoIec646(a){if(a+5>this.information.getSize())return!1;let o=this.extractNumericValueFromBitArray(a,5);if(o>=5&&o<16)return!0;if(a+7>this.information.getSize())return!1;let u=this.extractNumericValueFromBitArray(a,7);if(u>=64&&u<116)return!0;if(a+8>this.information.getSize())return!1;let f=this.extractNumericValueFromBitArray(a,8);return f>=232&&f<253}decodeIsoIec646(a){let o=this.extractNumericValueFromBitArray(a,5);if(o===15)return new _e(a+5,_e.FNC1);if(o>=5&&o<15)return new _e(a+5,"0"+(o-5));let u=this.extractNumericValueFromBitArray(a,7);if(u>=64&&u<90)return new _e(a+7,""+(u+1));if(u>=90&&u<116)return new _e(a+7,""+(u+7));let f=this.extractNumericValueFromBitArray(a,8),m;switch(f){case 232:m="!";break;case 233:m='"';break;case 234:m="%";break;case 235:m="&";break;case 236:m="'";break;case 237:m="(";break;case 238:m=")";break;case 239:m="*";break;case 240:m="+";break;case 241:m=",";break;case 242:m="-";break;case 243:m=".";break;case 244:m="/";break;case 245:m=":";break;case 246:m=";";break;case 247:m="<";break;case 248:m="=";break;case 249:m=">";break;case 250:m="?";break;case 251:m="_";break;case 252:m=" ";break;default:throw new A}return new _e(a+8,m)}isStillAlpha(a){if(a+5>this.information.getSize())return!1;let o=this.extractNumericValueFromBitArray(a,5);if(o>=5&&o<16)return!0;if(a+6>this.information.getSize())return!1;let u=this.extractNumericValueFromBitArray(a,6);return u>=16&&u<63}decodeAlphanumeric(a){let o=this.extractNumericValueFromBitArray(a,5);if(o===15)return new _e(a+5,_e.FNC1);if(o>=5&&o<15)return new _e(a+5,"0"+(o-5));let u=this.extractNumericValueFromBitArray(a,6);if(u>=32&&u<58)return new _e(a+6,""+(u+33));let f;switch(u){case 58:f="*";break;case 59:f=",";break;case 60:f="-";break;case 61:f=".";break;case 62:f="/";break;default:throw new Oe("Decoding invalid alphanumeric value: "+u)}return new _e(a+6,f)}isAlphaTo646ToAlphaLatch(a){if(a+1>this.information.getSize())return!1;for(let o=0;o<5&&o+a<this.information.getSize();++o)if(o===2){if(!this.information.get(a+2))return!1}else if(this.information.get(a+o))return!1;return!0}isAlphaOr646ToNumericLatch(a){if(a+3>this.information.getSize())return!1;for(let o=a;o<a+3;++o)if(this.information.get(o))return!1;return!0}isNumericToAlphaNumericLatch(a){if(a+1>this.information.getSize())return!1;for(let o=0;o<4&&o+a<this.information.getSize();++o)if(this.information.get(a+o))return!1;return!0}}class Ze{constructor(a){this.information=a,this.generalDecoder=new Ye(a)}getInformation(){return this.information}getGeneralDecoder(){return this.generalDecoder}}class Fe extends Ze{constructor(a){super(a)}encodeCompressedGtin(a,o){a.append("(01)");let u=a.length();a.append("9"),this.encodeCompressedGtinWithoutAI(a,o,u)}encodeCompressedGtinWithoutAI(a,o,u){for(let f=0;f<4;++f){let m=this.getGeneralDecoder().extractNumericValueFromBitArray(o+10*f,10);m/100===0&&a.append("0"),m/10===0&&a.append("0"),a.append(m)}Fe.appendCheckDigit(a,u)}static appendCheckDigit(a,o){let u=0;for(let f=0;f<13;f++){let m=a.charAt(f+o).charCodeAt(0)-48;u+=f&1?m:3*m}u=10-u%10,u===10&&(u=0),a.append(u)}}Fe.GTIN_SIZE=40;class Je extends Fe{constructor(a){super(a)}parseInformation(){let a=new R;a.append("(01)");let o=a.length(),u=this.getGeneralDecoder().extractNumericValueFromBitArray(Je.HEADER_SIZE,4);return a.append(u),this.encodeCompressedGtinWithoutAI(a,Je.HEADER_SIZE+4,o),this.getGeneralDecoder().decodeAllCodes(a,Je.HEADER_SIZE+44)}}Je.HEADER_SIZE=4;class Ct extends Ze{constructor(a){super(a)}parseInformation(){let a=new R;return this.getGeneralDecoder().decodeAllCodes(a,Ct.HEADER_SIZE)}}Ct.HEADER_SIZE=5;class St extends Fe{constructor(a){super(a)}encodeCompressedWeight(a,o,u){let f=this.getGeneralDecoder().extractNumericValueFromBitArray(o,u);this.addWeightCode(a,f);let m=this.checkWeight(f),g=1e5;for(let w=0;w<5;++w)m/g===0&&a.append("0"),g/=10;a.append(m)}}class lt extends St{constructor(a){super(a)}parseInformation(){if(this.getInformation().getSize()!=lt.HEADER_SIZE+St.GTIN_SIZE+lt.WEIGHT_SIZE)throw new te;let a=new R;return this.encodeCompressedGtin(a,lt.HEADER_SIZE),this.encodeCompressedWeight(a,lt.HEADER_SIZE+St.GTIN_SIZE,lt.WEIGHT_SIZE),a.toString()}}lt.HEADER_SIZE=5,lt.WEIGHT_SIZE=15;class xt extends lt{constructor(a){super(a)}addWeightCode(a,o){a.append("(3103)")}checkWeight(a){return a}}class Wt extends lt{constructor(a){super(a)}addWeightCode(a,o){o<1e4?a.append("(3202)"):a.append("(3203)")}checkWeight(a){return a<1e4?a:a-1e4}}class Pt extends Fe{constructor(a){super(a)}parseInformation(){if(this.getInformation().getSize()<Pt.HEADER_SIZE+Fe.GTIN_SIZE)throw new te;let a=new R;this.encodeCompressedGtin(a,Pt.HEADER_SIZE);let o=this.getGeneralDecoder().extractNumericValueFromBitArray(Pt.HEADER_SIZE+Fe.GTIN_SIZE,Pt.LAST_DIGIT_SIZE);a.append("(392"),a.append(o),a.append(")");let u=this.getGeneralDecoder().decodeGeneralPurposeField(Pt.HEADER_SIZE+Fe.GTIN_SIZE+Pt.LAST_DIGIT_SIZE,null);return a.append(u.getNewString()),a.toString()}}Pt.HEADER_SIZE=8,Pt.LAST_DIGIT_SIZE=2;class bn extends Fe{constructor(a){super(a)}parseInformation(){if(this.getInformation().getSize()<bn.HEADER_SIZE+Fe.GTIN_SIZE)throw new te;let a=new R;this.encodeCompressedGtin(a,bn.HEADER_SIZE);let o=this.getGeneralDecoder().extractNumericValueFromBitArray(bn.HEADER_SIZE+Fe.GTIN_SIZE,bn.LAST_DIGIT_SIZE);a.append("(393"),a.append(o),a.append(")");let u=this.getGeneralDecoder().extractNumericValueFromBitArray(bn.HEADER_SIZE+Fe.GTIN_SIZE+bn.LAST_DIGIT_SIZE,bn.FIRST_THREE_DIGITS_SIZE);u/100==0&&a.append("0"),u/10==0&&a.append("0"),a.append(u);let f=this.getGeneralDecoder().decodeGeneralPurposeField(bn.HEADER_SIZE+Fe.GTIN_SIZE+bn.LAST_DIGIT_SIZE+bn.FIRST_THREE_DIGITS_SIZE,null);return a.append(f.getNewString()),a.toString()}}bn.HEADER_SIZE=8,bn.LAST_DIGIT_SIZE=2,bn.FIRST_THREE_DIGITS_SIZE=10;class hn extends St{constructor(a,o,u){super(a),this.dateCode=u,this.firstAIdigits=o}parseInformation(){if(this.getInformation().getSize()!=hn.HEADER_SIZE+hn.GTIN_SIZE+hn.WEIGHT_SIZE+hn.DATE_SIZE)throw new te;let a=new R;return this.encodeCompressedGtin(a,hn.HEADER_SIZE),this.encodeCompressedWeight(a,hn.HEADER_SIZE+hn.GTIN_SIZE,hn.WEIGHT_SIZE),this.encodeCompressedDate(a,hn.HEADER_SIZE+hn.GTIN_SIZE+hn.WEIGHT_SIZE),a.toString()}encodeCompressedDate(a,o){let u=this.getGeneralDecoder().extractNumericValueFromBitArray(o,hn.DATE_SIZE);if(u==38400)return;a.append("("),a.append(this.dateCode),a.append(")");let f=u%32;u/=32;let m=u%12+1;u/=12;let g=u;g/10==0&&a.append("0"),a.append(g),m/10==0&&a.append("0"),a.append(m),f/10==0&&a.append("0"),a.append(f)}addWeightCode(a,o){a.append("("),a.append(this.firstAIdigits),a.append(o/1e5),a.append(")")}checkWeight(a){return a%1e5}}hn.HEADER_SIZE=8,hn.WEIGHT_SIZE=20,hn.DATE_SIZE=16;function Er(j){try{if(j.get(1))return new Je(j);if(!j.get(2))return new Ct(j);switch(Ye.extractNumericValueFromBitArray(j,1,4)){case 4:return new xt(j);case 5:return new Wt(j)}switch(Ye.extractNumericValueFromBitArray(j,1,5)){case 12:return new Pt(j);case 13:return new bn(j)}switch(Ye.extractNumericValueFromBitArray(j,1,7)){case 56:return new hn(j,"310","11");case 57:return new hn(j,"320","11");case 58:return new hn(j,"310","13");case 59:return new hn(j,"320","13");case 60:return new hn(j,"310","15");case 61:return new hn(j,"320","15");case 62:return new hn(j,"310","17");case 63:return new hn(j,"320","17")}}catch(a){throw console.log(a),new Oe("unknown decoder: "+j)}}class vn{constructor(a,o,u,f){this.leftchar=a,this.rightchar=o,this.finderpattern=u,this.maybeLast=f}mayBeLast(){return this.maybeLast}getLeftChar(){return this.leftchar}getRightChar(){return this.rightchar}getFinderPattern(){return this.finderpattern}mustBeLast(){return this.rightchar==null}toString(){return"[ "+this.leftchar+", "+this.rightchar+" : "+(this.finderpattern==null?"null":this.finderpattern.getValue())+" ]"}static equals(a,o){return a instanceof vn?vn.equalsOrNull(a.leftchar,o.leftchar)&&vn.equalsOrNull(a.rightchar,o.rightchar)&&vn.equalsOrNull(a.finderpattern,o.finderpattern):!1}static equalsOrNull(a,o){return a===null?o===null:vn.equals(a,o)}hashCode(){return this.leftchar.getValue()^this.rightchar.getValue()^this.finderpattern.getValue()}}class Qr{constructor(a,o,u){this.pairs=a,this.rowNumber=o,this.wasReversed=u}getPairs(){return this.pairs}getRowNumber(){return this.rowNumber}isReversed(){return this.wasReversed}isEquivalent(a){return this.checkEqualitity(this,a)}toString(){return"{ "+this.pairs+" }"}equals(a,o){return a instanceof Qr?this.checkEqualitity(a,o)&&a.wasReversed===o.wasReversed:!1}checkEqualitity(a,o){if(!a||!o)return;let u;return a.forEach((f,m)=>{o.forEach(g=>{f.getLeftChar().getValue()===g.getLeftChar().getValue()&&f.getRightChar().getValue()===g.getRightChar().getValue()&&f.getFinderPatter().getValue()===g.getFinderPatter().getValue()&&(u=!0)})}),u}}class Ae extends Bt{constructor(a){super(...arguments),this.pairs=new Array(Ae.MAX_PAIRS),this.rows=new Array,this.startEnd=[2],this.verbose=a===!0}decodeRow(a,o,u){this.pairs.length=0,this.startFromEven=!1;try{return Ae.constructResult(this.decodeRow2pairs(a,o))}catch(f){this.verbose&&console.log(f)}return this.pairs.length=0,this.startFromEven=!0,Ae.constructResult(this.decodeRow2pairs(a,o))}reset(){this.pairs.length=0,this.rows.length=0}decodeRow2pairs(a,o){let u=!1;for(;!u;)try{this.pairs.push(this.retrieveNextPair(o,this.pairs,a))}catch(m){if(m instanceof te){if(!this.pairs.length)throw new te;u=!0}}if(this.checkChecksum())return this.pairs;let f;if(this.rows.length?f=!0:f=!1,this.storeRow(a,!1),f){let m=this.checkRowsBoolean(!1);if(m!=null||(m=this.checkRowsBoolean(!0),m!=null))return m}throw new te}checkRowsBoolean(a){if(this.rows.length>25)return this.rows.length=0,null;this.pairs.length=0,a&&(this.rows=this.rows.reverse());let o=null;try{o=this.checkRows(new Array,0)}catch(u){this.verbose&&console.log(u)}return a&&(this.rows=this.rows.reverse()),o}checkRows(a,o){for(let u=o;u<this.rows.length;u++){let f=this.rows[u];this.pairs.length=0;for(let g of a)this.pairs.push(g.getPairs());if(this.pairs.push(f.getPairs()),!Ae.isValidSequence(this.pairs))continue;if(this.checkChecksum())return this.pairs;let m=new Array(a);m.push(f);try{return this.checkRows(m,u+1)}catch(g){this.verbose&&console.log(g)}}throw new te}static isValidSequence(a){for(let o of Ae.FINDER_PATTERN_SEQUENCES){if(a.length>o.length)continue;let u=!0;for(let f=0;f<a.length;f++)if(a[f].getFinderPattern().getValue()!=o[f]){u=!1;break}if(u)return!0}return!1}storeRow(a,o){let u=0,f=!1,m=!1;for(;u<this.rows.length;){let g=this.rows[u];if(g.getRowNumber()>a){m=g.isEquivalent(this.pairs);break}f=g.isEquivalent(this.pairs),u++}m||f||Ae.isPartialRow(this.pairs,this.rows)||(this.rows.push(u,new Qr(this.pairs,a,o)),this.removePartialRows(this.pairs,this.rows))}removePartialRows(a,o){for(let u of o)if(u.getPairs().length!==a.length){for(let f of u.getPairs())for(let m of a)if(vn.equals(f,m))break}}static isPartialRow(a,o){for(let u of o){let f=!0;for(let m of a){let g=!1;for(let w of u.getPairs())if(m.equals(w)){g=!0;break}if(!g){f=!1;break}}if(f)return!0}return!1}getRows(){return this.rows}static constructResult(a){let o=ee.buildBitArray(a),f=Er(o).parseInformation(),m=a[0].getFinderPattern().getResultPoints(),g=a[a.length-1].getFinderPattern().getResultPoints(),w=[m[0],m[1],g[0],g[1]];return new pe(f,null,null,w,fe.RSS_EXPANDED,null)}checkChecksum(){let a=this.pairs.get(0),o=a.getLeftChar(),u=a.getRightChar();if(u==null)return!1;let f=u.getChecksumPortion(),m=2;for(let w=1;w<this.pairs.size();++w){let b=this.pairs.get(w);f+=b.getLeftChar().getChecksumPortion(),m++;let I=b.getRightChar();I!=null&&(f+=I.getChecksumPortion(),m++)}return f%=211,211*(m-4)+f==o.getValue()}static getNextSecondBar(a,o){let u;return a.get(o)?(u=a.getNextUnset(o),u=a.getNextSet(u)):(u=a.getNextSet(o),u=a.getNextUnset(u)),u}retrieveNextPair(a,o,u){let f=o.length%2==0;this.startFromEven&&(f=!f);let m,g=!0,w=-1;do this.findNextPair(a,o,w),m=this.parseFoundFinderPattern(a,u,f),m==null?w=Ae.getNextSecondBar(a,this.startEnd[0]):g=!1;while(g);let b=this.decodeDataCharacter(a,m,f,!0);if(!this.isEmptyPair(o)&&o[o.length-1].mustBeLast())throw new te;let I;try{I=this.decodeDataCharacter(a,m,f,!1)}catch(P){I=null,this.verbose&&console.log(P)}return new vn(b,I,m,!0)}isEmptyPair(a){return a.length===0}findNextPair(a,o,u){let f=this.getDecodeFinderCounters();f[0]=0,f[1]=0,f[2]=0,f[3]=0;let m=a.getSize(),g;u>=0?g=u:this.isEmptyPair(o)?g=0:g=o[o.length-1].getFinderPattern().getStartEnd()[1];let w=o.length%2!=0;this.startFromEven&&(w=!w);let b=!1;for(;g<m&&(b=!a.get(g),!!b);)g++;let I=0,P=g;for(let V=g;V<m;V++)if(a.get(V)!=b)f[I]++;else{if(I==3){if(w&&Ae.reverseCounters(f),Ae.isFinderPattern(f)){this.startEnd[0]=P,this.startEnd[1]=V;return}w&&Ae.reverseCounters(f),P+=f[0]+f[1],f[0]=f[2],f[1]=f[3],f[2]=0,f[3]=0,I--}else I++;f[I]=1,b=!b}throw new te}static reverseCounters(a){let o=a.length;for(let u=0;u<o/2;++u){let f=a[u];a[u]=a[o-u-1],a[o-u-1]=f}}parseFoundFinderPattern(a,o,u){let f,m,g;if(u){let I=this.startEnd[0]-1;for(;I>=0&&!a.get(I);)I--;I++,f=this.startEnd[0]-I,m=I,g=this.startEnd[1]}else m=this.startEnd[0],g=a.getNextUnset(this.startEnd[1]+1),f=g-this.startEnd[1];let w=this.getDecodeFinderCounters();B.arraycopy(w,0,w,1,w.length-1),w[0]=f;let b;try{b=this.parseFinderValue(w,Ae.FINDER_PATTERNS)}catch{return null}return new Rn(b,[m,g],m,g,o)}decodeDataCharacter(a,o,u,f){let m=this.getDataCharacterCounters();for(let sr=0;sr<m.length;sr++)m[sr]=0;if(f)Ae.recordPatternInReverse(a,o.getStartEnd()[0],m);else{Ae.recordPattern(a,o.getStartEnd()[1],m);for(let sr=0,ms=m.length-1;sr<ms;sr++,ms--){let wi=m[sr];m[sr]=m[ms],m[ms]=wi}}let g=17,w=st.sum(new Int32Array(m))/g,b=(o.getStartEnd()[1]-o.getStartEnd()[0])/15;if(Math.abs(w-b)/b>.3)throw new te;let I=this.getOddCounts(),P=this.getEvenCounts(),V=this.getOddRoundingErrors(),z=this.getEvenRoundingErrors();for(let sr=0;sr<m.length;sr++){let ms=1*m[sr]/w,wi=ms+.5;if(wi<1){if(ms<.3)throw new te;wi=1}else if(wi>8){if(ms>8.7)throw new te;wi=8}let du=sr/2;sr&1?(P[du]=wi,z[du]=ms-wi):(I[du]=wi,V[du]=ms-wi)}this.adjustOddEvenCounts(g);let Y=4*o.getValue()+(u?0:2)+(f?0:1)-1,ne=0,re=0;for(let sr=I.length-1;sr>=0;sr--){if(Ae.isNotA1left(o,u,f)){let ms=Ae.WEIGHTS[Y][2*sr];re+=I[sr]*ms}ne+=I[sr]}let de=0;for(let sr=P.length-1;sr>=0;sr--)if(Ae.isNotA1left(o,u,f)){let ms=Ae.WEIGHTS[Y][2*sr+1];de+=P[sr]*ms}let ye=re+de;if(ne&1||ne>13||ne<4)throw new te;let Ue=(13-ne)/2,ze=Ae.SYMBOL_WIDEST[Ue],Me=9-ze,Tn=nt.getRSSvalue(I,ze,!0),mn=nt.getRSSvalue(P,Me,!1),Zs=Ae.EVEN_TOTAL_SUBSET[Ue],Xi=Ae.GSUM[Ue],Js=Tn*Zs+mn+Xi;return new Ht(Js,ye)}static isNotA1left(a,o,u){return!(a.getValue()==0&&o&&u)}adjustOddEvenCounts(a){let o=st.sum(new Int32Array(this.getOddCounts())),u=st.sum(new Int32Array(this.getEvenCounts())),f=!1,m=!1;o>13?m=!0:o<4&&(f=!0);let g=!1,w=!1;u>13?w=!0:u<4&&(g=!0);let b=o+u-a,I=(o&1)==1,P=(u&1)==0;if(b==1)if(I){if(P)throw new te;m=!0}else{if(!P)throw new te;w=!0}else if(b==-1)if(I){if(P)throw new te;f=!0}else{if(!P)throw new te;g=!0}else if(b==0){if(I){if(!P)throw new te;o<u?(f=!0,w=!0):(m=!0,g=!0)}else if(P)throw new te}else throw new te;if(f){if(m)throw new te;Ae.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(m&&Ae.decrement(this.getOddCounts(),this.getOddRoundingErrors()),g){if(w)throw new te;Ae.increment(this.getEvenCounts(),this.getOddRoundingErrors())}w&&Ae.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}Ae.SYMBOL_WIDEST=[7,5,4,3,1],Ae.EVEN_TOTAL_SUBSET=[4,20,52,104,204],Ae.GSUM=[0,348,1388,2948,3988],Ae.FINDER_PATTERNS=[Int32Array.from([1,8,4,1]),Int32Array.from([3,6,4,1]),Int32Array.from([3,4,6,1]),Int32Array.from([3,2,8,1]),Int32Array.from([2,6,5,1]),Int32Array.from([2,2,9,1])],Ae.WEIGHTS=[[1,3,9,27,81,32,96,77],[20,60,180,118,143,7,21,63],[189,145,13,39,117,140,209,205],[193,157,49,147,19,57,171,91],[62,186,136,197,169,85,44,132],[185,133,188,142,4,12,36,108],[113,128,173,97,80,29,87,50],[150,28,84,41,123,158,52,156],[46,138,203,187,139,206,196,166],[76,17,51,153,37,111,122,155],[43,129,176,106,107,110,119,146],[16,48,144,10,30,90,59,177],[109,116,137,200,178,112,125,164],[70,210,208,202,184,130,179,115],[134,191,151,31,93,68,204,190],[148,22,66,198,172,94,71,2],[6,18,54,162,64,192,154,40],[120,149,25,75,14,42,126,167],[79,26,78,23,69,207,199,175],[103,98,83,38,114,131,182,124],[161,61,183,127,170,88,53,159],[55,165,73,8,24,72,5,15],[45,135,194,160,58,174,100,89]],Ae.FINDER_PAT_A=0,Ae.FINDER_PAT_B=1,Ae.FINDER_PAT_C=2,Ae.FINDER_PAT_D=3,Ae.FINDER_PAT_E=4,Ae.FINDER_PAT_F=5,Ae.FINDER_PATTERN_SEQUENCES=[[Ae.FINDER_PAT_A,Ae.FINDER_PAT_A],[Ae.FINDER_PAT_A,Ae.FINDER_PAT_B,Ae.FINDER_PAT_B],[Ae.FINDER_PAT_A,Ae.FINDER_PAT_C,Ae.FINDER_PAT_B,Ae.FINDER_PAT_D],[Ae.FINDER_PAT_A,Ae.FINDER_PAT_E,Ae.FINDER_PAT_B,Ae.FINDER_PAT_D,Ae.FINDER_PAT_C],[Ae.FINDER_PAT_A,Ae.FINDER_PAT_E,Ae.FINDER_PAT_B,Ae.FINDER_PAT_D,Ae.FINDER_PAT_D,Ae.FINDER_PAT_F],[Ae.FINDER_PAT_A,Ae.FINDER_PAT_E,Ae.FINDER_PAT_B,Ae.FINDER_PAT_D,Ae.FINDER_PAT_E,Ae.FINDER_PAT_F,Ae.FINDER_PAT_F],[Ae.FINDER_PAT_A,Ae.FINDER_PAT_A,Ae.FINDER_PAT_B,Ae.FINDER_PAT_B,Ae.FINDER_PAT_C,Ae.FINDER_PAT_C,Ae.FINDER_PAT_D,Ae.FINDER_PAT_D],[Ae.FINDER_PAT_A,Ae.FINDER_PAT_A,Ae.FINDER_PAT_B,Ae.FINDER_PAT_B,Ae.FINDER_PAT_C,Ae.FINDER_PAT_C,Ae.FINDER_PAT_D,Ae.FINDER_PAT_E,Ae.FINDER_PAT_E],[Ae.FINDER_PAT_A,Ae.FINDER_PAT_A,Ae.FINDER_PAT_B,Ae.FINDER_PAT_B,Ae.FINDER_PAT_C,Ae.FINDER_PAT_C,Ae.FINDER_PAT_D,Ae.FINDER_PAT_E,Ae.FINDER_PAT_F,Ae.FINDER_PAT_F],[Ae.FINDER_PAT_A,Ae.FINDER_PAT_A,Ae.FINDER_PAT_B,Ae.FINDER_PAT_B,Ae.FINDER_PAT_C,Ae.FINDER_PAT_D,Ae.FINDER_PAT_D,Ae.FINDER_PAT_E,Ae.FINDER_PAT_E,Ae.FINDER_PAT_F,Ae.FINDER_PAT_F]],Ae.MAX_PAIRS=11;class jn extends Ht{constructor(a,o,u){super(a,o),this.count=0,this.finderPattern=u}getFinderPattern(){return this.finderPattern}getCount(){return this.count}incrementCount(){this.count++}}class Gt extends Bt{constructor(){super(...arguments),this.possibleLeftPairs=[],this.possibleRightPairs=[]}decodeRow(a,o,u){const f=this.decodePair(o,!1,a,u);Gt.addOrTally(this.possibleLeftPairs,f),o.reverse();let m=this.decodePair(o,!0,a,u);Gt.addOrTally(this.possibleRightPairs,m),o.reverse();for(let g of this.possibleLeftPairs)if(g.getCount()>1){for(let w of this.possibleRightPairs)if(w.getCount()>1&&Gt.checkChecksum(g,w))return Gt.constructResult(g,w)}throw new te}static addOrTally(a,o){if(o==null)return;let u=!1;for(let f of a)if(f.getValue()===o.getValue()){f.incrementCount(),u=!0;break}u||a.push(o)}reset(){this.possibleLeftPairs.length=0,this.possibleRightPairs.length=0}static constructResult(a,o){let u=4537077*a.getValue()+o.getValue(),f=new String(u).toString(),m=new R;for(let I=13-f.length;I>0;I--)m.append("0");m.append(f);let g=0;for(let I=0;I<13;I++){let P=m.charAt(I).charCodeAt(0)-48;g+=I&1?P:3*P}g=10-g%10,g===10&&(g=0),m.append(g.toString());let w=a.getFinderPattern().getResultPoints(),b=o.getFinderPattern().getResultPoints();return new pe(m.toString(),null,0,[w[0],w[1],b[0],b[1]],fe.RSS_14,new Date().getTime())}static checkChecksum(a,o){let u=(a.getChecksumPortion()+16*o.getChecksumPortion())%79,f=9*a.getFinderPattern().getValue()+o.getFinderPattern().getValue();return f>72&&f--,f>8&&f--,u===f}decodePair(a,o,u,f){try{let m=this.findFinderPattern(a,o),g=this.parseFoundFinderPattern(a,u,o,m),w=f==null?null:f.get(Z.NEED_RESULT_POINT_CALLBACK);if(w!=null){let P=(m[0]+m[1])/2;o&&(P=a.getSize()-1-P),w.foundPossibleResultPoint(new ae(P,u))}let b=this.decodeDataCharacter(a,g,!0),I=this.decodeDataCharacter(a,g,!1);return new jn(1597*b.getValue()+I.getValue(),b.getChecksumPortion()+4*I.getChecksumPortion(),g)}catch{return null}}decodeDataCharacter(a,o,u){let f=this.getDataCharacterCounters();for(let de=0;de<f.length;de++)f[de]=0;if(u)Mt.recordPatternInReverse(a,o.getStartEnd()[0],f);else{Mt.recordPattern(a,o.getStartEnd()[1]+1,f);for(let de=0,ye=f.length-1;de<ye;de++,ye--){let Ue=f[de];f[de]=f[ye],f[ye]=Ue}}let m=u?16:15,g=st.sum(new Int32Array(f))/m,w=this.getOddCounts(),b=this.getEvenCounts(),I=this.getOddRoundingErrors(),P=this.getEvenRoundingErrors();for(let de=0;de<f.length;de++){let ye=f[de]/g,Ue=Math.floor(ye+.5);Ue<1?Ue=1:Ue>8&&(Ue=8);let ze=Math.floor(de/2);de&1?(b[ze]=Ue,P[ze]=ye-Ue):(w[ze]=Ue,I[ze]=ye-Ue)}this.adjustOddEvenCounts(u,m);let V=0,z=0;for(let de=w.length-1;de>=0;de--)z*=9,z+=w[de],V+=w[de];let Y=0,ne=0;for(let de=b.length-1;de>=0;de--)Y*=9,Y+=b[de],ne+=b[de];let re=z+3*Y;if(u){if(V&1||V>12||V<4)throw new te;let de=(12-V)/2,ye=Gt.OUTSIDE_ODD_WIDEST[de],Ue=9-ye,ze=nt.getRSSvalue(w,ye,!1),Me=nt.getRSSvalue(b,Ue,!0),Tn=Gt.OUTSIDE_EVEN_TOTAL_SUBSET[de],mn=Gt.OUTSIDE_GSUM[de];return new Ht(ze*Tn+Me+mn,re)}else{if(ne&1||ne>10||ne<4)throw new te;let de=(10-ne)/2,ye=Gt.INSIDE_ODD_WIDEST[de],Ue=9-ye,ze=nt.getRSSvalue(w,ye,!0),Me=nt.getRSSvalue(b,Ue,!1),Tn=Gt.INSIDE_ODD_TOTAL_SUBSET[de],mn=Gt.INSIDE_GSUM[de];return new Ht(Me*Tn+ze+mn,re)}}findFinderPattern(a,o){let u=this.getDecodeFinderCounters();u[0]=0,u[1]=0,u[2]=0,u[3]=0;let f=a.getSize(),m=!1,g=0;for(;g<f&&(m=!a.get(g),o!==m);)g++;let w=0,b=g;for(let I=g;I<f;I++)if(a.get(I)!==m)u[w]++;else{if(w===3){if(Bt.isFinderPattern(u))return[b,I];b+=u[0]+u[1],u[0]=u[2],u[1]=u[3],u[2]=0,u[3]=0,w--}else w++;u[w]=1,m=!m}throw new te}parseFoundFinderPattern(a,o,u,f){let m=a.get(f[0]),g=f[0]-1;for(;g>=0&&m!==a.get(g);)g--;g++;const w=f[0]-g,b=this.getDecodeFinderCounters(),I=new Int32Array(b.length);B.arraycopy(b,0,I,1,b.length-1),I[0]=w;const P=this.parseFinderValue(I,Gt.FINDER_PATTERNS);let V=g,z=f[1];return u&&(V=a.getSize()-1-V,z=a.getSize()-1-z),new Rn(P,[g,f[1]],V,z,o)}adjustOddEvenCounts(a,o){let u=st.sum(new Int32Array(this.getOddCounts())),f=st.sum(new Int32Array(this.getEvenCounts())),m=!1,g=!1,w=!1,b=!1;a?(u>12?g=!0:u<4&&(m=!0),f>12?b=!0:f<4&&(w=!0)):(u>11?g=!0:u<5&&(m=!0),f>10?b=!0:f<4&&(w=!0));let I=u+f-o,P=(u&1)===(a?1:0),V=(f&1)===1;if(I===1)if(P){if(V)throw new te;g=!0}else{if(!V)throw new te;b=!0}else if(I===-1)if(P){if(V)throw new te;m=!0}else{if(!V)throw new te;w=!0}else if(I===0){if(P){if(!V)throw new te;u<f?(m=!0,b=!0):(g=!0,w=!0)}else if(V)throw new te}else throw new te;if(m){if(g)throw new te;Bt.increment(this.getOddCounts(),this.getOddRoundingErrors())}if(g&&Bt.decrement(this.getOddCounts(),this.getOddRoundingErrors()),w){if(b)throw new te;Bt.increment(this.getEvenCounts(),this.getOddRoundingErrors())}b&&Bt.decrement(this.getEvenCounts(),this.getEvenRoundingErrors())}}Gt.OUTSIDE_EVEN_TOTAL_SUBSET=[1,10,34,70,126],Gt.INSIDE_ODD_TOTAL_SUBSET=[4,20,48,81],Gt.OUTSIDE_GSUM=[0,161,961,2015,2715],Gt.INSIDE_GSUM=[0,336,1036,1516],Gt.OUTSIDE_ODD_WIDEST=[8,6,4,3,1],Gt.INSIDE_ODD_WIDEST=[2,4,6,8],Gt.FINDER_PATTERNS=[Int32Array.from([3,8,2,1]),Int32Array.from([3,5,5,1]),Int32Array.from([3,3,7,1]),Int32Array.from([3,1,9,1]),Int32Array.from([2,7,4,1]),Int32Array.from([2,5,6,1]),Int32Array.from([2,3,8,1]),Int32Array.from([1,5,7,1]),Int32Array.from([1,3,9,1])];class Jn extends Mt{constructor(a,o){super(),this.readers=[],this.verbose=o===!0;const u=a?a.get(Z.POSSIBLE_FORMATS):null,f=a&&a.get(Z.ASSUME_CODE_39_CHECK_DIGIT)!==void 0;u?((u.includes(fe.EAN_13)||u.includes(fe.UPC_A)||u.includes(fe.EAN_8)||u.includes(fe.UPC_E))&&this.readers.push(new wn(a)),u.includes(fe.CODE_39)&&this.readers.push(new Tt(f)),u.includes(fe.CODE_128)&&this.readers.push(new we),u.includes(fe.ITF)&&this.readers.push(new Rt),u.includes(fe.RSS_14)&&this.readers.push(new Gt),u.includes(fe.RSS_EXPANDED)&&this.readers.push(new Ae(this.verbose))):(this.readers.push(new wn(a)),this.readers.push(new Tt),this.readers.push(new wn(a)),this.readers.push(new we),this.readers.push(new Rt),this.readers.push(new Gt),this.readers.push(new Ae(this.verbose)))}decodeRow(a,o,u){for(let f=0;f<this.readers.length;f++)try{return this.readers[f].decodeRow(a,o,u)}catch{}throw new te}reset(){this.readers.forEach(a=>a.reset())}}class en extends rt{constructor(a=500,o){super(new Jn(o),a,o)}}class ct{constructor(a,o,u){this.ecCodewords=a,this.ecBlocks=[o],u&&this.ecBlocks.push(u)}getECCodewords(){return this.ecCodewords}getECBlocks(){return this.ecBlocks}}class It{constructor(a,o){this.count=a,this.dataCodewords=o}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class Ut{constructor(a,o,u,f,m,g){this.versionNumber=a,this.symbolSizeRows=o,this.symbolSizeColumns=u,this.dataRegionSizeRows=f,this.dataRegionSizeColumns=m,this.ecBlocks=g;let w=0;const b=g.getECCodewords(),I=g.getECBlocks();for(let P of I)w+=P.getCount()*(P.getDataCodewords()+b);this.totalCodewords=w}getVersionNumber(){return this.versionNumber}getSymbolSizeRows(){return this.symbolSizeRows}getSymbolSizeColumns(){return this.symbolSizeColumns}getDataRegionSizeRows(){return this.dataRegionSizeRows}getDataRegionSizeColumns(){return this.dataRegionSizeColumns}getTotalCodewords(){return this.totalCodewords}getECBlocks(){return this.ecBlocks}static getVersionForDimensions(a,o){if(a&1||o&1)throw new A;for(let u of Ut.VERSIONS)if(u.symbolSizeRows===a&&u.symbolSizeColumns===o)return u;throw new A}toString(){return""+this.versionNumber}static buildVersions(){return[new Ut(1,10,10,8,8,new ct(5,new It(1,3))),new Ut(2,12,12,10,10,new ct(7,new It(1,5))),new Ut(3,14,14,12,12,new ct(10,new It(1,8))),new Ut(4,16,16,14,14,new ct(12,new It(1,12))),new Ut(5,18,18,16,16,new ct(14,new It(1,18))),new Ut(6,20,20,18,18,new ct(18,new It(1,22))),new Ut(7,22,22,20,20,new ct(20,new It(1,30))),new Ut(8,24,24,22,22,new ct(24,new It(1,36))),new Ut(9,26,26,24,24,new ct(28,new It(1,44))),new Ut(10,32,32,14,14,new ct(36,new It(1,62))),new Ut(11,36,36,16,16,new ct(42,new It(1,86))),new Ut(12,40,40,18,18,new ct(48,new It(1,114))),new Ut(13,44,44,20,20,new ct(56,new It(1,144))),new Ut(14,48,48,22,22,new ct(68,new It(1,174))),new Ut(15,52,52,24,24,new ct(42,new It(2,102))),new Ut(16,64,64,14,14,new ct(56,new It(2,140))),new Ut(17,72,72,16,16,new ct(36,new It(4,92))),new Ut(18,80,80,18,18,new ct(48,new It(4,114))),new Ut(19,88,88,20,20,new ct(56,new It(4,144))),new Ut(20,96,96,22,22,new ct(68,new It(4,174))),new Ut(21,104,104,24,24,new ct(56,new It(6,136))),new Ut(22,120,120,18,18,new ct(68,new It(6,175))),new Ut(23,132,132,20,20,new ct(62,new It(8,163))),new Ut(24,144,144,22,22,new ct(62,new It(8,156),new It(2,155))),new Ut(25,8,18,6,16,new ct(7,new It(1,5))),new Ut(26,8,32,6,14,new ct(11,new It(1,10))),new Ut(27,12,26,10,24,new ct(14,new It(1,16))),new Ut(28,12,36,10,16,new ct(18,new It(1,22))),new Ut(29,16,36,14,16,new ct(24,new It(1,32))),new Ut(30,16,48,14,22,new ct(28,new It(1,49)))]}}Ut.VERSIONS=Ut.buildVersions();class pn{constructor(a){const o=a.getHeight();if(o<8||o>144||o&1)throw new A;this.version=pn.readVersion(a),this.mappingBitMatrix=this.extractDataRegion(a),this.readMappingMatrix=new ie(this.mappingBitMatrix.getWidth(),this.mappingBitMatrix.getHeight())}getVersion(){return this.version}static readVersion(a){const o=a.getHeight(),u=a.getWidth();return Ut.getVersionForDimensions(o,u)}readCodewords(){const a=new Int8Array(this.version.getTotalCodewords());let o=0,u=4,f=0;const m=this.mappingBitMatrix.getHeight(),g=this.mappingBitMatrix.getWidth();let w=!1,b=!1,I=!1,P=!1;do if(u===m&&f===0&&!w)a[o++]=this.readCorner1(m,g)&255,u-=2,f+=2,w=!0;else if(u===m-2&&f===0&&g&3&&!b)a[o++]=this.readCorner2(m,g)&255,u-=2,f+=2,b=!0;else if(u===m+4&&f===2&&!(g&7)&&!I)a[o++]=this.readCorner3(m,g)&255,u-=2,f+=2,I=!0;else if(u===m-2&&f===0&&(g&7)===4&&!P)a[o++]=this.readCorner4(m,g)&255,u-=2,f+=2,P=!0;else{do u<m&&f>=0&&!this.readMappingMatrix.get(f,u)&&(a[o++]=this.readUtah(u,f,m,g)&255),u-=2,f+=2;while(u>=0&&f<g);u+=1,f+=3;do u>=0&&f<g&&!this.readMappingMatrix.get(f,u)&&(a[o++]=this.readUtah(u,f,m,g)&255),u+=2,f-=2;while(u<m&&f>=0);u+=3,f+=1}while(u<m||f<g);if(o!==this.version.getTotalCodewords())throw new A;return a}readModule(a,o,u,f){return a<0&&(a+=u,o+=4-(u+4&7)),o<0&&(o+=f,a+=4-(f+4&7)),this.readMappingMatrix.set(o,a),this.mappingBitMatrix.get(o,a)}readUtah(a,o,u,f){let m=0;return this.readModule(a-2,o-2,u,f)&&(m|=1),m<<=1,this.readModule(a-2,o-1,u,f)&&(m|=1),m<<=1,this.readModule(a-1,o-2,u,f)&&(m|=1),m<<=1,this.readModule(a-1,o-1,u,f)&&(m|=1),m<<=1,this.readModule(a-1,o,u,f)&&(m|=1),m<<=1,this.readModule(a,o-2,u,f)&&(m|=1),m<<=1,this.readModule(a,o-1,u,f)&&(m|=1),m<<=1,this.readModule(a,o,u,f)&&(m|=1),m}readCorner1(a,o){let u=0;return this.readModule(a-1,0,a,o)&&(u|=1),u<<=1,this.readModule(a-1,1,a,o)&&(u|=1),u<<=1,this.readModule(a-1,2,a,o)&&(u|=1),u<<=1,this.readModule(0,o-2,a,o)&&(u|=1),u<<=1,this.readModule(0,o-1,a,o)&&(u|=1),u<<=1,this.readModule(1,o-1,a,o)&&(u|=1),u<<=1,this.readModule(2,o-1,a,o)&&(u|=1),u<<=1,this.readModule(3,o-1,a,o)&&(u|=1),u}readCorner2(a,o){let u=0;return this.readModule(a-3,0,a,o)&&(u|=1),u<<=1,this.readModule(a-2,0,a,o)&&(u|=1),u<<=1,this.readModule(a-1,0,a,o)&&(u|=1),u<<=1,this.readModule(0,o-4,a,o)&&(u|=1),u<<=1,this.readModule(0,o-3,a,o)&&(u|=1),u<<=1,this.readModule(0,o-2,a,o)&&(u|=1),u<<=1,this.readModule(0,o-1,a,o)&&(u|=1),u<<=1,this.readModule(1,o-1,a,o)&&(u|=1),u}readCorner3(a,o){let u=0;return this.readModule(a-1,0,a,o)&&(u|=1),u<<=1,this.readModule(a-1,o-1,a,o)&&(u|=1),u<<=1,this.readModule(0,o-3,a,o)&&(u|=1),u<<=1,this.readModule(0,o-2,a,o)&&(u|=1),u<<=1,this.readModule(0,o-1,a,o)&&(u|=1),u<<=1,this.readModule(1,o-3,a,o)&&(u|=1),u<<=1,this.readModule(1,o-2,a,o)&&(u|=1),u<<=1,this.readModule(1,o-1,a,o)&&(u|=1),u}readCorner4(a,o){let u=0;return this.readModule(a-3,0,a,o)&&(u|=1),u<<=1,this.readModule(a-2,0,a,o)&&(u|=1),u<<=1,this.readModule(a-1,0,a,o)&&(u|=1),u<<=1,this.readModule(0,o-2,a,o)&&(u|=1),u<<=1,this.readModule(0,o-1,a,o)&&(u|=1),u<<=1,this.readModule(1,o-1,a,o)&&(u|=1),u<<=1,this.readModule(2,o-1,a,o)&&(u|=1),u<<=1,this.readModule(3,o-1,a,o)&&(u|=1),u}extractDataRegion(a){const o=this.version.getSymbolSizeRows(),u=this.version.getSymbolSizeColumns();if(a.getHeight()!==o)throw new E("Dimension of bitMatrix must match the version size");const f=this.version.getDataRegionSizeRows(),m=this.version.getDataRegionSizeColumns(),g=o/f|0,w=u/m|0,b=g*f,I=w*m,P=new ie(I,b);for(let V=0;V<g;++V){const z=V*f;for(let Y=0;Y<w;++Y){const ne=Y*m;for(let re=0;re<f;++re){const de=V*(f+2)+1+re,ye=z+re;for(let Ue=0;Ue<m;++Ue){const ze=Y*(m+2)+1+Ue;if(a.get(ze,de)){const Me=ne+Ue;P.set(Me,ye)}}}}}return P}}class hr{constructor(a,o){this.numDataCodewords=a,this.codewords=o}static getDataBlocks(a,o){const u=o.getECBlocks();let f=0;const m=u.getECBlocks();for(let re of m)f+=re.getCount();const g=new Array(f);let w=0;for(let re of m)for(let de=0;de<re.getCount();de++){const ye=re.getDataCodewords(),Ue=u.getECCodewords()+ye;g[w++]=new hr(ye,new Uint8Array(Ue))}const I=g[0].codewords.length-u.getECCodewords(),P=I-1;let V=0;for(let re=0;re<P;re++)for(let de=0;de<w;de++)g[de].codewords[re]=a[V++];const z=o.getVersionNumber()===24,Y=z?8:w;for(let re=0;re<Y;re++)g[re].codewords[I-1]=a[V++];const ne=g[0].codewords.length;for(let re=I;re<ne;re++)for(let de=0;de<w;de++){const ye=z?(de+8)%w:de,Ue=z&&ye>7?re-1:re;g[ye].codewords[Ue]=a[V++]}if(V!==a.length)throw new E;return g}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}class qs{constructor(a){this.bytes=a,this.byteOffset=0,this.bitOffset=0}getBitOffset(){return this.bitOffset}getByteOffset(){return this.byteOffset}readBits(a){if(a<1||a>32||a>this.available())throw new E(""+a);let o=0,u=this.bitOffset,f=this.byteOffset;const m=this.bytes;if(u>0){const g=8-u,w=a<g?a:g,b=g-w,I=255>>8-w<<b;o=(m[f]&I)>>b,a-=w,u+=w,u===8&&(u=0,f++)}if(a>0){for(;a>=8;)o=o<<8|m[f]&255,f++,a-=8;if(a>0){const g=8-a,w=255>>g<<g;o=o<<a|(m[f]&w)>>g,u+=a}}return this.bitOffset=u,this.byteOffset=f,o}available(){return 8*(this.bytes.length-this.byteOffset)-this.bitOffset}}var Hn;(function(j){j[j.PAD_ENCODE=0]="PAD_ENCODE",j[j.ASCII_ENCODE=1]="ASCII_ENCODE",j[j.C40_ENCODE=2]="C40_ENCODE",j[j.TEXT_ENCODE=3]="TEXT_ENCODE",j[j.ANSIX12_ENCODE=4]="ANSIX12_ENCODE",j[j.EDIFACT_ENCODE=5]="EDIFACT_ENCODE",j[j.BASE256_ENCODE=6]="BASE256_ENCODE"})(Hn||(Hn={}));class Ks{static decode(a){const o=new qs(a),u=new R,f=new R,m=new Array;let g=Hn.ASCII_ENCODE;do if(g===Hn.ASCII_ENCODE)g=this.decodeAsciiSegment(o,u,f);else{switch(g){case Hn.C40_ENCODE:this.decodeC40Segment(o,u);break;case Hn.TEXT_ENCODE:this.decodeTextSegment(o,u);break;case Hn.ANSIX12_ENCODE:this.decodeAnsiX12Segment(o,u);break;case Hn.EDIFACT_ENCODE:this.decodeEdifactSegment(o,u);break;case Hn.BASE256_ENCODE:this.decodeBase256Segment(o,u,m);break;default:throw new A}g=Hn.ASCII_ENCODE}while(g!==Hn.PAD_ENCODE&&o.available()>0);return f.length()>0&&u.append(f.toString()),new Vt(a,u.toString(),m.length===0?null:m,null)}static decodeAsciiSegment(a,o,u){let f=!1;do{let m=a.readBits(8);if(m===0)throw new A;if(m<=128)return f&&(m+=128),o.append(String.fromCharCode(m-1)),Hn.ASCII_ENCODE;if(m===129)return Hn.PAD_ENCODE;if(m<=229){const g=m-130;g<10&&o.append("0"),o.append(""+g)}else switch(m){case 230:return Hn.C40_ENCODE;case 231:return Hn.BASE256_ENCODE;case 232:o.append("");break;case 233:case 234:break;case 235:f=!0;break;case 236:o.append("[)>05"),u.insert(0,"");break;case 237:o.append("[)>06"),u.insert(0,"");break;case 238:return Hn.ANSIX12_ENCODE;case 239:return Hn.TEXT_ENCODE;case 240:return Hn.EDIFACT_ENCODE;case 241:break;default:if(m!==254||a.available()!==0)throw new A;break}}while(a.available()>0);return Hn.ASCII_ENCODE}static decodeC40Segment(a,o){let u=!1;const f=[];let m=0;do{if(a.available()===8)return;const g=a.readBits(8);if(g===254)return;this.parseTwoBytes(g,a.readBits(8),f);for(let w=0;w<3;w++){const b=f[w];switch(m){case 0:if(b<3)m=b+1;else if(b<this.C40_BASIC_SET_CHARS.length){const I=this.C40_BASIC_SET_CHARS[b];u?(o.append(String.fromCharCode(I.charCodeAt(0)+128)),u=!1):o.append(I)}else throw new A;break;case 1:u?(o.append(String.fromCharCode(b+128)),u=!1):o.append(String.fromCharCode(b)),m=0;break;case 2:if(b<this.C40_SHIFT2_SET_CHARS.length){const I=this.C40_SHIFT2_SET_CHARS[b];u?(o.append(String.fromCharCode(I.charCodeAt(0)+128)),u=!1):o.append(I)}else switch(b){case 27:o.append("");break;case 30:u=!0;break;default:throw new A}m=0;break;case 3:u?(o.append(String.fromCharCode(b+224)),u=!1):o.append(String.fromCharCode(b+96)),m=0;break;default:throw new A}}}while(a.available()>0)}static decodeTextSegment(a,o){let u=!1,f=[],m=0;do{if(a.available()===8)return;const g=a.readBits(8);if(g===254)return;this.parseTwoBytes(g,a.readBits(8),f);for(let w=0;w<3;w++){const b=f[w];switch(m){case 0:if(b<3)m=b+1;else if(b<this.TEXT_BASIC_SET_CHARS.length){const I=this.TEXT_BASIC_SET_CHARS[b];u?(o.append(String.fromCharCode(I.charCodeAt(0)+128)),u=!1):o.append(I)}else throw new A;break;case 1:u?(o.append(String.fromCharCode(b+128)),u=!1):o.append(String.fromCharCode(b)),m=0;break;case 2:if(b<this.TEXT_SHIFT2_SET_CHARS.length){const I=this.TEXT_SHIFT2_SET_CHARS[b];u?(o.append(String.fromCharCode(I.charCodeAt(0)+128)),u=!1):o.append(I)}else switch(b){case 27:o.append("");break;case 30:u=!0;break;default:throw new A}m=0;break;case 3:if(b<this.TEXT_SHIFT3_SET_CHARS.length){const I=this.TEXT_SHIFT3_SET_CHARS[b];u?(o.append(String.fromCharCode(I.charCodeAt(0)+128)),u=!1):o.append(I),m=0}else throw new A;break;default:throw new A}}}while(a.available()>0)}static decodeAnsiX12Segment(a,o){const u=[];do{if(a.available()===8)return;const f=a.readBits(8);if(f===254)return;this.parseTwoBytes(f,a.readBits(8),u);for(let m=0;m<3;m++){const g=u[m];switch(g){case 0:o.append("\r");break;case 1:o.append("*");break;case 2:o.append(">");break;case 3:o.append(" ");break;default:if(g<14)o.append(String.fromCharCode(g+44));else if(g<40)o.append(String.fromCharCode(g+51));else throw new A;break}}}while(a.available()>0)}static parseTwoBytes(a,o,u){let f=(a<<8)+o-1,m=Math.floor(f/1600);u[0]=m,f-=m*1600,m=Math.floor(f/40),u[1]=m,u[2]=f-m*40}static decodeEdifactSegment(a,o){do{if(a.available()<=16)return;for(let u=0;u<4;u++){let f=a.readBits(6);if(f===31){const m=8-a.getBitOffset();m!==8&&a.readBits(m);return}f&32||(f|=64),o.append(String.fromCharCode(f))}}while(a.available()>0)}static decodeBase256Segment(a,o,u){let f=1+a.getByteOffset();const m=this.unrandomize255State(a.readBits(8),f++);let g;if(m===0?g=a.available()/8|0:m<250?g=m:g=250*(m-249)+this.unrandomize255State(a.readBits(8),f++),g<0)throw new A;const w=new Uint8Array(g);for(let b=0;b<g;b++){if(a.available()<8)throw new A;w[b]=this.unrandomize255State(a.readBits(8),f++)}u.push(w);try{o.append(O.decode(w,F.ISO88591))}catch(b){throw new Oe("Platform does not support required encoding: "+b.message)}}static unrandomize255State(a,o){const u=149*o%255+1,f=a-u;return f>=0?f:f+256}}Ks.C40_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],Ks.C40_SHIFT2_SET_CHARS=["!",'"',"#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","@","[","\\","]","^","_"],Ks.TEXT_BASIC_SET_CHARS=["*","*","*"," ","0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],Ks.TEXT_SHIFT2_SET_CHARS=Ks.C40_SHIFT2_SET_CHARS,Ks.TEXT_SHIFT3_SET_CHARS=["`","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","{","|","}","~",""];class Xl{constructor(){this.rsDecoder=new Ge(se.DATA_MATRIX_FIELD_256)}decode(a){const o=new pn(a),u=o.getVersion(),f=o.readCodewords(),m=hr.getDataBlocks(f,u);let g=0;for(let I of m)g+=I.getNumDataCodewords();const w=new Uint8Array(g),b=m.length;for(let I=0;I<b;I++){const P=m[I],V=P.getCodewords(),z=P.getNumDataCodewords();this.correctErrors(V,z);for(let Y=0;Y<z;Y++)w[Y*b+I]=V[Y]}return Ks.decode(w)}correctErrors(a,o){const u=new Int32Array(a);try{this.rsDecoder.decode(u,a.length-o)}catch{throw new k}for(let f=0;f<o;f++)a[f]=u[f]}}class nr{constructor(a){this.image=a,this.rectangleDetector=new Ke(this.image)}detect(){const a=this.rectangleDetector.detect();let o=this.detectSolid1(a);if(o=this.detectSolid2(o),o[3]=this.correctTopRight(o),!o[3])throw new te;o=this.shiftToModuleCenter(o);const u=o[0],f=o[1],m=o[2],g=o[3];let w=this.transitionsBetween(u,g)+1,b=this.transitionsBetween(m,g)+1;(w&1)===1&&(w+=1),(b&1)===1&&(b+=1),4*w<7*b&&4*b<7*w&&(w=b=Math.max(w,b));let I=nr.sampleGrid(this.image,u,f,m,g,w,b);return new ft(I,[u,f,m,g])}static shiftPoint(a,o,u){let f=(o.getX()-a.getX())/(u+1),m=(o.getY()-a.getY())/(u+1);return new ae(a.getX()+f,a.getY()+m)}static moveAway(a,o,u){let f=a.getX(),m=a.getY();return f<o?f-=1:f+=1,m<u?m-=1:m+=1,new ae(f,m)}detectSolid1(a){let o=a[0],u=a[1],f=a[3],m=a[2],g=this.transitionsBetween(o,u),w=this.transitionsBetween(u,f),b=this.transitionsBetween(f,m),I=this.transitionsBetween(m,o),P=g,V=[m,o,u,f];return P>w&&(P=w,V[0]=o,V[1]=u,V[2]=f,V[3]=m),P>b&&(P=b,V[0]=u,V[1]=f,V[2]=m,V[3]=o),P>I&&(V[0]=f,V[1]=m,V[2]=o,V[3]=u),V}detectSolid2(a){let o=a[0],u=a[1],f=a[2],m=a[3],g=this.transitionsBetween(o,m),w=nr.shiftPoint(u,f,(g+1)*4),b=nr.shiftPoint(f,u,(g+1)*4),I=this.transitionsBetween(w,o),P=this.transitionsBetween(b,m);return I<P?(a[0]=o,a[1]=u,a[2]=f,a[3]=m):(a[0]=u,a[1]=f,a[2]=m,a[3]=o),a}correctTopRight(a){let o=a[0],u=a[1],f=a[2],m=a[3],g=this.transitionsBetween(o,m),w=this.transitionsBetween(u,m),b=nr.shiftPoint(o,u,(w+1)*4),I=nr.shiftPoint(f,u,(g+1)*4);g=this.transitionsBetween(b,m),w=this.transitionsBetween(I,m);let P=new ae(m.getX()+(f.getX()-u.getX())/(g+1),m.getY()+(f.getY()-u.getY())/(g+1)),V=new ae(m.getX()+(o.getX()-u.getX())/(w+1),m.getY()+(o.getY()-u.getY())/(w+1));if(!this.isValid(P))return this.isValid(V)?V:null;if(!this.isValid(V))return P;let z=this.transitionsBetween(b,P)+this.transitionsBetween(I,P),Y=this.transitionsBetween(b,V)+this.transitionsBetween(I,V);return z>Y?P:V}shiftToModuleCenter(a){let o=a[0],u=a[1],f=a[2],m=a[3],g=this.transitionsBetween(o,m)+1,w=this.transitionsBetween(f,m)+1,b=nr.shiftPoint(o,u,w*4),I=nr.shiftPoint(f,u,g*4);g=this.transitionsBetween(b,m)+1,w=this.transitionsBetween(I,m)+1,(g&1)===1&&(g+=1),(w&1)===1&&(w+=1);let P=(o.getX()+u.getX()+f.getX()+m.getX())/4,V=(o.getY()+u.getY()+f.getY()+m.getY())/4;o=nr.moveAway(o,P,V),u=nr.moveAway(u,P,V),f=nr.moveAway(f,P,V),m=nr.moveAway(m,P,V);let z,Y;return b=nr.shiftPoint(o,u,w*4),b=nr.shiftPoint(b,m,g*4),z=nr.shiftPoint(u,o,w*4),z=nr.shiftPoint(z,f,g*4),I=nr.shiftPoint(f,m,w*4),I=nr.shiftPoint(I,u,g*4),Y=nr.shiftPoint(m,f,w*4),Y=nr.shiftPoint(Y,o,g*4),[b,z,I,Y]}isValid(a){return a.getX()>=0&&a.getX()<this.image.getWidth()&&a.getY()>0&&a.getY()<this.image.getHeight()}static sampleGrid(a,o,u,f,m,g,w){return jt.getInstance().sampleGrid(a,g,w,.5,.5,g-.5,.5,g-.5,w-.5,.5,w-.5,o.getX(),o.getY(),m.getX(),m.getY(),f.getX(),f.getY(),u.getX(),u.getY())}transitionsBetween(a,o){let u=Math.trunc(a.getX()),f=Math.trunc(a.getY()),m=Math.trunc(o.getX()),g=Math.trunc(o.getY()),w=Math.abs(g-f)>Math.abs(m-u);if(w){let re=u;u=f,f=re,re=m,m=g,g=re}let b=Math.abs(m-u),I=Math.abs(g-f),P=-b/2,V=f<g?1:-1,z=u<m?1:-1,Y=0,ne=this.image.get(w?f:u,w?u:f);for(let re=u,de=f;re!==m;re+=z){let ye=this.image.get(w?de:re,w?re:de);if(ye!==ne&&(Y++,ne=ye),P+=I,P>0){if(de===g)break;de+=V,P-=b}}return Y}}class Xs{constructor(){this.decoder=new Xl}decode(a,o=null){let u,f;if(o!=null&&o.has(Z.PURE_BARCODE)){const I=Xs.extractPureBits(a.getBlackMatrix());u=this.decoder.decode(I),f=Xs.NO_POINTS}else{const I=new nr(a.getBlackMatrix()).detect();u=this.decoder.decode(I.getBits()),f=I.getPoints()}const m=u.getRawBytes(),g=new pe(u.getText(),m,8*m.length,f,fe.DATA_MATRIX,B.currentTimeMillis()),w=u.getByteSegments();w!=null&&g.putMetadata(Ve.BYTE_SEGMENTS,w);const b=u.getECLevel();return b!=null&&g.putMetadata(Ve.ERROR_CORRECTION_LEVEL,b),g}reset(){}static extractPureBits(a){const o=a.getTopLeftOnBit(),u=a.getBottomRightOnBit();if(o==null||u==null)throw new te;const f=this.moduleSize(o,a);let m=o[1];const g=u[1];let w=o[0];const I=(u[0]-w+1)/f,P=(g-m+1)/f;if(I<=0||P<=0)throw new te;const V=f/2;m+=V,w+=V;const z=new ie(I,P);for(let Y=0;Y<P;Y++){const ne=m+Y*f;for(let re=0;re<I;re++)a.get(w+re*f,ne)&&z.set(re,Y)}return z}static moduleSize(a,o){const u=o.getWidth();let f=a[0];const m=a[1];for(;f<u&&o.get(f,m);)f++;if(f===u)throw new te;const g=f-a[0];if(g===0)throw new te;return g}}Xs.NO_POINTS=[];class Hd extends rt{constructor(a=500){super(new Xs,a)}}var Nr;(function(j){j[j.L=0]="L",j[j.M=1]="M",j[j.Q=2]="Q",j[j.H=3]="H"})(Nr||(Nr={}));class tn{constructor(a,o,u){this.value=a,this.stringValue=o,this.bits=u,tn.FOR_BITS.set(u,this),tn.FOR_VALUE.set(a,this)}getValue(){return this.value}getBits(){return this.bits}static fromString(a){switch(a){case"L":return tn.L;case"M":return tn.M;case"Q":return tn.Q;case"H":return tn.H;default:throw new _(a+"not available")}}toString(){return this.stringValue}equals(a){if(!(a instanceof tn))return!1;const o=a;return this.value===o.value}static forBits(a){if(a<0||a>=tn.FOR_BITS.size)throw new E;return tn.FOR_BITS.get(a)}}tn.FOR_BITS=new Map,tn.FOR_VALUE=new Map,tn.L=new tn(Nr.L,"L",1),tn.M=new tn(Nr.M,"M",0),tn.Q=new tn(Nr.Q,"Q",3),tn.H=new tn(Nr.H,"H",2);class or{constructor(a){this.errorCorrectionLevel=tn.forBits(a>>3&3),this.dataMask=a&7}static numBitsDiffering(a,o){return U.bitCount(a^o)}static decodeFormatInformation(a,o){const u=or.doDecodeFormatInformation(a,o);return u!==null?u:or.doDecodeFormatInformation(a^or.FORMAT_INFO_MASK_QR,o^or.FORMAT_INFO_MASK_QR)}static doDecodeFormatInformation(a,o){let u=Number.MAX_SAFE_INTEGER,f=0;for(const m of or.FORMAT_INFO_DECODE_LOOKUP){const g=m[0];if(g===a||g===o)return new or(m[1]);let w=or.numBitsDiffering(a,g);w<u&&(f=m[1],u=w),a!==o&&(w=or.numBitsDiffering(o,g),w<u&&(f=m[1],u=w))}return u<=3?new or(f):null}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getDataMask(){return this.dataMask}hashCode(){return this.errorCorrectionLevel.getBits()<<3|this.dataMask}equals(a){if(!(a instanceof or))return!1;const o=a;return this.errorCorrectionLevel===o.errorCorrectionLevel&&this.dataMask===o.dataMask}}or.FORMAT_INFO_MASK_QR=21522,or.FORMAT_INFO_DECODE_LOOKUP=[Int32Array.from([21522,0]),Int32Array.from([20773,1]),Int32Array.from([24188,2]),Int32Array.from([23371,3]),Int32Array.from([17913,4]),Int32Array.from([16590,5]),Int32Array.from([20375,6]),Int32Array.from([19104,7]),Int32Array.from([30660,8]),Int32Array.from([29427,9]),Int32Array.from([32170,10]),Int32Array.from([30877,11]),Int32Array.from([26159,12]),Int32Array.from([25368,13]),Int32Array.from([27713,14]),Int32Array.from([26998,15]),Int32Array.from([5769,16]),Int32Array.from([5054,17]),Int32Array.from([7399,18]),Int32Array.from([6608,19]),Int32Array.from([1890,20]),Int32Array.from([597,21]),Int32Array.from([3340,22]),Int32Array.from([2107,23]),Int32Array.from([13663,24]),Int32Array.from([12392,25]),Int32Array.from([16177,26]),Int32Array.from([14854,27]),Int32Array.from([9396,28]),Int32Array.from([8579,29]),Int32Array.from([11994,30]),Int32Array.from([11245,31])];class le{constructor(a,...o){this.ecCodewordsPerBlock=a,this.ecBlocks=o}getECCodewordsPerBlock(){return this.ecCodewordsPerBlock}getNumBlocks(){let a=0;const o=this.ecBlocks;for(const u of o)a+=u.getCount();return a}getTotalECCodewords(){return this.ecCodewordsPerBlock*this.getNumBlocks()}getECBlocks(){return this.ecBlocks}}class X{constructor(a,o){this.count=a,this.dataCodewords=o}getCount(){return this.count}getDataCodewords(){return this.dataCodewords}}class Pe{constructor(a,o,...u){this.versionNumber=a,this.alignmentPatternCenters=o,this.ecBlocks=u;let f=0;const m=u[0].getECCodewordsPerBlock(),g=u[0].getECBlocks();for(const w of g)f+=w.getCount()*(w.getDataCodewords()+m);this.totalCodewords=f}getVersionNumber(){return this.versionNumber}getAlignmentPatternCenters(){return this.alignmentPatternCenters}getTotalCodewords(){return this.totalCodewords}getDimensionForVersion(){return 17+4*this.versionNumber}getECBlocksForLevel(a){return this.ecBlocks[a.getValue()]}static getProvisionalVersionForDimension(a){if(a%4!==1)throw new A;try{return this.getVersionForNumber((a-17)/4)}catch{throw new A}}static getVersionForNumber(a){if(a<1||a>40)throw new E;return Pe.VERSIONS[a-1]}static decodeVersionInformation(a){let o=Number.MAX_SAFE_INTEGER,u=0;for(let f=0;f<Pe.VERSION_DECODE_INFO.length;f++){const m=Pe.VERSION_DECODE_INFO[f];if(m===a)return Pe.getVersionForNumber(f+7);const g=or.numBitsDiffering(a,m);g<o&&(u=f+7,o=g)}return o<=3?Pe.getVersionForNumber(u):null}buildFunctionPattern(){const a=this.getDimensionForVersion(),o=new ie(a);o.setRegion(0,0,9,9),o.setRegion(a-8,0,8,9),o.setRegion(0,a-8,9,8);const u=this.alignmentPatternCenters.length;for(let f=0;f<u;f++){const m=this.alignmentPatternCenters[f]-2;for(let g=0;g<u;g++)f===0&&(g===0||g===u-1)||f===u-1&&g===0||o.setRegion(this.alignmentPatternCenters[g]-2,m,5,5)}return o.setRegion(6,9,1,a-17),o.setRegion(9,6,a-17,1),this.versionNumber>6&&(o.setRegion(a-11,0,3,6),o.setRegion(0,a-11,6,3)),o}toString(){return""+this.versionNumber}}Pe.VERSION_DECODE_INFO=Int32Array.from([31892,34236,39577,42195,48118,51042,55367,58893,63784,68472,70749,76311,79154,84390,87683,92361,96236,102084,102881,110507,110734,117786,119615,126325,127568,133589,136944,141498,145311,150283,152622,158308,161089,167017]),Pe.VERSIONS=[new Pe(1,new Int32Array(0),new le(7,new X(1,19)),new le(10,new X(1,16)),new le(13,new X(1,13)),new le(17,new X(1,9))),new Pe(2,Int32Array.from([6,18]),new le(10,new X(1,34)),new le(16,new X(1,28)),new le(22,new X(1,22)),new le(28,new X(1,16))),new Pe(3,Int32Array.from([6,22]),new le(15,new X(1,55)),new le(26,new X(1,44)),new le(18,new X(2,17)),new le(22,new X(2,13))),new Pe(4,Int32Array.from([6,26]),new le(20,new X(1,80)),new le(18,new X(2,32)),new le(26,new X(2,24)),new le(16,new X(4,9))),new Pe(5,Int32Array.from([6,30]),new le(26,new X(1,108)),new le(24,new X(2,43)),new le(18,new X(2,15),new X(2,16)),new le(22,new X(2,11),new X(2,12))),new Pe(6,Int32Array.from([6,34]),new le(18,new X(2,68)),new le(16,new X(4,27)),new le(24,new X(4,19)),new le(28,new X(4,15))),new Pe(7,Int32Array.from([6,22,38]),new le(20,new X(2,78)),new le(18,new X(4,31)),new le(18,new X(2,14),new X(4,15)),new le(26,new X(4,13),new X(1,14))),new Pe(8,Int32Array.from([6,24,42]),new le(24,new X(2,97)),new le(22,new X(2,38),new X(2,39)),new le(22,new X(4,18),new X(2,19)),new le(26,new X(4,14),new X(2,15))),new Pe(9,Int32Array.from([6,26,46]),new le(30,new X(2,116)),new le(22,new X(3,36),new X(2,37)),new le(20,new X(4,16),new X(4,17)),new le(24,new X(4,12),new X(4,13))),new Pe(10,Int32Array.from([6,28,50]),new le(18,new X(2,68),new X(2,69)),new le(26,new X(4,43),new X(1,44)),new le(24,new X(6,19),new X(2,20)),new le(28,new X(6,15),new X(2,16))),new Pe(11,Int32Array.from([6,30,54]),new le(20,new X(4,81)),new le(30,new X(1,50),new X(4,51)),new le(28,new X(4,22),new X(4,23)),new le(24,new X(3,12),new X(8,13))),new Pe(12,Int32Array.from([6,32,58]),new le(24,new X(2,92),new X(2,93)),new le(22,new X(6,36),new X(2,37)),new le(26,new X(4,20),new X(6,21)),new le(28,new X(7,14),new X(4,15))),new Pe(13,Int32Array.from([6,34,62]),new le(26,new X(4,107)),new le(22,new X(8,37),new X(1,38)),new le(24,new X(8,20),new X(4,21)),new le(22,new X(12,11),new X(4,12))),new Pe(14,Int32Array.from([6,26,46,66]),new le(30,new X(3,115),new X(1,116)),new le(24,new X(4,40),new X(5,41)),new le(20,new X(11,16),new X(5,17)),new le(24,new X(11,12),new X(5,13))),new Pe(15,Int32Array.from([6,26,48,70]),new le(22,new X(5,87),new X(1,88)),new le(24,new X(5,41),new X(5,42)),new le(30,new X(5,24),new X(7,25)),new le(24,new X(11,12),new X(7,13))),new Pe(16,Int32Array.from([6,26,50,74]),new le(24,new X(5,98),new X(1,99)),new le(28,new X(7,45),new X(3,46)),new le(24,new X(15,19),new X(2,20)),new le(30,new X(3,15),new X(13,16))),new Pe(17,Int32Array.from([6,30,54,78]),new le(28,new X(1,107),new X(5,108)),new le(28,new X(10,46),new X(1,47)),new le(28,new X(1,22),new X(15,23)),new le(28,new X(2,14),new X(17,15))),new Pe(18,Int32Array.from([6,30,56,82]),new le(30,new X(5,120),new X(1,121)),new le(26,new X(9,43),new X(4,44)),new le(28,new X(17,22),new X(1,23)),new le(28,new X(2,14),new X(19,15))),new Pe(19,Int32Array.from([6,30,58,86]),new le(28,new X(3,113),new X(4,114)),new le(26,new X(3,44),new X(11,45)),new le(26,new X(17,21),new X(4,22)),new le(26,new X(9,13),new X(16,14))),new Pe(20,Int32Array.from([6,34,62,90]),new le(28,new X(3,107),new X(5,108)),new le(26,new X(3,41),new X(13,42)),new le(30,new X(15,24),new X(5,25)),new le(28,new X(15,15),new X(10,16))),new Pe(21,Int32Array.from([6,28,50,72,94]),new le(28,new X(4,116),new X(4,117)),new le(26,new X(17,42)),new le(28,new X(17,22),new X(6,23)),new le(30,new X(19,16),new X(6,17))),new Pe(22,Int32Array.from([6,26,50,74,98]),new le(28,new X(2,111),new X(7,112)),new le(28,new X(17,46)),new le(30,new X(7,24),new X(16,25)),new le(24,new X(34,13))),new Pe(23,Int32Array.from([6,30,54,78,102]),new le(30,new X(4,121),new X(5,122)),new le(28,new X(4,47),new X(14,48)),new le(30,new X(11,24),new X(14,25)),new le(30,new X(16,15),new X(14,16))),new Pe(24,Int32Array.from([6,28,54,80,106]),new le(30,new X(6,117),new X(4,118)),new le(28,new X(6,45),new X(14,46)),new le(30,new X(11,24),new X(16,25)),new le(30,new X(30,16),new X(2,17))),new Pe(25,Int32Array.from([6,32,58,84,110]),new le(26,new X(8,106),new X(4,107)),new le(28,new X(8,47),new X(13,48)),new le(30,new X(7,24),new X(22,25)),new le(30,new X(22,15),new X(13,16))),new Pe(26,Int32Array.from([6,30,58,86,114]),new le(28,new X(10,114),new X(2,115)),new le(28,new X(19,46),new X(4,47)),new le(28,new X(28,22),new X(6,23)),new le(30,new X(33,16),new X(4,17))),new Pe(27,Int32Array.from([6,34,62,90,118]),new le(30,new X(8,122),new X(4,123)),new le(28,new X(22,45),new X(3,46)),new le(30,new X(8,23),new X(26,24)),new le(30,new X(12,15),new X(28,16))),new Pe(28,Int32Array.from([6,26,50,74,98,122]),new le(30,new X(3,117),new X(10,118)),new le(28,new X(3,45),new X(23,46)),new le(30,new X(4,24),new X(31,25)),new le(30,new X(11,15),new X(31,16))),new Pe(29,Int32Array.from([6,30,54,78,102,126]),new le(30,new X(7,116),new X(7,117)),new le(28,new X(21,45),new X(7,46)),new le(30,new X(1,23),new X(37,24)),new le(30,new X(19,15),new X(26,16))),new Pe(30,Int32Array.from([6,26,52,78,104,130]),new le(30,new X(5,115),new X(10,116)),new le(28,new X(19,47),new X(10,48)),new le(30,new X(15,24),new X(25,25)),new le(30,new X(23,15),new X(25,16))),new Pe(31,Int32Array.from([6,30,56,82,108,134]),new le(30,new X(13,115),new X(3,116)),new le(28,new X(2,46),new X(29,47)),new le(30,new X(42,24),new X(1,25)),new le(30,new X(23,15),new X(28,16))),new Pe(32,Int32Array.from([6,34,60,86,112,138]),new le(30,new X(17,115)),new le(28,new X(10,46),new X(23,47)),new le(30,new X(10,24),new X(35,25)),new le(30,new X(19,15),new X(35,16))),new Pe(33,Int32Array.from([6,30,58,86,114,142]),new le(30,new X(17,115),new X(1,116)),new le(28,new X(14,46),new X(21,47)),new le(30,new X(29,24),new X(19,25)),new le(30,new X(11,15),new X(46,16))),new Pe(34,Int32Array.from([6,34,62,90,118,146]),new le(30,new X(13,115),new X(6,116)),new le(28,new X(14,46),new X(23,47)),new le(30,new X(44,24),new X(7,25)),new le(30,new X(59,16),new X(1,17))),new Pe(35,Int32Array.from([6,30,54,78,102,126,150]),new le(30,new X(12,121),new X(7,122)),new le(28,new X(12,47),new X(26,48)),new le(30,new X(39,24),new X(14,25)),new le(30,new X(22,15),new X(41,16))),new Pe(36,Int32Array.from([6,24,50,76,102,128,154]),new le(30,new X(6,121),new X(14,122)),new le(28,new X(6,47),new X(34,48)),new le(30,new X(46,24),new X(10,25)),new le(30,new X(2,15),new X(64,16))),new Pe(37,Int32Array.from([6,28,54,80,106,132,158]),new le(30,new X(17,122),new X(4,123)),new le(28,new X(29,46),new X(14,47)),new le(30,new X(49,24),new X(10,25)),new le(30,new X(24,15),new X(46,16))),new Pe(38,Int32Array.from([6,32,58,84,110,136,162]),new le(30,new X(4,122),new X(18,123)),new le(28,new X(13,46),new X(32,47)),new le(30,new X(48,24),new X(14,25)),new le(30,new X(42,15),new X(32,16))),new Pe(39,Int32Array.from([6,26,54,82,110,138,166]),new le(30,new X(20,117),new X(4,118)),new le(28,new X(40,47),new X(7,48)),new le(30,new X(43,24),new X(22,25)),new le(30,new X(10,15),new X(67,16))),new Pe(40,Int32Array.from([6,30,58,86,114,142,170]),new le(30,new X(19,118),new X(6,119)),new le(28,new X(18,47),new X(31,48)),new le(30,new X(34,24),new X(34,25)),new le(30,new X(20,15),new X(61,16)))];var er;(function(j){j[j.DATA_MASK_000=0]="DATA_MASK_000",j[j.DATA_MASK_001=1]="DATA_MASK_001",j[j.DATA_MASK_010=2]="DATA_MASK_010",j[j.DATA_MASK_011=3]="DATA_MASK_011",j[j.DATA_MASK_100=4]="DATA_MASK_100",j[j.DATA_MASK_101=5]="DATA_MASK_101",j[j.DATA_MASK_110=6]="DATA_MASK_110",j[j.DATA_MASK_111=7]="DATA_MASK_111"})(er||(er={}));class xr{constructor(a,o){this.value=a,this.isMasked=o}unmaskBitMatrix(a,o){for(let u=0;u<o;u++)for(let f=0;f<o;f++)this.isMasked(u,f)&&a.flip(f,u)}}xr.values=new Map([[er.DATA_MASK_000,new xr(er.DATA_MASK_000,(j,a)=>(j+a&1)===0)],[er.DATA_MASK_001,new xr(er.DATA_MASK_001,(j,a)=>(j&1)===0)],[er.DATA_MASK_010,new xr(er.DATA_MASK_010,(j,a)=>a%3===0)],[er.DATA_MASK_011,new xr(er.DATA_MASK_011,(j,a)=>(j+a)%3===0)],[er.DATA_MASK_100,new xr(er.DATA_MASK_100,(j,a)=>(Math.floor(j/2)+Math.floor(a/3)&1)===0)],[er.DATA_MASK_101,new xr(er.DATA_MASK_101,(j,a)=>j*a%6===0)],[er.DATA_MASK_110,new xr(er.DATA_MASK_110,(j,a)=>j*a%6<3)],[er.DATA_MASK_111,new xr(er.DATA_MASK_111,(j,a)=>(j+a+j*a%3&1)===0)]]);class fi{constructor(a){const o=a.getHeight();if(o<21||(o&3)!==1)throw new A;this.bitMatrix=a}readFormatInformation(){if(this.parsedFormatInfo!==null&&this.parsedFormatInfo!==void 0)return this.parsedFormatInfo;let a=0;for(let m=0;m<6;m++)a=this.copyBit(m,8,a);a=this.copyBit(7,8,a),a=this.copyBit(8,8,a),a=this.copyBit(8,7,a);for(let m=5;m>=0;m--)a=this.copyBit(8,m,a);const o=this.bitMatrix.getHeight();let u=0;const f=o-7;for(let m=o-1;m>=f;m--)u=this.copyBit(8,m,u);for(let m=o-8;m<o;m++)u=this.copyBit(m,8,u);if(this.parsedFormatInfo=or.decodeFormatInformation(a,u),this.parsedFormatInfo!==null)return this.parsedFormatInfo;throw new A}readVersion(){if(this.parsedVersion!==null&&this.parsedVersion!==void 0)return this.parsedVersion;const a=this.bitMatrix.getHeight(),o=Math.floor((a-17)/4);if(o<=6)return Pe.getVersionForNumber(o);let u=0;const f=a-11;for(let g=5;g>=0;g--)for(let w=a-9;w>=f;w--)u=this.copyBit(w,g,u);let m=Pe.decodeVersionInformation(u);if(m!==null&&m.getDimensionForVersion()===a)return this.parsedVersion=m,m;u=0;for(let g=5;g>=0;g--)for(let w=a-9;w>=f;w--)u=this.copyBit(g,w,u);if(m=Pe.decodeVersionInformation(u),m!==null&&m.getDimensionForVersion()===a)return this.parsedVersion=m,m;throw new A}copyBit(a,o,u){return(this.isMirror?this.bitMatrix.get(o,a):this.bitMatrix.get(a,o))?u<<1|1:u<<1}readCodewords(){const a=this.readFormatInformation(),o=this.readVersion(),u=xr.values.get(a.getDataMask()),f=this.bitMatrix.getHeight();u.unmaskBitMatrix(this.bitMatrix,f);const m=o.buildFunctionPattern();let g=!0;const w=new Uint8Array(o.getTotalCodewords());let b=0,I=0,P=0;for(let V=f-1;V>0;V-=2){V===6&&V--;for(let z=0;z<f;z++){const Y=g?f-1-z:z;for(let ne=0;ne<2;ne++)m.get(V-ne,Y)||(P++,I<<=1,this.bitMatrix.get(V-ne,Y)&&(I|=1),P===8&&(w[b++]=I,P=0,I=0))}g=!g}if(b!==o.getTotalCodewords())throw new A;return w}remask(){if(this.parsedFormatInfo===null)return;const a=xr.values[this.parsedFormatInfo.getDataMask()],o=this.bitMatrix.getHeight();a.unmaskBitMatrix(this.bitMatrix,o)}setMirror(a){this.parsedVersion=null,this.parsedFormatInfo=null,this.isMirror=a}mirror(){const a=this.bitMatrix;for(let o=0,u=a.getWidth();o<u;o++)for(let f=o+1,m=a.getHeight();f<m;f++)a.get(o,f)!==a.get(f,o)&&(a.flip(f,o),a.flip(o,f))}}class Ql{constructor(a,o){this.numDataCodewords=a,this.codewords=o}static getDataBlocks(a,o,u){if(a.length!==o.getTotalCodewords())throw new E;const f=o.getECBlocksForLevel(u);let m=0;const g=f.getECBlocks();for(const ne of g)m+=ne.getCount();const w=new Array(m);let b=0;for(const ne of g)for(let re=0;re<ne.getCount();re++){const de=ne.getDataCodewords(),ye=f.getECCodewordsPerBlock()+de;w[b++]=new Ql(de,new Uint8Array(ye))}const I=w[0].codewords.length;let P=w.length-1;for(;P>=0&&w[P].codewords.length!==I;)P--;P++;const V=I-f.getECCodewordsPerBlock();let z=0;for(let ne=0;ne<V;ne++)for(let re=0;re<b;re++)w[re].codewords[ne]=a[z++];for(let ne=P;ne<b;ne++)w[ne].codewords[V]=a[z++];const Y=w[0].codewords.length;for(let ne=V;ne<Y;ne++)for(let re=0;re<b;re++){const de=re<P?ne:ne+1;w[re].codewords[de]=a[z++]}return w}getNumDataCodewords(){return this.numDataCodewords}getCodewords(){return this.codewords}}var ts;(function(j){j[j.TERMINATOR=0]="TERMINATOR",j[j.NUMERIC=1]="NUMERIC",j[j.ALPHANUMERIC=2]="ALPHANUMERIC",j[j.STRUCTURED_APPEND=3]="STRUCTURED_APPEND",j[j.BYTE=4]="BYTE",j[j.ECI=5]="ECI",j[j.KANJI=6]="KANJI",j[j.FNC1_FIRST_POSITION=7]="FNC1_FIRST_POSITION",j[j.FNC1_SECOND_POSITION=8]="FNC1_SECOND_POSITION",j[j.HANZI=9]="HANZI"})(ts||(ts={}));class kt{constructor(a,o,u,f){this.value=a,this.stringValue=o,this.characterCountBitsForVersions=u,this.bits=f,kt.FOR_BITS.set(f,this),kt.FOR_VALUE.set(a,this)}static forBits(a){const o=kt.FOR_BITS.get(a);if(o===void 0)throw new E;return o}getCharacterCountBits(a){const o=a.getVersionNumber();let u;return o<=9?u=0:o<=26?u=1:u=2,this.characterCountBitsForVersions[u]}getValue(){return this.value}getBits(){return this.bits}equals(a){if(!(a instanceof kt))return!1;const o=a;return this.value===o.value}toString(){return this.stringValue}}kt.FOR_BITS=new Map,kt.FOR_VALUE=new Map,kt.TERMINATOR=new kt(ts.TERMINATOR,"TERMINATOR",Int32Array.from([0,0,0]),0),kt.NUMERIC=new kt(ts.NUMERIC,"NUMERIC",Int32Array.from([10,12,14]),1),kt.ALPHANUMERIC=new kt(ts.ALPHANUMERIC,"ALPHANUMERIC",Int32Array.from([9,11,13]),2),kt.STRUCTURED_APPEND=new kt(ts.STRUCTURED_APPEND,"STRUCTURED_APPEND",Int32Array.from([0,0,0]),3),kt.BYTE=new kt(ts.BYTE,"BYTE",Int32Array.from([8,16,16]),4),kt.ECI=new kt(ts.ECI,"ECI",Int32Array.from([0,0,0]),7),kt.KANJI=new kt(ts.KANJI,"KANJI",Int32Array.from([8,10,12]),8),kt.FNC1_FIRST_POSITION=new kt(ts.FNC1_FIRST_POSITION,"FNC1_FIRST_POSITION",Int32Array.from([0,0,0]),5),kt.FNC1_SECOND_POSITION=new kt(ts.FNC1_SECOND_POSITION,"FNC1_SECOND_POSITION",Int32Array.from([0,0,0]),9),kt.HANZI=new kt(ts.HANZI,"HANZI",Int32Array.from([8,10,12]),13);class rr{static decode(a,o,u,f){const m=new qs(a);let g=new R;const w=new Array;let b=-1,I=-1;try{let P=null,V=!1,z;do{if(m.available()<4)z=kt.TERMINATOR;else{const Y=m.readBits(4);z=kt.forBits(Y)}switch(z){case kt.TERMINATOR:break;case kt.FNC1_FIRST_POSITION:case kt.FNC1_SECOND_POSITION:V=!0;break;case kt.STRUCTURED_APPEND:if(m.available()<16)throw new A;b=m.readBits(8),I=m.readBits(8);break;case kt.ECI:const Y=rr.parseECIValue(m);if(P=N.getCharacterSetECIByValue(Y),P===null)throw new A;break;case kt.HANZI:const ne=m.readBits(4),re=m.readBits(z.getCharacterCountBits(o));ne===rr.GB2312_SUBSET&&rr.decodeHanziSegment(m,g,re);break;default:const de=m.readBits(z.getCharacterCountBits(o));switch(z){case kt.NUMERIC:rr.decodeNumericSegment(m,g,de);break;case kt.ALPHANUMERIC:rr.decodeAlphanumericSegment(m,g,de,V);break;case kt.BYTE:rr.decodeByteSegment(m,g,de,P,w,f);break;case kt.KANJI:rr.decodeKanjiSegment(m,g,de);break;default:throw new A}break}}while(z!==kt.TERMINATOR)}catch{throw new A}return new Vt(a,g.toString(),w.length===0?null:w,u===null?null:u.toString(),b,I)}static decodeHanziSegment(a,o,u){if(u*13>a.available())throw new A;const f=new Uint8Array(2*u);let m=0;for(;u>0;){const g=a.readBits(13);let w=g/96<<8&4294967295|g%96;w<959?w+=41377:w+=42657,f[m]=w>>8&255,f[m+1]=w&255,m+=2,u--}try{o.append(O.decode(f,F.GB2312))}catch(g){throw new A(g)}}static decodeKanjiSegment(a,o,u){if(u*13>a.available())throw new A;const f=new Uint8Array(2*u);let m=0;for(;u>0;){const g=a.readBits(13);let w=g/192<<8&4294967295|g%192;w<7936?w+=33088:w+=49472,f[m]=w>>8,f[m+1]=w,m+=2,u--}try{o.append(O.decode(f,F.SHIFT_JIS))}catch(g){throw new A(g)}}static decodeByteSegment(a,o,u,f,m,g){if(8*u>a.available())throw new A;const w=new Uint8Array(u);for(let I=0;I<u;I++)w[I]=a.readBits(8);let b;f===null?b=F.guessEncoding(w,g):b=f.getName();try{o.append(O.decode(w,b))}catch(I){throw new A(I)}m.push(w)}static toAlphaNumericChar(a){if(a>=rr.ALPHANUMERIC_CHARS.length)throw new A;return rr.ALPHANUMERIC_CHARS[a]}static decodeAlphanumericSegment(a,o,u,f){const m=o.length();for(;u>1;){if(a.available()<11)throw new A;const g=a.readBits(11);o.append(rr.toAlphaNumericChar(Math.floor(g/45))),o.append(rr.toAlphaNumericChar(g%45)),u-=2}if(u===1){if(a.available()<6)throw new A;o.append(rr.toAlphaNumericChar(a.readBits(6)))}if(f)for(let g=m;g<o.length();g++)o.charAt(g)==="%"&&(g<o.length()-1&&o.charAt(g+1)==="%"?o.deleteCharAt(g+1):o.setCharAt(g,""))}static decodeNumericSegment(a,o,u){for(;u>=3;){if(a.available()<10)throw new A;const f=a.readBits(10);if(f>=1e3)throw new A;o.append(rr.toAlphaNumericChar(Math.floor(f/100))),o.append(rr.toAlphaNumericChar(Math.floor(f/10)%10)),o.append(rr.toAlphaNumericChar(f%10)),u-=3}if(u===2){if(a.available()<7)throw new A;const f=a.readBits(7);if(f>=100)throw new A;o.append(rr.toAlphaNumericChar(Math.floor(f/10))),o.append(rr.toAlphaNumericChar(f%10))}else if(u===1){if(a.available()<4)throw new A;const f=a.readBits(4);if(f>=10)throw new A;o.append(rr.toAlphaNumericChar(f))}}static parseECIValue(a){const o=a.readBits(8);if(!(o&128))return o&127;if((o&192)===128){const u=a.readBits(8);return(o&63)<<8&4294967295|u}if((o&224)===192){const u=a.readBits(16);return(o&31)<<16&4294967295|u}throw new A}}rr.ALPHANUMERIC_CHARS="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ $%*+-./:",rr.GB2312_SUBSET=1;class uu{constructor(a){this.mirrored=a}isMirrored(){return this.mirrored}applyMirroredCorrection(a){if(!this.mirrored||a===null||a.length<3)return;const o=a[0];a[0]=a[2],a[2]=o}}class Gd{constructor(){this.rsDecoder=new Ge(se.QR_CODE_FIELD_256)}decodeBooleanArray(a,o){return this.decodeBitMatrix(ie.parseFromBooleanArray(a),o)}decodeBitMatrix(a,o){const u=new fi(a);let f=null;try{return this.decodeBitMatrixParser(u,o)}catch(m){f=m}try{u.remask(),u.setMirror(!0),u.readVersion(),u.readFormatInformation(),u.mirror();const m=this.decodeBitMatrixParser(u,o);return m.setOther(new uu(!0)),m}catch(m){throw f!==null?f:m}}decodeBitMatrixParser(a,o){const u=a.readVersion(),f=a.readFormatInformation().getErrorCorrectionLevel(),m=a.readCodewords(),g=Ql.getDataBlocks(m,u,f);let w=0;for(const P of g)w+=P.getNumDataCodewords();const b=new Uint8Array(w);let I=0;for(const P of g){const V=P.getCodewords(),z=P.getNumDataCodewords();this.correctErrors(V,z);for(let Y=0;Y<z;Y++)b[I++]=V[Y]}return rr.decode(b,u,f,o)}correctErrors(a,o){const u=new Int32Array(a);try{this.rsDecoder.decode(u,a.length-o)}catch{throw new k}for(let f=0;f<o;f++)a[f]=u[f]}}class Ls extends ae{constructor(a,o,u){super(a,o),this.estimatedModuleSize=u}aboutEquals(a,o,u){if(Math.abs(o-this.getY())<=a&&Math.abs(u-this.getX())<=a){const f=Math.abs(a-this.estimatedModuleSize);return f<=1||f<=this.estimatedModuleSize}return!1}combineEstimate(a,o,u){const f=(this.getX()+o)/2,m=(this.getY()+a)/2,g=(this.estimatedModuleSize+u)/2;return new Ls(f,m,g)}}class Rr{constructor(a,o,u,f,m,g,w){this.image=a,this.startX=o,this.startY=u,this.width=f,this.height=m,this.moduleSize=g,this.resultPointCallback=w,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(3)}find(){const a=this.startX,o=this.height,u=this.width,f=a+u,m=this.startY+o/2,g=new Int32Array(3),w=this.image;for(let b=0;b<o;b++){const I=m+(b&1?-Math.floor((b+1)/2):Math.floor((b+1)/2));g[0]=0,g[1]=0,g[2]=0;let P=a;for(;P<f&&!w.get(P,I);)P++;let V=0;for(;P<f;){if(w.get(P,I))if(V===1)g[1]++;else if(V===2){if(this.foundPatternCross(g)){const z=this.handlePossibleCenter(g,I,P);if(z!==null)return z}g[0]=g[2],g[1]=1,g[2]=0,V=1}else g[++V]++;else V===1&&V++,g[V]++;P++}if(this.foundPatternCross(g)){const z=this.handlePossibleCenter(g,I,f);if(z!==null)return z}}if(this.possibleCenters.length!==0)return this.possibleCenters[0];throw new te}static centerFromEnd(a,o){return o-a[2]-a[1]/2}foundPatternCross(a){const o=this.moduleSize,u=o/2;for(let f=0;f<3;f++)if(Math.abs(o-a[f])>=u)return!1;return!0}crossCheckVertical(a,o,u,f){const m=this.image,g=m.getHeight(),w=this.crossCheckStateCount;w[0]=0,w[1]=0,w[2]=0;let b=a;for(;b>=0&&m.get(o,b)&&w[1]<=u;)w[1]++,b--;if(b<0||w[1]>u)return NaN;for(;b>=0&&!m.get(o,b)&&w[0]<=u;)w[0]++,b--;if(w[0]>u)return NaN;for(b=a+1;b<g&&m.get(o,b)&&w[1]<=u;)w[1]++,b++;if(b===g||w[1]>u)return NaN;for(;b<g&&!m.get(o,b)&&w[2]<=u;)w[2]++,b++;if(w[2]>u)return NaN;const I=w[0]+w[1]+w[2];return 5*Math.abs(I-f)>=2*f?NaN:this.foundPatternCross(w)?Rr.centerFromEnd(w,b):NaN}handlePossibleCenter(a,o,u){const f=a[0]+a[1]+a[2],m=Rr.centerFromEnd(a,u),g=this.crossCheckVertical(o,m,2*a[1],f);if(!isNaN(g)){const w=(a[0]+a[1]+a[2])/3;for(const I of this.possibleCenters)if(I.aboutEquals(w,g,m))return I.combineEstimate(g,m,w);const b=new Ls(m,g,w);this.possibleCenters.push(b),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(b)}return null}}class Xa extends ae{constructor(a,o,u,f){super(a,o),this.estimatedModuleSize=u,this.count=f,f===void 0&&(this.count=1)}getEstimatedModuleSize(){return this.estimatedModuleSize}getCount(){return this.count}aboutEquals(a,o,u){if(Math.abs(o-this.getY())<=a&&Math.abs(u-this.getX())<=a){const f=Math.abs(a-this.estimatedModuleSize);return f<=1||f<=this.estimatedModuleSize}return!1}combineEstimate(a,o,u){const f=this.count+1,m=(this.count*this.getX()+o)/f,g=(this.count*this.getY()+a)/f,w=(this.count*this.estimatedModuleSize+u)/f;return new Xa(m,g,w,f)}}class Yl{constructor(a){this.bottomLeft=a[0],this.topLeft=a[1],this.topRight=a[2]}getBottomLeft(){return this.bottomLeft}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}}class wr{constructor(a,o){this.image=a,this.resultPointCallback=o,this.possibleCenters=[],this.crossCheckStateCount=new Int32Array(5),this.resultPointCallback=o}getImage(){return this.image}getPossibleCenters(){return this.possibleCenters}find(a){const o=a!=null&&a.get(Z.TRY_HARDER)!==void 0,u=a!=null&&a.get(Z.PURE_BARCODE)!==void 0,f=this.image,m=f.getHeight(),g=f.getWidth();let w=Math.floor(3*m/(4*wr.MAX_MODULES));(w<wr.MIN_SKIP||o)&&(w=wr.MIN_SKIP);let b=!1;const I=new Int32Array(5);for(let V=w-1;V<m&&!b;V+=w){I[0]=0,I[1]=0,I[2]=0,I[3]=0,I[4]=0;let z=0;for(let Y=0;Y<g;Y++)if(f.get(Y,V))(z&1)===1&&z++,I[z]++;else if(z&1)I[z]++;else if(z===4)if(wr.foundPatternCross(I)){if(this.handlePossibleCenter(I,V,Y,u)===!0)if(w=2,this.hasSkipped===!0)b=this.haveMultiplyConfirmedCenters();else{const re=this.findRowSkip();re>I[2]&&(V+=re-I[2]-w,Y=g-1)}else{I[0]=I[2],I[1]=I[3],I[2]=I[4],I[3]=1,I[4]=0,z=3;continue}z=0,I[0]=0,I[1]=0,I[2]=0,I[3]=0,I[4]=0}else I[0]=I[2],I[1]=I[3],I[2]=I[4],I[3]=1,I[4]=0,z=3;else I[++z]++;wr.foundPatternCross(I)&&this.handlePossibleCenter(I,V,g,u)===!0&&(w=I[0],this.hasSkipped&&(b=this.haveMultiplyConfirmedCenters()))}const P=this.selectBestPatterns();return ae.orderBestPatterns(P),new Yl(P)}static centerFromEnd(a,o){return o-a[4]-a[3]-a[2]/2}static foundPatternCross(a){let o=0;for(let m=0;m<5;m++){const g=a[m];if(g===0)return!1;o+=g}if(o<7)return!1;const u=o/7,f=u/2;return Math.abs(u-a[0])<f&&Math.abs(u-a[1])<f&&Math.abs(3*u-a[2])<3*f&&Math.abs(u-a[3])<f&&Math.abs(u-a[4])<f}getCrossCheckStateCount(){const a=this.crossCheckStateCount;return a[0]=0,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a}crossCheckDiagonal(a,o,u,f){const m=this.getCrossCheckStateCount();let g=0;const w=this.image;for(;a>=g&&o>=g&&w.get(o-g,a-g);)m[2]++,g++;if(a<g||o<g)return!1;for(;a>=g&&o>=g&&!w.get(o-g,a-g)&&m[1]<=u;)m[1]++,g++;if(a<g||o<g||m[1]>u)return!1;for(;a>=g&&o>=g&&w.get(o-g,a-g)&&m[0]<=u;)m[0]++,g++;if(m[0]>u)return!1;const b=w.getHeight(),I=w.getWidth();for(g=1;a+g<b&&o+g<I&&w.get(o+g,a+g);)m[2]++,g++;if(a+g>=b||o+g>=I)return!1;for(;a+g<b&&o+g<I&&!w.get(o+g,a+g)&&m[3]<u;)m[3]++,g++;if(a+g>=b||o+g>=I||m[3]>=u)return!1;for(;a+g<b&&o+g<I&&w.get(o+g,a+g)&&m[4]<u;)m[4]++,g++;if(m[4]>=u)return!1;const P=m[0]+m[1]+m[2]+m[3]+m[4];return Math.abs(P-f)<2*f&&wr.foundPatternCross(m)}crossCheckVertical(a,o,u,f){const m=this.image,g=m.getHeight(),w=this.getCrossCheckStateCount();let b=a;for(;b>=0&&m.get(o,b);)w[2]++,b--;if(b<0)return NaN;for(;b>=0&&!m.get(o,b)&&w[1]<=u;)w[1]++,b--;if(b<0||w[1]>u)return NaN;for(;b>=0&&m.get(o,b)&&w[0]<=u;)w[0]++,b--;if(w[0]>u)return NaN;for(b=a+1;b<g&&m.get(o,b);)w[2]++,b++;if(b===g)return NaN;for(;b<g&&!m.get(o,b)&&w[3]<u;)w[3]++,b++;if(b===g||w[3]>=u)return NaN;for(;b<g&&m.get(o,b)&&w[4]<u;)w[4]++,b++;if(w[4]>=u)return NaN;const I=w[0]+w[1]+w[2]+w[3]+w[4];return 5*Math.abs(I-f)>=2*f?NaN:wr.foundPatternCross(w)?wr.centerFromEnd(w,b):NaN}crossCheckHorizontal(a,o,u,f){const m=this.image,g=m.getWidth(),w=this.getCrossCheckStateCount();let b=a;for(;b>=0&&m.get(b,o);)w[2]++,b--;if(b<0)return NaN;for(;b>=0&&!m.get(b,o)&&w[1]<=u;)w[1]++,b--;if(b<0||w[1]>u)return NaN;for(;b>=0&&m.get(b,o)&&w[0]<=u;)w[0]++,b--;if(w[0]>u)return NaN;for(b=a+1;b<g&&m.get(b,o);)w[2]++,b++;if(b===g)return NaN;for(;b<g&&!m.get(b,o)&&w[3]<u;)w[3]++,b++;if(b===g||w[3]>=u)return NaN;for(;b<g&&m.get(b,o)&&w[4]<u;)w[4]++,b++;if(w[4]>=u)return NaN;const I=w[0]+w[1]+w[2]+w[3]+w[4];return 5*Math.abs(I-f)>=f?NaN:wr.foundPatternCross(w)?wr.centerFromEnd(w,b):NaN}handlePossibleCenter(a,o,u,f){const m=a[0]+a[1]+a[2]+a[3]+a[4];let g=wr.centerFromEnd(a,u),w=this.crossCheckVertical(o,Math.floor(g),a[2],m);if(!isNaN(w)&&(g=this.crossCheckHorizontal(Math.floor(g),Math.floor(w),a[2],m),!isNaN(g)&&(!f||this.crossCheckDiagonal(Math.floor(w),Math.floor(g),a[2],m)))){const b=m/7;let I=!1;const P=this.possibleCenters;for(let V=0,z=P.length;V<z;V++){const Y=P[V];if(Y.aboutEquals(b,w,g)){P[V]=Y.combineEstimate(w,g,b),I=!0;break}}if(!I){const V=new Xa(g,w,b);P.push(V),this.resultPointCallback!==null&&this.resultPointCallback!==void 0&&this.resultPointCallback.foundPossibleResultPoint(V)}return!0}return!1}findRowSkip(){if(this.possibleCenters.length<=1)return 0;let o=null;for(const u of this.possibleCenters)if(u.getCount()>=wr.CENTER_QUORUM)if(o==null)o=u;else return this.hasSkipped=!0,Math.floor((Math.abs(o.getX()-u.getX())-Math.abs(o.getY()-u.getY()))/2);return 0}haveMultiplyConfirmedCenters(){let a=0,o=0;const u=this.possibleCenters.length;for(const g of this.possibleCenters)g.getCount()>=wr.CENTER_QUORUM&&(a++,o+=g.getEstimatedModuleSize());if(a<3)return!1;const f=o/u;let m=0;for(const g of this.possibleCenters)m+=Math.abs(g.getEstimatedModuleSize()-f);return m<=.05*o}selectBestPatterns(){const a=this.possibleCenters.length;if(a<3)throw new te;const o=this.possibleCenters;let u;if(a>3){let f=0,m=0;for(const b of this.possibleCenters){const I=b.getEstimatedModuleSize();f+=I,m+=I*I}u=f/a;let g=Math.sqrt(m/a-u*u);o.sort((b,I)=>{const P=Math.abs(I.getEstimatedModuleSize()-u),V=Math.abs(b.getEstimatedModuleSize()-u);return P<V?-1:P>V?1:0});const w=Math.max(.2*u,g);for(let b=0;b<o.length&&o.length>3;b++){const I=o[b];Math.abs(I.getEstimatedModuleSize()-u)>w&&(o.splice(b,1),b--)}}if(o.length>3){let f=0;for(const m of o)f+=m.getEstimatedModuleSize();u=f/o.length,o.sort((m,g)=>{if(g.getCount()===m.getCount()){const w=Math.abs(g.getEstimatedModuleSize()-u),b=Math.abs(m.getEstimatedModuleSize()-u);return w<b?1:w>b?-1:0}else return g.getCount()-m.getCount()}),o.splice(3)}return[o[0],o[1],o[2]]}}wr.CENTER_QUORUM=2,wr.MIN_SKIP=3,wr.MAX_MODULES=57;class Yr{constructor(a){this.image=a}getImage(){return this.image}getResultPointCallback(){return this.resultPointCallback}detect(a){this.resultPointCallback=a==null?null:a.get(Z.NEED_RESULT_POINT_CALLBACK);const u=new wr(this.image,this.resultPointCallback).find(a);return this.processFinderPatternInfo(u)}processFinderPatternInfo(a){const o=a.getTopLeft(),u=a.getTopRight(),f=a.getBottomLeft(),m=this.calculateModuleSize(o,u,f);if(m<1)throw new te("No pattern found in proccess finder.");const g=Yr.computeDimension(o,u,f,m),w=Pe.getProvisionalVersionForDimension(g),b=w.getDimensionForVersion()-7;let I=null;if(w.getAlignmentPatternCenters().length>0){const Y=u.getX()-o.getX()+f.getX(),ne=u.getY()-o.getY()+f.getY(),re=1-3/b,de=Math.floor(o.getX()+re*(Y-o.getX())),ye=Math.floor(o.getY()+re*(ne-o.getY()));for(let Ue=4;Ue<=16;Ue<<=1)try{I=this.findAlignmentInRegion(m,de,ye,Ue);break}catch(ze){if(!(ze instanceof te))throw ze}}const P=Yr.createTransform(o,u,f,I,g),V=Yr.sampleGrid(this.image,P,g);let z;return I===null?z=[f,o,u]:z=[f,o,u,I],new ft(V,z)}static createTransform(a,o,u,f,m){const g=m-3.5;let w,b,I,P;return f!==null?(w=f.getX(),b=f.getY(),I=g-3,P=I):(w=o.getX()-a.getX()+u.getX(),b=o.getY()-a.getY()+u.getY(),I=g,P=g),tt.quadrilateralToQuadrilateral(3.5,3.5,g,3.5,I,P,3.5,g,a.getX(),a.getY(),o.getX(),o.getY(),w,b,u.getX(),u.getY())}static sampleGrid(a,o,u){return jt.getInstance().sampleGridWithTransform(a,u,u,o)}static computeDimension(a,o,u,f){const m=st.round(ae.distance(a,o)/f),g=st.round(ae.distance(a,u)/f);let w=Math.floor((m+g)/2)+7;switch(w&3){case 0:w++;break;case 2:w--;break;case 3:throw new te("Dimensions could be not found.")}return w}calculateModuleSize(a,o,u){return(this.calculateModuleSizeOneWay(a,o)+this.calculateModuleSizeOneWay(a,u))/2}calculateModuleSizeOneWay(a,o){const u=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(a.getX()),Math.floor(a.getY()),Math.floor(o.getX()),Math.floor(o.getY())),f=this.sizeOfBlackWhiteBlackRunBothWays(Math.floor(o.getX()),Math.floor(o.getY()),Math.floor(a.getX()),Math.floor(a.getY()));return isNaN(u)?f/7:isNaN(f)?u/7:(u+f)/14}sizeOfBlackWhiteBlackRunBothWays(a,o,u,f){let m=this.sizeOfBlackWhiteBlackRun(a,o,u,f),g=1,w=a-(u-a);w<0?(g=a/(a-w),w=0):w>=this.image.getWidth()&&(g=(this.image.getWidth()-1-a)/(w-a),w=this.image.getWidth()-1);let b=Math.floor(o-(f-o)*g);return g=1,b<0?(g=o/(o-b),b=0):b>=this.image.getHeight()&&(g=(this.image.getHeight()-1-o)/(b-o),b=this.image.getHeight()-1),w=Math.floor(a+(w-a)*g),m+=this.sizeOfBlackWhiteBlackRun(a,o,w,b),m-1}sizeOfBlackWhiteBlackRun(a,o,u,f){const m=Math.abs(f-o)>Math.abs(u-a);if(m){let Y=a;a=o,o=Y,Y=u,u=f,f=Y}const g=Math.abs(u-a),w=Math.abs(f-o);let b=-g/2;const I=a<u?1:-1,P=o<f?1:-1;let V=0;const z=u+I;for(let Y=a,ne=o;Y!==z;Y+=I){const re=m?ne:Y,de=m?Y:ne;if(V===1===this.image.get(re,de)){if(V===2)return st.distance(Y,ne,a,o);V++}if(b+=w,b>0){if(ne===f)break;ne+=P,b-=g}}return V===2?st.distance(u+I,f,a,o):NaN}findAlignmentInRegion(a,o,u,f){const m=Math.floor(f*a),g=Math.max(0,o-m),w=Math.min(this.image.getWidth()-1,o+m);if(w-g<a*3)throw new te("Alignment top exceeds estimated module size.");const b=Math.max(0,u-m),I=Math.min(this.image.getHeight()-1,u+m);if(I-b<a*3)throw new te("Alignment bottom exceeds estimated module size.");return new Rr(this.image,g,b,w-g,I-b,a,this.resultPointCallback).find()}}class ki{constructor(){this.decoder=new Gd}getDecoder(){return this.decoder}decode(a,o){let u,f;if(o!=null&&o.get(Z.PURE_BARCODE)!==void 0){const b=ki.extractPureBits(a.getBlackMatrix());u=this.decoder.decodeBitMatrix(b,o),f=ki.NO_POINTS}else{const b=new Yr(a.getBlackMatrix()).detect(o);u=this.decoder.decodeBitMatrix(b.getBits(),o),f=b.getPoints()}u.getOther()instanceof uu&&u.getOther().applyMirroredCorrection(f);const m=new pe(u.getText(),u.getRawBytes(),void 0,f,fe.QR_CODE,void 0),g=u.getByteSegments();g!==null&&m.putMetadata(Ve.BYTE_SEGMENTS,g);const w=u.getECLevel();return w!==null&&m.putMetadata(Ve.ERROR_CORRECTION_LEVEL,w),u.hasStructuredAppend()&&(m.putMetadata(Ve.STRUCTURED_APPEND_SEQUENCE,u.getStructuredAppendSequenceNumber()),m.putMetadata(Ve.STRUCTURED_APPEND_PARITY,u.getStructuredAppendParity())),m}reset(){}static extractPureBits(a){const o=a.getTopLeftOnBit(),u=a.getBottomRightOnBit();if(o===null||u===null)throw new te;const f=this.moduleSize(o,a);let m=o[1],g=u[1],w=o[0],b=u[0];if(w>=b||m>=g)throw new te;if(g-m!==b-w&&(b=w+(g-m),b>=a.getWidth()))throw new te;const I=Math.round((b-w+1)/f),P=Math.round((g-m+1)/f);if(I<=0||P<=0)throw new te;if(P!==I)throw new te;const V=Math.floor(f/2);m+=V,w+=V;const z=w+Math.floor((I-1)*f)-b;if(z>0){if(z>V)throw new te;w-=z}const Y=m+Math.floor((P-1)*f)-g;if(Y>0){if(Y>V)throw new te;m-=Y}const ne=new ie(I,P);for(let re=0;re<P;re++){const de=m+Math.floor(re*f);for(let ye=0;ye<I;ye++)a.get(w+Math.floor(ye*f),de)&&ne.set(ye,re)}return ne}static moduleSize(a,o){const u=o.getHeight(),f=o.getWidth();let m=a[0],g=a[1],w=!0,b=0;for(;m<f&&g<u;){if(w!==o.get(m,g)){if(++b===5)break;w=!w}m++,g++}if(m===f||g===u)throw new te;return(m-a[0])/7}}ki.NO_POINTS=new Array;class $t{PDF417Common(){}static getBitCountSum(a){return st.sum(a)}static toIntArray(a){if(a==null||!a.length)return $t.EMPTY_INT_ARRAY;const o=new Int32Array(a.length);let u=0;for(const f of a)o[u++]=f;return o}static getCodeword(a){const o=M.binarySearch($t.SYMBOL_TABLE,a&262143);return o<0?-1:($t.CODEWORD_TABLE[o]-1)%$t.NUMBER_OF_CODEWORDS}}$t.NUMBER_OF_CODEWORDS=929,$t.MAX_CODEWORDS_IN_BARCODE=$t.NUMBER_OF_CODEWORDS-1,$t.MIN_ROWS_IN_BARCODE=3,$t.MAX_ROWS_IN_BARCODE=90,$t.MODULES_IN_CODEWORD=17,$t.MODULES_IN_STOP_PATTERN=18,$t.BARS_IN_MODULE=8,$t.EMPTY_INT_ARRAY=new Int32Array([]),$t.SYMBOL_TABLE=Int32Array.from([66142,66170,66206,66236,66290,66292,66350,66382,66396,66454,66470,66476,66594,66600,66614,66626,66628,66632,66640,66654,66662,66668,66682,66690,66718,66720,66748,66758,66776,66798,66802,66804,66820,66824,66832,66846,66848,66876,66880,66936,66950,66956,66968,66992,67006,67022,67036,67042,67044,67048,67062,67118,67150,67164,67214,67228,67256,67294,67322,67350,67366,67372,67398,67404,67416,67438,67474,67476,67490,67492,67496,67510,67618,67624,67650,67656,67664,67678,67686,67692,67706,67714,67716,67728,67742,67744,67772,67782,67788,67800,67822,67826,67828,67842,67848,67870,67872,67900,67904,67960,67974,67992,68016,68030,68046,68060,68066,68068,68072,68086,68104,68112,68126,68128,68156,68160,68216,68336,68358,68364,68376,68400,68414,68448,68476,68494,68508,68536,68546,68548,68552,68560,68574,68582,68588,68654,68686,68700,68706,68708,68712,68726,68750,68764,68792,68802,68804,68808,68816,68830,68838,68844,68858,68878,68892,68920,68976,68990,68994,68996,69e3,69008,69022,69024,69052,69062,69068,69080,69102,69106,69108,69142,69158,69164,69190,69208,69230,69254,69260,69272,69296,69310,69326,69340,69386,69394,69396,69410,69416,69430,69442,69444,69448,69456,69470,69478,69484,69554,69556,69666,69672,69698,69704,69712,69726,69754,69762,69764,69776,69790,69792,69820,69830,69836,69848,69870,69874,69876,69890,69918,69920,69948,69952,70008,70022,70040,70064,70078,70094,70108,70114,70116,70120,70134,70152,70174,70176,70264,70384,70412,70448,70462,70496,70524,70542,70556,70584,70594,70600,70608,70622,70630,70636,70664,70672,70686,70688,70716,70720,70776,70896,71136,71180,71192,71216,71230,71264,71292,71360,71416,71452,71480,71536,71550,71554,71556,71560,71568,71582,71584,71612,71622,71628,71640,71662,71726,71732,71758,71772,71778,71780,71784,71798,71822,71836,71864,71874,71880,71888,71902,71910,71916,71930,71950,71964,71992,72048,72062,72066,72068,72080,72094,72096,72124,72134,72140,72152,72174,72178,72180,72206,72220,72248,72304,72318,72416,72444,72456,72464,72478,72480,72508,72512,72568,72588,72600,72624,72638,72654,72668,72674,72676,72680,72694,72726,72742,72748,72774,72780,72792,72814,72838,72856,72880,72894,72910,72924,72930,72932,72936,72950,72966,72972,72984,73008,73022,73056,73084,73102,73116,73144,73156,73160,73168,73182,73190,73196,73210,73226,73234,73236,73250,73252,73256,73270,73282,73284,73296,73310,73318,73324,73346,73348,73352,73360,73374,73376,73404,73414,73420,73432,73454,73498,73518,73522,73524,73550,73564,73570,73572,73576,73590,73800,73822,73858,73860,73872,73886,73888,73916,73944,73970,73972,73992,74014,74016,74044,74048,74104,74118,74136,74160,74174,74210,74212,74216,74230,74244,74256,74270,74272,74360,74480,74502,74508,74544,74558,74592,74620,74638,74652,74680,74690,74696,74704,74726,74732,74782,74784,74812,74992,75232,75288,75326,75360,75388,75456,75512,75576,75632,75646,75650,75652,75664,75678,75680,75708,75718,75724,75736,75758,75808,75836,75840,75896,76016,76256,76736,76824,76848,76862,76896,76924,76992,77048,77296,77340,77368,77424,77438,77536,77564,77572,77576,77584,77600,77628,77632,77688,77702,77708,77720,77744,77758,77774,77788,77870,77902,77916,77922,77928,77966,77980,78008,78018,78024,78032,78046,78060,78074,78094,78136,78192,78206,78210,78212,78224,78238,78240,78268,78278,78284,78296,78322,78324,78350,78364,78448,78462,78560,78588,78600,78622,78624,78652,78656,78712,78726,78744,78768,78782,78798,78812,78818,78820,78824,78838,78862,78876,78904,78960,78974,79072,79100,79296,79352,79368,79376,79390,79392,79420,79424,79480,79600,79628,79640,79664,79678,79712,79740,79772,79800,79810,79812,79816,79824,79838,79846,79852,79894,79910,79916,79942,79948,79960,79982,79988,80006,80024,80048,80062,80078,80092,80098,80100,80104,80134,80140,80176,80190,80224,80252,80270,80284,80312,80328,80336,80350,80358,80364,80378,80390,80396,80408,80432,80446,80480,80508,80576,80632,80654,80668,80696,80752,80766,80776,80784,80798,80800,80828,80844,80856,80878,80882,80884,80914,80916,80930,80932,80936,80950,80962,80968,80976,80990,80998,81004,81026,81028,81040,81054,81056,81084,81094,81100,81112,81134,81154,81156,81160,81168,81182,81184,81212,81216,81272,81286,81292,81304,81328,81342,81358,81372,81380,81384,81398,81434,81454,81458,81460,81486,81500,81506,81508,81512,81526,81550,81564,81592,81602,81604,81608,81616,81630,81638,81644,81702,81708,81722,81734,81740,81752,81774,81778,81780,82050,82078,82080,82108,82180,82184,82192,82206,82208,82236,82240,82296,82316,82328,82352,82366,82402,82404,82408,82440,82448,82462,82464,82492,82496,82552,82672,82694,82700,82712,82736,82750,82784,82812,82830,82882,82884,82888,82896,82918,82924,82952,82960,82974,82976,83004,83008,83064,83184,83424,83468,83480,83504,83518,83552,83580,83648,83704,83740,83768,83824,83838,83842,83844,83848,83856,83872,83900,83910,83916,83928,83950,83984,84e3,84028,84032,84088,84208,84448,84928,85040,85054,85088,85116,85184,85240,85488,85560,85616,85630,85728,85756,85764,85768,85776,85790,85792,85820,85824,85880,85894,85900,85912,85936,85966,85980,86048,86080,86136,86256,86496,86976,88160,88188,88256,88312,88560,89056,89200,89214,89312,89340,89536,89592,89608,89616,89632,89664,89720,89840,89868,89880,89904,89952,89980,89998,90012,90040,90190,90204,90254,90268,90296,90306,90308,90312,90334,90382,90396,90424,90480,90494,90500,90504,90512,90526,90528,90556,90566,90572,90584,90610,90612,90638,90652,90680,90736,90750,90848,90876,90884,90888,90896,90910,90912,90940,90944,91e3,91014,91020,91032,91056,91070,91086,91100,91106,91108,91112,91126,91150,91164,91192,91248,91262,91360,91388,91584,91640,91664,91678,91680,91708,91712,91768,91888,91928,91952,91966,92e3,92028,92046,92060,92088,92098,92100,92104,92112,92126,92134,92140,92188,92216,92272,92384,92412,92608,92664,93168,93200,93214,93216,93244,93248,93304,93424,93664,93720,93744,93758,93792,93820,93888,93944,93980,94008,94064,94078,94084,94088,94096,94110,94112,94140,94150,94156,94168,94246,94252,94278,94284,94296,94318,94342,94348,94360,94384,94398,94414,94428,94440,94470,94476,94488,94512,94526,94560,94588,94606,94620,94648,94658,94660,94664,94672,94686,94694,94700,94714,94726,94732,94744,94768,94782,94816,94844,94912,94968,94990,95004,95032,95088,95102,95112,95120,95134,95136,95164,95180,95192,95214,95218,95220,95244,95256,95280,95294,95328,95356,95424,95480,95728,95758,95772,95800,95856,95870,95968,95996,96008,96016,96030,96032,96060,96064,96120,96152,96176,96190,96220,96226,96228,96232,96290,96292,96296,96310,96322,96324,96328,96336,96350,96358,96364,96386,96388,96392,96400,96414,96416,96444,96454,96460,96472,96494,96498,96500,96514,96516,96520,96528,96542,96544,96572,96576,96632,96646,96652,96664,96688,96702,96718,96732,96738,96740,96744,96758,96772,96776,96784,96798,96800,96828,96832,96888,97008,97030,97036,97048,97072,97086,97120,97148,97166,97180,97208,97220,97224,97232,97246,97254,97260,97326,97330,97332,97358,97372,97378,97380,97384,97398,97422,97436,97464,97474,97476,97480,97488,97502,97510,97516,97550,97564,97592,97648,97666,97668,97672,97680,97694,97696,97724,97734,97740,97752,97774,97830,97836,97850,97862,97868,97880,97902,97906,97908,97926,97932,97944,97968,97998,98012,98018,98020,98024,98038,98618,98674,98676,98838,98854,98874,98892,98904,98926,98930,98932,98968,99006,99042,99044,99048,99062,99166,99194,99246,99286,99350,99366,99372,99386,99398,99416,99438,99442,99444,99462,99504,99518,99534,99548,99554,99556,99560,99574,99590,99596,99608,99632,99646,99680,99708,99726,99740,99768,99778,99780,99784,99792,99806,99814,99820,99834,99858,99860,99874,99880,99894,99906,99920,99934,99962,99970,99972,99976,99984,99998,1e5,100028,100038,100044,100056,100078,100082,100084,100142,100174,100188,100246,100262,100268,100306,100308,100390,100396,100410,100422,100428,100440,100462,100466,100468,100486,100504,100528,100542,100558,100572,100578,100580,100584,100598,100620,100656,100670,100704,100732,100750,100792,100802,100808,100816,100830,100838,100844,100858,100888,100912,100926,100960,100988,101056,101112,101148,101176,101232,101246,101250,101252,101256,101264,101278,101280,101308,101318,101324,101336,101358,101362,101364,101410,101412,101416,101430,101442,101448,101456,101470,101478,101498,101506,101508,101520,101534,101536,101564,101580,101618,101620,101636,101640,101648,101662,101664,101692,101696,101752,101766,101784,101838,101858,101860,101864,101934,101938,101940,101966,101980,101986,101988,101992,102030,102044,102072,102082,102084,102088,102096,102138,102166,102182,102188,102214,102220,102232,102254,102282,102290,102292,102306,102308,102312,102326,102444,102458,102470,102476,102488,102514,102516,102534,102552,102576,102590,102606,102620,102626,102632,102646,102662,102668,102704,102718,102752,102780,102798,102812,102840,102850,102856,102864,102878,102886,102892,102906,102936,102974,103008,103036,103104,103160,103224,103280,103294,103298,103300,103312,103326,103328,103356,103366,103372,103384,103406,103410,103412,103472,103486,103520,103548,103616,103672,103920,103992,104048,104062,104160,104188,104194,104196,104200,104208,104224,104252,104256,104312,104326,104332,104344,104368,104382,104398,104412,104418,104420,104424,104482,104484,104514,104520,104528,104542,104550,104570,104578,104580,104592,104606,104608,104636,104652,104690,104692,104706,104712,104734,104736,104764,104768,104824,104838,104856,104910,104930,104932,104936,104968,104976,104990,104992,105020,105024,105080,105200,105240,105278,105312,105372,105410,105412,105416,105424,105446,105518,105524,105550,105564,105570,105572,105576,105614,105628,105656,105666,105672,105680,105702,105722,105742,105756,105784,105840,105854,105858,105860,105864,105872,105888,105932,105970,105972,106006,106022,106028,106054,106060,106072,106100,106118,106124,106136,106160,106174,106190,106210,106212,106216,106250,106258,106260,106274,106276,106280,106306,106308,106312,106320,106334,106348,106394,106414,106418,106420,106566,106572,106610,106612,106630,106636,106648,106672,106686,106722,106724,106728,106742,106758,106764,106776,106800,106814,106848,106876,106894,106908,106936,106946,106948,106952,106960,106974,106982,106988,107032,107056,107070,107104,107132,107200,107256,107292,107320,107376,107390,107394,107396,107400,107408,107422,107424,107452,107462,107468,107480,107502,107506,107508,107544,107568,107582,107616,107644,107712,107768,108016,108060,108088,108144,108158,108256,108284,108290,108292,108296,108304,108318,108320,108348,108352,108408,108422,108428,108440,108464,108478,108494,108508,108514,108516,108520,108592,108640,108668,108736,108792,109040,109536,109680,109694,109792,109820,110016,110072,110084,110088,110096,110112,110140,110144,110200,110320,110342,110348,110360,110384,110398,110432,110460,110478,110492,110520,110532,110536,110544,110558,110658,110686,110714,110722,110724,110728,110736,110750,110752,110780,110796,110834,110836,110850,110852,110856,110864,110878,110880,110908,110912,110968,110982,111e3,111054,111074,111076,111080,111108,111112,111120,111134,111136,111164,111168,111224,111344,111372,111422,111456,111516,111554,111556,111560,111568,111590,111632,111646,111648,111676,111680,111736,111856,112096,112152,112224,112252,112320,112440,112514,112516,112520,112528,112542,112544,112588,112686,112718,112732,112782,112796,112824,112834,112836,112840,112848,112870,112890,112910,112924,112952,113008,113022,113026,113028,113032,113040,113054,113056,113100,113138,113140,113166,113180,113208,113264,113278,113376,113404,113416,113424,113440,113468,113472,113560,113614,113634,113636,113640,113686,113702,113708,113734,113740,113752,113778,113780,113798,113804,113816,113840,113854,113870,113890,113892,113896,113926,113932,113944,113968,113982,114016,114044,114076,114114,114116,114120,114128,114150,114170,114194,114196,114210,114212,114216,114242,114244,114248,114256,114270,114278,114306,114308,114312,114320,114334,114336,114364,114380,114420,114458,114478,114482,114484,114510,114524,114530,114532,114536,114842,114866,114868,114970,114994,114996,115042,115044,115048,115062,115130,115226,115250,115252,115278,115292,115298,115300,115304,115318,115342,115394,115396,115400,115408,115422,115430,115436,115450,115478,115494,115514,115526,115532,115570,115572,115738,115758,115762,115764,115790,115804,115810,115812,115816,115830,115854,115868,115896,115906,115912,115920,115934,115942,115948,115962,115996,116024,116080,116094,116098,116100,116104,116112,116126,116128,116156,116166,116172,116184,116206,116210,116212,116246,116262,116268,116282,116294,116300,116312,116334,116338,116340,116358,116364,116376,116400,116414,116430,116444,116450,116452,116456,116498,116500,116514,116520,116534,116546,116548,116552,116560,116574,116582,116588,116602,116654,116694,116714,116762,116782,116786,116788,116814,116828,116834,116836,116840,116854,116878,116892,116920,116930,116936,116944,116958,116966,116972,116986,117006,117048,117104,117118,117122,117124,117136,117150,117152,117180,117190,117196,117208,117230,117234,117236,117304,117360,117374,117472,117500,117506,117508,117512,117520,117536,117564,117568,117624,117638,117644,117656,117680,117694,117710,117724,117730,117732,117736,117750,117782,117798,117804,117818,117830,117848,117874,117876,117894,117936,117950,117966,117986,117988,117992,118022,118028,118040,118064,118078,118112,118140,118172,118210,118212,118216,118224,118238,118246,118266,118306,118312,118338,118352,118366,118374,118394,118402,118404,118408,118416,118430,118432,118460,118476,118514,118516,118574,118578,118580,118606,118620,118626,118628,118632,118678,118694,118700,118730,118738,118740,118830,118834,118836,118862,118876,118882,118884,118888,118902,118926,118940,118968,118978,118980,118984,118992,119006,119014,119020,119034,119068,119096,119152,119166,119170,119172,119176,119184,119198,119200,119228,119238,119244,119256,119278,119282,119284,119324,119352,119408,119422,119520,119548,119554,119556,119560,119568,119582,119584,119612,119616,119672,119686,119692,119704,119728,119742,119758,119772,119778,119780,119784,119798,119920,119934,120032,120060,120256,120312,120324,120328,120336,120352,120384,120440,120560,120582,120588,120600,120624,120638,120672,120700,120718,120732,120760,120770,120772,120776,120784,120798,120806,120812,120870,120876,120890,120902,120908,120920,120946,120948,120966,120972,120984,121008,121022,121038,121058,121060,121064,121078,121100,121112,121136,121150,121184,121212,121244,121282,121284,121288,121296,121318,121338,121356,121368,121392,121406,121440,121468,121536,121592,121656,121730,121732,121736,121744,121758,121760,121804,121842,121844,121890,121922,121924,121928,121936,121950,121958,121978,121986,121988,121992,122e3,122014,122016,122044,122060,122098,122100,122116,122120,122128,122142,122144,122172,122176,122232,122246,122264,122318,122338,122340,122344,122414,122418,122420,122446,122460,122466,122468,122472,122510,122524,122552,122562,122564,122568,122576,122598,122618,122646,122662,122668,122694,122700,122712,122738,122740,122762,122770,122772,122786,122788,122792,123018,123026,123028,123042,123044,123048,123062,123098,123146,123154,123156,123170,123172,123176,123190,123202,123204,123208,123216,123238,123244,123258,123290,123314,123316,123402,123410,123412,123426,123428,123432,123446,123458,123464,123472,123486,123494,123500,123514,123522,123524,123528,123536,123552,123580,123590,123596,123608,123630,123634,123636,123674,123698,123700,123740,123746,123748,123752,123834,123914,123922,123924,123938,123944,123958,123970,123976,123984,123998,124006,124012,124026,124034,124036,124048,124062,124064,124092,124102,124108,124120,124142,124146,124148,124162,124164,124168,124176,124190,124192,124220,124224,124280,124294,124300,124312,124336,124350,124366,124380,124386,124388,124392,124406,124442,124462,124466,124468,124494,124508,124514,124520,124558,124572,124600,124610,124612,124616,124624,124646,124666,124694,124710,124716,124730,124742,124748,124760,124786,124788,124818,124820,124834,124836,124840,124854,124946,124948,124962,124964,124968,124982,124994,124996,125e3,125008,125022,125030,125036,125050,125058,125060,125064,125072,125086,125088,125116,125126,125132,125144,125166,125170,125172,125186,125188,125192,125200,125216,125244,125248,125304,125318,125324,125336,125360,125374,125390,125404,125410,125412,125416,125430,125444,125448,125456,125472,125504,125560,125680,125702,125708,125720,125744,125758,125792,125820,125838,125852,125880,125890,125892,125896,125904,125918,125926,125932,125978,125998,126002,126004,126030,126044,126050,126052,126056,126094,126108,126136,126146,126148,126152,126160,126182,126202,126222,126236,126264,126320,126334,126338,126340,126344,126352,126366,126368,126412,126450,126452,126486,126502,126508,126522,126534,126540,126552,126574,126578,126580,126598,126604,126616,126640,126654,126670,126684,126690,126692,126696,126738,126754,126756,126760,126774,126786,126788,126792,126800,126814,126822,126828,126842,126894,126898,126900,126934,127126,127142,127148,127162,127178,127186,127188,127254,127270,127276,127290,127302,127308,127320,127342,127346,127348,127370,127378,127380,127394,127396,127400,127450,127510,127526,127532,127546,127558,127576,127598,127602,127604,127622,127628,127640,127664,127678,127694,127708,127714,127716,127720,127734,127754,127762,127764,127778,127784,127810,127812,127816,127824,127838,127846,127866,127898,127918,127922,127924,128022,128038,128044,128058,128070,128076,128088,128110,128114,128116,128134,128140,128152,128176,128190,128206,128220,128226,128228,128232,128246,128262,128268,128280,128304,128318,128352,128380,128398,128412,128440,128450,128452,128456,128464,128478,128486,128492,128506,128522,128530,128532,128546,128548,128552,128566,128578,128580,128584,128592,128606,128614,128634,128642,128644,128648,128656,128670,128672,128700,128716,128754,128756,128794,128814,128818,128820,128846,128860,128866,128868,128872,128886,128918,128934,128940,128954,128978,128980,129178,129198,129202,129204,129238,129258,129306,129326,129330,129332,129358,129372,129378,129380,129384,129398,129430,129446,129452,129466,129482,129490,129492,129562,129582,129586,129588,129614,129628,129634,129636,129640,129654,129678,129692,129720,129730,129732,129736,129744,129758,129766,129772,129814,129830,129836,129850,129862,129868,129880,129902,129906,129908,129930,129938,129940,129954,129956,129960,129974,130010]),$t.CODEWORD_TABLE=Int32Array.from([2627,1819,2622,2621,1813,1812,2729,2724,2723,2779,2774,2773,902,896,908,868,865,861,859,2511,873,871,1780,835,2493,825,2491,842,837,844,1764,1762,811,810,809,2483,807,2482,806,2480,815,814,813,812,2484,817,816,1745,1744,1742,1746,2655,2637,2635,2626,2625,2623,2628,1820,2752,2739,2737,2728,2727,2725,2730,2785,2783,2778,2777,2775,2780,787,781,747,739,736,2413,754,752,1719,692,689,681,2371,678,2369,700,697,694,703,1688,1686,642,638,2343,631,2341,627,2338,651,646,643,2345,654,652,1652,1650,1647,1654,601,599,2322,596,2321,594,2319,2317,611,610,608,606,2324,603,2323,615,614,612,1617,1616,1614,1612,616,1619,1618,2575,2538,2536,905,901,898,909,2509,2507,2504,870,867,864,860,2512,875,872,1781,2490,2489,2487,2485,1748,836,834,832,830,2494,827,2492,843,841,839,845,1765,1763,2701,2676,2674,2653,2648,2656,2634,2633,2631,2629,1821,2638,2636,2770,2763,2761,2750,2745,2753,2736,2735,2733,2731,1848,2740,2738,2786,2784,591,588,576,569,566,2296,1590,537,534,526,2276,522,2274,545,542,539,548,1572,1570,481,2245,466,2242,462,2239,492,485,482,2249,496,494,1534,1531,1528,1538,413,2196,406,2191,2188,425,419,2202,415,2199,432,430,427,1472,1467,1464,433,1476,1474,368,367,2160,365,2159,362,2157,2155,2152,378,377,375,2166,372,2165,369,2162,383,381,379,2168,1419,1418,1416,1414,385,1411,384,1423,1422,1420,1424,2461,802,2441,2439,790,786,783,794,2409,2406,2403,750,742,738,2414,756,753,1720,2367,2365,2362,2359,1663,693,691,684,2373,680,2370,702,699,696,704,1690,1687,2337,2336,2334,2332,1624,2329,1622,640,637,2344,634,2342,630,2340,650,648,645,2346,655,653,1653,1651,1649,1655,2612,2597,2595,2571,2568,2565,2576,2534,2529,2526,1787,2540,2537,907,904,900,910,2503,2502,2500,2498,1768,2495,1767,2510,2508,2506,869,866,863,2513,876,874,1782,2720,2713,2711,2697,2694,2691,2702,2672,2670,2664,1828,2678,2675,2647,2646,2644,2642,1823,2639,1822,2654,2652,2650,2657,2771,1855,2765,2762,1850,1849,2751,2749,2747,2754,353,2148,344,342,336,2142,332,2140,345,1375,1373,306,2130,299,2128,295,2125,319,314,311,2132,1354,1352,1349,1356,262,257,2101,253,2096,2093,274,273,267,2107,263,2104,280,278,275,1316,1311,1308,1320,1318,2052,202,2050,2044,2040,219,2063,212,2060,208,2055,224,221,2066,1260,1258,1252,231,1248,229,1266,1264,1261,1268,155,1998,153,1996,1994,1991,1988,165,164,2007,162,2006,159,2003,2e3,172,171,169,2012,166,2010,1186,1184,1182,1179,175,1176,173,1192,1191,1189,1187,176,1194,1193,2313,2307,2305,592,589,2294,2292,2289,578,572,568,2297,580,1591,2272,2267,2264,1547,538,536,529,2278,525,2275,547,544,541,1574,1571,2237,2235,2229,1493,2225,1489,478,2247,470,2244,465,2241,493,488,484,2250,498,495,1536,1533,1530,1539,2187,2186,2184,2182,1432,2179,1430,2176,1427,414,412,2197,409,2195,405,2193,2190,426,424,421,2203,418,2201,431,429,1473,1471,1469,1466,434,1477,1475,2478,2472,2470,2459,2457,2454,2462,803,2437,2432,2429,1726,2443,2440,792,789,785,2401,2399,2393,1702,2389,1699,2411,2408,2405,745,741,2415,758,755,1721,2358,2357,2355,2353,1661,2350,1660,2347,1657,2368,2366,2364,2361,1666,690,687,2374,683,2372,701,698,705,1691,1689,2619,2617,2610,2608,2605,2613,2593,2588,2585,1803,2599,2596,2563,2561,2555,1797,2551,1795,2573,2570,2567,2577,2525,2524,2522,2520,1786,2517,1785,2514,1783,2535,2533,2531,2528,1788,2541,2539,906,903,911,2721,1844,2715,2712,1838,1836,2699,2696,2693,2703,1827,1826,1824,2673,2671,2669,2666,1829,2679,2677,1858,1857,2772,1854,1853,1851,1856,2766,2764,143,1987,139,1986,135,133,131,1984,128,1983,125,1981,138,137,136,1985,1133,1132,1130,112,110,1974,107,1973,104,1971,1969,122,121,119,117,1977,114,1976,124,1115,1114,1112,1110,1117,1116,84,83,1953,81,1952,78,1950,1948,1945,94,93,91,1959,88,1958,85,1955,99,97,95,1961,1086,1085,1083,1081,1078,100,1090,1089,1087,1091,49,47,1917,44,1915,1913,1910,1907,59,1926,56,1925,53,1922,1919,66,64,1931,61,1929,1042,1040,1038,71,1035,70,1032,68,1048,1047,1045,1043,1050,1049,12,10,1869,1867,1864,1861,21,1880,19,1877,1874,1871,28,1888,25,1886,22,1883,982,980,977,974,32,30,991,989,987,984,34,995,994,992,2151,2150,2147,2146,2144,356,355,354,2149,2139,2138,2136,2134,1359,343,341,338,2143,335,2141,348,347,346,1376,1374,2124,2123,2121,2119,1326,2116,1324,310,308,305,2131,302,2129,298,2127,320,318,316,313,2133,322,321,1355,1353,1351,1357,2092,2091,2089,2087,1276,2084,1274,2081,1271,259,2102,256,2100,252,2098,2095,272,269,2108,266,2106,281,279,277,1317,1315,1313,1310,282,1321,1319,2039,2037,2035,2032,1203,2029,1200,1197,207,2053,205,2051,201,2049,2046,2043,220,218,2064,215,2062,211,2059,228,226,223,2069,1259,1257,1254,232,1251,230,1267,1265,1263,2316,2315,2312,2311,2309,2314,2304,2303,2301,2299,1593,2308,2306,590,2288,2287,2285,2283,1578,2280,1577,2295,2293,2291,579,577,574,571,2298,582,581,1592,2263,2262,2260,2258,1545,2255,1544,2252,1541,2273,2271,2269,2266,1550,535,532,2279,528,2277,546,543,549,1575,1573,2224,2222,2220,1486,2217,1485,2214,1482,1479,2238,2236,2234,2231,1496,2228,1492,480,477,2248,473,2246,469,2243,490,487,2251,497,1537,1535,1532,2477,2476,2474,2479,2469,2468,2466,2464,1730,2473,2471,2453,2452,2450,2448,1729,2445,1728,2460,2458,2456,2463,805,804,2428,2427,2425,2423,1725,2420,1724,2417,1722,2438,2436,2434,2431,1727,2444,2442,793,791,788,795,2388,2386,2384,1697,2381,1696,2378,1694,1692,2402,2400,2398,2395,1703,2392,1701,2412,2410,2407,751,748,744,2416,759,757,1807,2620,2618,1806,1805,2611,2609,2607,2614,1802,1801,1799,2594,2592,2590,2587,1804,2600,2598,1794,1793,1791,1789,2564,2562,2560,2557,1798,2554,1796,2574,2572,2569,2578,1847,1846,2722,1843,1842,1840,1845,2716,2714,1835,1834,1832,1830,1839,1837,2700,2698,2695,2704,1817,1811,1810,897,862,1777,829,826,838,1760,1758,808,2481,1741,1740,1738,1743,2624,1818,2726,2776,782,740,737,1715,686,679,695,1682,1680,639,628,2339,647,644,1645,1643,1640,1648,602,600,597,595,2320,593,2318,609,607,604,1611,1610,1608,1606,613,1615,1613,2328,926,924,892,886,899,857,850,2505,1778,824,823,821,819,2488,818,2486,833,831,828,840,1761,1759,2649,2632,2630,2746,2734,2732,2782,2781,570,567,1587,531,527,523,540,1566,1564,476,467,463,2240,486,483,1524,1521,1518,1529,411,403,2192,399,2189,423,416,1462,1457,1454,428,1468,1465,2210,366,363,2158,360,2156,357,2153,376,373,370,2163,1410,1409,1407,1405,382,1402,380,1417,1415,1412,1421,2175,2174,777,774,771,784,732,725,722,2404,743,1716,676,674,668,2363,665,2360,685,1684,1681,626,624,622,2335,620,2333,617,2330,641,635,649,1646,1644,1642,2566,928,925,2530,2527,894,891,888,2501,2499,2496,858,856,854,851,1779,2692,2668,2665,2645,2643,2640,2651,2768,2759,2757,2744,2743,2741,2748,352,1382,340,337,333,1371,1369,307,300,296,2126,315,312,1347,1342,1350,261,258,250,2097,246,2094,271,268,264,1306,1301,1298,276,1312,1309,2115,203,2048,195,2045,191,2041,213,209,2056,1246,1244,1238,225,1234,222,1256,1253,1249,1262,2080,2079,154,1997,150,1995,147,1992,1989,163,160,2004,156,2001,1175,1174,1172,1170,1167,170,1164,167,1185,1183,1180,1177,174,1190,1188,2025,2024,2022,587,586,564,559,556,2290,573,1588,520,518,512,2268,508,2265,530,1568,1565,461,457,2233,450,2230,446,2226,479,471,489,1526,1523,1520,397,395,2185,392,2183,389,2180,2177,410,2194,402,422,1463,1461,1459,1456,1470,2455,799,2433,2430,779,776,773,2397,2394,2390,734,728,724,746,1717,2356,2354,2351,2348,1658,677,675,673,670,667,688,1685,1683,2606,2589,2586,2559,2556,2552,927,2523,2521,2518,2515,1784,2532,895,893,890,2718,2709,2707,2689,2687,2684,2663,2662,2660,2658,1825,2667,2769,1852,2760,2758,142,141,1139,1138,134,132,129,126,1982,1129,1128,1126,1131,113,111,108,105,1972,101,1970,120,118,115,1109,1108,1106,1104,123,1113,1111,82,79,1951,75,1949,72,1946,92,89,86,1956,1077,1076,1074,1072,98,1069,96,1084,1082,1079,1088,1968,1967,48,45,1916,42,1914,39,1911,1908,60,57,54,1923,50,1920,1031,1030,1028,1026,67,1023,65,1020,62,1041,1039,1036,1033,69,1046,1044,1944,1943,1941,11,9,1868,7,1865,1862,1859,20,1878,16,1875,13,1872,970,968,966,963,29,960,26,23,983,981,978,975,33,971,31,990,988,985,1906,1904,1902,993,351,2145,1383,331,330,328,326,2137,323,2135,339,1372,1370,294,293,291,289,2122,286,2120,283,2117,309,303,317,1348,1346,1344,245,244,242,2090,239,2088,236,2085,2082,260,2099,249,270,1307,1305,1303,1300,1314,189,2038,186,2036,183,2033,2030,2026,206,198,2047,194,216,1247,1245,1243,1240,227,1237,1255,2310,2302,2300,2286,2284,2281,565,563,561,558,575,1589,2261,2259,2256,2253,1542,521,519,517,514,2270,511,533,1569,1567,2223,2221,2218,2215,1483,2211,1480,459,456,453,2232,449,474,491,1527,1525,1522,2475,2467,2465,2451,2449,2446,801,800,2426,2424,2421,2418,1723,2435,780,778,775,2387,2385,2382,2379,1695,2375,1693,2396,735,733,730,727,749,1718,2616,2615,2604,2603,2601,2584,2583,2581,2579,1800,2591,2550,2549,2547,2545,1792,2542,1790,2558,929,2719,1841,2710,2708,1833,1831,2690,2688,2686,1815,1809,1808,1774,1756,1754,1737,1736,1734,1739,1816,1711,1676,1674,633,629,1638,1636,1633,1641,598,1605,1604,1602,1600,605,1609,1607,2327,887,853,1775,822,820,1757,1755,1584,524,1560,1558,468,464,1514,1511,1508,1519,408,404,400,1452,1447,1444,417,1458,1455,2208,364,361,358,2154,1401,1400,1398,1396,374,1393,371,1408,1406,1403,1413,2173,2172,772,726,723,1712,672,669,666,682,1678,1675,625,623,621,618,2331,636,632,1639,1637,1635,920,918,884,880,889,849,848,847,846,2497,855,852,1776,2641,2742,2787,1380,334,1367,1365,301,297,1340,1338,1335,1343,255,251,247,1296,1291,1288,265,1302,1299,2113,204,196,192,2042,1232,1230,1224,214,1220,210,1242,1239,1235,1250,2077,2075,151,148,1993,144,1990,1163,1162,1160,1158,1155,161,1152,157,1173,1171,1168,1165,168,1181,1178,2021,2020,2018,2023,585,560,557,1585,516,509,1562,1559,458,447,2227,472,1516,1513,1510,398,396,393,390,2181,386,2178,407,1453,1451,1449,1446,420,1460,2209,769,764,720,712,2391,729,1713,664,663,661,659,2352,656,2349,671,1679,1677,2553,922,919,2519,2516,885,883,881,2685,2661,2659,2767,2756,2755,140,1137,1136,130,127,1125,1124,1122,1127,109,106,102,1103,1102,1100,1098,116,1107,1105,1980,80,76,73,1947,1068,1067,1065,1063,90,1060,87,1075,1073,1070,1080,1966,1965,46,43,40,1912,36,1909,1019,1018,1016,1014,58,1011,55,1008,51,1029,1027,1024,1021,63,1037,1034,1940,1939,1937,1942,8,1866,4,1863,1,1860,956,954,952,949,946,17,14,969,967,964,961,27,957,24,979,976,972,1901,1900,1898,1896,986,1905,1903,350,349,1381,329,327,324,1368,1366,292,290,287,284,2118,304,1341,1339,1337,1345,243,240,237,2086,233,2083,254,1297,1295,1293,1290,1304,2114,190,187,184,2034,180,2031,177,2027,199,1233,1231,1229,1226,217,1223,1241,2078,2076,584,555,554,552,550,2282,562,1586,507,506,504,502,2257,499,2254,515,1563,1561,445,443,441,2219,438,2216,435,2212,460,454,475,1517,1515,1512,2447,798,797,2422,2419,770,768,766,2383,2380,2376,721,719,717,714,731,1714,2602,2582,2580,2548,2546,2543,923,921,2717,2706,2705,2683,2682,2680,1771,1752,1750,1733,1732,1731,1735,1814,1707,1670,1668,1631,1629,1626,1634,1599,1598,1596,1594,1603,1601,2326,1772,1753,1751,1581,1554,1552,1504,1501,1498,1509,1442,1437,1434,401,1448,1445,2206,1392,1391,1389,1387,1384,359,1399,1397,1394,1404,2171,2170,1708,1672,1669,619,1632,1630,1628,1773,1378,1363,1361,1333,1328,1336,1286,1281,1278,248,1292,1289,2111,1218,1216,1210,197,1206,193,1228,1225,1221,1236,2073,2071,1151,1150,1148,1146,152,1143,149,1140,145,1161,1159,1156,1153,158,1169,1166,2017,2016,2014,2019,1582,510,1556,1553,452,448,1506,1500,394,391,387,1443,1441,1439,1436,1450,2207,765,716,713,1709,662,660,657,1673,1671,916,914,879,878,877,882,1135,1134,1121,1120,1118,1123,1097,1096,1094,1092,103,1101,1099,1979,1059,1058,1056,1054,77,1051,74,1066,1064,1061,1071,1964,1963,1007,1006,1004,1002,999,41,996,37,1017,1015,1012,1009,52,1025,1022,1936,1935,1933,1938,942,940,938,935,932,5,2,955,953,950,947,18,943,15,965,962,958,1895,1894,1892,1890,973,1899,1897,1379,325,1364,1362,288,285,1334,1332,1330,241,238,234,1287,1285,1283,1280,1294,2112,188,185,181,178,2028,1219,1217,1215,1212,200,1209,1227,2074,2072,583,553,551,1583,505,503,500,513,1557,1555,444,442,439,436,2213,455,451,1507,1505,1502,796,763,762,760,767,711,710,708,706,2377,718,715,1710,2544,917,915,2681,1627,1597,1595,2325,1769,1749,1747,1499,1438,1435,2204,1390,1388,1385,1395,2169,2167,1704,1665,1662,1625,1623,1620,1770,1329,1282,1279,2109,1214,1207,1222,2068,2065,1149,1147,1144,1141,146,1157,1154,2013,2011,2008,2015,1579,1549,1546,1495,1487,1433,1431,1428,1425,388,1440,2205,1705,658,1667,1664,1119,1095,1093,1978,1057,1055,1052,1062,1962,1960,1005,1003,1e3,997,38,1013,1010,1932,1930,1927,1934,941,939,936,933,6,930,3,951,948,944,1889,1887,1884,1881,959,1893,1891,35,1377,1360,1358,1327,1325,1322,1331,1277,1275,1272,1269,235,1284,2110,1205,1204,1201,1198,182,1195,179,1213,2070,2067,1580,501,1551,1548,440,437,1497,1494,1490,1503,761,709,707,1706,913,912,2198,1386,2164,2161,1621,1766,2103,1208,2058,2054,1145,1142,2005,2002,1999,2009,1488,1429,1426,2200,1698,1659,1656,1975,1053,1957,1954,1001,998,1924,1921,1918,1928,937,934,931,1879,1876,1873,1870,945,1885,1882,1323,1273,1270,2105,1202,1199,1196,1211,2061,2057,1576,1543,1540,1484,1481,1478,1491,1700]);class qd{constructor(a,o){this.bits=a,this.points=o}getBits(){return this.bits}getPoints(){return this.points}}class Nt{static detectMultiple(a,o,u){let f=a.getBlackMatrix(),m=Nt.detect(u,f);return m.length||(f=f.clone(),f.rotate180(),m=Nt.detect(u,f)),new qd(f,m)}static detect(a,o){const u=new Array;let f=0,m=0,g=!1;for(;f<o.getHeight();){const w=Nt.findVertices(o,f,m);if(w[0]==null&&w[3]==null){if(!g)break;g=!1,m=0;for(const b of u)b[1]!=null&&(f=Math.trunc(Math.max(f,b[1].getY()))),b[3]!=null&&(f=Math.max(f,Math.trunc(b[3].getY())));f+=Nt.ROW_STEP;continue}if(g=!0,u.push(w),!a)break;w[2]!=null?(m=Math.trunc(w[2].getX()),f=Math.trunc(w[2].getY())):(m=Math.trunc(w[4].getX()),f=Math.trunc(w[4].getY()))}return u}static findVertices(a,o,u){const f=a.getHeight(),m=a.getWidth(),g=new Array(8);return Nt.copyToResult(g,Nt.findRowsWithPattern(a,f,m,o,u,Nt.START_PATTERN),Nt.INDEXES_START_PATTERN),g[4]!=null&&(u=Math.trunc(g[4].getX()),o=Math.trunc(g[4].getY())),Nt.copyToResult(g,Nt.findRowsWithPattern(a,f,m,o,u,Nt.STOP_PATTERN),Nt.INDEXES_STOP_PATTERN),g}static copyToResult(a,o,u){for(let f=0;f<u.length;f++)a[u[f]]=o[f]}static findRowsWithPattern(a,o,u,f,m,g){const w=new Array(4);let b=!1;const I=new Int32Array(g.length);for(;f<o;f+=Nt.ROW_STEP){let V=Nt.findGuardPattern(a,m,f,u,!1,g,I);if(V!=null){for(;f>0;){const z=Nt.findGuardPattern(a,m,--f,u,!1,g,I);if(z!=null)V=z;else{f++;break}}w[0]=new ae(V[0],f),w[1]=new ae(V[1],f),b=!0;break}}let P=f+1;if(b){let V=0,z=Int32Array.from([Math.trunc(w[0].getX()),Math.trunc(w[1].getX())]);for(;P<o;P++){const Y=Nt.findGuardPattern(a,z[0],P,u,!1,g,I);if(Y!=null&&Math.abs(z[0]-Y[0])<Nt.MAX_PATTERN_DRIFT&&Math.abs(z[1]-Y[1])<Nt.MAX_PATTERN_DRIFT)z=Y,V=0;else{if(V>Nt.SKIPPED_ROW_COUNT_MAX)break;V++}}P-=V+1,w[2]=new ae(z[0],P),w[3]=new ae(z[1],P)}return P-f<Nt.BARCODE_MIN_HEIGHT&&M.fill(w,null),w}static findGuardPattern(a,o,u,f,m,g,w){M.fillWithin(w,0,w.length,0);let b=o,I=0;for(;a.get(b,u)&&b>0&&I++<Nt.MAX_PIXEL_DRIFT;)b--;let P=b,V=0,z=g.length;for(let Y=m;P<f;P++)if(a.get(P,u)!==Y)w[V]++;else{if(V===z-1){if(Nt.patternMatchVariance(w,g,Nt.MAX_INDIVIDUAL_VARIANCE)<Nt.MAX_AVG_VARIANCE)return new Int32Array([b,P]);b+=w[0]+w[1],B.arraycopy(w,2,w,0,V-1),w[V-1]=0,w[V]=0,V--}else V++;w[V]=1,Y=!Y}return V===z-1&&Nt.patternMatchVariance(w,g,Nt.MAX_INDIVIDUAL_VARIANCE)<Nt.MAX_AVG_VARIANCE?new Int32Array([b,P-1]):null}static patternMatchVariance(a,o,u){let f=a.length,m=0,g=0;for(let I=0;I<f;I++)m+=a[I],g+=o[I];if(m<g)return 1/0;let w=m/g;u*=w;let b=0;for(let I=0;I<f;I++){let P=a[I],V=o[I]*w,z=P>V?P-V:V-P;if(z>u)return 1/0;b+=z}return b/m}}Nt.INDEXES_START_PATTERN=Int32Array.from([0,4,1,5]),Nt.INDEXES_STOP_PATTERN=Int32Array.from([6,2,7,3]),Nt.MAX_AVG_VARIANCE=.42,Nt.MAX_INDIVIDUAL_VARIANCE=.8,Nt.START_PATTERN=Int32Array.from([8,1,1,1,1,1,1,3]),Nt.STOP_PATTERN=Int32Array.from([7,1,1,3,1,1,1,2,1]),Nt.MAX_PIXEL_DRIFT=3,Nt.MAX_PATTERN_DRIFT=5,Nt.SKIPPED_ROW_COUNT_MAX=25,Nt.ROW_STEP=5,Nt.BARCODE_MIN_HEIGHT=10;class Or{constructor(a,o){if(o.length===0)throw new E;this.field=a;let u=o.length;if(u>1&&o[0]===0){let f=1;for(;f<u&&o[f]===0;)f++;f===u?this.coefficients=new Int32Array([0]):(this.coefficients=new Int32Array(u-f),B.arraycopy(o,f,this.coefficients,0,this.coefficients.length))}else this.coefficients=o}getCoefficients(){return this.coefficients}getDegree(){return this.coefficients.length-1}isZero(){return this.coefficients[0]===0}getCoefficient(a){return this.coefficients[this.coefficients.length-1-a]}evaluateAt(a){if(a===0)return this.getCoefficient(0);if(a===1){let f=0;for(let m of this.coefficients)f=this.field.add(f,m);return f}let o=this.coefficients[0],u=this.coefficients.length;for(let f=1;f<u;f++)o=this.field.add(this.field.multiply(a,o),this.coefficients[f]);return o}add(a){if(!this.field.equals(a.field))throw new E("ModulusPolys do not have same ModulusGF field");if(this.isZero())return a;if(a.isZero())return this;let o=this.coefficients,u=a.coefficients;if(o.length>u.length){let g=o;o=u,u=g}let f=new Int32Array(u.length),m=u.length-o.length;B.arraycopy(u,0,f,0,m);for(let g=m;g<u.length;g++)f[g]=this.field.add(o[g-m],u[g]);return new Or(this.field,f)}subtract(a){if(!this.field.equals(a.field))throw new E("ModulusPolys do not have same ModulusGF field");return a.isZero()?this:this.add(a.negative())}multiply(a){return a instanceof Or?this.multiplyOther(a):this.multiplyScalar(a)}multiplyOther(a){if(!this.field.equals(a.field))throw new E("ModulusPolys do not have same ModulusGF field");if(this.isZero()||a.isZero())return new Or(this.field,new Int32Array([0]));let o=this.coefficients,u=o.length,f=a.coefficients,m=f.length,g=new Int32Array(u+m-1);for(let w=0;w<u;w++){let b=o[w];for(let I=0;I<m;I++)g[w+I]=this.field.add(g[w+I],this.field.multiply(b,f[I]))}return new Or(this.field,g)}negative(){let a=this.coefficients.length,o=new Int32Array(a);for(let u=0;u<a;u++)o[u]=this.field.subtract(0,this.coefficients[u]);return new Or(this.field,o)}multiplyScalar(a){if(a===0)return new Or(this.field,new Int32Array([0]));if(a===1)return this;let o=this.coefficients.length,u=new Int32Array(o);for(let f=0;f<o;f++)u[f]=this.field.multiply(this.coefficients[f],a);return new Or(this.field,u)}multiplyByMonomial(a,o){if(a<0)throw new E;if(o===0)return new Or(this.field,new Int32Array([0]));let u=this.coefficients.length,f=new Int32Array(u+a);for(let m=0;m<u;m++)f[m]=this.field.multiply(this.coefficients[m],o);return new Or(this.field,f)}toString(){let a=new R;for(let o=this.getDegree();o>=0;o--){let u=this.getCoefficient(o);u!==0&&(u<0?(a.append(" - "),u=-u):a.length()>0&&a.append(" + "),(o===0||u!==1)&&a.append(u),o!==0&&(o===1?a.append("x"):(a.append("x^"),a.append(o))))}return a.toString()}}class Kd{add(a,o){return(a+o)%this.modulus}subtract(a,o){return(this.modulus+a-o)%this.modulus}exp(a){return this.expTable[a]}log(a){if(a===0)throw new E;return this.logTable[a]}inverse(a){if(a===0)throw new xe;return this.expTable[this.modulus-this.logTable[a]-1]}multiply(a,o){return a===0||o===0?0:this.expTable[(this.logTable[a]+this.logTable[o])%(this.modulus-1)]}getSize(){return this.modulus}equals(a){return a===this}}class mi extends Kd{constructor(a,o){super(),this.modulus=a,this.expTable=new Int32Array(a),this.logTable=new Int32Array(a);let u=1;for(let f=0;f<a;f++)this.expTable[f]=u,u=u*o%a;for(let f=0;f<a-1;f++)this.logTable[this.expTable[f]]=f;this.zero=new Or(this,new Int32Array([0])),this.one=new Or(this,new Int32Array([1]))}getZero(){return this.zero}getOne(){return this.one}buildMonomial(a,o){if(a<0)throw new E;if(o===0)return this.zero;let u=new Int32Array(a+1);return u[0]=o,new Or(this,u)}}mi.PDF417_GF=new mi($t.NUMBER_OF_CODEWORDS,3);class Di{constructor(){this.field=mi.PDF417_GF}decode(a,o,u){let f=new Or(this.field,a),m=new Int32Array(o),g=!1;for(let ne=o;ne>0;ne--){let re=f.evaluateAt(this.field.exp(ne));m[o-ne]=re,re!==0&&(g=!0)}if(!g)return 0;let w=this.field.getOne();if(u!=null)for(const ne of u){let re=this.field.exp(a.length-1-ne),de=new Or(this.field,new Int32Array([this.field.subtract(0,re),1]));w=w.multiply(de)}let b=new Or(this.field,m),I=this.runEuclideanAlgorithm(this.field.buildMonomial(o,1),b,o),P=I[0],V=I[1],z=this.findErrorLocations(P),Y=this.findErrorMagnitudes(V,P,z);for(let ne=0;ne<z.length;ne++){let re=a.length-1-this.field.log(z[ne]);if(re<0)throw k.getChecksumInstance();a[re]=this.field.subtract(a[re],Y[ne])}return z.length}runEuclideanAlgorithm(a,o,u){if(a.getDegree()<o.getDegree()){let z=a;a=o,o=z}let f=a,m=o,g=this.field.getZero(),w=this.field.getOne();for(;m.getDegree()>=Math.round(u/2);){let z=f,Y=g;if(f=m,g=w,f.isZero())throw k.getChecksumInstance();m=z;let ne=this.field.getZero(),re=f.getCoefficient(f.getDegree()),de=this.field.inverse(re);for(;m.getDegree()>=f.getDegree()&&!m.isZero();){let ye=m.getDegree()-f.getDegree(),Ue=this.field.multiply(m.getCoefficient(m.getDegree()),de);ne=ne.add(this.field.buildMonomial(ye,Ue)),m=m.subtract(f.multiplyByMonomial(ye,Ue))}w=ne.multiply(g).subtract(Y).negative()}let b=w.getCoefficient(0);if(b===0)throw k.getChecksumInstance();let I=this.field.inverse(b),P=w.multiply(I),V=m.multiply(I);return[P,V]}findErrorLocations(a){let o=a.getDegree(),u=new Int32Array(o),f=0;for(let m=1;m<this.field.getSize()&&f<o;m++)a.evaluateAt(m)===0&&(u[f]=this.field.inverse(m),f++);if(f!==o)throw k.getChecksumInstance();return u}findErrorMagnitudes(a,o,u){let f=o.getDegree(),m=new Int32Array(f);for(let I=1;I<=f;I++)m[f-I]=this.field.multiply(I,o.getCoefficient(I));let g=new Or(this.field,m),w=u.length,b=new Int32Array(w);for(let I=0;I<w;I++){let P=this.field.inverse(u[I]),V=this.field.subtract(0,a.evaluateAt(P)),z=this.field.inverse(g.evaluateAt(P));b[I]=this.field.multiply(V,z)}return b}}class pi{constructor(a,o,u,f,m){a instanceof pi?this.constructor_2(a):this.constructor_1(a,o,u,f,m)}constructor_1(a,o,u,f,m){const g=o==null||u==null,w=f==null||m==null;if(g&&w)throw new te;g?(o=new ae(0,f.getY()),u=new ae(0,m.getY())):w&&(f=new ae(a.getWidth()-1,o.getY()),m=new ae(a.getWidth()-1,u.getY())),this.image=a,this.topLeft=o,this.bottomLeft=u,this.topRight=f,this.bottomRight=m,this.minX=Math.trunc(Math.min(o.getX(),u.getX())),this.maxX=Math.trunc(Math.max(f.getX(),m.getX())),this.minY=Math.trunc(Math.min(o.getY(),f.getY())),this.maxY=Math.trunc(Math.max(u.getY(),m.getY()))}constructor_2(a){this.image=a.image,this.topLeft=a.getTopLeft(),this.bottomLeft=a.getBottomLeft(),this.topRight=a.getTopRight(),this.bottomRight=a.getBottomRight(),this.minX=a.getMinX(),this.maxX=a.getMaxX(),this.minY=a.getMinY(),this.maxY=a.getMaxY()}static merge(a,o){return a==null?o:o==null?a:new pi(a.image,a.topLeft,a.bottomLeft,o.topRight,o.bottomRight)}addMissingRows(a,o,u){let f=this.topLeft,m=this.bottomLeft,g=this.topRight,w=this.bottomRight;if(a>0){let b=u?this.topLeft:this.topRight,I=Math.trunc(b.getY()-a);I<0&&(I=0);let P=new ae(b.getX(),I);u?f=P:g=P}if(o>0){let b=u?this.bottomLeft:this.bottomRight,I=Math.trunc(b.getY()+o);I>=this.image.getHeight()&&(I=this.image.getHeight()-1);let P=new ae(b.getX(),I);u?m=P:w=P}return new pi(this.image,f,m,g,w)}getMinX(){return this.minX}getMaxX(){return this.maxX}getMinY(){return this.minY}getMaxY(){return this.maxY}getTopLeft(){return this.topLeft}getTopRight(){return this.topRight}getBottomLeft(){return this.bottomLeft}getBottomRight(){return this.bottomRight}}class gi{constructor(a,o,u,f){this.columnCount=a,this.errorCorrectionLevel=f,this.rowCountUpperPart=o,this.rowCountLowerPart=u,this.rowCount=o+u}getColumnCount(){return this.columnCount}getErrorCorrectionLevel(){return this.errorCorrectionLevel}getRowCount(){return this.rowCount}getRowCountUpperPart(){return this.rowCountUpperPart}getRowCountLowerPart(){return this.rowCountLowerPart}}class ds{constructor(){this.buffer=""}static form(a,o){let u=-1;function f(g,w,b,I,P,V){if(g==="%%")return"%";if(o[++u]===void 0)return;g=I?parseInt(I.substr(1)):void 0;let z=P?parseInt(P.substr(1)):void 0,Y;switch(V){case"s":Y=o[u];break;case"c":Y=o[u][0];break;case"f":Y=parseFloat(o[u]).toFixed(g);break;case"p":Y=parseFloat(o[u]).toPrecision(g);break;case"e":Y=parseFloat(o[u]).toExponential(g);break;case"x":Y=parseInt(o[u]).toString(z||16);break;case"d":Y=parseFloat(parseInt(o[u],z||10).toPrecision(g)).toFixed(0);break}Y=typeof Y=="object"?JSON.stringify(Y):(+Y).toString(z);let ne=parseInt(b),re=b&&b[0]+""=="0"?"0":" ";for(;Y.length<ne;)Y=w!==void 0?Y+re:re+Y;return Y}let m=/%(-)?(0?[0-9]+)?([.][0-9]+)?([#][0-9]+)?([scfpexd%])/g;return a.replace(m,f)}format(a,...o){this.buffer+=ds.form(a,o)}toString(){return this.buffer}}class Gi{constructor(a){this.boundingBox=new pi(a),this.codewords=new Array(a.getMaxY()-a.getMinY()+1)}getCodewordNearby(a){let o=this.getCodeword(a);if(o!=null)return o;for(let u=1;u<Gi.MAX_NEARBY_DISTANCE;u++){let f=this.imageRowToCodewordIndex(a)-u;if(f>=0&&(o=this.codewords[f],o!=null)||(f=this.imageRowToCodewordIndex(a)+u,f<this.codewords.length&&(o=this.codewords[f],o!=null)))return o}return null}imageRowToCodewordIndex(a){return a-this.boundingBox.getMinY()}setCodeword(a,o){this.codewords[this.imageRowToCodewordIndex(a)]=o}getCodeword(a){return this.codewords[this.imageRowToCodewordIndex(a)]}getBoundingBox(){return this.boundingBox}getCodewords(){return this.codewords}toString(){const a=new ds;let o=0;for(const u of this.codewords){if(u==null){a.format("%3d:    |   %n",o++);continue}a.format("%3d: %3d|%3d%n",o++,u.getRowNumber(),u.getValue())}return a.toString()}}Gi.MAX_NEARBY_DISTANCE=5;class yi{constructor(){this.values=new Map}setValue(a){a=Math.trunc(a);let o=this.values.get(a);o==null&&(o=0),o++,this.values.set(a,o)}getValue(){let a=-1,o=new Array;for(const[u,f]of this.values.entries()){const m={getKey:()=>u,getValue:()=>f};m.getValue()>a?(a=m.getValue(),o=[],o.push(m.getKey())):m.getValue()===a&&o.push(m.getKey())}return $t.toIntArray(o)}getConfidence(a){return this.values.get(a)}}class Zt extends Gi{constructor(a,o){super(a),this._isLeft=o}setRowNumbers(){for(let a of this.getCodewords())a!=null&&a.setRowNumberAsRowIndicatorColumn()}adjustCompleteIndicatorColumnRowNumbers(a){let o=this.getCodewords();this.setRowNumbers(),this.removeIncorrectCodewords(o,a);let u=this.getBoundingBox(),f=this._isLeft?u.getTopLeft():u.getTopRight(),m=this._isLeft?u.getBottomLeft():u.getBottomRight(),g=this.imageRowToCodewordIndex(Math.trunc(f.getY())),w=this.imageRowToCodewordIndex(Math.trunc(m.getY())),b=-1,I=1,P=0;for(let V=g;V<w;V++){if(o[V]==null)continue;let z=o[V],Y=z.getRowNumber()-b;if(Y===0)P++;else if(Y===1)I=Math.max(I,P),P=1,b=z.getRowNumber();else if(Y<0||z.getRowNumber()>=a.getRowCount()||Y>V)o[V]=null;else{let ne;I>2?ne=(I-2)*Y:ne=Y;let re=ne>=V;for(let de=1;de<=ne&&!re;de++)re=o[V-de]!=null;re?o[V]=null:(b=z.getRowNumber(),P=1)}}}getRowHeights(){let a=this.getBarcodeMetadata();if(a==null)return null;this.adjustIncompleteIndicatorColumnRowNumbers(a);let o=new Int32Array(a.getRowCount());for(let u of this.getCodewords())if(u!=null){let f=u.getRowNumber();if(f>=o.length)continue;o[f]++}return o}adjustIncompleteIndicatorColumnRowNumbers(a){let o=this.getBoundingBox(),u=this._isLeft?o.getTopLeft():o.getTopRight(),f=this._isLeft?o.getBottomLeft():o.getBottomRight(),m=this.imageRowToCodewordIndex(Math.trunc(u.getY())),g=this.imageRowToCodewordIndex(Math.trunc(f.getY())),w=this.getCodewords(),b=-1;for(let I=m;I<g;I++){if(w[I]==null)continue;let P=w[I];P.setRowNumberAsRowIndicatorColumn();let V=P.getRowNumber()-b;V===0||(V===1?b=P.getRowNumber():P.getRowNumber()>=a.getRowCount()?w[I]=null:b=P.getRowNumber())}}getBarcodeMetadata(){let a=this.getCodewords(),o=new yi,u=new yi,f=new yi,m=new yi;for(let w of a){if(w==null)continue;w.setRowNumberAsRowIndicatorColumn();let b=w.getValue()%30,I=w.getRowNumber();switch(this._isLeft||(I+=2),I%3){case 0:u.setValue(b*3+1);break;case 1:m.setValue(b/3),f.setValue(b%3);break;case 2:o.setValue(b+1);break}}if(o.getValue().length===0||u.getValue().length===0||f.getValue().length===0||m.getValue().length===0||o.getValue()[0]<1||u.getValue()[0]+f.getValue()[0]<$t.MIN_ROWS_IN_BARCODE||u.getValue()[0]+f.getValue()[0]>$t.MAX_ROWS_IN_BARCODE)return null;let g=new gi(o.getValue()[0],u.getValue()[0],f.getValue()[0],m.getValue()[0]);return this.removeIncorrectCodewords(a,g),g}removeIncorrectCodewords(a,o){for(let u=0;u<a.length;u++){let f=a[u];if(a[u]==null)continue;let m=f.getValue()%30,g=f.getRowNumber();if(g>o.getRowCount()){a[u]=null;continue}switch(this._isLeft||(g+=2),g%3){case 0:m*3+1!==o.getRowCountUpperPart()&&(a[u]=null);break;case 1:(Math.trunc(m/3)!==o.getErrorCorrectionLevel()||m%3!==o.getRowCountLowerPart())&&(a[u]=null);break;case 2:m+1!==o.getColumnCount()&&(a[u]=null);break}}}isLeft(){return this._isLeft}toString(){return"IsLeft: "+this._isLeft+`
`+super.toString()}}class Qa{constructor(a,o){this.ADJUST_ROW_NUMBER_SKIP=2,this.barcodeMetadata=a,this.barcodeColumnCount=a.getColumnCount(),this.boundingBox=o,this.detectionResultColumns=new Array(this.barcodeColumnCount+2)}getDetectionResultColumns(){this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[0]),this.adjustIndicatorColumnRowNumbers(this.detectionResultColumns[this.barcodeColumnCount+1]);let a=$t.MAX_CODEWORDS_IN_BARCODE,o;do o=a,a=this.adjustRowNumbersAndGetCount();while(a>0&&a<o);return this.detectionResultColumns}adjustIndicatorColumnRowNumbers(a){a!=null&&a.adjustCompleteIndicatorColumnRowNumbers(this.barcodeMetadata)}adjustRowNumbersAndGetCount(){let a=this.adjustRowNumbersByRow();if(a===0)return 0;for(let o=1;o<this.barcodeColumnCount+1;o++){let u=this.detectionResultColumns[o].getCodewords();for(let f=0;f<u.length;f++)u[f]!=null&&(u[f].hasValidRowNumber()||this.adjustRowNumbers(o,f,u))}return a}adjustRowNumbersByRow(){return this.adjustRowNumbersFromBothRI(),this.adjustRowNumbersFromLRI()+this.adjustRowNumbersFromRRI()}adjustRowNumbersFromBothRI(){if(this.detectionResultColumns[0]==null||this.detectionResultColumns[this.barcodeColumnCount+1]==null)return;let a=this.detectionResultColumns[0].getCodewords(),o=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let u=0;u<a.length;u++)if(a[u]!=null&&o[u]!=null&&a[u].getRowNumber()===o[u].getRowNumber())for(let f=1;f<=this.barcodeColumnCount;f++){let m=this.detectionResultColumns[f].getCodewords()[u];m!=null&&(m.setRowNumber(a[u].getRowNumber()),m.hasValidRowNumber()||(this.detectionResultColumns[f].getCodewords()[u]=null))}}adjustRowNumbersFromRRI(){if(this.detectionResultColumns[this.barcodeColumnCount+1]==null)return 0;let a=0,o=this.detectionResultColumns[this.barcodeColumnCount+1].getCodewords();for(let u=0;u<o.length;u++){if(o[u]==null)continue;let f=o[u].getRowNumber(),m=0;for(let g=this.barcodeColumnCount+1;g>0&&m<this.ADJUST_ROW_NUMBER_SKIP;g--){let w=this.detectionResultColumns[g].getCodewords()[u];w!=null&&(m=Qa.adjustRowNumberIfValid(f,m,w),w.hasValidRowNumber()||a++)}}return a}adjustRowNumbersFromLRI(){if(this.detectionResultColumns[0]==null)return 0;let a=0,o=this.detectionResultColumns[0].getCodewords();for(let u=0;u<o.length;u++){if(o[u]==null)continue;let f=o[u].getRowNumber(),m=0;for(let g=1;g<this.barcodeColumnCount+1&&m<this.ADJUST_ROW_NUMBER_SKIP;g++){let w=this.detectionResultColumns[g].getCodewords()[u];w!=null&&(m=Qa.adjustRowNumberIfValid(f,m,w),w.hasValidRowNumber()||a++)}}return a}static adjustRowNumberIfValid(a,o,u){return u==null||u.hasValidRowNumber()||(u.isValidRowNumber(a)?(u.setRowNumber(a),o=0):++o),o}adjustRowNumbers(a,o,u){if(!this.detectionResultColumns[a-1])return;let f=u[o],m=this.detectionResultColumns[a-1].getCodewords(),g=m;this.detectionResultColumns[a+1]!=null&&(g=this.detectionResultColumns[a+1].getCodewords());let w=new Array(14);w[2]=m[o],w[3]=g[o],o>0&&(w[0]=u[o-1],w[4]=m[o-1],w[5]=g[o-1]),o>1&&(w[8]=u[o-2],w[10]=m[o-2],w[11]=g[o-2]),o<u.length-1&&(w[1]=u[o+1],w[6]=m[o+1],w[7]=g[o+1]),o<u.length-2&&(w[9]=u[o+2],w[12]=m[o+2],w[13]=g[o+2]);for(let b of w)if(Qa.adjustRowNumber(f,b))return}static adjustRowNumber(a,o){return o==null?!1:o.hasValidRowNumber()&&o.getBucket()===a.getBucket()?(a.setRowNumber(o.getRowNumber()),!0):!1}getBarcodeColumnCount(){return this.barcodeColumnCount}getBarcodeRowCount(){return this.barcodeMetadata.getRowCount()}getBarcodeECLevel(){return this.barcodeMetadata.getErrorCorrectionLevel()}setBoundingBox(a){this.boundingBox=a}getBoundingBox(){return this.boundingBox}setDetectionResultColumn(a,o){this.detectionResultColumns[a]=o}getDetectionResultColumn(a){return this.detectionResultColumns[a]}toString(){let a=this.detectionResultColumns[0];a==null&&(a=this.detectionResultColumns[this.barcodeColumnCount+1]);let o=new ds;for(let u=0;u<a.getCodewords().length;u++){o.format("CW %3d:",u);for(let f=0;f<this.barcodeColumnCount+2;f++){if(this.detectionResultColumns[f]==null){o.format("    |   ");continue}let m=this.detectionResultColumns[f].getCodewords()[u];if(m==null){o.format("    |   ");continue}o.format(" %3d|%3d",m.getRowNumber(),m.getValue())}o.format("%n")}return o.toString()}}class Ya{constructor(a,o,u,f){this.rowNumber=Ya.BARCODE_ROW_UNKNOWN,this.startX=Math.trunc(a),this.endX=Math.trunc(o),this.bucket=Math.trunc(u),this.value=Math.trunc(f)}hasValidRowNumber(){return this.isValidRowNumber(this.rowNumber)}isValidRowNumber(a){return a!==Ya.BARCODE_ROW_UNKNOWN&&this.bucket===a%3*3}setRowNumberAsRowIndicatorColumn(){this.rowNumber=Math.trunc(Math.trunc(this.value/30)*3+Math.trunc(this.bucket/3))}getWidth(){return this.endX-this.startX}getStartX(){return this.startX}getEndX(){return this.endX}getBucket(){return this.bucket}getValue(){return this.value}getRowNumber(){return this.rowNumber}setRowNumber(a){this.rowNumber=a}toString(){return this.rowNumber+"|"+this.value}}Ya.BARCODE_ROW_UNKNOWN=-1;class $r{static initialize(){for(let a=0;a<$t.SYMBOL_TABLE.length;a++){let o=$t.SYMBOL_TABLE[a],u=o&1;for(let f=0;f<$t.BARS_IN_MODULE;f++){let m=0;for(;(o&1)===u;)m+=1,o>>=1;u=o&1,$r.RATIOS_TABLE[a]||($r.RATIOS_TABLE[a]=new Array($t.BARS_IN_MODULE)),$r.RATIOS_TABLE[a][$t.BARS_IN_MODULE-f-1]=Math.fround(m/$t.MODULES_IN_CODEWORD)}}this.bSymbolTableReady=!0}static getDecodedValue(a){let o=$r.getDecodedCodewordValue($r.sampleBitCounts(a));return o!==-1?o:$r.getClosestDecodedValue(a)}static sampleBitCounts(a){let o=st.sum(a),u=new Int32Array($t.BARS_IN_MODULE),f=0,m=0;for(let g=0;g<$t.MODULES_IN_CODEWORD;g++){let w=o/(2*$t.MODULES_IN_CODEWORD)+g*o/$t.MODULES_IN_CODEWORD;m+a[f]<=w&&(m+=a[f],f++),u[f]++}return u}static getDecodedCodewordValue(a){let o=$r.getBitValue(a);return $t.getCodeword(o)===-1?-1:o}static getBitValue(a){let o=0;for(let u=0;u<a.length;u++)for(let f=0;f<a[u];f++)o=o<<1|(u%2===0?1:0);return Math.trunc(o)}static getClosestDecodedValue(a){let o=st.sum(a),u=new Array($t.BARS_IN_MODULE);if(o>1)for(let g=0;g<u.length;g++)u[g]=Math.fround(a[g]/o);let f=me.MAX_VALUE,m=-1;this.bSymbolTableReady||$r.initialize();for(let g=0;g<$r.RATIOS_TABLE.length;g++){let w=0,b=$r.RATIOS_TABLE[g];for(let I=0;I<$t.BARS_IN_MODULE;I++){let P=Math.fround(b[I]-u[I]);if(w+=Math.fround(P*P),w>=f)break}w<f&&(f=w,m=$t.SYMBOL_TABLE[g])}return m}}$r.bSymbolTableReady=!1,$r.RATIOS_TABLE=new Array($t.SYMBOL_TABLE.length).map(j=>new Array($t.BARS_IN_MODULE));class $o{constructor(){this.segmentCount=-1,this.fileSize=-1,this.timestamp=-1,this.checksum=-1}getSegmentIndex(){return this.segmentIndex}setSegmentIndex(a){this.segmentIndex=a}getFileId(){return this.fileId}setFileId(a){this.fileId=a}getOptionalData(){return this.optionalData}setOptionalData(a){this.optionalData=a}isLastSegment(){return this.lastSegment}setLastSegment(a){this.lastSegment=a}getSegmentCount(){return this.segmentCount}setSegmentCount(a){this.segmentCount=a}getSender(){return this.sender||null}setSender(a){this.sender=a}getAddressee(){return this.addressee||null}setAddressee(a){this.addressee=a}getFileName(){return this.fileName}setFileName(a){this.fileName=a}getFileSize(){return this.fileSize}setFileSize(a){this.fileSize=a}getChecksum(){return this.checksum}setChecksum(a){this.checksum=a}getTimestamp(){return this.timestamp}setTimestamp(a){this.timestamp=a}}class zo{static parseLong(a,o=void 0){return parseInt(a,o)}}class Oi extends y{}Oi.kind="NullPointerException";class Zl{writeBytes(a){this.writeBytesOffset(a,0,a.length)}writeBytesOffset(a,o,u){if(a==null)throw new Oi;if(o<0||o>a.length||u<0||o+u>a.length||o+u<0)throw new H;if(u===0)return;for(let f=0;f<u;f++)this.write(a[o+f])}flush(){}close(){}}class Mr extends y{}class Jl extends Zl{constructor(a=32){if(super(),this.count=0,a<0)throw new E("Negative initial size: "+a);this.buf=new Uint8Array(a)}ensureCapacity(a){a-this.buf.length>0&&this.grow(a)}grow(a){let u=this.buf.length<<1;if(u-a<0&&(u=a),u<0){if(a<0)throw new Mr;u=U.MAX_VALUE}this.buf=M.copyOfUint8Array(this.buf,u)}write(a){this.ensureCapacity(this.count+1),this.buf[this.count]=a,this.count+=1}writeBytesOffset(a,o,u){if(o<0||o>a.length||u<0||o+u-a.length>0)throw new H;this.ensureCapacity(this.count+u),B.arraycopy(a,o,this.buf,this.count,u),this.count+=u}writeTo(a){a.writeBytesOffset(this.buf,0,this.count)}reset(){this.count=0}toByteArray(){return M.copyOfUint8Array(this.buf,this.count)}size(){return this.count}toString(a){return a?typeof a=="string"?this.toString_string(a):this.toString_number(a):this.toString_void()}toString_void(){return new String(this.buf).toString()}toString_string(a){return new String(this.buf).toString()}toString_number(a){return new String(this.buf).toString()}close(){}}var $n;(function(j){j[j.ALPHA=0]="ALPHA",j[j.LOWER=1]="LOWER",j[j.MIXED=2]="MIXED",j[j.PUNCT=3]="PUNCT",j[j.ALPHA_SHIFT=4]="ALPHA_SHIFT",j[j.PUNCT_SHIFT=5]="PUNCT_SHIFT"})($n||($n={}));function Qs(){if(typeof window<"u")return window.BigInt||null;if(typeof Qd<"u")return Qd.BigInt||null;if(typeof self<"u")return self.BigInt||null;throw new Error("Can't search globals for BigInt!")}let pa;function Es(j){if(typeof pa>"u"&&(pa=Qs()),pa===null)throw new Error("BigInt is not supported!");return pa(j)}function qi(){let j=[];j[0]=Es(1);let a=Es(900);j[1]=a;for(let o=2;o<16;o++)j[o]=j[o-1]*a;return j}class he{static decode(a,o){let u=new R(""),f=N.ISO8859_1;u.enableDecoding(f);let m=1,g=a[m++],w=new $o;for(;m<a[0];){switch(g){case he.TEXT_COMPACTION_MODE_LATCH:m=he.textCompaction(a,m,u);break;case he.BYTE_COMPACTION_MODE_LATCH:case he.BYTE_COMPACTION_MODE_LATCH_6:m=he.byteCompaction(g,a,f,m,u);break;case he.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:u.append(a[m++]);break;case he.NUMERIC_COMPACTION_MODE_LATCH:m=he.numericCompaction(a,m,u);break;case he.ECI_CHARSET:N.getCharacterSetECIByValue(a[m++]);break;case he.ECI_GENERAL_PURPOSE:m+=2;break;case he.ECI_USER_DEFINED:m++;break;case he.BEGIN_MACRO_PDF417_CONTROL_BLOCK:m=he.decodeMacroBlock(a,m,w);break;case he.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case he.MACRO_PDF417_TERMINATOR:throw new A;default:m--,m=he.textCompaction(a,m,u);break}if(m<a.length)g=a[m++];else throw A.getFormatInstance()}if(u.length()===0)throw A.getFormatInstance();let b=new Vt(null,u.toString(),null,o);return b.setOther(w),b}static decodeMacroBlock(a,o,u){if(o+he.NUMBER_OF_SEQUENCE_CODEWORDS>a[0])throw A.getFormatInstance();let f=new Int32Array(he.NUMBER_OF_SEQUENCE_CODEWORDS);for(let w=0;w<he.NUMBER_OF_SEQUENCE_CODEWORDS;w++,o++)f[w]=a[o];u.setSegmentIndex(U.parseInt(he.decodeBase900toBase10(f,he.NUMBER_OF_SEQUENCE_CODEWORDS)));let m=new R;o=he.textCompaction(a,o,m),u.setFileId(m.toString());let g=-1;for(a[o]===he.BEGIN_MACRO_PDF417_OPTIONAL_FIELD&&(g=o+1);o<a[0];)switch(a[o]){case he.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:switch(o++,a[o]){case he.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME:let w=new R;o=he.textCompaction(a,o+1,w),u.setFileName(w.toString());break;case he.MACRO_PDF417_OPTIONAL_FIELD_SENDER:let b=new R;o=he.textCompaction(a,o+1,b),u.setSender(b.toString());break;case he.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE:let I=new R;o=he.textCompaction(a,o+1,I),u.setAddressee(I.toString());break;case he.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT:let P=new R;o=he.numericCompaction(a,o+1,P),u.setSegmentCount(U.parseInt(P.toString()));break;case he.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP:let V=new R;o=he.numericCompaction(a,o+1,V),u.setTimestamp(zo.parseLong(V.toString()));break;case he.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM:let z=new R;o=he.numericCompaction(a,o+1,z),u.setChecksum(U.parseInt(z.toString()));break;case he.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE:let Y=new R;o=he.numericCompaction(a,o+1,Y),u.setFileSize(zo.parseLong(Y.toString()));break;default:throw A.getFormatInstance()}break;case he.MACRO_PDF417_TERMINATOR:o++,u.setLastSegment(!0);break;default:throw A.getFormatInstance()}if(g!==-1){let w=o-g;u.isLastSegment()&&w--,u.setOptionalData(M.copyOfRange(a,g,g+w))}return o}static textCompaction(a,o,u){let f=new Int32Array((a[0]-o)*2),m=new Int32Array((a[0]-o)*2),g=0,w=!1;for(;o<a[0]&&!w;){let b=a[o++];if(b<he.TEXT_COMPACTION_MODE_LATCH)f[g]=b/30,f[g+1]=b%30,g+=2;else switch(b){case he.TEXT_COMPACTION_MODE_LATCH:f[g++]=he.TEXT_COMPACTION_MODE_LATCH;break;case he.BYTE_COMPACTION_MODE_LATCH:case he.BYTE_COMPACTION_MODE_LATCH_6:case he.NUMERIC_COMPACTION_MODE_LATCH:case he.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case he.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case he.MACRO_PDF417_TERMINATOR:o--,w=!0;break;case he.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:f[g]=he.MODE_SHIFT_TO_BYTE_COMPACTION_MODE,b=a[o++],m[g]=b,g++;break}}return he.decodeTextCompaction(f,m,g,u),o}static decodeTextCompaction(a,o,u,f){let m=$n.ALPHA,g=$n.ALPHA,w=0;for(;w<u;){let b=a[w],I="";switch(m){case $n.ALPHA:if(b<26)I=String.fromCharCode(65+b);else switch(b){case 26:I=" ";break;case he.LL:m=$n.LOWER;break;case he.ML:m=$n.MIXED;break;case he.PS:g=m,m=$n.PUNCT_SHIFT;break;case he.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:f.append(o[w]);break;case he.TEXT_COMPACTION_MODE_LATCH:m=$n.ALPHA;break}break;case $n.LOWER:if(b<26)I=String.fromCharCode(97+b);else switch(b){case 26:I=" ";break;case he.AS:g=m,m=$n.ALPHA_SHIFT;break;case he.ML:m=$n.MIXED;break;case he.PS:g=m,m=$n.PUNCT_SHIFT;break;case he.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:f.append(o[w]);break;case he.TEXT_COMPACTION_MODE_LATCH:m=$n.ALPHA;break}break;case $n.MIXED:if(b<he.PL)I=he.MIXED_CHARS[b];else switch(b){case he.PL:m=$n.PUNCT;break;case 26:I=" ";break;case he.LL:m=$n.LOWER;break;case he.AL:m=$n.ALPHA;break;case he.PS:g=m,m=$n.PUNCT_SHIFT;break;case he.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:f.append(o[w]);break;case he.TEXT_COMPACTION_MODE_LATCH:m=$n.ALPHA;break}break;case $n.PUNCT:if(b<he.PAL)I=he.PUNCT_CHARS[b];else switch(b){case he.PAL:m=$n.ALPHA;break;case he.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:f.append(o[w]);break;case he.TEXT_COMPACTION_MODE_LATCH:m=$n.ALPHA;break}break;case $n.ALPHA_SHIFT:if(m=g,b<26)I=String.fromCharCode(65+b);else switch(b){case 26:I=" ";break;case he.TEXT_COMPACTION_MODE_LATCH:m=$n.ALPHA;break}break;case $n.PUNCT_SHIFT:if(m=g,b<he.PAL)I=he.PUNCT_CHARS[b];else switch(b){case he.PAL:m=$n.ALPHA;break;case he.MODE_SHIFT_TO_BYTE_COMPACTION_MODE:f.append(o[w]);break;case he.TEXT_COMPACTION_MODE_LATCH:m=$n.ALPHA;break}break}I!==""&&f.append(I),w++}}static byteCompaction(a,o,u,f,m){let g=new Jl,w=0,b=0,I=!1;switch(a){case he.BYTE_COMPACTION_MODE_LATCH:let P=new Int32Array(6),V=o[f++];for(;f<o[0]&&!I;)switch(P[w++]=V,b=900*b+V,V=o[f++],V){case he.TEXT_COMPACTION_MODE_LATCH:case he.BYTE_COMPACTION_MODE_LATCH:case he.NUMERIC_COMPACTION_MODE_LATCH:case he.BYTE_COMPACTION_MODE_LATCH_6:case he.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case he.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case he.MACRO_PDF417_TERMINATOR:f--,I=!0;break;default:if(w%5===0&&w>0){for(let z=0;z<6;++z)g.write(Number(Es(b)>>Es(8*(5-z))));b=0,w=0}break}f===o[0]&&V<he.TEXT_COMPACTION_MODE_LATCH&&(P[w++]=V);for(let z=0;z<w;z++)g.write(P[z]);break;case he.BYTE_COMPACTION_MODE_LATCH_6:for(;f<o[0]&&!I;){let z=o[f++];if(z<he.TEXT_COMPACTION_MODE_LATCH)w++,b=900*b+z;else switch(z){case he.TEXT_COMPACTION_MODE_LATCH:case he.BYTE_COMPACTION_MODE_LATCH:case he.NUMERIC_COMPACTION_MODE_LATCH:case he.BYTE_COMPACTION_MODE_LATCH_6:case he.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case he.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case he.MACRO_PDF417_TERMINATOR:f--,I=!0;break}if(w%5===0&&w>0){for(let Y=0;Y<6;++Y)g.write(Number(Es(b)>>Es(8*(5-Y))));b=0,w=0}}break}return m.append(O.decode(g.toByteArray(),u)),f}static numericCompaction(a,o,u){let f=0,m=!1,g=new Int32Array(he.MAX_NUMERIC_CODEWORDS);for(;o<a[0]&&!m;){let w=a[o++];if(o===a[0]&&(m=!0),w<he.TEXT_COMPACTION_MODE_LATCH)g[f]=w,f++;else switch(w){case he.TEXT_COMPACTION_MODE_LATCH:case he.BYTE_COMPACTION_MODE_LATCH:case he.BYTE_COMPACTION_MODE_LATCH_6:case he.BEGIN_MACRO_PDF417_CONTROL_BLOCK:case he.BEGIN_MACRO_PDF417_OPTIONAL_FIELD:case he.MACRO_PDF417_TERMINATOR:o--,m=!0;break}(f%he.MAX_NUMERIC_CODEWORDS===0||w===he.NUMERIC_COMPACTION_MODE_LATCH||m)&&f>0&&(u.append(he.decodeBase900toBase10(g,f)),f=0)}return o}static decodeBase900toBase10(a,o){let u=Es(0);for(let m=0;m<o;m++)u+=he.EXP900[o-m-1]*Es(a[m]);let f=u.toString();if(f.charAt(0)!=="1")throw new A;return f.substring(1)}}he.TEXT_COMPACTION_MODE_LATCH=900,he.BYTE_COMPACTION_MODE_LATCH=901,he.NUMERIC_COMPACTION_MODE_LATCH=902,he.BYTE_COMPACTION_MODE_LATCH_6=924,he.ECI_USER_DEFINED=925,he.ECI_GENERAL_PURPOSE=926,he.ECI_CHARSET=927,he.BEGIN_MACRO_PDF417_CONTROL_BLOCK=928,he.BEGIN_MACRO_PDF417_OPTIONAL_FIELD=923,he.MACRO_PDF417_TERMINATOR=922,he.MODE_SHIFT_TO_BYTE_COMPACTION_MODE=913,he.MAX_NUMERIC_CODEWORDS=15,he.MACRO_PDF417_OPTIONAL_FIELD_FILE_NAME=0,he.MACRO_PDF417_OPTIONAL_FIELD_SEGMENT_COUNT=1,he.MACRO_PDF417_OPTIONAL_FIELD_TIME_STAMP=2,he.MACRO_PDF417_OPTIONAL_FIELD_SENDER=3,he.MACRO_PDF417_OPTIONAL_FIELD_ADDRESSEE=4,he.MACRO_PDF417_OPTIONAL_FIELD_FILE_SIZE=5,he.MACRO_PDF417_OPTIONAL_FIELD_CHECKSUM=6,he.PL=25,he.LL=27,he.AS=27,he.ML=28,he.AL=28,he.PS=29,he.PAL=29,he.PUNCT_CHARS=`;<>@[\\]_\`~!\r	,:
-.$/"|*()?{}'`,he.MIXED_CHARS="0123456789&\r	,:#-.$/+%*=^",he.EXP900=Qs()?qi():[],he.NUMBER_OF_SEQUENCE_CODEWORDS=2;class Qt{constructor(){}static decode(a,o,u,f,m,g,w){let b=new pi(a,o,u,f,m),I=null,P=null,V;for(let ne=!0;;ne=!1){if(o!=null&&(I=Qt.getRowIndicatorColumn(a,b,o,!0,g,w)),f!=null&&(P=Qt.getRowIndicatorColumn(a,b,f,!1,g,w)),V=Qt.merge(I,P),V==null)throw te.getNotFoundInstance();let re=V.getBoundingBox();if(ne&&re!=null&&(re.getMinY()<b.getMinY()||re.getMaxY()>b.getMaxY()))b=re;else break}V.setBoundingBox(b);let z=V.getBarcodeColumnCount()+1;V.setDetectionResultColumn(0,I),V.setDetectionResultColumn(z,P);let Y=I!=null;for(let ne=1;ne<=z;ne++){let re=Y?ne:z-ne;if(V.getDetectionResultColumn(re)!==void 0)continue;let de;re===0||re===z?de=new Zt(b,re===0):de=new Gi(b),V.setDetectionResultColumn(re,de);let ye=-1,Ue=ye;for(let ze=b.getMinY();ze<=b.getMaxY();ze++){if(ye=Qt.getStartColumn(V,re,ze,Y),ye<0||ye>b.getMaxX()){if(Ue===-1)continue;ye=Ue}let Me=Qt.detectCodeword(a,b.getMinX(),b.getMaxX(),Y,ye,ze,g,w);Me!=null&&(de.setCodeword(ze,Me),Ue=ye,g=Math.min(g,Me.getWidth()),w=Math.max(w,Me.getWidth()))}}return Qt.createDecoderResult(V)}static merge(a,o){if(a==null&&o==null)return null;let u=Qt.getBarcodeMetadata(a,o);if(u==null)return null;let f=pi.merge(Qt.adjustBoundingBox(a),Qt.adjustBoundingBox(o));return new Qa(u,f)}static adjustBoundingBox(a){if(a==null)return null;let o=a.getRowHeights();if(o==null)return null;let u=Qt.getMax(o),f=0;for(let w of o)if(f+=u-w,w>0)break;let m=a.getCodewords();for(let w=0;f>0&&m[w]==null;w++)f--;let g=0;for(let w=o.length-1;w>=0&&(g+=u-o[w],!(o[w]>0));w--);for(let w=m.length-1;g>0&&m[w]==null;w--)g--;return a.getBoundingBox().addMissingRows(f,g,a.isLeft())}static getMax(a){let o=-1;for(let u of a)o=Math.max(o,u);return o}static getBarcodeMetadata(a,o){let u;if(a==null||(u=a.getBarcodeMetadata())==null)return o==null?null:o.getBarcodeMetadata();let f;return o==null||(f=o.getBarcodeMetadata())==null?u:u.getColumnCount()!==f.getColumnCount()&&u.getErrorCorrectionLevel()!==f.getErrorCorrectionLevel()&&u.getRowCount()!==f.getRowCount()?null:u}static getRowIndicatorColumn(a,o,u,f,m,g){let w=new Zt(o,f);for(let b=0;b<2;b++){let I=b===0?1:-1,P=Math.trunc(Math.trunc(u.getX()));for(let V=Math.trunc(Math.trunc(u.getY()));V<=o.getMaxY()&&V>=o.getMinY();V+=I){let z=Qt.detectCodeword(a,0,a.getWidth(),f,P,V,m,g);z!=null&&(w.setCodeword(V,z),f?P=z.getStartX():P=z.getEndX())}}return w}static adjustCodewordCount(a,o){let u=o[0][1],f=u.getValue(),m=a.getBarcodeColumnCount()*a.getBarcodeRowCount()-Qt.getNumberOfECCodeWords(a.getBarcodeECLevel());if(f.length===0){if(m<1||m>$t.MAX_CODEWORDS_IN_BARCODE)throw te.getNotFoundInstance();u.setValue(m)}else f[0]!==m&&u.setValue(m)}static createDecoderResult(a){let o=Qt.createBarcodeMatrix(a);Qt.adjustCodewordCount(a,o);let u=new Array,f=new Int32Array(a.getBarcodeRowCount()*a.getBarcodeColumnCount()),m=[],g=new Array;for(let b=0;b<a.getBarcodeRowCount();b++)for(let I=0;I<a.getBarcodeColumnCount();I++){let P=o[b][I+1].getValue(),V=b*a.getBarcodeColumnCount()+I;P.length===0?u.push(V):P.length===1?f[V]=P[0]:(g.push(V),m.push(P))}let w=new Array(m.length);for(let b=0;b<w.length;b++)w[b]=m[b];return Qt.createDecoderResultFromAmbiguousValues(a.getBarcodeECLevel(),f,$t.toIntArray(u),$t.toIntArray(g),w)}static createDecoderResultFromAmbiguousValues(a,o,u,f,m){let g=new Int32Array(f.length),w=100;for(;w-- >0;){for(let b=0;b<g.length;b++)o[f[b]]=m[b][g[b]];try{return Qt.decodeCodewords(o,a,u)}catch(b){if(!(b instanceof k))throw b}if(g.length===0)throw k.getChecksumInstance();for(let b=0;b<g.length;b++)if(g[b]<m[b].length-1){g[b]++;break}else if(g[b]=0,b===g.length-1)throw k.getChecksumInstance()}throw k.getChecksumInstance()}static createBarcodeMatrix(a){let o=Array.from({length:a.getBarcodeRowCount()},()=>new Array(a.getBarcodeColumnCount()+2));for(let f=0;f<o.length;f++)for(let m=0;m<o[f].length;m++)o[f][m]=new yi;let u=0;for(let f of a.getDetectionResultColumns()){if(f!=null){for(let m of f.getCodewords())if(m!=null){let g=m.getRowNumber();if(g>=0){if(g>=o.length)continue;o[g][u].setValue(m.getValue())}}}u++}return o}static isValidBarcodeColumn(a,o){return o>=0&&o<=a.getBarcodeColumnCount()+1}static getStartColumn(a,o,u,f){let m=f?1:-1,g=null;if(Qt.isValidBarcodeColumn(a,o-m)&&(g=a.getDetectionResultColumn(o-m).getCodeword(u)),g!=null)return f?g.getEndX():g.getStartX();if(g=a.getDetectionResultColumn(o).getCodewordNearby(u),g!=null)return f?g.getStartX():g.getEndX();if(Qt.isValidBarcodeColumn(a,o-m)&&(g=a.getDetectionResultColumn(o-m).getCodewordNearby(u)),g!=null)return f?g.getEndX():g.getStartX();let w=0;for(;Qt.isValidBarcodeColumn(a,o-m);){o-=m;for(let b of a.getDetectionResultColumn(o).getCodewords())if(b!=null)return(f?b.getEndX():b.getStartX())+m*w*(b.getEndX()-b.getStartX());w++}return f?a.getBoundingBox().getMinX():a.getBoundingBox().getMaxX()}static detectCodeword(a,o,u,f,m,g,w,b){m=Qt.adjustCodewordStartColumn(a,o,u,f,m,g);let I=Qt.getModuleBitCount(a,o,u,f,m,g);if(I==null)return null;let P,V=st.sum(I);if(f)P=m+V;else{for(let ne=0;ne<I.length/2;ne++){let re=I[ne];I[ne]=I[I.length-1-ne],I[I.length-1-ne]=re}P=m,m=P-V}if(!Qt.checkCodewordSkew(V,w,b))return null;let z=$r.getDecodedValue(I),Y=$t.getCodeword(z);return Y===-1?null:new Ya(m,P,Qt.getCodewordBucketNumber(z),Y)}static getModuleBitCount(a,o,u,f,m,g){let w=m,b=new Int32Array(8),I=0,P=f?1:-1,V=f;for(;(f?w<u:w>=o)&&I<b.length;)a.get(w,g)===V?(b[I]++,w+=P):(I++,V=!V);return I===b.length||w===(f?u:o)&&I===b.length-1?b:null}static getNumberOfECCodeWords(a){return 2<<a}static adjustCodewordStartColumn(a,o,u,f,m,g){let w=m,b=f?-1:1;for(let I=0;I<2;I++){for(;(f?w>=o:w<u)&&f===a.get(w,g);){if(Math.abs(m-w)>Qt.CODEWORD_SKEW_SIZE)return m;w+=b}b=-b,f=!f}return w}static checkCodewordSkew(a,o,u){return o-Qt.CODEWORD_SKEW_SIZE<=a&&a<=u+Qt.CODEWORD_SKEW_SIZE}static decodeCodewords(a,o,u){if(a.length===0)throw A.getFormatInstance();let f=1<<o+1,m=Qt.correctErrors(a,u,f);Qt.verifyCodewordCount(a,f);let g=he.decode(a,""+o);return g.setErrorsCorrected(m),g.setErasures(u.length),g}static correctErrors(a,o,u){if(o!=null&&o.length>u/2+Qt.MAX_ERRORS||u<0||u>Qt.MAX_EC_CODEWORDS)throw k.getChecksumInstance();return Qt.errorCorrection.decode(a,u,o)}static verifyCodewordCount(a,o){if(a.length<4)throw A.getFormatInstance();let u=a[0];if(u>a.length)throw A.getFormatInstance();if(u===0)if(o<a.length)a[0]=a.length-o;else throw A.getFormatInstance()}static getBitCountForCodeword(a){let o=new Int32Array(8),u=0,f=o.length-1;for(;!((a&1)!==u&&(u=a&1,f--,f<0));)o[f]++,a>>=1;return o}static getCodewordBucketNumber(a){return a instanceof Int32Array?this.getCodewordBucketNumber_Int32Array(a):this.getCodewordBucketNumber_number(a)}static getCodewordBucketNumber_number(a){return Qt.getCodewordBucketNumber(Qt.getBitCountForCodeword(a))}static getCodewordBucketNumber_Int32Array(a){return(a[0]-a[2]+a[4]-a[6]+9)%9}static toString(a){let o=new ds;for(let u=0;u<a.length;u++){o.format("Row %2d: ",u);for(let f=0;f<a[u].length;f++){let m=a[u][f];m.getValue().length===0?o.format("        ",null):o.format("%4d(%2d)",m.getValue()[0],m.getConfidence(m.getValue()[0]))}o.format("%n")}return o.toString()}}Qt.CODEWORD_SKEW_SIZE=2,Qt.MAX_ERRORS=3,Qt.MAX_EC_CODEWORDS=512,Qt.errorCorrection=new Di;class Lr{decode(a,o=null){let u=Lr.decode(a,o,!1);if(u==null||u.length===0||u[0]==null)throw te.getNotFoundInstance();return u[0]}decodeMultiple(a,o=null){try{return Lr.decode(a,o,!0)}catch(u){throw u instanceof A||u instanceof k?te.getNotFoundInstance():u}}static decode(a,o,u){const f=new Array,m=Nt.detectMultiple(a,o,u);for(const g of m.getPoints()){const w=Qt.decode(m.getBits(),g[4],g[5],g[6],g[7],Lr.getMinCodewordWidth(g),Lr.getMaxCodewordWidth(g)),b=new pe(w.getText(),w.getRawBytes(),void 0,g,fe.PDF_417);b.putMetadata(Ve.ERROR_CORRECTION_LEVEL,w.getECLevel());const I=w.getOther();I!=null&&b.putMetadata(Ve.PDF417_EXTRA_METADATA,I),f.push(b)}return f.map(g=>g)}static getMaxWidth(a,o){return a==null||o==null?0:Math.trunc(Math.abs(a.getX()-o.getX()))}static getMinWidth(a,o){return a==null||o==null?U.MAX_VALUE:Math.trunc(Math.abs(a.getX()-o.getX()))}static getMaxCodewordWidth(a){return Math.floor(Math.max(Math.max(Lr.getMaxWidth(a[0],a[4]),Lr.getMaxWidth(a[6],a[2])*$t.MODULES_IN_CODEWORD/$t.MODULES_IN_STOP_PATTERN),Math.max(Lr.getMaxWidth(a[1],a[5]),Lr.getMaxWidth(a[7],a[3])*$t.MODULES_IN_CODEWORD/$t.MODULES_IN_STOP_PATTERN)))}static getMinCodewordWidth(a){return Math.floor(Math.min(Math.min(Lr.getMinWidth(a[0],a[4]),Lr.getMinWidth(a[6],a[2])*$t.MODULES_IN_CODEWORD/$t.MODULES_IN_STOP_PATTERN),Math.min(Lr.getMinWidth(a[1],a[5]),Lr.getMinWidth(a[7],a[3])*$t.MODULES_IN_CODEWORD/$t.MODULES_IN_STOP_PATTERN)))}reset(){}}class ga extends y{}ga.kind="ReaderException";class Ys{constructor(a,o){this.verbose=a===!0,o&&this.setHints(o)}decode(a,o){return o&&this.setHints(o),this.decodeInternal(a)}decodeWithState(a){return(this.readers===null||this.readers===void 0)&&this.setHints(null),this.decodeInternal(a)}setHints(a){this.hints=a;const o=!r(a)&&a.get(Z.TRY_HARDER)===!0,u=r(a)?null:a.get(Z.POSSIBLE_FORMATS),f=new Array;if(!r(u)){const m=u.some(g=>g===fe.UPC_A||g===fe.UPC_E||g===fe.EAN_13||g===fe.EAN_8||g===fe.CODABAR||g===fe.CODE_39||g===fe.CODE_93||g===fe.CODE_128||g===fe.ITF||g===fe.RSS_14||g===fe.RSS_EXPANDED);m&&!o&&f.push(new Jn(a,this.verbose)),u.includes(fe.QR_CODE)&&f.push(new ki),u.includes(fe.DATA_MATRIX)&&f.push(new Xs),u.includes(fe.AZTEC)&&f.push(new Xt),u.includes(fe.PDF_417)&&f.push(new Lr),m&&o&&f.push(new Jn(a,this.verbose))}f.length===0&&(o||f.push(new Jn(a,this.verbose)),f.push(new ki),f.push(new Xs),f.push(new Xt),f.push(new Lr),o&&f.push(new Jn(a,this.verbose))),this.readers=f}reset(){if(this.readers!==null)for(const a of this.readers)a.reset()}decodeInternal(a){if(this.readers===null)throw new ga("No readers where selected, nothing can be read.");for(const o of this.readers)try{return o.decode(a,this.hints)}catch(u){if(u instanceof ga)continue}throw new te("No MultiFormat Readers were able to detect the code.")}}class ec extends rt{constructor(a=null,o=500){const u=new Ys;u.setHints(a),super(u,o)}decodeBitmap(a){return this.reader.decodeWithState(a)}}class tc extends rt{constructor(a=500){super(new Lr,a)}}class Za extends rt{constructor(a=500){super(new ki,a)}}var Ki;(function(j){j[j.ERROR_CORRECTION=0]="ERROR_CORRECTION",j[j.CHARACTER_SET=1]="CHARACTER_SET",j[j.DATA_MATRIX_SHAPE=2]="DATA_MATRIX_SHAPE",j[j.MIN_SIZE=3]="MIN_SIZE",j[j.MAX_SIZE=4]="MAX_SIZE",j[j.MARGIN=5]="MARGIN",j[j.PDF417_COMPACT=6]="PDF417_COMPACT",j[j.PDF417_COMPACTION=7]="PDF417_COMPACTION",j[j.PDF417_DIMENSIONS=8]="PDF417_DIMENSIONS",j[j.AZTEC_LAYERS=9]="AZTEC_LAYERS",j[j.QR_VERSION=10]="QR_VERSION"})(Ki||(Ki={}));var fr=Ki;class xi{constructor(a){this.field=a,this.cachedGenerators=[],this.cachedGenerators.push(new yt(a,Int32Array.from([1])))}buildGenerator(a){const o=this.cachedGenerators;if(a>=o.length){let u=o[o.length-1];const f=this.field;for(let m=o.length;m<=a;m++){const g=u.multiply(new yt(f,Int32Array.from([1,f.exp(m-1+f.getGeneratorBase())])));o.push(g),u=g}}return o[a]}encode(a,o){if(o===0)throw new E("No error correction bytes");const u=a.length-o;if(u<=0)throw new E("No data bytes provided");const f=this.buildGenerator(o),m=new Int32Array(u);B.arraycopy(a,0,m,0,u);let g=new yt(this.field,m);g=g.multiplyByMonomial(o,1);const b=g.divide(f)[1].getCoefficients(),I=o-b.length;for(let P=0;P<I;P++)a[u+P]=0;B.arraycopy(b,0,a,u+I,b.length)}}class tr{constructor(){}static applyMaskPenaltyRule1(a){return tr.applyMaskPenaltyRule1Internal(a,!0)+tr.applyMaskPenaltyRule1Internal(a,!1)}static applyMaskPenaltyRule2(a){let o=0;const u=a.getArray(),f=a.getWidth(),m=a.getHeight();for(let g=0;g<m-1;g++){const w=u[g];for(let b=0;b<f-1;b++){const I=w[b];I===w[b+1]&&I===u[g+1][b]&&I===u[g+1][b+1]&&o++}}return tr.N2*o}static applyMaskPenaltyRule3(a){let o=0;const u=a.getArray(),f=a.getWidth(),m=a.getHeight();for(let g=0;g<m;g++)for(let w=0;w<f;w++){const b=u[g];w+6<f&&b[w]===1&&b[w+1]===0&&b[w+2]===1&&b[w+3]===1&&b[w+4]===1&&b[w+5]===0&&b[w+6]===1&&(tr.isWhiteHorizontal(b,w-4,w)||tr.isWhiteHorizontal(b,w+7,w+11))&&o++,g+6<m&&u[g][w]===1&&u[g+1][w]===0&&u[g+2][w]===1&&u[g+3][w]===1&&u[g+4][w]===1&&u[g+5][w]===0&&u[g+6][w]===1&&(tr.isWhiteVertical(u,w,g-4,g)||tr.isWhiteVertical(u,w,g+7,g+11))&&o++}return o*tr.N3}static isWhiteHorizontal(a,o,u){o=Math.max(o,0),u=Math.min(u,a.length);for(let f=o;f<u;f++)if(a[f]===1)return!1;return!0}static isWhiteVertical(a,o,u,f){u=Math.max(u,0),f=Math.min(f,a.length);for(let m=u;m<f;m++)if(a[m][o]===1)return!1;return!0}static applyMaskPenaltyRule4(a){let o=0;const u=a.getArray(),f=a.getWidth(),m=a.getHeight();for(let b=0;b<m;b++){const I=u[b];for(let P=0;P<f;P++)I[P]===1&&o++}const g=a.getHeight()*a.getWidth();return Math.floor(Math.abs(o*2-g)*10/g)*tr.N4}static getDataMaskBit(a,o,u){let f,m;switch(a){case 0:f=u+o&1;break;case 1:f=u&1;break;case 2:f=o%3;break;case 3:f=(u+o)%3;break;case 4:f=Math.floor(u/2)+Math.floor(o/3)&1;break;case 5:m=u*o,f=(m&1)+m%3;break;case 6:m=u*o,f=(m&1)+m%3&1;break;case 7:m=u*o,f=m%3+(u+o&1)&1;break;default:throw new E("Invalid mask pattern: "+a)}return f===0}static applyMaskPenaltyRule1Internal(a,o){let u=0;const f=o?a.getHeight():a.getWidth(),m=o?a.getWidth():a.getHeight(),g=a.getArray();for(let w=0;w<f;w++){let b=0,I=-1;for(let P=0;P<m;P++){const V=o?g[w][P]:g[P][w];V===I?b++:(b>=5&&(u+=tr.N1+(b-5)),b=1,I=V)}b>=5&&(u+=tr.N1+(b-5))}return u}}tr.N1=3,tr.N2=3,tr.N3=40,tr.N4=10;class ya{constructor(a,o){this.width=a,this.height=o;const u=new Array(o);for(let f=0;f!==o;f++)u[f]=new Uint8Array(a);this.bytes=u}getHeight(){return this.height}getWidth(){return this.width}get(a,o){return this.bytes[o][a]}getArray(){return this.bytes}setNumber(a,o,u){this.bytes[o][a]=u}setBoolean(a,o,u){this.bytes[o][a]=u?1:0}clear(a){for(const o of this.bytes)M.fill(o,a)}equals(a){if(!(a instanceof ya))return!1;const o=a;if(this.width!==o.width||this.height!==o.height)return!1;for(let u=0,f=this.height;u<f;++u){const m=this.bytes[u],g=o.bytes[u];for(let w=0,b=this.width;w<b;++w)if(m[w]!==g[w])return!1}return!0}toString(){const a=new R;for(let o=0,u=this.height;o<u;++o){const f=this.bytes[o];for(let m=0,g=this.width;m<g;++m)switch(f[m]){case 0:a.append(" 0");break;case 1:a.append(" 1");break;default:a.append("  ");break}a.append(`
`)}return a.toString()}}class br{constructor(){this.maskPattern=-1}getMode(){return this.mode}getECLevel(){return this.ecLevel}getVersion(){return this.version}getMaskPattern(){return this.maskPattern}getMatrix(){return this.matrix}toString(){const a=new R;return a.append(`<<
`),a.append(" mode: "),a.append(this.mode?this.mode.toString():"null"),a.append(`
 ecLevel: `),a.append(this.ecLevel?this.ecLevel.toString():"null"),a.append(`
 version: `),a.append(this.version?this.version.toString():"null"),a.append(`
 maskPattern: `),a.append(this.maskPattern.toString()),this.matrix?(a.append(`
 matrix:
`),a.append(this.matrix.toString())):a.append(`
 matrix: null
`),a.append(`>>
`),a.toString()}setMode(a){this.mode=a}setECLevel(a){this.ecLevel=a}setVersion(a){this.version=a}setMaskPattern(a){this.maskPattern=a}setMatrix(a){this.matrix=a}static isValidMaskPattern(a){return a>=0&&a<br.NUM_MASK_PATTERNS}}br.NUM_MASK_PATTERNS=8;class Fn extends y{}Fn.kind="WriterException";class Dt{constructor(){}static clearMatrix(a){a.clear(255)}static buildMatrix(a,o,u,f,m){Dt.clearMatrix(m),Dt.embedBasicPatterns(u,m),Dt.embedTypeInfo(o,f,m),Dt.maybeEmbedVersionInfo(u,m),Dt.embedDataBits(a,f,m)}static embedBasicPatterns(a,o){Dt.embedPositionDetectionPatternsAndSeparators(o),Dt.embedDarkDotAtLeftBottomCorner(o),Dt.maybeEmbedPositionAdjustmentPatterns(a,o),Dt.embedTimingPatterns(o)}static embedTypeInfo(a,o,u){const f=new $;Dt.makeTypeInfoBits(a,o,f);for(let m=0,g=f.getSize();m<g;++m){const w=f.get(f.getSize()-1-m),b=Dt.TYPE_INFO_COORDINATES[m],I=b[0],P=b[1];if(u.setBoolean(I,P,w),m<8){const V=u.getWidth()-m-1;u.setBoolean(V,8,w)}else{const z=u.getHeight()-7+(m-8);u.setBoolean(8,z,w)}}}static maybeEmbedVersionInfo(a,o){if(a.getVersionNumber()<7)return;const u=new $;Dt.makeVersionInfoBits(a,u);let f=6*3-1;for(let m=0;m<6;++m)for(let g=0;g<3;++g){const w=u.get(f);f--,o.setBoolean(m,o.getHeight()-11+g,w),o.setBoolean(o.getHeight()-11+g,m,w)}}static embedDataBits(a,o,u){let f=0,m=-1,g=u.getWidth()-1,w=u.getHeight()-1;for(;g>0;){for(g===6&&(g-=1);w>=0&&w<u.getHeight();){for(let b=0;b<2;++b){const I=g-b;if(!Dt.isEmpty(u.get(I,w)))continue;let P;f<a.getSize()?(P=a.get(f),++f):P=!1,o!==255&&tr.getDataMaskBit(o,I,w)&&(P=!P),u.setBoolean(I,w,P)}w+=m}m=-m,w+=m,g-=2}if(f!==a.getSize())throw new Fn("Not all bits consumed: "+f+"/"+a.getSize())}static findMSBSet(a){return 32-U.numberOfLeadingZeros(a)}static calculateBCHCode(a,o){if(o===0)throw new E("0 polynomial");const u=Dt.findMSBSet(o);for(a<<=u-1;Dt.findMSBSet(a)>=u;)a^=o<<Dt.findMSBSet(a)-u;return a}static makeTypeInfoBits(a,o,u){if(!br.isValidMaskPattern(o))throw new Fn("Invalid mask pattern");const f=a.getBits()<<3|o;u.appendBits(f,5);const m=Dt.calculateBCHCode(f,Dt.TYPE_INFO_POLY);u.appendBits(m,10);const g=new $;if(g.appendBits(Dt.TYPE_INFO_MASK_PATTERN,15),u.xor(g),u.getSize()!==15)throw new Fn("should not happen but we got: "+u.getSize())}static makeVersionInfoBits(a,o){o.appendBits(a.getVersionNumber(),6);const u=Dt.calculateBCHCode(a.getVersionNumber(),Dt.VERSION_INFO_POLY);if(o.appendBits(u,12),o.getSize()!==18)throw new Fn("should not happen but we got: "+o.getSize())}static isEmpty(a){return a===255}static embedTimingPatterns(a){for(let o=8;o<a.getWidth()-8;++o){const u=(o+1)%2;Dt.isEmpty(a.get(o,6))&&a.setNumber(o,6,u),Dt.isEmpty(a.get(6,o))&&a.setNumber(6,o,u)}}static embedDarkDotAtLeftBottomCorner(a){if(a.get(8,a.getHeight()-8)===0)throw new Fn;a.setNumber(8,a.getHeight()-8,1)}static embedHorizontalSeparationPattern(a,o,u){for(let f=0;f<8;++f){if(!Dt.isEmpty(u.get(a+f,o)))throw new Fn;u.setNumber(a+f,o,0)}}static embedVerticalSeparationPattern(a,o,u){for(let f=0;f<7;++f){if(!Dt.isEmpty(u.get(a,o+f)))throw new Fn;u.setNumber(a,o+f,0)}}static embedPositionAdjustmentPattern(a,o,u){for(let f=0;f<5;++f){const m=Dt.POSITION_ADJUSTMENT_PATTERN[f];for(let g=0;g<5;++g)u.setNumber(a+g,o+f,m[g])}}static embedPositionDetectionPattern(a,o,u){for(let f=0;f<7;++f){const m=Dt.POSITION_DETECTION_PATTERN[f];for(let g=0;g<7;++g)u.setNumber(a+g,o+f,m[g])}}static embedPositionDetectionPatternsAndSeparators(a){const o=Dt.POSITION_DETECTION_PATTERN[0].length;Dt.embedPositionDetectionPattern(0,0,a),Dt.embedPositionDetectionPattern(a.getWidth()-o,0,a),Dt.embedPositionDetectionPattern(0,a.getWidth()-o,a);const u=8;Dt.embedHorizontalSeparationPattern(0,u-1,a),Dt.embedHorizontalSeparationPattern(a.getWidth()-u,u-1,a),Dt.embedHorizontalSeparationPattern(0,a.getWidth()-u,a);const f=7;Dt.embedVerticalSeparationPattern(f,0,a),Dt.embedVerticalSeparationPattern(a.getHeight()-f-1,0,a),Dt.embedVerticalSeparationPattern(f,a.getHeight()-f,a)}static maybeEmbedPositionAdjustmentPatterns(a,o){if(a.getVersionNumber()<2)return;const u=a.getVersionNumber()-1,f=Dt.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE[u];for(let m=0,g=f.length;m!==g;m++){const w=f[m];if(w>=0)for(let b=0;b!==g;b++){const I=f[b];I>=0&&Dt.isEmpty(o.get(I,w))&&Dt.embedPositionAdjustmentPattern(I-2,w-2,o)}}}}Dt.POSITION_DETECTION_PATTERN=Array.from([Int32Array.from([1,1,1,1,1,1,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,1,1,1,0,1]),Int32Array.from([1,0,0,0,0,0,1]),Int32Array.from([1,1,1,1,1,1,1])]),Dt.POSITION_ADJUSTMENT_PATTERN=Array.from([Int32Array.from([1,1,1,1,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,0,1,0,1]),Int32Array.from([1,0,0,0,1]),Int32Array.from([1,1,1,1,1])]),Dt.POSITION_ADJUSTMENT_PATTERN_COORDINATE_TABLE=Array.from([Int32Array.from([-1,-1,-1,-1,-1,-1,-1]),Int32Array.from([6,18,-1,-1,-1,-1,-1]),Int32Array.from([6,22,-1,-1,-1,-1,-1]),Int32Array.from([6,26,-1,-1,-1,-1,-1]),Int32Array.from([6,30,-1,-1,-1,-1,-1]),Int32Array.from([6,34,-1,-1,-1,-1,-1]),Int32Array.from([6,22,38,-1,-1,-1,-1]),Int32Array.from([6,24,42,-1,-1,-1,-1]),Int32Array.from([6,26,46,-1,-1,-1,-1]),Int32Array.from([6,28,50,-1,-1,-1,-1]),Int32Array.from([6,30,54,-1,-1,-1,-1]),Int32Array.from([6,32,58,-1,-1,-1,-1]),Int32Array.from([6,34,62,-1,-1,-1,-1]),Int32Array.from([6,26,46,66,-1,-1,-1]),Int32Array.from([6,26,48,70,-1,-1,-1]),Int32Array.from([6,26,50,74,-1,-1,-1]),Int32Array.from([6,30,54,78,-1,-1,-1]),Int32Array.from([6,30,56,82,-1,-1,-1]),Int32Array.from([6,30,58,86,-1,-1,-1]),Int32Array.from([6,34,62,90,-1,-1,-1]),Int32Array.from([6,28,50,72,94,-1,-1]),Int32Array.from([6,26,50,74,98,-1,-1]),Int32Array.from([6,30,54,78,102,-1,-1]),Int32Array.from([6,28,54,80,106,-1,-1]),Int32Array.from([6,32,58,84,110,-1,-1]),Int32Array.from([6,30,58,86,114,-1,-1]),Int32Array.from([6,34,62,90,118,-1,-1]),Int32Array.from([6,26,50,74,98,122,-1]),Int32Array.from([6,30,54,78,102,126,-1]),Int32Array.from([6,26,52,78,104,130,-1]),Int32Array.from([6,30,56,82,108,134,-1]),Int32Array.from([6,34,60,86,112,138,-1]),Int32Array.from([6,30,58,86,114,142,-1]),Int32Array.from([6,34,62,90,118,146,-1]),Int32Array.from([6,30,54,78,102,126,150]),Int32Array.from([6,24,50,76,102,128,154]),Int32Array.from([6,28,54,80,106,132,158]),Int32Array.from([6,32,58,84,110,136,162]),Int32Array.from([6,26,54,82,110,138,166]),Int32Array.from([6,30,58,86,114,142,170])]),Dt.TYPE_INFO_COORDINATES=Array.from([Int32Array.from([8,0]),Int32Array.from([8,1]),Int32Array.from([8,2]),Int32Array.from([8,3]),Int32Array.from([8,4]),Int32Array.from([8,5]),Int32Array.from([8,7]),Int32Array.from([8,8]),Int32Array.from([7,8]),Int32Array.from([5,8]),Int32Array.from([4,8]),Int32Array.from([3,8]),Int32Array.from([2,8]),Int32Array.from([1,8]),Int32Array.from([0,8])]),Dt.VERSION_INFO_POLY=7973,Dt.TYPE_INFO_POLY=1335,Dt.TYPE_INFO_MASK_PATTERN=21522;class nc{constructor(a,o){this.dataBytes=a,this.errorCorrectionBytes=o}getDataBytes(){return this.dataBytes}getErrorCorrectionBytes(){return this.errorCorrectionBytes}}class Gn{constructor(){}static calculateMaskPenalty(a){return tr.applyMaskPenaltyRule1(a)+tr.applyMaskPenaltyRule2(a)+tr.applyMaskPenaltyRule3(a)+tr.applyMaskPenaltyRule4(a)}static encode(a,o,u=null){let f=Gn.DEFAULT_BYTE_MODE_ENCODING;const m=u!==null&&u.get(fr.CHARACTER_SET)!==void 0;m&&(f=u.get(fr.CHARACTER_SET).toString());const g=this.chooseMode(a,f),w=new $;if(g===kt.BYTE&&(m||Gn.DEFAULT_BYTE_MODE_ENCODING!==f)){const ze=N.getCharacterSetECIByName(f);ze!==void 0&&this.appendECI(ze,w)}this.appendModeInfo(g,w);const b=new $;this.appendBytes(a,g,b,f);let I;if(u!==null&&u.get(fr.QR_VERSION)!==void 0){const ze=Number.parseInt(u.get(fr.QR_VERSION).toString(),10);I=Pe.getVersionForNumber(ze);const Me=this.calculateBitsNeeded(g,w,b,I);if(!this.willFit(Me,I,o))throw new Fn("Data too big for requested version")}else I=this.recommendVersion(o,g,w,b);const P=new $;P.appendBitArray(w);const V=g===kt.BYTE?b.getSizeInBytes():a.length;this.appendLengthInfo(V,I,g,P),P.appendBitArray(b);const z=I.getECBlocksForLevel(o),Y=I.getTotalCodewords()-z.getTotalECCodewords();this.terminateBits(Y,P);const ne=this.interleaveWithECBytes(P,I.getTotalCodewords(),Y,z.getNumBlocks()),re=new br;re.setECLevel(o),re.setMode(g),re.setVersion(I);const de=I.getDimensionForVersion(),ye=new ya(de,de),Ue=this.chooseMaskPattern(ne,o,I,ye);return re.setMaskPattern(Ue),Dt.buildMatrix(ne,o,I,Ue,ye),re.setMatrix(ye),re}static recommendVersion(a,o,u,f){const m=this.calculateBitsNeeded(o,u,f,Pe.getVersionForNumber(1)),g=this.chooseVersion(m,a),w=this.calculateBitsNeeded(o,u,f,g);return this.chooseVersion(w,a)}static calculateBitsNeeded(a,o,u,f){return o.getSize()+a.getCharacterCountBits(f)+u.getSize()}static getAlphanumericCode(a){return a<Gn.ALPHANUMERIC_TABLE.length?Gn.ALPHANUMERIC_TABLE[a]:-1}static chooseMode(a,o=null){if(N.SJIS.getName()===o&&this.isOnlyDoubleByteKanji(a))return kt.KANJI;let u=!1,f=!1;for(let m=0,g=a.length;m<g;++m){const w=a.charAt(m);if(Gn.isDigit(w))u=!0;else if(this.getAlphanumericCode(w.charCodeAt(0))!==-1)f=!0;else return kt.BYTE}return f?kt.ALPHANUMERIC:u?kt.NUMERIC:kt.BYTE}static isOnlyDoubleByteKanji(a){let o;try{o=O.encode(a,N.SJIS)}catch{return!1}const u=o.length;if(u%2!==0)return!1;for(let f=0;f<u;f+=2){const m=o[f]&255;if((m<129||m>159)&&(m<224||m>235))return!1}return!0}static chooseMaskPattern(a,o,u,f){let m=Number.MAX_SAFE_INTEGER,g=-1;for(let w=0;w<br.NUM_MASK_PATTERNS;w++){Dt.buildMatrix(a,o,u,w,f);let b=this.calculateMaskPenalty(f);b<m&&(m=b,g=w)}return g}static chooseVersion(a,o){for(let u=1;u<=40;u++){const f=Pe.getVersionForNumber(u);if(Gn.willFit(a,f,o))return f}throw new Fn("Data too big")}static willFit(a,o,u){const f=o.getTotalCodewords(),g=o.getECBlocksForLevel(u).getTotalECCodewords(),w=f-g,b=(a+7)/8;return w>=b}static terminateBits(a,o){const u=a*8;if(o.getSize()>u)throw new Fn("data bits cannot fit in the QR Code"+o.getSize()+" > "+u);for(let g=0;g<4&&o.getSize()<u;++g)o.appendBit(!1);const f=o.getSize()&7;if(f>0)for(let g=f;g<8;g++)o.appendBit(!1);const m=a-o.getSizeInBytes();for(let g=0;g<m;++g)o.appendBits(g&1?17:236,8);if(o.getSize()!==u)throw new Fn("Bits size does not equal capacity")}static getNumDataBytesAndNumECBytesForBlockID(a,o,u,f,m,g){if(f>=u)throw new Fn("Block ID too large");const w=a%u,b=u-w,I=Math.floor(a/u),P=I+1,V=Math.floor(o/u),z=V+1,Y=I-V,ne=P-z;if(Y!==ne)throw new Fn("EC bytes mismatch");if(u!==b+w)throw new Fn("RS blocks mismatch");if(a!==(V+Y)*b+(z+ne)*w)throw new Fn("Total bytes mismatch");f<b?(m[0]=V,g[0]=Y):(m[0]=z,g[0]=ne)}static interleaveWithECBytes(a,o,u,f){if(a.getSizeInBytes()!==u)throw new Fn("Number of bits and data bytes does not match");let m=0,g=0,w=0;const b=new Array;for(let P=0;P<f;++P){const V=new Int32Array(1),z=new Int32Array(1);Gn.getNumDataBytesAndNumECBytesForBlockID(o,u,f,P,V,z);const Y=V[0],ne=new Uint8Array(Y);a.toBytes(8*m,ne,0,Y);const re=Gn.generateECBytes(ne,z[0]);b.push(new nc(ne,re)),g=Math.max(g,Y),w=Math.max(w,re.length),m+=V[0]}if(u!==m)throw new Fn("Data bytes does not match offset");const I=new $;for(let P=0;P<g;++P)for(const V of b){const z=V.getDataBytes();P<z.length&&I.appendBits(z[P],8)}for(let P=0;P<w;++P)for(const V of b){const z=V.getErrorCorrectionBytes();P<z.length&&I.appendBits(z[P],8)}if(o!==I.getSizeInBytes())throw new Fn("Interleaving error: "+o+" and "+I.getSizeInBytes()+" differ.");return I}static generateECBytes(a,o){const u=a.length,f=new Int32Array(u+o);for(let g=0;g<u;g++)f[g]=a[g]&255;new xi(se.QR_CODE_FIELD_256).encode(f,o);const m=new Uint8Array(o);for(let g=0;g<o;g++)m[g]=f[u+g];return m}static appendModeInfo(a,o){o.appendBits(a.getBits(),4)}static appendLengthInfo(a,o,u,f){const m=u.getCharacterCountBits(o);if(a>=1<<m)throw new Fn(a+" is bigger than "+((1<<m)-1));f.appendBits(a,m)}static appendBytes(a,o,u,f){switch(o){case kt.NUMERIC:Gn.appendNumericBytes(a,u);break;case kt.ALPHANUMERIC:Gn.appendAlphanumericBytes(a,u);break;case kt.BYTE:Gn.append8BitBytes(a,u,f);break;case kt.KANJI:Gn.appendKanjiBytes(a,u);break;default:throw new Fn("Invalid mode: "+o)}}static getDigit(a){return a.charCodeAt(0)-48}static isDigit(a){const o=Gn.getDigit(a);return o>=0&&o<=9}static appendNumericBytes(a,o){const u=a.length;let f=0;for(;f<u;){const m=Gn.getDigit(a.charAt(f));if(f+2<u){const g=Gn.getDigit(a.charAt(f+1)),w=Gn.getDigit(a.charAt(f+2));o.appendBits(m*100+g*10+w,10),f+=3}else if(f+1<u){const g=Gn.getDigit(a.charAt(f+1));o.appendBits(m*10+g,7),f+=2}else o.appendBits(m,4),f++}}static appendAlphanumericBytes(a,o){const u=a.length;let f=0;for(;f<u;){const m=Gn.getAlphanumericCode(a.charCodeAt(f));if(m===-1)throw new Fn;if(f+1<u){const g=Gn.getAlphanumericCode(a.charCodeAt(f+1));if(g===-1)throw new Fn;o.appendBits(m*45+g,11),f+=2}else o.appendBits(m,6),f++}}static append8BitBytes(a,o,u){let f;try{f=O.encode(a,u)}catch(m){throw new Fn(m)}for(let m=0,g=f.length;m!==g;m++){const w=f[m];o.appendBits(w,8)}}static appendKanjiBytes(a,o){let u;try{u=O.encode(a,N.SJIS)}catch(m){throw new Fn(m)}const f=u.length;for(let m=0;m<f;m+=2){const g=u[m]&255,w=u[m+1]&255,b=g<<8&4294967295|w;let I=-1;if(b>=33088&&b<=40956?I=b-33088:b>=57408&&b<=60351&&(I=b-49472),I===-1)throw new Fn("Invalid byte sequence");const P=(I>>8)*192+(I&255);o.appendBits(P,13)}}static appendECI(a,o){o.appendBits(kt.ECI.getBits(),4),o.appendBits(a.getValue(),8)}}Gn.ALPHANUMERIC_TABLE=Int32Array.from([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,36,-1,-1,-1,37,38,-1,-1,-1,-1,39,40,-1,41,42,43,0,1,2,3,4,5,6,7,8,9,44,-1,-1,-1,-1,-1,-1,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,-1,-1,-1,-1,-1]),Gn.DEFAULT_BYTE_MODE_ENCODING=N.UTF8.getName();class hs{write(a,o,u,f=null){if(a.length===0)throw new E("Found empty contents");if(o<0||u<0)throw new E("Requested dimensions are too small: "+o+"x"+u);let m=tn.L,g=hs.QUIET_ZONE_SIZE;f!==null&&(f.get(fr.ERROR_CORRECTION)!==void 0&&(m=tn.fromString(f.get(fr.ERROR_CORRECTION).toString())),f.get(fr.MARGIN)!==void 0&&(g=Number.parseInt(f.get(fr.MARGIN).toString(),10)));const w=Gn.encode(a,m,f);return this.renderResult(w,o,u,g)}writeToDom(a,o,u,f,m=null){typeof a=="string"&&(a=document.querySelector(a));const g=this.write(o,u,f,m);a&&a.appendChild(g)}renderResult(a,o,u,f){const m=a.getMatrix();if(m===null)throw new Oe;const g=m.getWidth(),w=m.getHeight(),b=g+f*2,I=w+f*2,P=Math.max(o,b),V=Math.max(u,I),z=Math.min(Math.floor(P/b),Math.floor(V/I)),Y=Math.floor((P-g*z)/2),ne=Math.floor((V-w*z)/2),re=this.createSVGElement(P,V);for(let de=0,ye=ne;de<w;de++,ye+=z)for(let Ue=0,ze=Y;Ue<g;Ue++,ze+=z)if(m.get(Ue,de)===1){const Me=this.createSvgRectElement(ze,ye,z,z);re.appendChild(Me)}return re}createSVGElement(a,o){const u=document.createElementNS(hs.SVG_NS,"svg");return u.setAttributeNS(null,"height",a.toString()),u.setAttributeNS(null,"width",o.toString()),u}createSvgRectElement(a,o,u,f){const m=document.createElementNS(hs.SVG_NS,"rect");return m.setAttributeNS(null,"x",a.toString()),m.setAttributeNS(null,"y",o.toString()),m.setAttributeNS(null,"height",u.toString()),m.setAttributeNS(null,"width",f.toString()),m.setAttributeNS(null,"fill","#000000"),m}}hs.QUIET_ZONE_SIZE=4,hs.SVG_NS="http://www.w3.org/2000/svg";class On{encode(a,o,u,f,m){if(a.length===0)throw new E("Found empty contents");if(o!==fe.QR_CODE)throw new E("Can only encode QR_CODE, but got "+o);if(u<0||f<0)throw new E(`Requested dimensions are too small: ${u}x${f}`);let g=tn.L,w=On.QUIET_ZONE_SIZE;m!==null&&(m.get(fr.ERROR_CORRECTION)!==void 0&&(g=tn.fromString(m.get(fr.ERROR_CORRECTION).toString())),m.get(fr.MARGIN)!==void 0&&(w=Number.parseInt(m.get(fr.MARGIN).toString(),10)));const b=Gn.encode(a,g,m);return On.renderResult(b,u,f,w)}static renderResult(a,o,u,f){const m=a.getMatrix();if(m===null)throw new Oe;const g=m.getWidth(),w=m.getHeight(),b=g+f*2,I=w+f*2,P=Math.max(o,b),V=Math.max(u,I),z=Math.min(Math.floor(P/b),Math.floor(V/I)),Y=Math.floor((P-g*z)/2),ne=Math.floor((V-w*z)/2),re=new ie(P,V);for(let de=0,ye=ne;de<w;de++,ye+=z)for(let Ue=0,ze=Y;Ue<g;Ue++,ze+=z)m.get(Ue,de)===1&&re.setRegion(ze,ye,z,z);return re}}On.QUIET_ZONE_SIZE=4;class rc{encode(a,o,u,f,m){let g;switch(o){case fe.QR_CODE:g=new On;break;default:throw new E("No encoder available for format "+o)}return g.encode(a,o,u,f,m)}}class bs extends Ee{constructor(a,o,u,f,m,g,w,b){if(super(g,w),this.yuvData=a,this.dataWidth=o,this.dataHeight=u,this.left=f,this.top=m,f+g>o||m+w>u)throw new E("Crop rectangle does not fit within image data.");b&&this.reverseHorizontal(g,w)}getRow(a,o){if(a<0||a>=this.getHeight())throw new E("Requested row is outside the image: "+a);const u=this.getWidth();(o==null||o.length<u)&&(o=new Uint8ClampedArray(u));const f=(a+this.top)*this.dataWidth+this.left;return B.arraycopy(this.yuvData,f,o,0,u),o}getMatrix(){const a=this.getWidth(),o=this.getHeight();if(a===this.dataWidth&&o===this.dataHeight)return this.yuvData;const u=a*o,f=new Uint8ClampedArray(u);let m=this.top*this.dataWidth+this.left;if(a===this.dataWidth)return B.arraycopy(this.yuvData,m,f,0,u),f;for(let g=0;g<o;g++){const w=g*a;B.arraycopy(this.yuvData,m,f,w,a),m+=this.dataWidth}return f}isCropSupported(){return!0}crop(a,o,u,f){return new bs(this.yuvData,this.dataWidth,this.dataHeight,this.left+a,this.top+o,u,f,!1)}renderThumbnail(){const a=this.getWidth()/bs.THUMBNAIL_SCALE_FACTOR,o=this.getHeight()/bs.THUMBNAIL_SCALE_FACTOR,u=new Int32Array(a*o),f=this.yuvData;let m=this.top*this.dataWidth+this.left;for(let g=0;g<o;g++){const w=g*a;for(let b=0;b<a;b++){const I=f[m+b*bs.THUMBNAIL_SCALE_FACTOR]&255;u[w+b]=4278190080|I*65793}m+=this.dataWidth*bs.THUMBNAIL_SCALE_FACTOR}return u}getThumbnailWidth(){return this.getWidth()/bs.THUMBNAIL_SCALE_FACTOR}getThumbnailHeight(){return this.getHeight()/bs.THUMBNAIL_SCALE_FACTOR}reverseHorizontal(a,o){const u=this.yuvData;for(let f=0,m=this.top*this.dataWidth+this.left;f<o;f++,m+=this.dataWidth){const g=m+a/2;for(let w=m,b=m+a-1;w<g;w++,b--){const I=u[w];u[w]=u[b],u[b]=I}}}invert(){return new qe(this)}}bs.THUMBNAIL_SCALE_FACTOR=2;class fs extends Ee{constructor(a,o,u,f,m,g,w){if(super(o,u),this.dataWidth=f,this.dataHeight=m,this.left=g,this.top=w,a.BYTES_PER_ELEMENT===4){const b=o*u,I=new Uint8ClampedArray(b);for(let P=0;P<b;P++){const V=a[P],z=V>>16&255,Y=V>>7&510,ne=V&255;I[P]=(z+Y+ne)/4&255}this.luminances=I}else this.luminances=a;if(f===void 0&&(this.dataWidth=o),m===void 0&&(this.dataHeight=u),g===void 0&&(this.left=0),w===void 0&&(this.top=0),this.left+o>this.dataWidth||this.top+u>this.dataHeight)throw new E("Crop rectangle does not fit within image data.")}getRow(a,o){if(a<0||a>=this.getHeight())throw new E("Requested row is outside the image: "+a);const u=this.getWidth();(o==null||o.length<u)&&(o=new Uint8ClampedArray(u));const f=(a+this.top)*this.dataWidth+this.left;return B.arraycopy(this.luminances,f,o,0,u),o}getMatrix(){const a=this.getWidth(),o=this.getHeight();if(a===this.dataWidth&&o===this.dataHeight)return this.luminances;const u=a*o,f=new Uint8ClampedArray(u);let m=this.top*this.dataWidth+this.left;if(a===this.dataWidth)return B.arraycopy(this.luminances,m,f,0,u),f;for(let g=0;g<o;g++){const w=g*a;B.arraycopy(this.luminances,m,f,w,a),m+=this.dataWidth}return f}isCropSupported(){return!0}crop(a,o,u,f){return new fs(this.luminances,u,f,this.dataWidth,this.dataHeight,this.left+a,this.top+o)}invert(){return new qe(this)}}class c extends N{static forName(a){return this.getCharacterSetECIByName(a)}}class x{}x.ISO_8859_1=N.ISO8859_1;class v{isCompact(){return this.compact}setCompact(a){this.compact=a}getSize(){return this.size}setSize(a){this.size=a}getLayers(){return this.layers}setLayers(a){this.layers=a}getCodeWords(){return this.codeWords}setCodeWords(a){this.codeWords=a}getMatrix(){return this.matrix}setMatrix(a){this.matrix=a}}class S{static singletonList(a){return[a]}static min(a,o){return a.sort(o)[0]}}class G{constructor(a){this.previous=a}getPrevious(){return this.previous}}class Q extends G{constructor(a,o,u){super(a),this.value=o,this.bitCount=u}appendTo(a,o){a.appendBits(this.value,this.bitCount)}add(a,o){return new Q(this,a,o)}addBinaryShift(a,o){return console.warn("addBinaryShift on SimpleToken, this simply returns a copy of this token"),new Q(this,a,o)}toString(){let a=this.value&(1<<this.bitCount)-1;return a|=1<<this.bitCount,"<"+U.toBinaryString(a|1<<this.bitCount).substring(1)+">"}}class ue extends Q{constructor(a,o,u){super(a,0,0),this.binaryShiftStart=o,this.binaryShiftByteCount=u}appendTo(a,o){for(let u=0;u<this.binaryShiftByteCount;u++)(u===0||u===31&&this.binaryShiftByteCount<=62)&&(a.appendBits(31,5),this.binaryShiftByteCount>62?a.appendBits(this.binaryShiftByteCount-31,16):u===0?a.appendBits(Math.min(this.binaryShiftByteCount,31),5):a.appendBits(this.binaryShiftByteCount-31,5)),a.appendBits(o[this.binaryShiftStart+u],8)}addBinaryShift(a,o){return new ue(this,a,o)}toString(){return"<"+this.binaryShiftStart+"::"+(this.binaryShiftStart+this.binaryShiftByteCount-1)+">"}}function Ot(j,a,o){return new ue(j,a,o)}function gn(j,a,o){return new Q(j,a,o)}const mt=["UPPER","LOWER","DIGIT","MIXED","PUNCT"],fn=0,En=1,lr=2,cr=3,zr=4,Ja=new Q(null,0,0),T1=[Int32Array.from([0,(5<<16)+28,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(9<<16)+480+14,0,(5<<16)+30,(5<<16)+29,656318]),Int32Array.from([(4<<16)+14,(9<<16)+448+28,0,(9<<16)+448+29,932798]),Int32Array.from([(5<<16)+29,(5<<16)+28,656318,0,(5<<16)+30]),Int32Array.from([(5<<16)+31,656380,656382,656381,0])];function yD(j){for(let a of j)M.fill(a,-1);return j[fn][zr]=0,j[En][zr]=0,j[En][fn]=28,j[cr][zr]=0,j[lr][zr]=0,j[lr][fn]=15,j}const W2=yD(M.createInt32Array(6,6));class xa{constructor(a,o,u,f){this.token=a,this.mode=o,this.binaryShiftByteCount=u,this.bitCount=f}getMode(){return this.mode}getToken(){return this.token}getBinaryShiftByteCount(){return this.binaryShiftByteCount}getBitCount(){return this.bitCount}latchAndAppend(a,o){let u=this.bitCount,f=this.token;if(a!==this.mode){let g=T1[this.mode][a];f=gn(f,g&65535,g>>16),u+=g>>16}let m=a===lr?4:5;return f=gn(f,o,m),new xa(f,a,0,u+m)}shiftAndAppend(a,o){let u=this.token,f=this.mode===lr?4:5;return u=gn(u,W2[this.mode][a],f),u=gn(u,o,5),new xa(u,this.mode,0,this.bitCount+f+5)}addBinaryShiftChar(a){let o=this.token,u=this.mode,f=this.bitCount;if(this.mode===zr||this.mode===lr){let w=T1[u][fn];o=gn(o,w&65535,w>>16),f+=w>>16,u=fn}let m=this.binaryShiftByteCount===0||this.binaryShiftByteCount===31?18:this.binaryShiftByteCount===62?9:8,g=new xa(o,u,this.binaryShiftByteCount+1,f+m);return g.binaryShiftByteCount===2078&&(g=g.endBinaryShift(a+1)),g}endBinaryShift(a){if(this.binaryShiftByteCount===0)return this;let o=this.token;return o=Ot(o,a-this.binaryShiftByteCount,this.binaryShiftByteCount),new xa(o,this.mode,0,this.bitCount)}isBetterThanOrEqualTo(a){let o=this.bitCount+(T1[this.mode][a.mode]>>16);return this.binaryShiftByteCount<a.binaryShiftByteCount?o+=xa.calculateBinaryShiftCost(a)-xa.calculateBinaryShiftCost(this):this.binaryShiftByteCount>a.binaryShiftByteCount&&a.binaryShiftByteCount>0&&(o+=10),o<=a.bitCount}toBitArray(a){let o=[];for(let f=this.endBinaryShift(a.length).token;f!==null;f=f.getPrevious())o.unshift(f);let u=new $;for(const f of o)f.appendTo(u,a);return u}toString(){return F.format("%s bits=%d bytes=%d",mt[this.mode],this.bitCount,this.binaryShiftByteCount)}static calculateBinaryShiftCost(a){return a.binaryShiftByteCount>62?21:a.binaryShiftByteCount>31?20:a.binaryShiftByteCount>0?10:0}}xa.INITIAL_STATE=new xa(Ja,fn,0,0);function xD(j){const a=F.getCharCode(" "),o=F.getCharCode("."),u=F.getCharCode(",");j[fn][a]=1;const f=F.getCharCode("Z"),m=F.getCharCode("A");for(let z=m;z<=f;z++)j[fn][z]=z-m+2;j[En][a]=1;const g=F.getCharCode("z"),w=F.getCharCode("a");for(let z=w;z<=g;z++)j[En][z]=z-w+2;j[lr][a]=1;const b=F.getCharCode("9"),I=F.getCharCode("0");for(let z=I;z<=b;z++)j[lr][z]=z-I+2;j[lr][u]=12,j[lr][o]=13;const P=["\0"," ","","","","","","","\x07","\b","	",`
`,"\v","\f","\r","\x1B","","","","","@","\\","^","_","`","|","~",""];for(let z=0;z<P.length;z++)j[cr][F.getCharCode(P[z])]=z;const V=["\0","\r","\0","\0","\0","\0","!","'","#","$","%","&","'","(",")","*","+",",","-",".","/",":",";","<","=",">","?","[","]","{","}"];for(let z=0;z<V.length;z++)F.getCharCode(V[z])>0&&(j[zr][F.getCharCode(V[z])]=z);return j}const C1=xD(M.createInt32Array(5,256));class Xd{constructor(a){this.text=a}encode(){const a=F.getCharCode(" "),o=F.getCharCode(`
`);let u=S.singletonList(xa.INITIAL_STATE);for(let m=0;m<this.text.length;m++){let g,w=m+1<this.text.length?this.text[m+1]:0;switch(this.text[m]){case F.getCharCode("\r"):g=w===o?2:0;break;case F.getCharCode("."):g=w===a?3:0;break;case F.getCharCode(","):g=w===a?4:0;break;case F.getCharCode(":"):g=w===a?5:0;break;default:g=0}g>0?(u=Xd.updateStateListForPair(u,m,g),m++):u=this.updateStateListForChar(u,m)}return S.min(u,(m,g)=>m.getBitCount()-g.getBitCount()).toBitArray(this.text)}updateStateListForChar(a,o){const u=[];for(let f of a)this.updateStateForChar(f,o,u);return Xd.simplifyStates(u)}updateStateForChar(a,o,u){let f=this.text[o]&255,m=C1[a.getMode()][f]>0,g=null;for(let w=0;w<=zr;w++){let b=C1[w][f];if(b>0){if(g==null&&(g=a.endBinaryShift(o)),!m||w===a.getMode()||w===lr){const I=g.latchAndAppend(w,b);u.push(I)}if(!m&&W2[a.getMode()][w]>=0){const I=g.shiftAndAppend(w,b);u.push(I)}}}if(a.getBinaryShiftByteCount()>0||C1[a.getMode()][f]===0){let w=a.addBinaryShiftChar(o);u.push(w)}}static updateStateListForPair(a,o,u){const f=[];for(let m of a)this.updateStateForPair(m,o,u,f);return this.simplifyStates(f)}static updateStateForPair(a,o,u,f){let m=a.endBinaryShift(o);if(f.push(m.latchAndAppend(zr,u)),a.getMode()!==zr&&f.push(m.shiftAndAppend(zr,u)),u===3||u===4){let g=m.latchAndAppend(lr,16-u).latchAndAppend(lr,1);f.push(g)}if(a.getBinaryShiftByteCount()>0){let g=a.addBinaryShiftChar(o).addBinaryShiftChar(o+1);f.push(g)}}static simplifyStates(a){let o=[];for(const u of a){let f=!0;for(const m of o){if(m.isBetterThanOrEqualTo(u)){f=!1;break}u.isBetterThanOrEqualTo(m)&&(o=o.filter(g=>g!==m))}f&&o.push(u)}return o}}class Vn{constructor(){}static encodeBytes(a){return Vn.encode(a,Vn.DEFAULT_EC_PERCENT,Vn.DEFAULT_AZTEC_LAYERS)}static encode(a,o,u){let f=new Xd(a).encode(),m=U.truncDivision(f.getSize()*o,100)+11,g=f.getSize()+m,w,b,I,P,V;if(u!==Vn.DEFAULT_AZTEC_LAYERS){if(w=u<0,b=Math.abs(u),b>(w?Vn.MAX_NB_BITS_COMPACT:Vn.MAX_NB_BITS))throw new E(F.format("Illegal value %s for layers",u));I=Vn.totalBitsInLayer(b,w),P=Vn.WORD_SIZE[b];let Me=I-I%P;if(V=Vn.stuffBits(f,P),V.getSize()+m>Me)throw new E("Data to large for user specified layer");if(w&&V.getSize()>P*64)throw new E("Data to large for user specified layer")}else{P=0,V=null;for(let Me=0;;Me++){if(Me>Vn.MAX_NB_BITS)throw new E("Data too large for an Aztec code");if(w=Me<=3,b=w?Me+1:Me,I=Vn.totalBitsInLayer(b,w),g>I)continue;(V==null||P!==Vn.WORD_SIZE[b])&&(P=Vn.WORD_SIZE[b],V=Vn.stuffBits(f,P));let Tn=I-I%P;if(!(w&&V.getSize()>P*64)&&V.getSize()+m<=Tn)break}}let z=Vn.generateCheckWords(V,I,P),Y=V.getSize()/P,ne=Vn.generateModeMessage(w,b,Y),re=(w?11:14)+b*4,de=new Int32Array(re),ye;if(w){ye=re;for(let Me=0;Me<de.length;Me++)de[Me]=Me}else{ye=re+1+2*U.truncDivision(U.truncDivision(re,2)-1,15);let Me=U.truncDivision(re,2),Tn=U.truncDivision(ye,2);for(let mn=0;mn<Me;mn++){let Zs=mn+U.truncDivision(mn,15);de[Me-mn-1]=Tn-Zs-1,de[Me+mn]=Tn+Zs+1}}let Ue=new ie(ye);for(let Me=0,Tn=0;Me<b;Me++){let mn=(b-Me)*4+(w?9:12);for(let Zs=0;Zs<mn;Zs++){let Xi=Zs*2;for(let Js=0;Js<2;Js++)z.get(Tn+Xi+Js)&&Ue.set(de[Me*2+Js],de[Me*2+Zs]),z.get(Tn+mn*2+Xi+Js)&&Ue.set(de[Me*2+Zs],de[re-1-Me*2-Js]),z.get(Tn+mn*4+Xi+Js)&&Ue.set(de[re-1-Me*2-Js],de[re-1-Me*2-Zs]),z.get(Tn+mn*6+Xi+Js)&&Ue.set(de[re-1-Me*2-Zs],de[Me*2+Js])}Tn+=mn*8}if(Vn.drawModeMessage(Ue,w,ye,ne),w)Vn.drawBullsEye(Ue,U.truncDivision(ye,2),5);else{Vn.drawBullsEye(Ue,U.truncDivision(ye,2),7);for(let Me=0,Tn=0;Me<U.truncDivision(re,2)-1;Me+=15,Tn+=16)for(let mn=U.truncDivision(ye,2)&1;mn<ye;mn+=2)Ue.set(U.truncDivision(ye,2)-Tn,mn),Ue.set(U.truncDivision(ye,2)+Tn,mn),Ue.set(mn,U.truncDivision(ye,2)-Tn),Ue.set(mn,U.truncDivision(ye,2)+Tn)}let ze=new v;return ze.setCompact(w),ze.setSize(ye),ze.setLayers(b),ze.setCodeWords(Y),ze.setMatrix(Ue),ze}static drawBullsEye(a,o,u){for(let f=0;f<u;f+=2)for(let m=o-f;m<=o+f;m++)a.set(m,o-f),a.set(m,o+f),a.set(o-f,m),a.set(o+f,m);a.set(o-u,o-u),a.set(o-u+1,o-u),a.set(o-u,o-u+1),a.set(o+u,o-u),a.set(o+u,o-u+1),a.set(o+u,o+u-1)}static generateModeMessage(a,o,u){let f=new $;return a?(f.appendBits(o-1,2),f.appendBits(u-1,6),f=Vn.generateCheckWords(f,28,4)):(f.appendBits(o-1,5),f.appendBits(u-1,11),f=Vn.generateCheckWords(f,40,4)),f}static drawModeMessage(a,o,u,f){let m=U.truncDivision(u,2);if(o)for(let g=0;g<7;g++){let w=m-3+g;f.get(g)&&a.set(w,m-5),f.get(g+7)&&a.set(m+5,w),f.get(20-g)&&a.set(w,m+5),f.get(27-g)&&a.set(m-5,w)}else for(let g=0;g<10;g++){let w=m-5+g+U.truncDivision(g,5);f.get(g)&&a.set(w,m-7),f.get(g+10)&&a.set(m+7,w),f.get(29-g)&&a.set(w,m+7),f.get(39-g)&&a.set(m-7,w)}}static generateCheckWords(a,o,u){let f=a.getSize()/u,m=new xi(Vn.getGF(u)),g=U.truncDivision(o,u),w=Vn.bitsToWords(a,u,g);m.encode(w,g-f);let b=o%u,I=new $;I.appendBits(0,b);for(const P of Array.from(w))I.appendBits(P,u);return I}static bitsToWords(a,o,u){let f=new Int32Array(u),m,g;for(m=0,g=a.getSize()/o;m<g;m++){let w=0;for(let b=0;b<o;b++)w|=a.get(m*o+b)?1<<o-b-1:0;f[m]=w}return f}static getGF(a){switch(a){case 4:return se.AZTEC_PARAM;case 6:return se.AZTEC_DATA_6;case 8:return se.AZTEC_DATA_8;case 10:return se.AZTEC_DATA_10;case 12:return se.AZTEC_DATA_12;default:throw new E("Unsupported word size "+a)}}static stuffBits(a,o){let u=new $,f=a.getSize(),m=(1<<o)-2;for(let g=0;g<f;g+=o){let w=0;for(let b=0;b<o;b++)(g+b>=f||a.get(g+b))&&(w|=1<<o-1-b);(w&m)===m?(u.appendBits(w&m,o),g--):w&m?u.appendBits(w,o):(u.appendBits(w|1,o),g--)}return u}static totalBitsInLayer(a,o){return((o?88:112)+16*a)*a}}Vn.DEFAULT_EC_PERCENT=33,Vn.DEFAULT_AZTEC_LAYERS=0,Vn.MAX_NB_BITS=32,Vn.MAX_NB_BITS_COMPACT=4,Vn.WORD_SIZE=Int32Array.from([4,6,6,8,8,8,8,8,8,10,10,10,10,10,10,10,10,10,10,10,10,10,10,12,12,12,12,12,12,12,12,12,12]);class Sm{encode(a,o,u,f){return this.encodeWithHints(a,o,u,f,null)}encodeWithHints(a,o,u,f,m){let g=x.ISO_8859_1,w=Vn.DEFAULT_EC_PERCENT,b=Vn.DEFAULT_AZTEC_LAYERS;return m!=null&&(m.has(fr.CHARACTER_SET)&&(g=c.forName(m.get(fr.CHARACTER_SET).toString())),m.has(fr.ERROR_CORRECTION)&&(w=U.parseInt(m.get(fr.ERROR_CORRECTION).toString())),m.has(fr.AZTEC_LAYERS)&&(b=U.parseInt(m.get(fr.AZTEC_LAYERS).toString()))),Sm.encodeLayers(a,o,u,f,g,w,b)}static encodeLayers(a,o,u,f,m,g,w){if(o!==fe.AZTEC)throw new E("Can only encode AZTEC, but got "+o);let b=Vn.encode(F.getBytes(a,m),g,w);return Sm.renderResult(b,u,f)}static renderResult(a,o,u){let f=a.getMatrix();if(f==null)throw new Oe;let m=f.getWidth(),g=f.getHeight(),w=Math.max(o,m),b=Math.max(u,g),I=Math.min(w/m,b/g),P=(w-m*I)/2,V=(b-g*I)/2,z=new ie(w,b);for(let Y=0,ne=V;Y<g;Y++,ne+=I)for(let re=0,de=P;re<m;re++,de+=I)f.get(re,Y)&&z.setRegion(de,ne,I,I);return z}}n.AbstractExpandedDecoder=Ze,n.ArgumentException=_,n.ArithmeticException=xe,n.AztecCode=v,n.AztecCodeReader=Xt,n.AztecCodeWriter=Sm,n.AztecDecoder=Et,n.AztecDetector=ar,n.AztecDetectorResult=At,n.AztecEncoder=Vn,n.AztecHighLevelEncoder=Xd,n.AztecPoint=Kt,n.BarcodeFormat=fe,n.Binarizer=L,n.BinaryBitmap=T,n.BitArray=$,n.BitMatrix=ie,n.BitSource=qs,n.BrowserAztecCodeReader=xn,n.BrowserBarcodeReader=en,n.BrowserCodeReader=rt,n.BrowserDatamatrixCodeReader=Hd,n.BrowserMultiFormatReader=ec,n.BrowserPDF417Reader=tc,n.BrowserQRCodeReader=Za,n.BrowserQRCodeSvgWriter=hs,n.CharacterSetECI=N,n.ChecksumException=k,n.Code128Reader=we,n.Code39Reader=Tt,n.DataMatrixDecodedBitStreamParser=Ks,n.DataMatrixReader=Xs,n.DecodeHintType=Z,n.DecoderResult=Vt,n.DefaultGridSampler=ot,n.DetectorResult=ft,n.EAN13Reader=Ce,n.EncodeHintType=fr,n.Exception=y,n.FormatException=A,n.GenericGF=se,n.GenericGFPoly=yt,n.GlobalHistogramBinarizer=je,n.GridSampler=dn,n.GridSamplerInstance=jt,n.HTMLCanvasElementLuminanceSource=et,n.HybridBinarizer=We,n.ITFReader=Rt,n.IllegalArgumentException=E,n.IllegalStateException=Oe,n.InvertedLuminanceSource=qe,n.LuminanceSource=Ee,n.MathUtils=st,n.MultiFormatOneDReader=Jn,n.MultiFormatReader=Ys,n.MultiFormatWriter=rc,n.NotFoundException=te,n.OneDReader=Mt,n.PDF417DecodedBitStreamParser=he,n.PDF417DecoderErrorCorrection=Di,n.PDF417Reader=Lr,n.PDF417ResultMetadata=$o,n.PerspectiveTransform=tt,n.PlanarYUVLuminanceSource=bs,n.QRCodeByteMatrix=ya,n.QRCodeDataMask=xr,n.QRCodeDecodedBitStreamParser=rr,n.QRCodeDecoderErrorCorrectionLevel=tn,n.QRCodeDecoderFormatInformation=or,n.QRCodeEncoder=Gn,n.QRCodeEncoderQRCode=br,n.QRCodeMaskUtil=tr,n.QRCodeMatrixUtil=Dt,n.QRCodeMode=kt,n.QRCodeReader=ki,n.QRCodeVersion=Pe,n.QRCodeWriter=On,n.RGBLuminanceSource=fs,n.RSS14Reader=Gt,n.RSSExpandedReader=Ae,n.ReaderException=ga,n.ReedSolomonDecoder=Ge,n.ReedSolomonEncoder=xi,n.ReedSolomonException=De,n.Result=pe,n.ResultMetadataType=Ve,n.ResultPoint=ae,n.StringUtils=F,n.UnsupportedOperationException=D,n.VideoInputDevice=Lt,n.WhiteRectangleDetector=Ke,n.WriterException=Fn,n.ZXingArrays=M,n.ZXingCharset=c,n.ZXingInteger=U,n.ZXingStandardCharsets=x,n.ZXingStringBuilder=R,n.ZXingStringEncoding=O,n.ZXingSystem=B,n.createAbstractExpandedDecoder=Er,Object.defineProperty(n,"__esModule",{value:!0})})})(Qw,Qw.exports);var pr=Qw.exports;const UK=Jw(pr),$K=Zw({__proto__:null,default:UK},[pr]);var MT=function(){function t(e,n,r){if(this.formatMap=new Map([[pt.QR_CODE,pr.BarcodeFormat.QR_CODE],[pt.AZTEC,pr.BarcodeFormat.AZTEC],[pt.CODABAR,pr.BarcodeFormat.CODABAR],[pt.CODE_39,pr.BarcodeFormat.CODE_39],[pt.CODE_93,pr.BarcodeFormat.CODE_93],[pt.CODE_128,pr.BarcodeFormat.CODE_128],[pt.DATA_MATRIX,pr.BarcodeFormat.DATA_MATRIX],[pt.MAXICODE,pr.BarcodeFormat.MAXICODE],[pt.ITF,pr.BarcodeFormat.ITF],[pt.EAN_13,pr.BarcodeFormat.EAN_13],[pt.EAN_8,pr.BarcodeFormat.EAN_8],[pt.PDF_417,pr.BarcodeFormat.PDF_417],[pt.RSS_14,pr.BarcodeFormat.RSS_14],[pt.RSS_EXPANDED,pr.BarcodeFormat.RSS_EXPANDED],[pt.UPC_A,pr.BarcodeFormat.UPC_A],[pt.UPC_E,pr.BarcodeFormat.UPC_E],[pt.UPC_EAN_EXTENSION,pr.BarcodeFormat.UPC_EAN_EXTENSION]]),this.reverseFormatMap=this.createReverseFormatMap(),!$K)throw"Use html5qrcode.min.js without edit, ZXing not found.";this.verbose=n,this.logger=r;var s=this.createZXingFormats(e),i=new Map;i.set(pr.DecodeHintType.POSSIBLE_FORMATS,s),i.set(pr.DecodeHintType.TRY_HARDER,!1),this.hints=i}return t.prototype.decodeAsync=function(e){var n=this;return new Promise(function(r,s){try{r(n.decode(e))}catch(i){s(i)}})},t.prototype.decode=function(e){var n=new pr.MultiFormatReader(this.verbose,this.hints),r=new pr.HTMLCanvasElementLuminanceSource(e),s=new pr.BinaryBitmap(new pr.HybridBinarizer(r)),i=n.decode(s);return{text:i.text,format:uD.create(this.toHtml5QrcodeSupportedFormats(i.format)),debugData:this.createDebugData()}},t.prototype.createReverseFormatMap=function(){var e=new Map;return this.formatMap.forEach(function(n,r,s){e.set(n,r)}),e},t.prototype.toHtml5QrcodeSupportedFormats=function(e){if(!this.reverseFormatMap.has(e))throw"reverseFormatMap doesn't have ".concat(e);return this.reverseFormatMap.get(e)},t.prototype.createZXingFormats=function(e){for(var n=[],r=0,s=e;r<s.length;r++){var i=s[r];this.formatMap.has(i)?n.push(this.formatMap.get(i)):this.logger.logError("".concat(i," is not supported by")+"ZXingHtml5QrcodeShim")}return n},t.prototype.createDebugData=function(){return{decoderName:"zxing-js"}},t}(),zK=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(l){l(i)})}return new(n||(n=Promise))(function(i,l){function h(_){try{y(r.next(_))}catch(E){l(E)}}function p(_){try{y(r.throw(_))}catch(E){l(E)}}function y(_){_.done?i(_.value):s(_.value).then(h,p)}y((r=r.apply(t,e||[])).next())})},WK=function(t,e){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,s,i,l;return l={next:h(0),throw:h(1),return:h(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function h(y){return function(_){return p([y,_])}}function p(y){if(r)throw new TypeError("Generator is already executing.");for(;l&&(l=0,y[0]&&(n=0)),n;)try{if(r=1,s&&(i=y[0]&2?s.return:y[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,y[1])).done)return i;switch(s=0,i&&(y=[y[0]&2,i.value]),y[0]){case 0:case 1:i=y;break;case 4:return n.label++,{value:y[1],done:!1};case 5:n.label++,s=y[1],y=[0];continue;case 7:y=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(y[0]===6||y[0]===2)){n=0;continue}if(y[0]===3&&(!i||y[1]>i[0]&&y[1]<i[3])){n.label=y[1];break}if(y[0]===6&&n.label<i[1]){n.label=i[1],i=y;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(y);break}i[2]&&n.ops.pop(),n.trys.pop();continue}y=e.call(t,n)}catch(_){y=[6,_],s=0}finally{r=i=0}if(y[0]&5)throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}},LT=function(){function t(e,n,r){if(this.formatMap=new Map([[pt.QR_CODE,"qr_code"],[pt.AZTEC,"aztec"],[pt.CODABAR,"codabar"],[pt.CODE_39,"code_39"],[pt.CODE_93,"code_93"],[pt.CODE_128,"code_128"],[pt.DATA_MATRIX,"data_matrix"],[pt.ITF,"itf"],[pt.EAN_13,"ean_13"],[pt.EAN_8,"ean_8"],[pt.PDF_417,"pdf417"],[pt.UPC_A,"upc_a"],[pt.UPC_E,"upc_e"]]),this.reverseFormatMap=this.createReverseFormatMap(),!t.isSupported())throw"Use html5qrcode.min.js without edit, Use BarcodeDetectorDelegate only if it isSupported();";this.verbose=n,this.logger=r;var s=this.createBarcodeDetectorFormats(e);if(this.detector=new BarcodeDetector(s),!this.detector)throw"BarcodeDetector detector not supported"}return t.isSupported=function(){if(!("BarcodeDetector"in window))return!1;var e=new BarcodeDetector({formats:["qr_code"]});return typeof e<"u"},t.prototype.decodeAsync=function(e){return zK(this,void 0,void 0,function(){var n,r;return WK(this,function(s){switch(s.label){case 0:return[4,this.detector.detect(e)];case 1:if(n=s.sent(),!n||n.length===0)throw"No barcode or QR code detected.";return r=this.selectLargestBarcode(n),[2,{text:r.rawValue,format:uD.create(this.toHtml5QrcodeSupportedFormats(r.format)),debugData:this.createDebugData()}]}})})},t.prototype.selectLargestBarcode=function(e){for(var n=null,r=0,s=0,i=e;s<i.length;s++){var l=i[s],h=l.boundingBox.width*l.boundingBox.height;h>r&&(r=h,n=l)}if(!n)throw"No largest barcode found";return n},t.prototype.createBarcodeDetectorFormats=function(e){for(var n=[],r=0,s=e;r<s.length;r++){var i=s[r];this.formatMap.has(i)?n.push(this.formatMap.get(i)):this.logger.warn("".concat(i," is not supported by")+"BarcodeDetectorDelegate")}return{formats:n}},t.prototype.toHtml5QrcodeSupportedFormats=function(e){if(!this.reverseFormatMap.has(e))throw"reverseFormatMap doesn't have ".concat(e);return this.reverseFormatMap.get(e)},t.prototype.createReverseFormatMap=function(){var e=new Map;return this.formatMap.forEach(function(n,r,s){e.set(n,r)}),e},t.prototype.createDebugData=function(){return{decoderName:"BarcodeDetector"}},t}(),jT=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(l){l(i)})}return new(n||(n=Promise))(function(i,l){function h(_){try{y(r.next(_))}catch(E){l(E)}}function p(_){try{y(r.throw(_))}catch(E){l(E)}}function y(_){_.done?i(_.value):s(_.value).then(h,p)}y((r=r.apply(t,e||[])).next())})},FT=function(t,e){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,s,i,l;return l={next:h(0),throw:h(1),return:h(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function h(y){return function(_){return p([y,_])}}function p(y){if(r)throw new TypeError("Generator is already executing.");for(;l&&(l=0,y[0]&&(n=0)),n;)try{if(r=1,s&&(i=y[0]&2?s.return:y[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,y[1])).done)return i;switch(s=0,i&&(y=[y[0]&2,i.value]),y[0]){case 0:case 1:i=y;break;case 4:return n.label++,{value:y[1],done:!1};case 5:n.label++,s=y[1],y=[0];continue;case 7:y=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(y[0]===6||y[0]===2)){n=0;continue}if(y[0]===3&&(!i||y[1]>i[0]&&y[1]<i[3])){n.label=y[1];break}if(y[0]===6&&n.label<i[1]){n.label=i[1],i=y;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(y);break}i[2]&&n.ops.pop(),n.trys.pop();continue}y=e.call(t,n)}catch(_){y=[6,_],s=0}finally{r=i=0}if(y[0]&5)throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}},HK=function(){function t(e,n,r,s){this.EXECUTIONS_TO_REPORT_PERFORMANCE=100,this.executions=0,this.executionResults=[],this.wasPrimaryDecoderUsedInLastDecode=!1,this.verbose=r,n&&LT.isSupported()?(this.primaryDecoder=new LT(e,r,s),this.secondaryDecoder=new MT(e,r,s)):this.primaryDecoder=new MT(e,r,s)}return t.prototype.decodeAsync=function(e){return jT(this,void 0,void 0,function(){var n;return FT(this,function(r){switch(r.label){case 0:n=performance.now(),r.label=1;case 1:return r.trys.push([1,,3,4]),[4,this.getDecoder().decodeAsync(e)];case 2:return[2,r.sent()];case 3:return this.possiblyLogPerformance(n),[7];case 4:return[2]}})})},t.prototype.decodeRobustlyAsync=function(e){return jT(this,void 0,void 0,function(){var n,r;return FT(this,function(s){switch(s.label){case 0:n=performance.now(),s.label=1;case 1:return s.trys.push([1,3,4,5]),[4,this.primaryDecoder.decodeAsync(e)];case 2:return[2,s.sent()];case 3:if(r=s.sent(),this.secondaryDecoder)return[2,this.secondaryDecoder.decodeAsync(e)];throw r;case 4:return this.possiblyLogPerformance(n),[7];case 5:return[2]}})})},t.prototype.getDecoder=function(){return this.secondaryDecoder?this.wasPrimaryDecoderUsedInLastDecode===!1?(this.wasPrimaryDecoderUsedInLastDecode=!0,this.primaryDecoder):(this.wasPrimaryDecoderUsedInLastDecode=!1,this.secondaryDecoder):this.primaryDecoder},t.prototype.possiblyLogPerformance=function(e){if(this.verbose){var n=performance.now()-e;this.executionResults.push(n),this.executions++,this.possiblyFlushPerformanceReport()}},t.prototype.possiblyFlushPerformanceReport=function(){if(!(this.executions<this.EXECUTIONS_TO_REPORT_PERFORMANCE)){for(var e=0,n=0,r=this.executionResults;n<r.length;n++){var s=r[n];e+=s}var i=e/this.executionResults.length;console.log("".concat(i," ms for ").concat(this.executionResults.length," last runs.")),this.executions=0,this.executionResults=[]}},t}(),U2=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,s){r.__proto__=s}||function(r,s){for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(r[i]=s[i])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),ug=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(l){l(i)})}return new(n||(n=Promise))(function(i,l){function h(_){try{y(r.next(_))}catch(E){l(E)}}function p(_){try{y(r.throw(_))}catch(E){l(E)}}function y(_){_.done?i(_.value):s(_.value).then(h,p)}y((r=r.apply(t,e||[])).next())})},dg=function(t,e){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,s,i,l;return l={next:h(0),throw:h(1),return:h(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function h(y){return function(_){return p([y,_])}}function p(y){if(r)throw new TypeError("Generator is already executing.");for(;l&&(l=0,y[0]&&(n=0)),n;)try{if(r=1,s&&(i=y[0]&2?s.return:y[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,y[1])).done)return i;switch(s=0,i&&(y=[y[0]&2,i.value]),y[0]){case 0:case 1:i=y;break;case 4:return n.label++,{value:y[1],done:!1};case 5:n.label++,s=y[1],y=[0];continue;case 7:y=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(y[0]===6||y[0]===2)){n=0;continue}if(y[0]===3&&(!i||y[1]>i[0]&&y[1]<i[3])){n.label=y[1];break}if(y[0]===6&&n.label<i[1]){n.label=i[1],i=y;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(y);break}i[2]&&n.ops.pop(),n.trys.pop();continue}y=e.call(t,n)}catch(_){y=[6,_],s=0}finally{r=i=0}if(y[0]&5)throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}},hD=function(){function t(e,n){this.name=e,this.track=n}return t.prototype.isSupported=function(){return this.track.getCapabilities?this.name in this.track.getCapabilities():!1},t.prototype.apply=function(e){var n={};n[this.name]=e;var r={advanced:[n]};return this.track.applyConstraints(r)},t.prototype.value=function(){var e=this.track.getSettings();if(this.name in e){var n=e[this.name];return n}return null},t}(),GK=function(t){U2(e,t);function e(n,r){return t.call(this,n,r)||this}return e.prototype.min=function(){return this.getCapabilities().min},e.prototype.max=function(){return this.getCapabilities().max},e.prototype.step=function(){return this.getCapabilities().step},e.prototype.apply=function(n){var r={};r[this.name]=n;var s={advanced:[r]};return this.track.applyConstraints(s)},e.prototype.getCapabilities=function(){this.failIfNotSupported();var n=this.track.getCapabilities(),r=n[this.name];return{min:r.min,max:r.max,step:r.step}},e.prototype.failIfNotSupported=function(){if(!this.isSupported())throw new Error("".concat(this.name," capability not supported"))},e}(hD),qK=function(t){U2(e,t);function e(n){return t.call(this,"zoom",n)||this}return e}(GK),KK=function(t){U2(e,t);function e(n){return t.call(this,"torch",n)||this}return e}(hD),XK=function(){function t(e){this.track=e}return t.prototype.zoomFeature=function(){return new qK(this.track)},t.prototype.torchFeature=function(){return new KK(this.track)},t}(),QK=function(){function t(e,n,r){this.isClosed=!1,this.parentElement=e,this.mediaStream=n,this.callbacks=r,this.surface=this.createVideoElement(this.parentElement.clientWidth),e.append(this.surface)}return t.prototype.createVideoElement=function(e){var n=document.createElement("video");return n.style.width="".concat(e,"px"),n.style.display="block",n.muted=!0,n.setAttribute("muted","true"),n.playsInline=!0,n},t.prototype.setupSurface=function(){var e=this;this.surface.onabort=function(){throw"RenderedCameraImpl video surface onabort() called"},this.surface.onerror=function(){throw"RenderedCameraImpl video surface onerror() called"};var n=function(){var r=e.surface.clientWidth,s=e.surface.clientHeight;e.callbacks.onRenderSurfaceReady(r,s),e.surface.removeEventListener("playing",n)};this.surface.addEventListener("playing",n),this.surface.srcObject=this.mediaStream,this.surface.play()},t.create=function(e,n,r,s){return ug(this,void 0,void 0,function(){var i,l;return dg(this,function(h){switch(h.label){case 0:return i=new t(e,n,s),r.aspectRatio?(l={aspectRatio:r.aspectRatio},[4,i.getFirstTrackOrFail().applyConstraints(l)]):[3,2];case 1:h.sent(),h.label=2;case 2:return i.setupSurface(),[2,i]}})})},t.prototype.failIfClosed=function(){if(this.isClosed)throw"The RenderedCamera has already been closed."},t.prototype.getFirstTrackOrFail=function(){if(this.failIfClosed(),this.mediaStream.getVideoTracks().length===0)throw"No video tracks found";return this.mediaStream.getVideoTracks()[0]},t.prototype.pause=function(){this.failIfClosed(),this.surface.pause()},t.prototype.resume=function(e){this.failIfClosed();var n=this,r=function(){setTimeout(e,200),n.surface.removeEventListener("playing",r)};this.surface.addEventListener("playing",r),this.surface.play()},t.prototype.isPaused=function(){return this.failIfClosed(),this.surface.paused},t.prototype.getSurface=function(){return this.failIfClosed(),this.surface},t.prototype.getRunningTrackCapabilities=function(){return this.getFirstTrackOrFail().getCapabilities()},t.prototype.getRunningTrackSettings=function(){return this.getFirstTrackOrFail().getSettings()},t.prototype.applyVideoConstraints=function(e){return ug(this,void 0,void 0,function(){return dg(this,function(n){if("aspectRatio"in e)throw"Changing 'aspectRatio' in run-time is not yet supported.";return[2,this.getFirstTrackOrFail().applyConstraints(e)]})})},t.prototype.close=function(){if(this.isClosed)return Promise.resolve();var e=this;return new Promise(function(n,r){var s=e.mediaStream.getVideoTracks(),i=s.length,l=0;e.mediaStream.getVideoTracks().forEach(function(h){e.mediaStream.removeTrack(h),h.stop(),++l,l>=i&&(e.isClosed=!0,e.parentElement.removeChild(e.surface),n())})})},t.prototype.getCapabilities=function(){return new XK(this.getFirstTrackOrFail())},t}(),YK=function(){function t(e){this.mediaStream=e}return t.prototype.render=function(e,n,r){return ug(this,void 0,void 0,function(){return dg(this,function(s){return[2,QK.create(e,this.mediaStream,n,r)]})})},t.create=function(e){return ug(this,void 0,void 0,function(){var n,r;return dg(this,function(s){switch(s.label){case 0:if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return n={audio:!1,video:e},[4,navigator.mediaDevices.getUserMedia(n)];case 1:return r=s.sent(),[2,new t(r)]}})})},t}(),VT=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(l){l(i)})}return new(n||(n=Promise))(function(i,l){function h(_){try{y(r.next(_))}catch(E){l(E)}}function p(_){try{y(r.throw(_))}catch(E){l(E)}}function y(_){_.done?i(_.value):s(_.value).then(h,p)}y((r=r.apply(t,e||[])).next())})},BT=function(t,e){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,s,i,l;return l={next:h(0),throw:h(1),return:h(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function h(y){return function(_){return p([y,_])}}function p(y){if(r)throw new TypeError("Generator is already executing.");for(;l&&(l=0,y[0]&&(n=0)),n;)try{if(r=1,s&&(i=y[0]&2?s.return:y[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,y[1])).done)return i;switch(s=0,i&&(y=[y[0]&2,i.value]),y[0]){case 0:case 1:i=y;break;case 4:return n.label++,{value:y[1],done:!1};case 5:n.label++,s=y[1],y=[0];continue;case 7:y=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(y[0]===6||y[0]===2)){n=0;continue}if(y[0]===3&&(!i||y[1]>i[0]&&y[1]<i[3])){n.label=y[1];break}if(y[0]===6&&n.label<i[1]){n.label=i[1],i=y;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(y);break}i[2]&&n.ops.pop(),n.trys.pop();continue}y=e.call(t,n)}catch(_){y=[6,_],s=0}finally{r=i=0}if(y[0]&5)throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}},ZK=function(){function t(){}return t.failIfNotSupported=function(){return VT(this,void 0,void 0,function(){return BT(this,function(e){if(!navigator.mediaDevices)throw"navigator.mediaDevices not supported";return[2,new t]})})},t.prototype.create=function(e){return VT(this,void 0,void 0,function(){return BT(this,function(n){return[2,YK.create(e)]})})},t}(),JK=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(l){l(i)})}return new(n||(n=Promise))(function(i,l){function h(_){try{y(r.next(_))}catch(E){l(E)}}function p(_){try{y(r.throw(_))}catch(E){l(E)}}function y(_){_.done?i(_.value):s(_.value).then(h,p)}y((r=r.apply(t,e||[])).next())})},eX=function(t,e){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,s,i,l;return l={next:h(0),throw:h(1),return:h(2)},typeof Symbol=="function"&&(l[Symbol.iterator]=function(){return this}),l;function h(y){return function(_){return p([y,_])}}function p(y){if(r)throw new TypeError("Generator is already executing.");for(;l&&(l=0,y[0]&&(n=0)),n;)try{if(r=1,s&&(i=y[0]&2?s.return:y[0]?s.throw||((i=s.return)&&i.call(s),0):s.next)&&!(i=i.call(s,y[1])).done)return i;switch(s=0,i&&(y=[y[0]&2,i.value]),y[0]){case 0:case 1:i=y;break;case 4:return n.label++,{value:y[1],done:!1};case 5:n.label++,s=y[1],y=[0];continue;case 7:y=n.ops.pop(),n.trys.pop();continue;default:if(i=n.trys,!(i=i.length>0&&i[i.length-1])&&(y[0]===6||y[0]===2)){n=0;continue}if(y[0]===3&&(!i||y[1]>i[0]&&y[1]<i[3])){n.label=y[1];break}if(y[0]===6&&n.label<i[1]){n.label=i[1],i=y;break}if(i&&n.label<i[2]){n.label=i[2],n.ops.push(y);break}i[2]&&n.ops.pop(),n.trys.pop();continue}y=e.call(t,n)}catch(_){y=[6,_],s=0}finally{r=i=0}if(y[0]&5)throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}},tX=function(){function t(){}return t.retrieve=function(){if(navigator.mediaDevices)return t.getCamerasFromMediaDevices();var e=MediaStreamTrack;return MediaStreamTrack&&e.getSources?t.getCamerasFromMediaStreamTrack():t.rejectWithError()},t.rejectWithError=function(){var e=Uu.unableToQuerySupportedDevices();return t.isHttpsOrLocalhost()||(e=Uu.insecureContextCameraQueryError()),Promise.reject(e)},t.isHttpsOrLocalhost=function(){if(location.protocol==="https:")return!0;var e=location.host.split(":")[0];return e==="127.0.0.1"||e==="localhost"},t.getCamerasFromMediaDevices=function(){return JK(this,void 0,void 0,function(){var e,n,r,s,i,l,h;return eX(this,function(p){switch(p.label){case 0:return e=function(y){for(var _=y.getVideoTracks(),E=0,T=_;E<T.length;E++){var k=T[E];k.enabled=!1,k.stop(),y.removeTrack(k)}},[4,navigator.mediaDevices.getUserMedia({audio:!1,video:!0})];case 1:return n=p.sent(),[4,navigator.mediaDevices.enumerateDevices()];case 2:for(r=p.sent(),s=[],i=0,l=r;i<l.length;i++)h=l[i],h.kind==="videoinput"&&s.push({id:h.deviceId,label:h.label});return e(n),[2,s]}})})},t.getCamerasFromMediaStreamTrack=function(){return new Promise(function(e,n){var r=function(i){for(var l=[],h=0,p=i;h<p.length;h++){var y=p[h];y.kind==="video"&&l.push({id:y.id,label:y.label})}e(l)},s=MediaStreamTrack;s.getSources(r)})},t}(),kr;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.NOT_STARTED=1]="NOT_STARTED",t[t.SCANNING=2]="SCANNING",t[t.PAUSED=3]="PAUSED"})(kr||(kr={}));var nX=function(){function t(){this.state=kr.NOT_STARTED,this.onGoingTransactionNewState=kr.UNKNOWN}return t.prototype.directTransition=function(e){this.failIfTransitionOngoing(),this.validateTransition(e),this.state=e},t.prototype.startTransition=function(e){return this.failIfTransitionOngoing(),this.validateTransition(e),this.onGoingTransactionNewState=e,this},t.prototype.execute=function(){if(this.onGoingTransactionNewState===kr.UNKNOWN)throw"Transaction is already cancelled, cannot execute().";var e=this.onGoingTransactionNewState;this.onGoingTransactionNewState=kr.UNKNOWN,this.directTransition(e)},t.prototype.cancel=function(){if(this.onGoingTransactionNewState===kr.UNKNOWN)throw"Transaction is already cancelled, cannot cancel().";this.onGoingTransactionNewState=kr.UNKNOWN},t.prototype.getState=function(){return this.state},t.prototype.failIfTransitionOngoing=function(){if(this.onGoingTransactionNewState!==kr.UNKNOWN)throw"Cannot transition to a new state, already under transition"},t.prototype.validateTransition=function(e){switch(this.state){case kr.UNKNOWN:throw"Transition from unknown is not allowed";case kr.NOT_STARTED:this.failIfNewStateIs(e,[kr.PAUSED]);break;case kr.SCANNING:break;case kr.PAUSED:break}},t.prototype.failIfNewStateIs=function(e,n){for(var r=0,s=n;r<s.length;r++){var i=s[r];if(e===i)throw"Cannot transition from ".concat(this.state," to ").concat(e)}},t}(),rX=function(){function t(e){this.stateManager=e}return t.prototype.startTransition=function(e){return this.stateManager.startTransition(e)},t.prototype.directTransition=function(e){this.stateManager.directTransition(e)},t.prototype.getState=function(){return this.stateManager.getState()},t.prototype.canScanFile=function(){return this.stateManager.getState()===kr.NOT_STARTED},t.prototype.isScanning=function(){return this.stateManager.getState()!==kr.NOT_STARTED},t.prototype.isStrictlyScanning=function(){return this.stateManager.getState()===kr.SCANNING},t.prototype.isPaused=function(){return this.stateManager.getState()===kr.PAUSED},t}(),sX=function(){function t(){}return t.create=function(){return new rX(new nX)},t}(),iX=function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,s){r.__proto__=s}||function(r,s){for(var i in s)Object.prototype.hasOwnProperty.call(s,i)&&(r[i]=s[i])},t(e,n)};return function(e,n){if(typeof n!="function"&&n!==null)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");t(e,n);function r(){this.constructor=e}e.prototype=n===null?Object.create(n):(r.prototype=n.prototype,new r)}}(),_i=function(t){iX(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.DEFAULT_WIDTH=300,e.DEFAULT_WIDTH_OFFSET=2,e.FILE_SCAN_MIN_HEIGHT=300,e.FILE_SCAN_HIDDEN_CANVAS_PADDING=100,e.MIN_QR_BOX_SIZE=50,e.SHADED_LEFT=1,e.SHADED_RIGHT=2,e.SHADED_TOP=3,e.SHADED_BOTTOM=4,e.SHADED_REGION_ELEMENT_ID="qr-shaded-region",e.VERBOSE=!1,e.BORDER_SHADER_DEFAULT_COLOR="#ffffff",e.BORDER_SHADER_MATCH_COLOR="rgb(90, 193, 56)",e}(FK),aX=function(){function t(e,n){this.logger=n,this.fps=_i.SCAN_DEFAULT_FPS,e?(e.fps&&(this.fps=e.fps),this.disableFlip=e.disableFlip===!0,this.qrbox=e.qrbox,this.aspectRatio=e.aspectRatio,this.videoConstraints=e.videoConstraints):this.disableFlip=_i.DEFAULT_DISABLE_FLIP}return t.prototype.isMediaStreamConstraintsValid=function(){return this.videoConstraints?dD.isMediaStreamConstraintsValid(this.videoConstraints,this.logger):(this.logger.logError("Empty videoConstraints",!0),!1)},t.prototype.isShadedBoxEnabled=function(){return!no(this.qrbox)},t.create=function(e,n){return new t(e,n)},t}(),$2=function(){function t(e,n){if(this.element=null,this.canvasElement=null,this.scannerPausedUiElement=null,this.hasBorderShaders=null,this.borderShaders=null,this.qrMatch=null,this.renderedCamera=null,this.qrRegion=null,this.context=null,this.lastScanImageFile=null,this.isScanning=!1,!document.getElementById(e))throw"HTML Element with id=".concat(e," not found");this.elementId=e,this.verbose=!1;var r;typeof n=="boolean"?this.verbose=n===!0:n&&(r=n,this.verbose=r.verbose===!0,r.experimentalFeatures),this.logger=new BK(this.verbose),this.qrcode=new HK(this.getSupportedFormats(n),this.getUseBarCodeDetectorIfSupported(r),this.verbose,this.logger),this.foreverScanTimeout,this.shouldScan=!0,this.stateManagerProxy=sX.create()}return t.prototype.start=function(e,n,r,s){var i=this;if(!e)throw"cameraIdOrConfig is required";if(!r||typeof r!="function")throw"qrCodeSuccessCallback is required and should be a function.";var l;s?l=s:l=this.verbose?this.logger.log:function(){};var h=aX.create(n,this.logger);this.clearElement();var p=!1;h.videoConstraints&&(h.isMediaStreamConstraintsValid()?p=!0:this.logger.logError("'videoConstraints' is not valid 'MediaStreamConstraints, it will be ignored.'",!0));var y=p,_=document.getElementById(this.elementId);_.clientWidth?_.clientWidth:_i.DEFAULT_WIDTH,_.style.position="relative",this.shouldScan=!0,this.element=_;var E=this,T=this.stateManagerProxy.startTransition(kr.SCANNING);return new Promise(function(k,L){var B=y?h.videoConstraints:E.createVideoConstraints(e);if(!B){T.cancel(),L("videoConstraints should be defined");return}var H={};(!y||h.aspectRatio)&&(H.aspectRatio=h.aspectRatio);var W={onRenderSurfaceReady:function(M,U){E.setupUi(M,U,h),E.isScanning=!0,E.foreverScan(h,r,l)}};ZK.failIfNotSupported().then(function(M){M.create(B).then(function(U){return U.render(i.element,H,W).then(function($){E.renderedCamera=$,T.execute(),k(null)}).catch(function($){T.cancel(),L($)})}).catch(function(U){T.cancel(),L(Uu.errorGettingUserMedia(U))})}).catch(function(M){T.cancel(),L(Uu.cameraStreamingNotSupported())})})},t.prototype.pause=function(e){if(!this.stateManagerProxy.isStrictlyScanning())throw"Cannot pause, scanner is not scanning.";this.stateManagerProxy.directTransition(kr.PAUSED),this.showPausedState(),(no(e)||e!==!0)&&(e=!1),e&&this.renderedCamera&&this.renderedCamera.pause()},t.prototype.resume=function(){if(!this.stateManagerProxy.isPaused())throw"Cannot result, scanner is not paused.";if(!this.renderedCamera)throw"renderedCamera doesn't exist while trying resume()";var e=this,n=function(){e.stateManagerProxy.directTransition(kr.SCANNING),e.hidePausedState()};if(!this.renderedCamera.isPaused()){n();return}this.renderedCamera.resume(function(){n()})},t.prototype.getState=function(){return this.stateManagerProxy.getState()},t.prototype.stop=function(){var e=this;if(!this.stateManagerProxy.isScanning())throw"Cannot stop, scanner is not running or paused.";var n=this.stateManagerProxy.startTransition(kr.NOT_STARTED);this.shouldScan=!1,this.foreverScanTimeout&&clearTimeout(this.foreverScanTimeout);var r=function(){if(e.element){var i=document.getElementById(_i.SHADED_REGION_ELEMENT_ID);i&&e.element.removeChild(i)}},s=this;return this.renderedCamera.close().then(function(){return s.renderedCamera=null,s.element&&(s.element.removeChild(s.canvasElement),s.canvasElement=null),r(),s.qrRegion&&(s.qrRegion=null),s.context&&(s.context=null),n.execute(),s.hidePausedState(),s.isScanning=!1,Promise.resolve()})},t.prototype.scanFile=function(e,n){return this.scanFileV2(e,n).then(function(r){return r.decodedText})},t.prototype.scanFileV2=function(e,n){var r=this;if(!e||!(e instanceof File))throw"imageFile argument is mandatory and should be instance of File. Use 'event.target.files[0]'.";if(no(n)&&(n=!0),!this.stateManagerProxy.canScanFile())throw"Cannot start file scan - ongoing camera scan";return new Promise(function(s,i){r.possiblyCloseLastScanImageFile(),r.clearElement(),r.lastScanImageFile=URL.createObjectURL(e);var l=new Image;l.onload=function(){var h=l.width,p=l.height,y=document.getElementById(r.elementId),_=y.clientWidth?y.clientWidth:_i.DEFAULT_WIDTH,E=Math.max(y.clientHeight?y.clientHeight:p,_i.FILE_SCAN_MIN_HEIGHT),T=r.computeCanvasDrawConfig(h,p,_,E);if(n){var k=r.createCanvasElement(_,E,"qr-canvas-visible");k.style.display="inline-block",y.appendChild(k);var L=k.getContext("2d");if(!L)throw"Unable to get 2d context from canvas";L.canvas.width=_,L.canvas.height=E,L.drawImage(l,0,0,h,p,T.x,T.y,T.width,T.height)}var B=_i.FILE_SCAN_HIDDEN_CANVAS_PADDING,H=Math.max(l.width,T.width),W=Math.max(l.height,T.height),M=H+2*B,U=W+2*B,$=r.createCanvasElement(M,U);y.appendChild($);var K=$.getContext("2d");if(!K)throw"Unable to get 2d context from canvas";K.canvas.width=M,K.canvas.height=U,K.drawImage(l,0,0,h,p,B,B,H,W);try{r.qrcode.decodeRobustlyAsync($).then(function(Z){s(OT.createFromQrcodeResult(Z))}).catch(i)}catch(Z){i("QR code parse error, error = ".concat(Z))}},l.onerror=i,l.onabort=i,l.onstalled=i,l.onsuspend=i,l.src=URL.createObjectURL(e)})},t.prototype.clear=function(){this.clearElement()},t.getCameras=function(){return tX.retrieve()},t.prototype.getRunningTrackCapabilities=function(){return this.getRenderedCameraOrFail().getRunningTrackCapabilities()},t.prototype.getRunningTrackSettings=function(){return this.getRenderedCameraOrFail().getRunningTrackSettings()},t.prototype.getRunningTrackCameraCapabilities=function(){return this.getRenderedCameraOrFail().getCapabilities()},t.prototype.applyVideoConstraints=function(e){if(e){if(!dD.isMediaStreamConstraintsValid(e,this.logger))throw"invalid videoConstaints passed, check logs for more details"}else throw"videoConstaints is required argument.";return this.getRenderedCameraOrFail().applyVideoConstraints(e)},t.prototype.getRenderedCameraOrFail=function(){if(this.renderedCamera==null)throw"Scanning is not in running state, call this API only when QR code scanning using camera is in running state.";return this.renderedCamera},t.prototype.getSupportedFormats=function(e){var n=[pt.QR_CODE,pt.AZTEC,pt.CODABAR,pt.CODE_39,pt.CODE_93,pt.CODE_128,pt.DATA_MATRIX,pt.MAXICODE,pt.ITF,pt.EAN_13,pt.EAN_8,pt.PDF_417,pt.RSS_14,pt.RSS_EXPANDED,pt.UPC_A,pt.UPC_E,pt.UPC_EAN_EXTENSION];if(!e||typeof e=="boolean"||!e.formatsToSupport)return n;if(!Array.isArray(e.formatsToSupport))throw"configOrVerbosityFlag.formatsToSupport should be undefined or an array.";if(e.formatsToSupport.length===0)throw"Atleast 1 formatsToSupport is needed.";for(var r=[],s=0,i=e.formatsToSupport;s<i.length;s++){var l=i[s];jK(l)?r.push(l):this.logger.warn("Invalid format: ".concat(l," passed in config, ignoring."))}if(r.length===0)throw"None of formatsToSupport match supported values.";return r},t.prototype.getUseBarCodeDetectorIfSupported=function(e){if(no(e))return!0;if(!no(e.useBarCodeDetectorIfSupported))return e.useBarCodeDetectorIfSupported!==!1;if(no(e.experimentalFeatures))return!0;var n=e.experimentalFeatures;return no(n.useBarCodeDetectorIfSupported)?!0:n.useBarCodeDetectorIfSupported!==!1},t.prototype.validateQrboxSize=function(e,n,r){var s=this,i=r.qrbox;this.validateQrboxConfig(i);var l=this.toQrdimensions(e,n,i),h=function(y){if(y<_i.MIN_QR_BOX_SIZE)throw"minimum size of 'config.qrbox' dimension value is"+" ".concat(_i.MIN_QR_BOX_SIZE,"px.")},p=function(y){return y>e&&(s.logger.warn("`qrbox.width` or `qrbox` is larger than the width of the root element. The width will be truncated to the width of root element."),y=e),y};h(l.width),h(l.height),l.width=p(l.width)},t.prototype.validateQrboxConfig=function(e){if(typeof e!="number"&&typeof e!="function"&&(e.width===void 0||e.height===void 0))throw"Invalid instance of QrDimensions passed for 'config.qrbox'. Both 'width' and 'height' should be set."},t.prototype.toQrdimensions=function(e,n,r){if(typeof r=="number")return{width:r,height:r};if(typeof r=="function")try{return r(e,n)}catch(s){throw new Error("qrbox config was passed as a function but it failed with unknown error"+s)}return r},t.prototype.setupUi=function(e,n,r){r.isShadedBoxEnabled()&&this.validateQrboxSize(e,n,r);var s=no(r.qrbox)?{width:e,height:n}:r.qrbox;this.validateQrboxConfig(s);var i=this.toQrdimensions(e,n,s);i.height>n&&this.logger.warn("[Html5Qrcode] config.qrbox has height that isgreater than the height of the video stream. Shading will be ignored");var l=r.isShadedBoxEnabled()&&i.height<=n,h={x:0,y:0,width:e,height:n},p=l?this.getShadedRegionBounds(e,n,i):h,y=this.createCanvasElement(p.width,p.height),_={willReadFrequently:!0},E=y.getContext("2d",_);E.canvas.width=p.width,E.canvas.height=p.height,this.element.append(y),l&&this.possiblyInsertShadingElement(this.element,e,n,i),this.createScannerPausedUiElement(this.element),this.qrRegion=p,this.context=E,this.canvasElement=y},t.prototype.createScannerPausedUiElement=function(e){var n=document.createElement("div");n.innerText=Uu.scannerPaused(),n.style.display="none",n.style.position="absolute",n.style.top="0px",n.style.zIndex="1",n.style.background="rgba(9, 9, 9, 0.46)",n.style.color="#FFECEC",n.style.textAlign="center",n.style.width="100%",e.appendChild(n),this.scannerPausedUiElement=n},t.prototype.scanContext=function(e,n){var r=this;return this.stateManagerProxy.isPaused()?Promise.resolve(!1):this.qrcode.decodeAsync(this.canvasElement).then(function(s){return e(s.text,OT.createFromQrcodeResult(s)),r.possiblyUpdateShaders(!0),!0}).catch(function(s){r.possiblyUpdateShaders(!1);var i=Uu.codeParseError(s);return n(i,VK.createFrom(i)),!1})},t.prototype.foreverScan=function(e,n,r){var s=this;if(this.shouldScan&&this.renderedCamera){var i=this.renderedCamera.getSurface(),l=i.videoWidth/i.clientWidth,h=i.videoHeight/i.clientHeight;if(!this.qrRegion)throw"qrRegion undefined when localMediaStream is ready.";var p=this.qrRegion.width*l,y=this.qrRegion.height*h,_=this.qrRegion.x*l,E=this.qrRegion.y*h;this.context.drawImage(i,_,E,p,y,0,0,this.qrRegion.width,this.qrRegion.height);var T=function(){s.foreverScanTimeout=setTimeout(function(){s.foreverScan(e,n,r)},s.getTimeoutFps(e.fps))};this.scanContext(n,r).then(function(k){!k&&e.disableFlip!==!0?(s.context.translate(s.context.canvas.width,0),s.context.scale(-1,1),s.scanContext(n,r).finally(function(){T()})):T()}).catch(function(k){s.logger.logError("Error happend while scanning context",k),T()})}},t.prototype.createVideoConstraints=function(e){if(typeof e=="string")return{deviceId:{exact:e}};if(typeof e=="object"){var n="facingMode",r="deviceId",s={user:!0,environment:!0},i="exact",l=function(L){if(L in s)return!0;throw"config has invalid 'facingMode' value = "+"'".concat(L,"'")},h=Object.keys(e);if(h.length!==1)throw"'cameraIdOrConfig' object should have exactly 1 key,"+" if passed as an object, found ".concat(h.length," keys");var p=Object.keys(e)[0];if(p!==n&&p!==r)throw"Only '".concat(n,"' and '").concat(r,"' ")+" are supported for 'cameraIdOrConfig'";if(p===n){var y=e.facingMode;if(typeof y=="string"){if(l(y))return{facingMode:y}}else if(typeof y=="object")if(i in y){if(l(y["".concat(i)]))return{facingMode:{exact:y["".concat(i)]}}}else throw"'facingMode' should be string or object with"+" ".concat(i," as key.");else{var _=typeof y;throw"Invalid type of 'facingMode' = ".concat(_)}}else{var E=e.deviceId;if(typeof E=="string")return{deviceId:E};if(typeof E=="object"){if(i in E)return{deviceId:{exact:E["".concat(i)]}};throw"'deviceId' should be string or object with"+" ".concat(i," as key.")}else{var T=typeof E;throw"Invalid type of 'deviceId' = ".concat(T)}}}var k=typeof e;throw"Invalid type of 'cameraIdOrConfig' = ".concat(k)},t.prototype.computeCanvasDrawConfig=function(e,n,r,s){if(e<=r&&n<=s){var i=(r-e)/2,l=(s-n)/2;return{x:i,y:l,width:e,height:n}}else{var h=e,p=n;return e>r&&(n=r/e*n,e=r),n>s&&(e=s/n*e,n=s),this.logger.log("Image downsampled from "+"".concat(h,"X").concat(p)+" to ".concat(e,"X").concat(n,".")),this.computeCanvasDrawConfig(e,n,r,s)}},t.prototype.clearElement=function(){if(this.stateManagerProxy.isScanning())throw"Cannot clear while scan is ongoing, close it first.";var e=document.getElementById(this.elementId);e&&(e.innerHTML="")},t.prototype.possiblyUpdateShaders=function(e){this.qrMatch!==e&&(this.hasBorderShaders&&this.borderShaders&&this.borderShaders.length&&this.borderShaders.forEach(function(n){n.style.backgroundColor=e?_i.BORDER_SHADER_MATCH_COLOR:_i.BORDER_SHADER_DEFAULT_COLOR}),this.qrMatch=e)},t.prototype.possiblyCloseLastScanImageFile=function(){this.lastScanImageFile&&(URL.revokeObjectURL(this.lastScanImageFile),this.lastScanImageFile=null)},t.prototype.createCanvasElement=function(e,n,r){var s=e,i=n,l=document.createElement("canvas");return l.style.width="".concat(s,"px"),l.style.height="".concat(i,"px"),l.style.display="none",l.id=no(r)?"qr-canvas":r,l},t.prototype.getShadedRegionBounds=function(e,n,r){if(r.width>e||r.height>n)throw"'config.qrbox' dimensions should not be greater than the dimensions of the root HTML element.";return{x:(e-r.width)/2,y:(n-r.height)/2,width:r.width,height:r.height}},t.prototype.possiblyInsertShadingElement=function(e,n,r,s){if(!(n-s.width<1||r-s.height<1)){var i=document.createElement("div");i.style.position="absolute";var l=(n-s.width)/2,h=(r-s.height)/2;if(i.style.borderLeft="".concat(l,"px solid rgba(0, 0, 0, 0.48)"),i.style.borderRight="".concat(l,"px solid rgba(0, 0, 0, 0.48)"),i.style.borderTop="".concat(h,"px solid rgba(0, 0, 0, 0.48)"),i.style.borderBottom="".concat(h,"px solid rgba(0, 0, 0, 0.48)"),i.style.boxSizing="border-box",i.style.top="0px",i.style.bottom="0px",i.style.left="0px",i.style.right="0px",i.id="".concat(_i.SHADED_REGION_ELEMENT_ID),n-s.width<11||r-s.height<11)this.hasBorderShaders=!1;else{var p=5,y=40;this.insertShaderBorders(i,y,p,-p,null,0,!0),this.insertShaderBorders(i,y,p,-p,null,0,!1),this.insertShaderBorders(i,y,p,null,-p,0,!0),this.insertShaderBorders(i,y,p,null,-p,0,!1),this.insertShaderBorders(i,p,y+p,-p,null,-p,!0),this.insertShaderBorders(i,p,y+p,null,-p,-p,!0),this.insertShaderBorders(i,p,y+p,-p,null,-p,!1),this.insertShaderBorders(i,p,y+p,null,-p,-p,!1),this.hasBorderShaders=!0}e.append(i)}},t.prototype.insertShaderBorders=function(e,n,r,s,i,l,h){var p=document.createElement("div");p.style.position="absolute",p.style.backgroundColor=_i.BORDER_SHADER_DEFAULT_COLOR,p.style.width="".concat(n,"px"),p.style.height="".concat(r,"px"),s!==null&&(p.style.top="".concat(s,"px")),i!==null&&(p.style.bottom="".concat(i,"px")),h?p.style.left="".concat(l,"px"):p.style.right="".concat(l,"px"),this.borderShaders||(this.borderShaders=[]),this.borderShaders.push(p),e.appendChild(p)},t.prototype.showPausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="block"},t.prototype.hidePausedState=function(){if(!this.scannerPausedUiElement)throw"[internal error] scanner paused UI element not found";this.scannerPausedUiElement.style.display="none"},t.prototype.getTimeoutFps=function(e){return 1e3/e},t}(),UT;(function(t){t[t.STATUS_DEFAULT=0]="STATUS_DEFAULT",t[t.STATUS_SUCCESS=1]="STATUS_SUCCESS",t[t.STATUS_WARNING=2]="STATUS_WARNING",t[t.STATUS_REQUESTING_PERMISSION=3]="STATUS_REQUESTING_PERMISSION"})(UT||(UT={}));function oX(){var Ke,dn,tt,ot,jt,Kt,ar,Xt,xn,Mt,we,Tt,Rt,wt,bt;const{user:t}=Gs(),[e,n]=q.useState([]),[r,s]=q.useState(!0),[i,l]=q.useState("");q.useEffect(()=>{console.log("[FulfillmentPage] RBAC User:",{type:t==null?void 0:t.type,email:t==null?void 0:t.email,role_id:t==null?void 0:t.role_id})},[t]);const[h,p]=q.useState("all"),[y,_]=q.useState("all"),[E,T]=q.useState(null),[k,L]=q.useState(!1),[B,H]=q.useState(!1),[W,M]=q.useState([]),[U,$]=q.useState("order"),[K,Z]=q.useState(""),[A,C]=q.useState(!1),[N,D]=q.useState(null),[O,F]=q.useState(null),[R,ie]=q.useState(null),[te,je]=q.useState(new Set),We=q.useRef(null),Ee=q.useRef(null),qe=q.useRef(null),et=q.useRef(""),Lt=q.useRef(null),Qe=q.useRef(null),rt=q.useRef(null),[pe,ve]=q.useState(!1),[fe,ke]=q.useState(!1),[Ve,Vt]=q.useState(!1),[qt,yt]=q.useState(!1),[xe,se]=q.useState({status:"pending",trackingNumber:"",notes:""});q.useEffect(()=>{Ge()},[]),q.useEffect(()=>{B&&Et()},[B]),q.useEffect(()=>{if(!k){Oe(),ve(!1);return}const ce=()=>{requestAnimationFrame(()=>{requestAnimationFrame(()=>{const be=rt.current||document.getElementById("html5qr-code-full-region");be&&be.isConnected?(ve(!0),setTimeout(()=>{De()},200)):setTimeout(ce,100)})})},Ie=setTimeout(ce,500);return()=>{clearTimeout(Ie),Oe()}},[k]);const De=async()=>{try{D(null);const ce="html5qr-code-full-region";let Ie=rt.current;Ie||(Ie=document.getElementById(ce));let be=0;const Ce=30;for(;!Ie&&be<Ce;)await new Promise(nt=>setTimeout(nt,100)),Ie=rt.current||document.getElementById(ce),be++;if(!Ie)throw console.error("[FulfillmentPage] Element not found after",Ce,"attempts"),console.error("[FulfillmentPage] Available elements with id:",document.querySelectorAll("[id]")),console.error("[FulfillmentPage] Ref value:",rt.current),console.error("[FulfillmentPage] showScanModal:",k),console.error("[FulfillmentPage] containerReady:",pe),new Error("Camera container element not found. Please try again.");(!Ie.id||Ie.id!==ce)&&(Ie.id=ce),console.log("[FulfillmentPage] Found container element:",Ie.id,Ie),console.log("[FulfillmentPage] Container parent:",Ie.parentElement),console.log("[FulfillmentPage] Container isConnected:",Ie.isConnected);let it=0;for(;!Ie.isConnected&&it<20;)await new Promise(nt=>setTimeout(nt,100)),Ie=rt.current||document.getElementById(ce),it++;if(!Ie||!Ie.isConnected)throw console.error("[FulfillmentPage] Container still not connected after waiting"),console.error("[FulfillmentPage] Container:",Ie),console.error("[FulfillmentPage] Parent:",Ie==null?void 0:Ie.parentElement),new Error("Container element is not connected to DOM after waiting");let He=document.getElementById(ce),un=0;for(;!He&&un<10;)await new Promise(nt=>setTimeout(nt,50)),He=document.getElementById(ce),un++;if(!He)throw console.error("[FulfillmentPage] Element not findable by getElementById after verification"),console.error("[FulfillmentPage] Trying querySelector:",document.querySelector(`#${ce}`)),console.error("[FulfillmentPage] All elements with that ID:",document.querySelectorAll(`#${ce}`)),new Error("Element with ID not findable in document by getElementById");if(console.log("[FulfillmentPage] Verified element is findable by ID:",He===Ie),Ie.style.visibility==="hidden"&&(Ie.style.visibility="visible"),Ie.parentElement){const nt=Ie.parentElement;nt.style.visibility==="hidden"&&(nt.style.visibility="visible"),nt.style.opacity==="0"&&(nt.style.opacity="1")}await new Promise(nt=>setTimeout(nt,200)),console.log("[FulfillmentPage] Initializing Html5Qrcode with element:",Ie.id,"isConnected:",Ie.isConnected);const wn=new $2(ce);Qe.current=wn;const Bt=Ie.clientWidth||300,Ht=Ie.clientHeight||256,Rn=Math.min(Bt,Ht)*.8;await wn.start({facingMode:"environment"},{fps:10,qrbox:{width:Rn,height:Rn},aspectRatio:1,disableFlip:!1},nt=>{nt&&nt!==et.current&&(et.current=nt,Z(nt),Lt.current&&clearTimeout(Lt.current),Lt.current=setTimeout(()=>{const ee=document.querySelector("[data-barcode-input]");if(ee&&ee.value===nt){const J=document.querySelector("[data-scan-button]");J&&!J.disabled&&J.click()}},1500))},nt=>{})}catch(ce){if(console.error("[FulfillmentPage] Camera error:",ce),D("Failed to access camera. Please allow camera permissions or enter barcode manually."),Qe.current){try{Qe.current.stop().catch(()=>{})}catch{}Qe.current=null}}},Oe=async()=>{if(Qe.current){try{await Qe.current.stop(),await Qe.current.clear()}catch(Ie){console.warn("[FulfillmentPage] Error stopping html5-qrcode:",Ie)}Qe.current=null}const ce=document.getElementById("html5qr-code-full-region");ce&&ce.remove(),Ee.current&&(Ee.current.getTracks().forEach(Ie=>Ie.stop()),Ee.current=null),We.current&&(We.current.srcObject=null),qe.current&&(clearInterval(qe.current),qe.current=null),Lt.current&&(clearTimeout(Lt.current),Lt.current=null),et.current=""},Ge=async()=>{try{s(!0);const ce=[],Ie=await Cn(In(at,"businesses"));console.log(`[FulfillmentPage] Found ${Ie.docs.length} businesses`);for(const be of Ie.docs){const Ce=be.id,it=be.data(),He=it.features||{},un=He.fulfillment===!0||He.fulfillment_service===!0||He.fulfillmentService===!0;console.log(`[FulfillmentPage] Business ${Ce} (${it.businessName||it.name}):`,{features:He,hasFulfillmentService:un,"features.fulfillment":He.fulfillment,"features.fulfillment_service":He.fulfillment_service,"features.fulfillmentService":He.fulfillmentService,fullFeaturesObject:JSON.stringify(He,null,2)});let wn=un;if(!un){console.log(`[FulfillmentPage] Business ${Ce} does NOT have fulfillment service enabled`),console.log("[FulfillmentPage] Features object:",He),console.log("[FulfillmentPage] Checking orders anyway for debugging...");try{const Bt=In(at,"businesses",Ce,"orders"),Ht=await Cn(Bt);console.log(`[FulfillmentPage] Business ${Ce} has ${Ht.docs.length} orders (but fulfillment service is disabled)`),Ht.docs.length>0&&(console.warn(`[FulfillmentPage]  WARNING: Business ${Ce} has ${Ht.docs.length} orders but fulfillment service is NOT enabled!`),console.warn("[FulfillmentPage] Enable fulfillment service in Admin  Clients  [Business Name]  Business Features"))}catch(Bt){console.error(`[FulfillmentPage] Error checking orders for business ${Ce}:`,Bt)}}if(!wn){console.log(`[FulfillmentPage] Skipping business ${Ce} - no fulfillment service`);continue}try{const Bt=[`businesses/${Ce}/orders`,"orders"];let Ht=null,Rn="";const nt=In(at,"businesses",Ce,"orders");console.log(`[FulfillmentPage] Attempting to load orders from: businesses/${Ce}/orders`);try{try{Ht=await Cn(Ii(nt,xc("date","desc"))),Rn=`businesses/${Ce}/orders (with orderBy date)`,console.log(`[FulfillmentPage] Successfully queried orders with orderBy('date') for business ${Ce}`)}catch(ee){console.warn(`[FulfillmentPage] Could not order by 'date' for business ${Ce}, trying metadata.createdAt:`,ee);try{Ht=await Cn(Ii(nt,xc("metadata.createdAt","desc"))),Rn=`businesses/${Ce}/orders (with orderBy metadata.createdAt)`,console.log(`[FulfillmentPage] Successfully queried orders with orderBy('metadata.createdAt') for business ${Ce}`)}catch(J){console.warn(`[FulfillmentPage] Could not order by 'metadata.createdAt' for business ${Ce}, trying createdAt:`,J);try{Ht=await Cn(Ii(nt,xc("createdAt","desc"))),Rn=`businesses/${Ce}/orders (with orderBy createdAt)`,console.log(`[FulfillmentPage] Successfully queried orders with orderBy('createdAt') for business ${Ce}`)}catch(oe){console.warn(`[FulfillmentPage] Could not order by any date field for business ${Ce}, loading without order:`,oe),Ht=await Cn(nt),Rn=`businesses/${Ce}/orders (without orderBy)`,console.log(`[FulfillmentPage] Successfully loaded orders without orderBy for business ${Ce}`)}}}}catch(ee){console.error(`[FulfillmentPage] Error loading orders from businesses/${Ce}/orders:`,ee),console.log("[FulfillmentPage] Trying top-level orders collection with businessId filter...");try{const J=In(at,"orders");Ht=await Cn(Ii(J,hc("businessId","==",Ce))),Rn="orders (top-level with businessId filter)",console.log(`[FulfillmentPage] Found orders in top-level collection for business ${Ce}`)}catch(J){throw console.error("[FulfillmentPage] Error loading from top-level orders collection:",J),ee}}console.log(`[FulfillmentPage] Found ${Ht.docs.length} orders for business ${Ce} from path: ${Rn}`),Ht.docs.length===0?(console.warn(`[FulfillmentPage]  No orders found for business ${Ce} (${it.businessName||it.name})`),console.warn(`[FulfillmentPage] Tried paths: ${Bt.join(", ")}`),console.warn("[FulfillmentPage] This business has fulfillment service enabled but no orders exist in Firestore"),console.warn("[FulfillmentPage] Possible reasons:"),console.warn("[FulfillmentPage] 1. Orders are not saved to Firestore (only in local state)"),console.warn("[FulfillmentPage] 2. Orders are stored in a different collection path"),console.warn("[FulfillmentPage] 3. Orders collection doesn't exist yet")):console.log(`[FulfillmentPage]  Found ${Ht.docs.length} orders for business ${Ce} from ${Rn}`),Ht.docs.forEach(ee=>{var _e,Se,$e,ge,Ye,Ze,Fe;const J=ee.data();console.log(`[FulfillmentPage] Processing order ${ee.id} from business ${Ce}:`,{orderNumber:J.orderNumber||J.order_id||J.id,status:((_e=J.fulfillment)==null?void 0:_e.status)||J.status,customer:((Se=J.customer)==null?void 0:Se.name)||J.customerName,fulfillment:J.fulfillment,allKeys:Object.keys(J)});const oe=J.fulfillment||{status:J.status==="pending"?"pending":J.status==="processing"?"processing":J.status==="shipped"?"shipped":J.status==="delivered"?"delivered":J.status==="cancelled"?"cancelled":"pending",type:(($e=J.fulfillment)==null?void 0:$e.type)||J.shippingType||"delivery",trackingNumber:((ge=J.fulfillment)==null?void 0:ge.trackingNumber)||J.trackingNumber||null,address:((Ye=J.fulfillment)==null?void 0:Ye.address)||J.shippingAddress||J.address||"",shippedAt:((Ze=J.fulfillment)==null?void 0:Ze.shippedAt)||J.shippedAt||null,deliveredAt:((Fe=J.fulfillment)==null?void 0:Fe.deliveredAt)||J.deliveredAt||null};ce.push({id:ee.id,orderId:ee.id,orderNumber:J.orderNumber||J.order_id||J.id||`#${ee.id.slice(0,6)}`,businessId:Ce,businessName:it.businessName||it.name||"Unknown Business",hasFulfillmentService:!0,customer:J.customer||{name:J.customerName||"Unknown",email:J.customerEmail||"",phone:J.customerPhone||""},fulfillment:oe,financials:J.financials||{total:J.total||J.amount||0},metadata:J.metadata||{createdAt:J.createdAt||J.created_at||J.date||new Date().toISOString(),updatedAt:J.updatedAt||J.updated_at||new Date().toISOString()},...J})})}catch(Bt){console.error(`[FulfillmentPage] Could not load orders for business ${Ce}:`,Bt)}}console.log(`[FulfillmentPage] Total orders loaded: ${ce.length}`),ce.sort((be,Ce)=>{const it=wn=>{var Ht;let Bt=((Ht=wn.metadata)==null?void 0:Ht.createdAt)||wn.createdAt||wn.created_at||wn.date||"";if(Bt&&typeof Bt.toDate=="function")return Bt.toDate();if(Bt instanceof Date)return Bt;if(typeof Bt=="string"&&Bt.length>0){const Rn=new Date(Bt);if(!isNaN(Rn.getTime()))return Rn}return new Date(0)},He=it(be);return it(Ce).getTime()-He.getTime()}),n(ce)}catch(ce){console.error("[FulfillmentPage] Error loading orders:",ce),alert("Failed to load orders")}finally{s(!1)}},ht=async()=>{var ce,Ie;if(E){yt(!0);try{const be=Bn(at,"businesses",E.businessId,"orders",E.id),Ce=He=>{switch(He){case"pending":return"pending";case"processing":return"pending";case"ready_for_pickup":return"ready_for_pickup";case"shipped":return"processing";case"delivered":return"completed";case"cancelled":return"cancelled";default:return"pending"}},it={"fulfillment.status":xe.status,status:Ce(xe.status),"metadata.updatedAt":new Date().toISOString()};xe.trackingNumber&&(it["fulfillment.trackingNumber"]=xe.trackingNumber),xe.status==="shipped"&&!((ce=E.fulfillment)!=null&&ce.shippedAt)&&(it["fulfillment.shippedAt"]=new Date().toISOString()),xe.status==="delivered"&&!((Ie=E.fulfillment)!=null&&Ie.deliveredAt)&&(it["fulfillment.deliveredAt"]=new Date().toISOString()),await ls(be,it),alert(" Fulfillment status updated successfully!"),Vt(!1),T(null),await Ge()}catch(be){console.error("[FulfillmentPage] Error updating fulfillment:",be),alert(" Failed to update fulfillment status")}finally{yt(!1)}}},Et=async()=>{try{s(!0);const ce=[],Ie=await Cn(In(at,"businesses"));for(const be of Ie.docs){const Ce=be.id,it=be.data(),He=it.features||{};if(He.fulfillment===!0||He.fulfillment_service===!0||He.fulfillmentService===!0)try{const wn=In(at,"businesses",Ce,"scan_log");(await Cn(Ii(wn,xc("timestamp","desc")))).docs.forEach(Ht=>{const Rn=Ht.data();Rn.source==="fulfillment_page"&&ce.push({id:Ht.id,businessId:Ce,businessName:it.businessName||it.name||"Unknown Business",...Rn})})}catch(wn){console.warn(`[FulfillmentPage] Could not load scan logs for business ${Ce}:`,wn)}}ce.sort((be,Ce)=>{var un,wn;const it=(un=be.timestamp)!=null&&un.toDate?be.timestamp.toDate():new Date(be.timestamp||0);return((wn=Ce.timestamp)!=null&&wn.toDate?Ce.timestamp.toDate():new Date(Ce.timestamp||0)).getTime()-it.getTime()}),M(ce)}catch(ce){console.error("[FulfillmentPage] Error loading scan logs:",ce)}finally{s(!1)}},st=async()=>{var ce,Ie,be,Ce,it,He,un,wn,Bt,Ht,Rn,nt;if(!K.trim()){alert("Please enter or scan a barcode");return}if(!R||!O){alert("Please select an order to scan products for");return}C(!0);try{const ee=K.trim().toLowerCase(),J=K.trim(),oe=lt=>lt.toLowerCase().replace(/\s+/g,"").replace(/-/g,""),_e=oe(J);console.log("[FulfillmentPage] ========== SCAN START =========="),console.log("[FulfillmentPage] Scanning barcode:",J,"normalized:",_e),console.log("[FulfillmentPage] Order ID:",R,"Business ID:",O);let Se=e.find(lt=>lt.id===R);if(!Se)try{const lt=await ri(Bn(at,"businesses",O,"orders",R));if(lt.exists()){const xt=lt.data(),Wt=await ri(Bn(at,"businesses",O)),Pt=Wt.exists()?Wt.data():{};Se={id:R,orderId:R,orderNumber:xt.orderNumber||`#${R.slice(0,6)}`,businessId:O,businessName:Pt.businessName||Pt.name||"Unknown Business",customer:xt.customer||{name:"Unknown",email:"",phone:""},fulfillment:xt.fulfillment||{status:"pending"},financials:xt.financials||{total:0},metadata:xt.metadata||{},items:xt.items||[],...xt}}else{alert("Order not found"),Z("");return}}catch(lt){console.error("[FulfillmentPage] Error loading order:",lt),alert("Error loading order: "+lt.message),Z("");return}if(!Se||!Se.items||Se.items.length===0){alert("Order has no items to scan"),Z("");return}console.log("[FulfillmentPage] Order items count:",Se.items.length),console.log("[FulfillmentPage] Order items:",JSON.stringify(Se.items,null,2));let $e=-1,ge=null;const Ye=[];try{const lt=In(at,"businesses",O,"products"),xt=await Cn(lt);console.log("[FulfillmentPage] Searching through",xt.docs.length,"products");for(const Wt of xt.docs){const Pt=Wt.data(),bn=((ce=Pt.barcode)==null?void 0:ce.toString().toLowerCase())||"",hn=((Ie=Pt.mainBarcode)==null?void 0:Ie.toString().toLowerCase())||"",Er=oe(bn),vn=oe(hn),Qr=((be=Pt.sku)==null?void 0:be.toString().toLowerCase())||"",Ae=oe(Qr),jn=Wt.id,Gt=jn.toLowerCase(),Jn=[jn];let en=!1,ct="";if((bn===ee||Er===_e)&&(en=!0,ct=`main barcode: ${bn}`),(hn===ee||vn===_e)&&(en=!0,ct=`mainBarcode: ${hn}`),(Qr===ee||Ae===_e)&&(en=!0,ct=`SKU: ${Qr}`),(Gt===ee||oe(Gt)===_e)&&(en=!0,ct="product ID direct match"),Pt.sizeVariants&&typeof Pt.sizeVariants=="object")for(const[It,Ut]of Object.entries(Pt.sizeVariants)){const pn=Ut,hr=((Ce=pn==null?void 0:pn.barcode)==null?void 0:Ce.toString().toLowerCase())||"",qs=oe(hr),Hn=((it=pn==null?void 0:pn.sku)==null?void 0:it.toString().toLowerCase())||"",Ks=oe(Hn),Xl=`${jn}-${It}`;Jn.push(Xl),(hr===ee||qs===_e)&&(en=!0,ct=`size variant ${It} barcode: ${hr}`),(Hn===ee||Ks===_e)&&(en=!0,ct=`size variant ${It} SKU: ${Hn}`)}if(Pt.variants&&Array.isArray(Pt.variants))for(const It of Pt.variants){const Ut=((He=It==null?void 0:It.barcode)==null?void 0:He.toString().toLowerCase())||"",pn=oe(Ut),hr=(It==null?void 0:It.size)||(It==null?void 0:It.name)||"";hr&&Jn.push(`${jn}-${hr}`),(Ut===ee||pn===_e)&&(en=!0,ct=`variant barcode: ${Ut}`)}if(en){console.log("[FulfillmentPage]  Product MATCH found:",jn,"Reason:",ct),console.log("[FulfillmentPage] Variant IDs for this product:",Jn);const It=Pt.price||null;Ye.push({baseId:jn,variantIds:Jn,costPrice:It})}}}catch(lt){console.warn("[FulfillmentPage] Error searching products:",lt)}console.log("[FulfillmentPage] Total matching products found:",Ye.length);const Ze=new Set;Ye.forEach(lt=>{Ze.add(lt.baseId.toLowerCase()),lt.variantIds.forEach(xt=>Ze.add(xt.toLowerCase()))}),console.log("[FulfillmentPage] All matching IDs:",Array.from(Ze));for(let lt=0;lt<Se.items.length;lt++){const xt=Se.items[lt];if(te.has(lt.toString())){console.log(`[FulfillmentPage] Item ${lt} already scanned, skipping`);continue}const Wt=((un=xt.barcode)==null?void 0:un.toString().toLowerCase())||"",Pt=oe(Wt),bn=((wn=xt.sku)==null?void 0:wn.toString().toLowerCase())||"",hn=oe(bn),Er=((Bt=xt.productId)==null?void 0:Bt.toString())||"",vn=Er.toLowerCase(),Qr=oe(Er);console.log(`[FulfillmentPage] Checking item ${lt}:`,{productId:Er,barcode:Wt||"N/A",sku:bn||"N/A",productName:xt.productName||xt.name||"Unknown"});let Ae=Wt&&(Wt===ee||Pt===_e)||bn&&(bn===ee||hn===_e)||vn&&(vn===ee||Qr===_e),jn=!1;if(Er)if(Ze.has(vn))jn=!0,console.log(`[FulfillmentPage]  Item ${lt}: Exact productId match!`);else for(const Gt of Ye){const Jn=Gt.baseId.toLowerCase();if(vn.startsWith(Jn+"-")||vn===Jn){jn=!0,console.log(`[FulfillmentPage]  Item ${lt}: productId starts with base product ${Gt.baseId}`);break}if(vn.includes(Jn)){jn=!0,console.log(`[FulfillmentPage]  Item ${lt}: productId contains ${Gt.baseId}`);break}}if(Ae||jn){$e=lt,ge=xt,console.log(`[FulfillmentPage]  FINAL MATCH at item ${lt}:`,xt.productName||xt.name||"Unknown");break}}if($e===-1){console.log("[FulfillmentPage]  No match found"),console.log("[FulfillmentPage] ========== SCAN END (NO MATCH) =========="),alert(`Product barcode "${J}" not found in this order's items.

Please scan a product that belongs to this order.

Debug: Searched ${Ye.length} matching products, checked ${Se.items.length} order items.`),Z("");return}const Fe=new Set(te);Fe.add($e.toString()),je(Fe),console.log(`[FulfillmentPage] Item ${$e} scanned. Total scanned: ${Fe.size}/${Se.items.length}`);const Je=Fe.size>=Se.items.length;if(Je){const lt=((Ht=Se.fulfillment)==null?void 0:Ht.status)||Se.status||"pending";if(lt==="pending"||lt==="processing")try{const xt=Bn(at,"businesses",O,"orders",R);await ls(xt,{"fulfillment.status":"ready_for_pickup",status:"ready_for_pickup","metadata.updatedAt":new Date().toISOString()}),console.log("[FulfillmentPage] Order status updated to ready_for_pickup (both fulfillment.status and status)")}catch(xt){console.error("[FulfillmentPage] Error updating order status:",xt)}}let Ct=null;if(ge.productId){const lt=ge.productId.toLowerCase();for(const xt of Ye)if(lt.startsWith(xt.baseId.toLowerCase())||lt===xt.baseId.toLowerCase()){Ct=xt.costPrice;break}}const St=In(at,"businesses",O,"scan_log");await Wc(St,{barcode:J,orderId:R,orderNumber:Se.orderNumber,businessId:O,businessName:Se.businessName,type:"order",itemIndex:$e,itemScanned:ge.productName||ge.name||"Unknown",productName:ge.productName||ge.name||"Unknown",productId:ge.productId||null,size:ge.size||ge.selectedSize||ge.variant||null,price:Ct??ge.price??ge.unitPrice??0,sellingPrice:ge.price||ge.unitPrice||0,quantity:ge.quantity||1,previousStock:ge.stock||ge.currentStock||null,newStock:ge.stock?ge.stock-(ge.quantity||1):null,scannedItemsCount:Fe.size,totalItemsCount:Se.items.length,allItemsScanned:Je,timestamp:F0(),user:"XDIGIX",userId:"xdigix-fulfillment",adminEmail:(t==null?void 0:t.email)||"Unknown",adminUserId:(t==null?void 0:t.id)||null,scannedBy:"XDIGIX",scannedByUserId:"xdigix-fulfillment",orderStatus:Je?"ready_for_pickup":((Rn=Se.fulfillment)==null?void 0:Rn.status)||"pending",customer:((nt=Se.customer)==null?void 0:nt.name)||"Unknown",notes:Je?"All items scanned - Order ready for pickup":`Item ${$e+1} of ${Se.items.length} scanned`,source:"fulfillment_page"}),Je?(alert(` All items scanned!

Order ${Se.orderNumber} is now ready for pickup.`),Z(""),L(!1),je(new Set),ie(null),F(null),await Ge()):(alert(` Item scanned!

Scanned: ${Fe.size} / ${Se.items.length} items

Continue scanning remaining items.`),Z(""))}catch(ee){console.error("[FulfillmentPage] Error processing scan:",ee),alert(" Failed to process scan: "+ee.message),Z("")}finally{C(!1)}},me=ce=>{switch(ce){case"pending":return"bg-amber-500/20 text-amber-400 border-amber-500/30";case"ready_for_pickup":return"bg-cyan-500/20 text-cyan-400 border-cyan-500/30";case"shipped":return"bg-purple-500/20 text-purple-400 border-purple-500/30";case"delivered":return"bg-emerald-500/20 text-emerald-400 border-emerald-500/30";case"returned":return"bg-orange-500/20 text-orange-400 border-orange-500/30";case"damaged":return"bg-rose-500/20 text-rose-400 border-rose-500/30";case"cancelled":return"bg-red-500/20 text-red-400 border-red-500/30";default:return"bg-gray-500/20 text-gray-400 border-gray-500/30"}},ae=ce=>{switch(ce){case"pending":return d.jsx(Na,{className:"w-4 h-4"});case"ready_for_pickup":return d.jsx(bi,{className:"w-4 h-4"});case"shipped":return d.jsx(Fi,{className:"w-4 h-4"});case"delivered":return d.jsx(Ur,{className:"w-4 h-4"});case"returned":return d.jsx(Wd,{className:"w-4 h-4"});case"damaged":return d.jsx(oD,{className:"w-4 h-4"});case"cancelled":return d.jsx(Ar,{className:"w-4 h-4"});default:return d.jsx(Ui,{className:"w-4 h-4"})}},ft=e.filter(ce=>{var it,He,un,wn,Bt,Ht,Rn,nt,ee,J;const Ie=((it=ce.orderNumber)==null?void 0:it.toLowerCase().includes(i.toLowerCase()))||((un=(He=ce.customer)==null?void 0:He.name)==null?void 0:un.toLowerCase().includes(i.toLowerCase()))||((Bt=(wn=ce.customer)==null?void 0:wn.email)==null?void 0:Bt.toLowerCase().includes(i.toLowerCase()))||((Ht=ce.businessName)==null?void 0:Ht.toLowerCase().includes(i.toLowerCase()))||((nt=(Rn=ce.fulfillment)==null?void 0:Rn.trackingNumber)==null?void 0:nt.toLowerCase().includes(i.toLowerCase())),be=h==="all"||((ee=ce.fulfillment)==null?void 0:ee.status)===h,Ce=y==="all"||((J=ce.fulfillment)==null?void 0:J.type)===y;return Ie&&be&&Ce}),At={total:e.length,pending:e.filter(ce=>{var Ie;return((Ie=ce.fulfillment)==null?void 0:Ie.status)==="pending"}).length,ready_for_pickup:e.filter(ce=>{var Ie;return((Ie=ce.fulfillment)==null?void 0:Ie.status)==="ready_for_pickup"}).length,shipped:e.filter(ce=>{var Ie;return((Ie=ce.fulfillment)==null?void 0:Ie.status)==="shipped"}).length,delivered:e.filter(ce=>{var Ie;return((Ie=ce.fulfillment)==null?void 0:Ie.status)==="delivered"}).length,cancelled:e.filter(ce=>{var Ie;return((Ie=ce.fulfillment)==null?void 0:Ie.status)==="cancelled"}).length};return d.jsx(cs,{permissions:["super_admin.manage_all_tenants","super_admin.view_analytics","super_admin.manage_subscriptions"],showError:!1,children:d.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[d.jsx("div",{className:"mb-6 sm:mb-8",children:d.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-4",children:[d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 bg-gradient-to-br from-amber-500/20 to-amber-600/20 rounded-xl flex items-center justify-center flex-shrink-0",children:d.jsx(Fi,{className:"w-5 h-5 sm:w-6 sm:h-6 text-amber-400"})}),d.jsxs("div",{className:"min-w-0",children:[d.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-white",children:"Fulfillment Management"}),d.jsx("p",{className:"text-gray-400 mt-1 text-sm sm:text-base hidden sm:block",children:"Manage order fulfillment for businesses with fulfillment service subscription"})]})]}),d.jsx("div",{className:"flex items-center gap-2 sm:gap-3 flex-shrink-0",children:d.jsxs("button",{onClick:()=>H(!0),className:"flex items-center gap-1.5 sm:gap-2 px-3 sm:px-4 py-2 bg-white/5 border border-white/10 rounded-xl text-gray-300 hover:bg-white/10 transition-all text-sm sm:text-base",children:[d.jsx(ET,{className:"w-4 h-4"}),d.jsx("span",{className:"hidden sm:inline",children:"Scan Logs"}),d.jsx("span",{className:"sm:hidden",children:"Logs"})]})})]})}),d.jsx("div",{className:"mt-4 bg-blue-500/10 border border-blue-500/20 rounded-xl p-3 sm:p-4",children:d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(Ui,{className:"w-4 h-4 sm:w-5 sm:h-5 text-blue-400 flex-shrink-0"}),d.jsx("p",{className:"text-xs sm:text-sm text-blue-300",children:"Only showing orders from businesses that have subscribed to the fulfillment service"})]})}),d.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-6 gap-3 sm:gap-4 mb-6 sm:mb-8",children:[d.jsxs("div",{className:"bg-[#1a1b3e] border border-[#2d2f5a] rounded-xl p-3 sm:p-5",children:[d.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 mb-2",children:[d.jsx("div",{className:"p-1.5 sm:p-2 rounded-lg bg-blue-500/10",children:d.jsx(bi,{className:"w-4 h-4 sm:w-5 sm:h-5 text-blue-400"})}),d.jsx("span",{className:"text-xs sm:text-sm text-gray-400",children:"Total Orders"})]}),d.jsx("p",{className:"text-xl sm:text-2xl font-bold text-white",children:At.total})]}),d.jsxs("div",{className:"bg-[#1a1b3e] border border-[#2d2f5a] rounded-xl p-3 sm:p-5",children:[d.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[d.jsx("div",{className:"p-2 rounded-lg bg-amber-500/10",children:d.jsx(Na,{className:"w-5 h-5 text-amber-400"})}),d.jsx("span",{className:"text-sm text-gray-400",children:"Pending"})]}),d.jsx("p",{className:"text-2xl font-bold text-amber-400",children:At.pending})]}),d.jsxs("div",{className:"bg-[#1a1b3e] border border-[#2d2f5a] rounded-xl p-3 sm:p-5",children:[d.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[d.jsx("div",{className:"p-2 rounded-lg bg-cyan-500/10",children:d.jsx(bi,{className:"w-5 h-5 text-cyan-400"})}),d.jsx("span",{className:"text-sm text-gray-400",children:"Ready for Pickup"})]}),d.jsx("p",{className:"text-2xl font-bold text-cyan-400",children:At.ready_for_pickup})]}),d.jsxs("div",{className:"bg-[#1a1b3e] border border-[#2d2f5a] rounded-xl p-3 sm:p-5",children:[d.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[d.jsx("div",{className:"p-2 rounded-lg bg-purple-500/10",children:d.jsx(Fi,{className:"w-5 h-5 text-purple-400"})}),d.jsx("span",{className:"text-sm text-gray-400",children:"Shipped"})]}),d.jsx("p",{className:"text-2xl font-bold text-purple-400",children:At.shipped})]}),d.jsxs("div",{className:"bg-[#1a1b3e] border border-[#2d2f5a] rounded-xl p-3 sm:p-5",children:[d.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[d.jsx("div",{className:"p-2 rounded-lg bg-emerald-500/10",children:d.jsx(Ur,{className:"w-5 h-5 text-emerald-400"})}),d.jsx("span",{className:"text-sm text-gray-400",children:"Delivered"})]}),d.jsx("p",{className:"text-2xl font-bold text-emerald-400",children:At.delivered})]}),d.jsxs("div",{className:"bg-[#1a1b3e] border border-[#2d2f5a] rounded-xl p-3 sm:p-5",children:[d.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[d.jsx("div",{className:"p-2 rounded-lg bg-red-500/10",children:d.jsx(Ar,{className:"w-5 h-5 text-red-400"})}),d.jsx("span",{className:"text-sm text-gray-400",children:"Cancelled"})]}),d.jsx("p",{className:"text-2xl font-bold text-red-400",children:At.cancelled})]})]}),d.jsx("div",{className:"bg-[#1a1b3e] border border-[#2d2f5a] rounded-xl p-5 mb-6",children:d.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[d.jsxs("div",{className:"relative",children:[d.jsx(Kl,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-500"}),d.jsx("input",{type:"text",value:i,onChange:ce=>l(ce.target.value),placeholder:"Search by order number, customer, business...",className:"w-full pl-10 pr-4 py-2.5 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:border-amber-500/50"})]}),d.jsxs("select",{value:h,onChange:ce=>p(ce.target.value),className:"px-4 py-2.5 bg-white/5 border border-white/10 rounded-xl text-gray-300 focus:outline-none focus:border-amber-500/50",children:[d.jsx("option",{value:"all",children:"All Statuses"}),d.jsx("option",{value:"pending",children:"Pending"}),d.jsx("option",{value:"ready_for_pickup",children:"Ready for Pickup"}),d.jsx("option",{value:"shipped",children:"Shipped"}),d.jsx("option",{value:"delivered",children:"Delivered"}),d.jsx("option",{value:"cancelled",children:"Cancelled"})]}),d.jsxs("select",{value:y,onChange:ce=>_(ce.target.value),className:"px-4 py-2.5 bg-white/5 border border-white/10 rounded-xl text-gray-300 focus:outline-none focus:border-amber-500/50",children:[d.jsx("option",{value:"all",children:"All Types"}),d.jsx("option",{value:"pickup",children:"Pickup"}),d.jsx("option",{value:"delivery",children:"Delivery"}),d.jsx("option",{value:"shipping",children:"Shipping"})]})]})}),d.jsx("div",{className:"bg-[#1a1b3e] border border-[#2d2f5a] rounded-xl overflow-hidden",children:d.jsx("div",{className:"overflow-x-auto",children:d.jsxs("table",{className:"w-full",children:[d.jsx("thead",{children:d.jsxs("tr",{className:"bg-white/5",children:[d.jsx("th",{className:"text-left text-xs font-medium text-gray-400 uppercase px-6 py-4",children:"Order #"}),d.jsx("th",{className:"text-left text-xs font-medium text-gray-400 uppercase px-6 py-4",children:"Business"}),d.jsx("th",{className:"text-left text-xs font-medium text-gray-400 uppercase px-6 py-4",children:"Customer"}),d.jsx("th",{className:"text-left text-xs font-medium text-gray-400 uppercase px-6 py-4",children:"Type"}),d.jsx("th",{className:"text-left text-xs font-medium text-gray-400 uppercase px-6 py-4",children:"Status"}),d.jsx("th",{className:"text-left text-xs font-medium text-gray-400 uppercase px-6 py-4",children:"Tracking"}),d.jsx("th",{className:"text-left text-xs font-medium text-gray-400 uppercase px-6 py-4",children:"Date"}),d.jsx("th",{className:"text-left text-xs font-medium text-gray-400 uppercase px-6 py-4",children:"Actions"})]})}),d.jsx("tbody",{className:"divide-y divide-white/5",children:r?d.jsx("tr",{children:d.jsxs("td",{colSpan:8,className:"px-6 py-12 text-center",children:[d.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-amber-400"}),d.jsx("p",{className:"text-gray-400 mt-4",children:"Loading orders..."})]})}):ft.length===0?d.jsx("tr",{children:d.jsxs("td",{colSpan:8,className:"px-6 py-12 text-center",children:[d.jsx(bi,{className:"w-12 h-12 text-gray-600 mx-auto mb-4"}),d.jsx("p",{className:"text-gray-400 text-lg",children:"No orders found"}),d.jsx("p",{className:"text-gray-500 text-sm mt-2",children:i||h!=="all"||y!=="all"?"Try adjusting your filters":e.length===0?"No orders found from businesses with fulfillment service. Check browser console (F12) for details.":"No orders match your current filters"}),e.length===0&&d.jsx("div",{className:"mt-4 bg-amber-500/10 border border-amber-500/20 rounded-xl p-4 max-w-md mx-auto",children:d.jsxs("p",{className:"text-xs text-amber-300",children:[d.jsx("strong",{children:"Debug:"})," Open browser console (F12) to see which businesses have fulfillment enabled and how many orders were found."]})})]})}):ft.map(ce=>{var Ce,it,He;const Ie=ce.fulfillment||{},be=Ie.status||"pending";return d.jsxs("tr",{className:"hover:bg-white/5 transition-colors",children:[d.jsx("td",{className:"px-6 py-4",children:d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(I1,{className:"w-4 h-4 text-gray-500"}),d.jsx("span",{className:"font-medium text-white",children:ce.orderNumber||ce.id.slice(0,8)})]})}),d.jsx("td",{className:"px-6 py-4",children:d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(zi,{className:"w-4 h-4 text-gray-500"}),d.jsx("span",{className:"text-gray-300",children:ce.businessName})]})}),d.jsx("td",{className:"px-6 py-4",children:d.jsxs("div",{children:[d.jsx("div",{className:"text-white font-medium",children:((Ce=ce.customer)==null?void 0:Ce.name)||"N/A"}),d.jsx("div",{className:"text-xs text-gray-500",children:((it=ce.customer)==null?void 0:it.email)||""})]})}),d.jsx("td",{className:"px-6 py-4",children:d.jsx("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-blue-500/20 text-blue-400 border border-blue-500/30",children:Ie.type||"N/A"})}),d.jsx("td",{className:"px-6 py-4",children:d.jsxs("span",{className:`inline-flex items-center gap-1.5 px-3 py-1 text-xs font-medium rounded-full border ${me(be)}`,children:[ae(be),be.charAt(0).toUpperCase()+be.slice(1)]})}),d.jsx("td",{className:"px-6 py-4",children:Ie.trackingNumber?d.jsx("span",{className:"text-sm text-gray-300 font-mono",children:Ie.trackingNumber}):d.jsx("span",{className:"text-xs text-gray-500",children:"No tracking"})}),d.jsx("td",{className:"px-6 py-4 text-gray-400 text-sm",children:(He=ce.metadata)!=null&&He.createdAt?new Date(ce.metadata.createdAt).toLocaleDateString():ce.created_at?new Date(ce.created_at).toLocaleDateString():"N/A"}),d.jsx("td",{className:"px-6 py-4",children:d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("button",{onClick:()=>{T(ce),ke(!0)},className:"p-2 rounded-lg text-gray-400 hover:text-blue-400 hover:bg-blue-500/10 transition-all",title:"View Details",children:d.jsx(Qc,{className:"w-4 h-4"})}),d.jsx("button",{onClick:()=>{T(ce),se({status:Ie.status||"pending",trackingNumber:Ie.trackingNumber||"",notes:""}),Vt(!0)},className:"p-2 rounded-lg text-gray-400 hover:text-amber-400 hover:bg-amber-500/10 transition-all",title:"Update Fulfillment",children:d.jsx(Nd,{className:"w-4 h-4"})}),d.jsx("button",{onClick:()=>{ie(ce.id),F(ce.businessId),Z(""),$("order"),je(new Set),L(!0)},className:"p-2 rounded-lg text-gray-400 hover:text-purple-400 hover:bg-purple-500/10 transition-all",title:`Scan Products for Order ${ce.orderNumber}`,children:d.jsx(Bu,{className:"w-4 h-4"})})]})})]},ce.id)})})]})})}),fe&&E&&d.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:d.jsxs("div",{className:"bg-[#1a1b3e] border border-white/10 rounded-2xl p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[d.jsxs("div",{className:"flex items-center justify-between mb-6",children:[d.jsxs("div",{children:[d.jsx("h2",{className:"text-2xl font-bold text-white",children:"Order Details"}),d.jsxs("p",{className:"text-gray-400 mt-1",children:["Order #",E.orderNumber||E.id.slice(0,8)]})]}),d.jsx("button",{onClick:()=>{ke(!1),T(null)},className:"p-2 rounded-lg text-gray-400 hover:text-white hover:bg-white/10 transition-all",children:d.jsx(Ar,{className:"w-5 h-5"})})]}),d.jsxs("div",{className:"space-y-6",children:[d.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[d.jsxs("div",{className:"bg-white/5 rounded-xl p-4 border border-white/10",children:[d.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[d.jsx(zi,{className:"w-4 h-4 text-amber-400"}),d.jsx("span",{className:"text-xs text-gray-400 uppercase",children:"Business"})]}),d.jsx("p",{className:"text-white font-medium",children:E.businessName})]}),d.jsxs("div",{className:"bg-white/5 rounded-xl p-4 border border-white/10",children:[d.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[d.jsx(B2,{className:"w-4 h-4 text-amber-400"}),d.jsx("span",{className:"text-xs text-gray-400 uppercase",children:"Customer"})]}),d.jsx("p",{className:"text-white font-medium",children:((Ke=E.customer)==null?void 0:Ke.name)||"N/A"}),d.jsx("p",{className:"text-xs text-gray-500 mt-1",children:((dn=E.customer)==null?void 0:dn.email)||""})]})]}),d.jsxs("div",{className:"bg-white/5 rounded-xl p-4 border border-white/10",children:[d.jsx("h3",{className:"text-sm font-semibold text-white mb-3",children:"Order Items"}),d.jsx("div",{className:"space-y-2",children:(tt=E.items)==null?void 0:tt.map((ce,Ie)=>{var be,Ce;return d.jsxs("div",{className:"flex items-center justify-between p-2 bg-white/5 rounded-lg",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-sm text-white",children:ce.productName}),d.jsxs("p",{className:"text-xs text-gray-500",children:["Qty: ",ce.quantity,"  $",(be=ce.price)==null?void 0:be.toFixed(2)]})]}),d.jsxs("p",{className:"text-sm font-medium text-white",children:["$",(Ce=ce.subtotal)==null?void 0:Ce.toFixed(2)]})]},Ie)})}),d.jsxs("div",{className:"mt-4 pt-4 border-t border-white/10 flex justify-between",children:[d.jsx("span",{className:"text-sm text-gray-400",children:"Total"}),d.jsxs("span",{className:"text-lg font-bold text-white",children:["$",((jt=(ot=E.financials)==null?void 0:ot.total)==null?void 0:jt.toFixed(2))||"0.00"]})]})]}),d.jsxs("div",{className:"bg-white/5 rounded-xl p-4 border border-white/10",children:[d.jsx("h3",{className:"text-sm font-semibold text-white mb-3",children:"Fulfillment Information"}),d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("span",{className:"text-sm text-gray-400",children:"Status"}),d.jsxs("span",{className:`inline-flex items-center gap-1.5 px-3 py-1 text-xs font-medium rounded-full border ${me(((Kt=E.fulfillment)==null?void 0:Kt.status)||"pending")}`,children:[ae(((ar=E.fulfillment)==null?void 0:ar.status)||"pending"),(((Xt=E.fulfillment)==null?void 0:Xt.status)||"pending").charAt(0).toUpperCase()+(((xn=E.fulfillment)==null?void 0:xn.status)||"pending").slice(1)]})]}),d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("span",{className:"text-sm text-gray-400",children:"Type"}),d.jsx("span",{className:"text-sm text-white",children:((Mt=E.fulfillment)==null?void 0:Mt.type)||"N/A"})]}),((we=E.fulfillment)==null?void 0:we.trackingNumber)&&d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("span",{className:"text-sm text-gray-400",children:"Tracking Number"}),d.jsx("span",{className:"text-sm text-white font-mono",children:E.fulfillment.trackingNumber})]}),((Tt=E.fulfillment)==null?void 0:Tt.address)&&d.jsxs("div",{className:"flex items-start justify-between gap-4",children:[d.jsx("span",{className:"text-sm text-gray-400",children:"Address"}),d.jsx("span",{className:"text-sm text-white text-right",children:E.fulfillment.address})]}),((Rt=E.fulfillment)==null?void 0:Rt.shippedAt)&&d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("span",{className:"text-sm text-gray-400",children:"Shipped At"}),d.jsx("span",{className:"text-sm text-white",children:new Date(E.fulfillment.shippedAt).toLocaleString()})]}),((wt=E.fulfillment)==null?void 0:wt.deliveredAt)&&d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("span",{className:"text-sm text-gray-400",children:"Delivered At"}),d.jsx("span",{className:"text-sm text-white",children:new Date(E.fulfillment.deliveredAt).toLocaleString()})]})]})]})]})]})}),Ve&&E&&d.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:d.jsxs("div",{className:"bg-[#1a1b3e] border border-white/10 rounded-2xl p-6 max-w-md w-full",children:[d.jsxs("div",{className:"flex items-center justify-between mb-6",children:[d.jsx("h2",{className:"text-xl font-bold text-white",children:"Update Fulfillment"}),d.jsx("button",{onClick:()=>{Vt(!1),T(null)},className:"p-2 rounded-lg text-gray-400 hover:text-white hover:bg-white/10 transition-all",children:d.jsx(Ar,{className:"w-5 h-5"})})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Order Number"}),d.jsx("input",{type:"text",value:E.orderNumber||E.id.slice(0,8),disabled:!0,className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-gray-400"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Fulfillment Status"}),d.jsxs("select",{value:xe.status,onChange:ce=>se({...xe,status:ce.target.value}),className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white focus:outline-none focus:border-amber-500/50",children:[d.jsx("option",{value:"pending",children:"Pending"}),d.jsx("option",{value:"ready_for_pickup",children:"Ready for Pickup"}),d.jsx("option",{value:"shipped",children:"Shipped"}),d.jsx("option",{value:"delivered",children:"Delivered"}),d.jsx("option",{value:"returned",children:"Returned"}),d.jsx("option",{value:"damaged",children:"Damaged"}),d.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),d.jsxs("div",{children:[d.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Tracking Number"}),d.jsx("input",{type:"text",value:xe.trackingNumber,onChange:ce=>se({...xe,trackingNumber:ce.target.value}),placeholder:"Enter tracking number (optional)",className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:border-amber-500/50"})]}),d.jsxs("div",{className:"flex gap-3 pt-4",children:[d.jsx("button",{onClick:()=>{Vt(!1),T(null)},className:"flex-1 px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-gray-300 hover:bg-white/10 transition-all",children:"Cancel"}),d.jsx("button",{onClick:ht,disabled:qt,className:"flex-1 px-4 py-3 bg-gradient-to-r from-amber-400 to-amber-500 text-[#0a0b1a] font-semibold rounded-xl hover:from-amber-300 hover:to-amber-400 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:qt?d.jsxs("span",{className:"flex items-center justify-center gap-2",children:[d.jsx("div",{className:"w-4 h-4 border-2 border-[#0a0b1a] border-t-transparent rounded-full animate-spin"}),"Updating..."]}):d.jsxs("span",{className:"flex items-center justify-center gap-2",children:[d.jsx(og,{className:"w-4 h-4"}),"Update Fulfillment"]})})]})]})]})}),k&&d.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-4 overflow-y-auto",children:d.jsxs("div",{className:"bg-[#1a1b3e] border border-white/10 rounded-2xl p-4 sm:p-6 max-w-md w-full my-4",children:[d.jsxs("div",{className:"flex items-center justify-between mb-6",children:[d.jsxs("div",{children:[d.jsx("h2",{className:"text-2xl font-bold text-white",children:"Scan Barcode"}),d.jsx("p",{className:"text-gray-400 mt-1",children:R&&O?(()=>{var Ce;const ce=e.find(it=>it.id===R),Ie=((Ce=ce==null?void 0:ce.items)==null?void 0:Ce.length)||0,be=te.size;return`Scanning products for Order ${(ce==null?void 0:ce.orderNumber)||R.slice(0,8)} (${be}/${Ie} items scanned)`})():O?`Scanning for: ${((bt=e.find(ce=>ce.businessId===O))==null?void 0:bt.businessName)||O.slice(0,8)}`:"Scan or enter barcode to log fulfillment action"})]}),d.jsx("button",{onClick:()=>{Oe(),L(!1),Z(""),$("order"),F(null),ie(null),je(new Set)},className:"p-2 rounded-lg text-gray-400 hover:text-white hover:bg-white/10 transition-all",children:d.jsx(Ar,{className:"w-5 h-5"})})]}),d.jsxs("div",{className:"space-y-4",children:[d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-medium text-gray-400 mb-2 block",children:"Scan Type"}),d.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[d.jsxs("button",{onClick:()=>$("order"),className:`px-4 py-3 rounded-xl border transition-all ${U==="order"?"bg-blue-500/20 border-blue-500/30 text-blue-400":"bg-white/5 border-white/10 text-gray-300 hover:bg-white/10"}`,children:[d.jsx(bi,{className:"w-5 h-5 mx-auto mb-1"}),d.jsx("span",{className:"text-xs",children:"Order"})]}),d.jsxs("button",{onClick:()=>$("return"),className:`px-4 py-3 rounded-xl border transition-all ${U==="return"?"bg-emerald-500/20 border-emerald-500/30 text-emerald-400":"bg-white/5 border-white/10 text-gray-300 hover:bg-white/10"}`,children:[d.jsx(Fi,{className:"w-5 h-5 mx-auto mb-1"}),d.jsx("span",{className:"text-xs",children:"Return"})]}),d.jsxs("button",{onClick:()=>$("damaged"),className:`px-4 py-3 rounded-xl border transition-all ${U==="damaged"?"bg-red-500/20 border-red-500/30 text-red-400":"bg-white/5 border-white/10 text-gray-300 hover:bg-white/10"}`,children:[d.jsx(Ui,{className:"w-5 h-5 mx-auto mb-1"}),d.jsx("span",{className:"text-xs",children:"Damaged"})]})]})]}),d.jsxs("div",{className:"relative bg-black rounded-xl overflow-hidden",style:{display:"block",minHeight:"300px",height:"300px",width:"100%"},children:[d.jsx("div",{ref:ce=>{rt.current=ce,ce&&(ce.id="html5qr-code-full-region",console.log("[FulfillmentPage] Container ref set:",ce.id,"isConnected:",ce.isConnected,"parent:",ce.parentElement))},id:"html5qr-code-full-region",className:"w-full h-full",style:{minHeight:"300px",height:"300px",width:"100%",display:"block"}}),N&&d.jsx("div",{className:"absolute top-4 left-4 right-4 bg-red-500/90 text-white p-3 rounded-lg text-sm z-10",children:N}),!N&&d.jsx("div",{className:"absolute bottom-4 left-0 right-0 text-center text-white text-sm bg-black/50 px-4 py-2 z-10",children:"Position barcode within the scanning frame"})]}),d.jsxs("div",{children:[d.jsx("label",{className:"text-sm font-medium text-gray-400 mb-2 block",children:"Barcode / Order Number"}),d.jsx("input",{"data-barcode-input":!0,type:"text",value:K,onChange:ce=>{Z(ce.target.value),et.current=""},onKeyPress:ce=>{ce.key==="Enter"&&st()},placeholder:"Camera will auto-detect barcode or enter manually...",className:"w-full px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-amber-500/50 focus:border-amber-500/50",autoFocus:!1}),K&&d.jsxs("p",{className:"text-xs text-amber-400 mt-2 flex items-center gap-1",children:[d.jsx(Ur,{className:"w-3 h-3"}),"Barcode detected: ",K]})]}),d.jsxs("div",{className:"flex gap-3 pt-4",children:[d.jsx("button",{onClick:()=>{Oe(),L(!1),Z(""),$("order"),D(null),F(null),ie(null),je(new Set)},className:"flex-1 px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-gray-300 hover:bg-white/10 transition-all",children:"Cancel"}),d.jsx("button",{"data-scan-button":!0,onClick:st,disabled:A||!K.trim(),className:"flex-1 px-4 py-3 bg-gradient-to-r from-amber-400 to-amber-500 text-[#0a0b1a] font-semibold rounded-xl hover:from-amber-300 hover:to-amber-400 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:A?d.jsxs("span",{className:"flex items-center justify-center gap-2",children:[d.jsx("div",{className:"w-4 h-4 border-2 border-[#0a0b1a] border-t-transparent rounded-full animate-spin"}),"Scanning..."]}):d.jsxs("span",{className:"flex items-center justify-center gap-2",children:[d.jsx(_K,{className:"w-4 h-4"}),"Process Scan"]})})]})]})]})}),B&&d.jsx("div",{className:"fixed inset-0 bg-black/70 backdrop-blur-sm flex items-center justify-center z-50 p-2 sm:p-4 overflow-y-auto",children:d.jsxs("div",{className:"bg-[#1a1b3e] border border-white/10 rounded-2xl p-4 sm:p-6 max-w-6xl w-full max-h-[90vh] overflow-y-auto my-4",children:[d.jsxs("div",{className:"flex items-center justify-between mb-6",children:[d.jsxs("div",{children:[d.jsx("h2",{className:"text-2xl font-bold text-white",children:"Scan Logs"}),d.jsx("p",{className:"text-gray-400 mt-1",children:"View all scan activities across all businesses"})]}),d.jsx("button",{onClick:()=>H(!1),className:"p-2 rounded-lg text-gray-400 hover:text-white hover:bg-white/10 transition-all",children:d.jsx(Ar,{className:"w-5 h-5"})})]}),r?d.jsxs("div",{className:"text-center py-12",children:[d.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-amber-400"}),d.jsx("p",{className:"text-gray-400 mt-4",children:"Loading scan logs..."})]}):W.length===0?d.jsxs("div",{className:"text-center py-12",children:[d.jsx(ET,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),d.jsx("p",{className:"text-gray-400 text-lg",children:"No scan logs found"}),d.jsx("p",{className:"text-gray-500 text-sm mt-2",children:"Scan logs will appear here after scanning barcodes"})]}):d.jsx("div",{className:"overflow-x-auto",children:d.jsxs("table",{className:"w-full min-w-[700px]",children:[d.jsx("thead",{children:d.jsxs("tr",{className:"bg-white/5 border-b border-white/10",children:[d.jsx("th",{className:"text-left text-xs font-medium text-gray-400 uppercase px-2 sm:px-4 py-2 sm:py-3",children:"Date"}),d.jsx("th",{className:"text-left text-xs font-medium text-gray-400 uppercase px-2 sm:px-4 py-2 sm:py-3 hidden sm:table-cell",children:"Business"}),d.jsx("th",{className:"text-left text-xs font-medium text-gray-400 uppercase px-2 sm:px-4 py-2 sm:py-3",children:"Order #"}),d.jsx("th",{className:"text-left text-xs font-medium text-gray-400 uppercase px-2 sm:px-4 py-2 sm:py-3 hidden md:table-cell",children:"Barcode"}),d.jsx("th",{className:"text-left text-xs font-medium text-gray-400 uppercase px-2 sm:px-4 py-2 sm:py-3",children:"Type"}),d.jsx("th",{className:"text-left text-xs font-medium text-gray-400 uppercase px-2 sm:px-4 py-2 sm:py-3 hidden lg:table-cell",children:"Customer"}),d.jsx("th",{className:"text-left text-xs font-medium text-gray-400 uppercase px-2 sm:px-4 py-2 sm:py-3 hidden lg:table-cell",children:"Scanned By"})]})}),d.jsx("tbody",{className:"divide-y divide-white/5",children:W.map(ce=>{var Ce,it,He;const Ie=(Ce=ce.timestamp)!=null&&Ce.toDate?ce.timestamp.toDate():new Date(ce.timestamp||0),be={order:"bg-blue-500/20 text-blue-400 border-blue-500/30",return:"bg-emerald-500/20 text-emerald-400 border-emerald-500/30",damaged:"bg-red-500/20 text-red-400 border-red-500/30"};return d.jsxs("tr",{className:"hover:bg-white/5 transition-colors",children:[d.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:Ie.toLocaleString()}),d.jsx("td",{className:"px-4 py-3 text-sm text-white",children:ce.businessName}),d.jsx("td",{className:"px-4 py-3 text-sm text-white font-mono",children:ce.orderNumber||"N/A"}),d.jsx("td",{className:"px-4 py-3 text-sm text-gray-300 font-mono",children:ce.barcode}),d.jsx("td",{className:"px-4 py-3",children:d.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 text-xs font-medium rounded-full border ${be[ce.type]||"bg-gray-500/20 text-gray-400 border-gray-500/30"}`,children:[ce.type==="order"&&d.jsx(bi,{className:"w-3 h-3"}),ce.type==="return"&&d.jsx(Fi,{className:"w-3 h-3"}),ce.type==="damaged"&&d.jsx(Ui,{className:"w-3 h-3"}),((it=ce.type)==null?void 0:it.charAt(0).toUpperCase())+((He=ce.type)==null?void 0:He.slice(1))||"Unknown"]})}),d.jsx("td",{className:"px-4 py-3 text-sm text-gray-300",children:ce.customer||"N/A"}),d.jsx("td",{className:"px-4 py-3 text-sm text-gray-400",children:ce.scannedBy||"Unknown"})]},ce.id)})})]})})]})})]})})}function ma(t){const e=Object.prototype.toString.call(t);return t instanceof Date||typeof t=="object"&&e==="[object Date]"?new t.constructor(+t):typeof t=="number"||e==="[object Number]"||typeof t=="string"||e==="[object String]"?new Date(t):new Date(NaN)}function Zc(t,e){return t instanceof Date?new t.constructor(e):new Date(e)}const fD=6048e5,lX=864e5;let cX={};function A1(){return cX}function Wf(t,e){var h,p,y,_;const n=A1(),r=(e==null?void 0:e.weekStartsOn)??((p=(h=e==null?void 0:e.locale)==null?void 0:h.options)==null?void 0:p.weekStartsOn)??n.weekStartsOn??((_=(y=n.locale)==null?void 0:y.options)==null?void 0:_.weekStartsOn)??0,s=ma(t),i=s.getDay(),l=(i<r?7:0)+i-r;return s.setDate(s.getDate()-l),s.setHours(0,0,0,0),s}function hg(t){return Wf(t,{weekStartsOn:1})}function mD(t){const e=ma(t),n=e.getFullYear(),r=Zc(t,0);r.setFullYear(n+1,0,4),r.setHours(0,0,0,0);const s=hg(r),i=Zc(t,0);i.setFullYear(n,0,4),i.setHours(0,0,0,0);const l=hg(i);return e.getTime()>=s.getTime()?n+1:e.getTime()>=l.getTime()?n:n-1}function $T(t){const e=ma(t);return e.setHours(0,0,0,0),e}function zT(t){const e=ma(t),n=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return n.setUTCFullYear(e.getFullYear()),+t-+n}function uX(t,e){const n=$T(t),r=$T(e),s=+n-zT(n),i=+r-zT(r);return Math.round((s-i)/lX)}function dX(t){const e=mD(t),n=Zc(t,0);return n.setFullYear(e,0,4),n.setHours(0,0,0,0),hg(n)}function hX(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function fX(t){if(!hX(t)&&typeof t!="number")return!1;const e=ma(t);return!isNaN(Number(e))}function mX(t){const e=ma(t),n=Zc(t,0);return n.setFullYear(e.getFullYear(),0,1),n.setHours(0,0,0,0),n}const pX={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},gX=(t,e,n)=>{let r;const s=pX[t];return typeof s=="string"?r=s:e===1?r=s.one:r=s.other.replace("{{count}}",e.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+r:r+" ago":r};function Py(t){return(e={})=>{const n=e.width?String(e.width):t.defaultWidth;return t.formats[n]||t.formats[t.defaultWidth]}}const yX={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},xX={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},wX={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},_X={date:Py({formats:yX,defaultWidth:"full"}),time:Py({formats:xX,defaultWidth:"full"}),dateTime:Py({formats:wX,defaultWidth:"full"})},vX={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},EX=(t,e,n,r)=>vX[t];function uh(t){return(e,n)=>{const r=n!=null&&n.context?String(n.context):"standalone";let s;if(r==="formatting"&&t.formattingValues){const l=t.defaultFormattingWidth||t.defaultWidth,h=n!=null&&n.width?String(n.width):l;s=t.formattingValues[h]||t.formattingValues[l]}else{const l=t.defaultWidth,h=n!=null&&n.width?String(n.width):t.defaultWidth;s=t.values[h]||t.values[l]}const i=t.argumentCallback?t.argumentCallback(e):e;return s[i]}}const bX={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},IX={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},AX={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},TX={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},CX={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},SX={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},NX=(t,e)=>{const n=Number(t),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},RX={ordinalNumber:NX,era:uh({values:bX,defaultWidth:"wide"}),quarter:uh({values:IX,defaultWidth:"wide",argumentCallback:t=>t-1}),month:uh({values:AX,defaultWidth:"wide"}),day:uh({values:TX,defaultWidth:"wide"}),dayPeriod:uh({values:CX,defaultWidth:"wide",formattingValues:SX,defaultFormattingWidth:"wide"})};function dh(t){return(e,n={})=>{const r=n.width,s=r&&t.matchPatterns[r]||t.matchPatterns[t.defaultMatchWidth],i=e.match(s);if(!i)return null;const l=i[0],h=r&&t.parsePatterns[r]||t.parsePatterns[t.defaultParseWidth],p=Array.isArray(h)?kX(h,E=>E.test(l)):PX(h,E=>E.test(l));let y;y=t.valueCallback?t.valueCallback(p):p,y=n.valueCallback?n.valueCallback(y):y;const _=e.slice(l.length);return{value:y,rest:_}}}function PX(t,e){for(const n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&e(t[n]))return n}function kX(t,e){for(let n=0;n<t.length;n++)if(e(t[n]))return n}function DX(t){return(e,n={})=>{const r=e.match(t.matchPattern);if(!r)return null;const s=r[0],i=e.match(t.parsePattern);if(!i)return null;let l=t.valueCallback?t.valueCallback(i[0]):i[0];l=n.valueCallback?n.valueCallback(l):l;const h=e.slice(s.length);return{value:l,rest:h}}}const OX=/^(\d+)(th|st|nd|rd)?/i,MX=/\d+/i,LX={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},jX={any:[/^b/i,/^(a|c)/i]},FX={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},VX={any:[/1/i,/2/i,/3/i,/4/i]},BX={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},UX={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},$X={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},zX={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},WX={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},HX={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},GX={ordinalNumber:DX({matchPattern:OX,parsePattern:MX,valueCallback:t=>parseInt(t,10)}),era:dh({matchPatterns:LX,defaultMatchWidth:"wide",parsePatterns:jX,defaultParseWidth:"any"}),quarter:dh({matchPatterns:FX,defaultMatchWidth:"wide",parsePatterns:VX,defaultParseWidth:"any",valueCallback:t=>t+1}),month:dh({matchPatterns:BX,defaultMatchWidth:"wide",parsePatterns:UX,defaultParseWidth:"any"}),day:dh({matchPatterns:$X,defaultMatchWidth:"wide",parsePatterns:zX,defaultParseWidth:"any"}),dayPeriod:dh({matchPatterns:WX,defaultMatchWidth:"any",parsePatterns:HX,defaultParseWidth:"any"})},qX={code:"en-US",formatDistance:gX,formatLong:_X,formatRelative:EX,localize:RX,match:GX,options:{weekStartsOn:0,firstWeekContainsDate:1}};function KX(t){const e=ma(t);return uX(e,mX(e))+1}function XX(t){const e=ma(t),n=+hg(e)-+dX(e);return Math.round(n/fD)+1}function pD(t,e){var _,E,T,k;const n=ma(t),r=n.getFullYear(),s=A1(),i=(e==null?void 0:e.firstWeekContainsDate)??((E=(_=e==null?void 0:e.locale)==null?void 0:_.options)==null?void 0:E.firstWeekContainsDate)??s.firstWeekContainsDate??((k=(T=s.locale)==null?void 0:T.options)==null?void 0:k.firstWeekContainsDate)??1,l=Zc(t,0);l.setFullYear(r+1,0,i),l.setHours(0,0,0,0);const h=Wf(l,e),p=Zc(t,0);p.setFullYear(r,0,i),p.setHours(0,0,0,0);const y=Wf(p,e);return n.getTime()>=h.getTime()?r+1:n.getTime()>=y.getTime()?r:r-1}function QX(t,e){var h,p,y,_;const n=A1(),r=(e==null?void 0:e.firstWeekContainsDate)??((p=(h=e==null?void 0:e.locale)==null?void 0:h.options)==null?void 0:p.firstWeekContainsDate)??n.firstWeekContainsDate??((_=(y=n.locale)==null?void 0:y.options)==null?void 0:_.firstWeekContainsDate)??1,s=pD(t,e),i=Zc(t,0);return i.setFullYear(s,0,r),i.setHours(0,0,0,0),Wf(i,e)}function YX(t,e){const n=ma(t),r=+Wf(n,e)-+QX(n,e);return Math.round(r/fD)+1}function qn(t,e){const n=t<0?"-":"",r=Math.abs(t).toString().padStart(e,"0");return n+r}const qo={y(t,e){const n=t.getFullYear(),r=n>0?n:1-n;return qn(e==="yy"?r%100:r,e.length)},M(t,e){const n=t.getMonth();return e==="M"?String(n+1):qn(n+1,2)},d(t,e){return qn(t.getDate(),e.length)},a(t,e){const n=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(t,e){return qn(t.getHours()%12||12,e.length)},H(t,e){return qn(t.getHours(),e.length)},m(t,e){return qn(t.getMinutes(),e.length)},s(t,e){return qn(t.getSeconds(),e.length)},S(t,e){const n=e.length,r=t.getMilliseconds(),s=Math.trunc(r*Math.pow(10,n-3));return qn(s,e.length)}},pu={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},WT={G:function(t,e,n){const r=t.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return n.era(r,{width:"abbreviated"});case"GGGGG":return n.era(r,{width:"narrow"});case"GGGG":default:return n.era(r,{width:"wide"})}},y:function(t,e,n){if(e==="yo"){const r=t.getFullYear(),s=r>0?r:1-r;return n.ordinalNumber(s,{unit:"year"})}return qo.y(t,e)},Y:function(t,e,n,r){const s=pD(t,r),i=s>0?s:1-s;if(e==="YY"){const l=i%100;return qn(l,2)}return e==="Yo"?n.ordinalNumber(i,{unit:"year"}):qn(i,e.length)},R:function(t,e){const n=mD(t);return qn(n,e.length)},u:function(t,e){const n=t.getFullYear();return qn(n,e.length)},Q:function(t,e,n){const r=Math.ceil((t.getMonth()+1)/3);switch(e){case"Q":return String(r);case"QQ":return qn(r,2);case"Qo":return n.ordinalNumber(r,{unit:"quarter"});case"QQQ":return n.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(r,{width:"wide",context:"formatting"})}},q:function(t,e,n){const r=Math.ceil((t.getMonth()+1)/3);switch(e){case"q":return String(r);case"qq":return qn(r,2);case"qo":return n.ordinalNumber(r,{unit:"quarter"});case"qqq":return n.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(r,{width:"wide",context:"standalone"})}},M:function(t,e,n){const r=t.getMonth();switch(e){case"M":case"MM":return qo.M(t,e);case"Mo":return n.ordinalNumber(r+1,{unit:"month"});case"MMM":return n.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(r,{width:"wide",context:"formatting"})}},L:function(t,e,n){const r=t.getMonth();switch(e){case"L":return String(r+1);case"LL":return qn(r+1,2);case"Lo":return n.ordinalNumber(r+1,{unit:"month"});case"LLL":return n.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(r,{width:"wide",context:"standalone"})}},w:function(t,e,n,r){const s=YX(t,r);return e==="wo"?n.ordinalNumber(s,{unit:"week"}):qn(s,e.length)},I:function(t,e,n){const r=XX(t);return e==="Io"?n.ordinalNumber(r,{unit:"week"}):qn(r,e.length)},d:function(t,e,n){return e==="do"?n.ordinalNumber(t.getDate(),{unit:"date"}):qo.d(t,e)},D:function(t,e,n){const r=KX(t);return e==="Do"?n.ordinalNumber(r,{unit:"dayOfYear"}):qn(r,e.length)},E:function(t,e,n){const r=t.getDay();switch(e){case"E":case"EE":case"EEE":return n.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(r,{width:"short",context:"formatting"});case"EEEE":default:return n.day(r,{width:"wide",context:"formatting"})}},e:function(t,e,n,r){const s=t.getDay(),i=(s-r.weekStartsOn+8)%7||7;switch(e){case"e":return String(i);case"ee":return qn(i,2);case"eo":return n.ordinalNumber(i,{unit:"day"});case"eee":return n.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(s,{width:"short",context:"formatting"});case"eeee":default:return n.day(s,{width:"wide",context:"formatting"})}},c:function(t,e,n,r){const s=t.getDay(),i=(s-r.weekStartsOn+8)%7||7;switch(e){case"c":return String(i);case"cc":return qn(i,e.length);case"co":return n.ordinalNumber(i,{unit:"day"});case"ccc":return n.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(s,{width:"narrow",context:"standalone"});case"cccccc":return n.day(s,{width:"short",context:"standalone"});case"cccc":default:return n.day(s,{width:"wide",context:"standalone"})}},i:function(t,e,n){const r=t.getDay(),s=r===0?7:r;switch(e){case"i":return String(s);case"ii":return qn(s,e.length);case"io":return n.ordinalNumber(s,{unit:"day"});case"iii":return n.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(r,{width:"short",context:"formatting"});case"iiii":default:return n.day(r,{width:"wide",context:"formatting"})}},a:function(t,e,n){const s=t.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(t,e,n){const r=t.getHours();let s;switch(r===12?s=pu.noon:r===0?s=pu.midnight:s=r/12>=1?"pm":"am",e){case"b":case"bb":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(t,e,n){const r=t.getHours();let s;switch(r>=17?s=pu.evening:r>=12?s=pu.afternoon:r>=4?s=pu.morning:s=pu.night,e){case"B":case"BB":case"BBB":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(t,e,n){if(e==="ho"){let r=t.getHours()%12;return r===0&&(r=12),n.ordinalNumber(r,{unit:"hour"})}return qo.h(t,e)},H:function(t,e,n){return e==="Ho"?n.ordinalNumber(t.getHours(),{unit:"hour"}):qo.H(t,e)},K:function(t,e,n){const r=t.getHours()%12;return e==="Ko"?n.ordinalNumber(r,{unit:"hour"}):qn(r,e.length)},k:function(t,e,n){let r=t.getHours();return r===0&&(r=24),e==="ko"?n.ordinalNumber(r,{unit:"hour"}):qn(r,e.length)},m:function(t,e,n){return e==="mo"?n.ordinalNumber(t.getMinutes(),{unit:"minute"}):qo.m(t,e)},s:function(t,e,n){return e==="so"?n.ordinalNumber(t.getSeconds(),{unit:"second"}):qo.s(t,e)},S:function(t,e){return qo.S(t,e)},X:function(t,e,n){const r=t.getTimezoneOffset();if(r===0)return"Z";switch(e){case"X":return GT(r);case"XXXX":case"XX":return cc(r);case"XXXXX":case"XXX":default:return cc(r,":")}},x:function(t,e,n){const r=t.getTimezoneOffset();switch(e){case"x":return GT(r);case"xxxx":case"xx":return cc(r);case"xxxxx":case"xxx":default:return cc(r,":")}},O:function(t,e,n){const r=t.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+HT(r,":");case"OOOO":default:return"GMT"+cc(r,":")}},z:function(t,e,n){const r=t.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+HT(r,":");case"zzzz":default:return"GMT"+cc(r,":")}},t:function(t,e,n){const r=Math.trunc(t.getTime()/1e3);return qn(r,e.length)},T:function(t,e,n){const r=t.getTime();return qn(r,e.length)}};function HT(t,e=""){const n=t>0?"-":"+",r=Math.abs(t),s=Math.trunc(r/60),i=r%60;return i===0?n+String(s):n+String(s)+e+qn(i,2)}function GT(t,e){return t%60===0?(t>0?"-":"+")+qn(Math.abs(t)/60,2):cc(t,e)}function cc(t,e=""){const n=t>0?"-":"+",r=Math.abs(t),s=qn(Math.trunc(r/60),2),i=qn(r%60,2);return n+s+e+i}const qT=(t,e)=>{switch(t){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},gD=(t,e)=>{switch(t){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},ZX=(t,e)=>{const n=t.match(/(P+)(p+)?/)||[],r=n[1],s=n[2];if(!s)return qT(t,e);let i;switch(r){case"P":i=e.dateTime({width:"short"});break;case"PP":i=e.dateTime({width:"medium"});break;case"PPP":i=e.dateTime({width:"long"});break;case"PPPP":default:i=e.dateTime({width:"full"});break}return i.replace("{{date}}",qT(r,e)).replace("{{time}}",gD(s,e))},JX={p:gD,P:ZX},eQ=/^D+$/,tQ=/^Y+$/,nQ=["D","DD","YY","YYYY"];function rQ(t){return eQ.test(t)}function sQ(t){return tQ.test(t)}function iQ(t,e,n){const r=aQ(t,e,n);if(console.warn(r),nQ.includes(t))throw new RangeError(r)}function aQ(t,e,n){const r=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${e}\`) for formatting ${r} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const oQ=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,lQ=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,cQ=/^'([^]*?)'?$/,uQ=/''/g,dQ=/[a-zA-Z]/;function z2(t,e,n){var _,E,T,k;const r=A1(),s=r.locale??qX,i=r.firstWeekContainsDate??((E=(_=r.locale)==null?void 0:_.options)==null?void 0:E.firstWeekContainsDate)??1,l=r.weekStartsOn??((k=(T=r.locale)==null?void 0:T.options)==null?void 0:k.weekStartsOn)??0,h=ma(t);if(!fX(h))throw new RangeError("Invalid time value");let p=e.match(lQ).map(L=>{const B=L[0];if(B==="p"||B==="P"){const H=JX[B];return H(L,s.formatLong)}return L}).join("").match(oQ).map(L=>{if(L==="''")return{isToken:!1,value:"'"};const B=L[0];if(B==="'")return{isToken:!1,value:hQ(L)};if(WT[B])return{isToken:!0,value:L};if(B.match(dQ))throw new RangeError("Format string contains an unescaped latin alphabet character `"+B+"`");return{isToken:!1,value:L}});s.localize.preprocessor&&(p=s.localize.preprocessor(h,p));const y={firstWeekContainsDate:i,weekStartsOn:l,locale:s};return p.map(L=>{if(!L.isToken)return L.value;const B=L.value;(sQ(B)||rQ(B))&&iQ(B,e,String(t));const H=WT[B[0]];return H(h,B,s.localize,y)}).join("")}function hQ(t){const e=t.match(cQ);return e?e[1].replace(uQ,"'"):t}function fQ(){var je,We,Ee,qe,et,Lt,Qe,rt;const{user:t}=Gs(),[e,n]=q.useState([]),[r,s]=q.useState(!0),[i,l]=q.useState(""),[h,p]=q.useState(null),[y,_]=q.useState(!1),[E,T]=q.useState(!1),[k,L]=q.useState(new Set),[B,H]=q.useState(""),[W,M]=q.useState(!1),[U,$]=q.useState(!1),[K,Z]=q.useState(!1),[A,C]=q.useState(!1),N=q.useRef(null),D=async()=>{var pe,ve,fe;s(!0);try{const ke=[],Ve=await Cn(In(at,"businesses"));console.log(`[PendingOrdersPage] Found ${Ve.docs.length} total businesses`);for(const Vt of Ve.docs){const qt=Vt.id,yt=Vt.data(),xe=((pe=yt.features)==null?void 0:pe.fulfillment)===!0||((ve=yt.features)==null?void 0:ve.fulfillment_service)===!0||((fe=yt.features)==null?void 0:fe.fulfillmentService)===!0;if(console.log(`[PendingOrdersPage] Business ${qt} (${yt.businessName||yt.name}): fulfillment=${xe}`),!!xe)try{const se=In(at,"businesses",qt,"orders");let De;try{const Oe=Ii(se,xc("date","desc"));De=await Cn(Oe)}catch(Oe){console.warn(`[PendingOrdersPage] OrderBy failed for ${qt}, trying without order:`,Oe),De=await Cn(se)}console.log(`[PendingOrdersPage] Business ${qt}: found ${De.docs.length} orders`),De.docs.forEach(Oe=>{var Et,st;const Ge=Oe.data(),ht=((Et=Ge.fulfillment)==null?void 0:Et.status)||Ge.status||"pending";console.log(`[PendingOrdersPage] Order ${Oe.id}: status=${ht}`),ht==="pending"&&ke.push({id:Oe.id,orderId:Oe.id,orderNumber:Ge.orderNumber||`#${Oe.id.slice(0,6)}`,businessId:qt,businessName:yt.businessName||yt.name||"Unknown Business",customer:Ge.customer||{name:"Unknown",email:"",phone:""},fulfillment:Ge.fulfillment||{status:"pending"},financials:Ge.financials||{total:0},metadata:Ge.metadata||{},items:Ge.items||[],shippingAddress:Ge.shippingAddress||((st=Ge.shipping)==null?void 0:st.address)})})}catch(se){console.error(`[PendingOrdersPage] Error loading orders for business ${qt}:`,se)}}console.log(`[PendingOrdersPage] Total pending orders loaded: ${ke.length}`),n(ke)}catch(ke){console.error("[PendingOrdersPage] Error loading orders:",ke)}finally{s(!1)}};q.useEffect(()=>{D()},[]);const O=async()=>{var st,me,ae,ft,At,Ke,dn,tt,ot,jt,Kt,ar;if(!B.trim()||!h)return;M(!0);const pe=B.trim().toLowerCase(),ve=Xt=>Xt.toLowerCase().replace(/\s+/g,"").replace(/-/g,""),fe=ve(pe);let ke=-1,Ve=null,Vt=null,qt=null;const yt=[];try{const Xt=In(at,"businesses",h.businessId,"products"),xn=await Cn(Xt);for(const Mt of xn.docs){const we=Mt.data(),Tt=((st=we.barcode)==null?void 0:st.toString().toLowerCase())||"",Rt=((me=we.mainBarcode)==null?void 0:me.toString().toLowerCase())||"",wt=((ae=we.sku)==null?void 0:ae.toString().toLowerCase())||"";let bt;if(we.sizeBarcodes&&typeof we.sizeBarcodes=="object")for(const[Ie,be]of Object.entries(we.sizeBarcodes)){const Ce=(be==null?void 0:be.toString().toLowerCase())||"";if(Ce===pe||ve(Ce)===fe){bt=Ie;break}}if(!bt&&we.sizeVariants&&typeof we.sizeVariants=="object")for(const[Ie,be]of Object.entries(we.sizeVariants)){const Ce=((ft=be==null?void 0:be.barcode)==null?void 0:ft.toString().toLowerCase())||"";if(Ce===pe||ve(Ce)===fe){bt=Ie;break}}(Tt===pe||ve(Tt)===fe||Rt===pe||ve(Rt)===fe||wt===pe||ve(wt)===fe||bt)&&yt.push({id:Mt.id,data:we,matchedSize:bt})}}catch(Xt){console.warn("[PendingOrdersPage] Error searching products:",Xt)}for(let Xt=0;Xt<(((At=h.items)==null?void 0:At.length)||0);Xt++){const xn=h.items[Xt];if(k.has(Xt))continue;const Mt=((Ke=xn.barcode)==null?void 0:Ke.toString().toLowerCase())||"",we=((dn=xn.productId)==null?void 0:dn.toString())||"",Tt=we.toLowerCase(),Rt=xn.size||"",wt=Mt===pe||ve(Mt)===fe,bt=yt.find(ce=>{const Ie=Tt.startsWith(ce.id.toLowerCase())||Tt===ce.id.toLowerCase();return ce.matchedSize&&Rt?Ie&&ce.matchedSize.toLowerCase()===Rt.toLowerCase():Ie});if(wt||bt){ke=Xt,Ve=xn,Vt=(bt==null?void 0:bt.id)||we.split("_")[0]||null,bt!=null&&bt.data,qt=(bt==null?void 0:bt.matchedSize)||Rt||null;break}}if(ke===-1){alert(` Product not found in this order's items.
Barcode: ${B}`),H(""),M(!1);return}let xe=null,se=null,De=null;const Oe=Ve.quantity||1;if(Vt)try{const Xt=Bn(at,"businesses",h.businessId,"products",Vt),xn=await ri(Xt);if(xn.exists()){const Mt=xn.data();De=Mt.price||null;const we=Mt.stock||{},Tt=qt||Ve.size||"default";typeof we=="object"&&we[Tt]!==void 0?(xe=we[Tt],se=Math.max(0,xe-Oe),await ls(Xt,{[`stock.${Tt}`]:se}),console.log(`[PendingOrdersPage] Updated stock for ${Vt} size ${Tt}: ${xe} -> ${se}`)):typeof we=="number"&&(xe=we,se=Math.max(0,xe-Oe),await ls(Xt,{stock:se}),console.log(`[PendingOrdersPage] Updated total stock for ${Vt}: ${xe} -> ${se}`))}}catch(Xt){console.error("[PendingOrdersPage] Error updating stock:",Xt)}const Ge=new Set(k);Ge.add(ke),L(Ge);const ht=Ge.size>=(((tt=h.items)==null?void 0:tt.length)||0),Et=In(at,"businesses",h.businessId,"scan_log");if(await Wc(Et,{barcode:B,orderId:h.id,orderNumber:h.orderNumber,businessId:h.businessId,businessName:h.businessName,type:"order",itemIndex:ke,productName:Ve.productName||Ve.name||"Unknown",productId:Vt||Ve.productId||null,size:qt||Ve.size||Ve.selectedSize||Ve.variant||null,price:De??Ve.price??Ve.unitPrice??0,sellingPrice:Ve.price||Ve.unitPrice||0,quantity:Oe,previousStock:xe,newStock:se,stockUpdated:xe!==null,scannedItemsCount:Ge.size,totalItemsCount:((ot=h.items)==null?void 0:ot.length)||0,allItemsScanned:ht,timestamp:F0(),user:"XDIGIX",userId:"xdigix-fulfillment",adminEmail:(t==null?void 0:t.email)||"Unknown",adminUserId:(t==null?void 0:t.id)||null,orderStatus:ht?"ready_for_pickup":"pending",customer:((jt=h.customer)==null?void 0:jt.name)||"Unknown",notes:ht?"All items scanned - Order ready for pickup":`Item ${ke+1} of ${(Kt=h.items)==null?void 0:Kt.length} scanned`,source:"pending_orders_page"}),ht)try{const Xt=Bn(at,"businesses",h.businessId,"orders",h.id);await ls(Xt,{"fulfillment.status":"ready_for_pickup",status:"ready_for_pickup","metadata.updatedAt":new Date().toISOString()}),alert(` All items scanned!

Order ${h.orderNumber} is now Ready for Pickup!`),R(),T(!1),L(new Set),p(null),await D()}catch(Xt){console.error("[PendingOrdersPage] Error updating order:",Xt),alert(" Failed to update order status")}else{const Xt=xe!==null?`
Stock: ${xe}  ${se}`:"";alert(` Item scanned!${Xt}

Scanned: ${Ge.size} / ${(ar=h.items)==null?void 0:ar.length} items

Continue scanning remaining items.`),H("")}M(!1)},F=async()=>{var pe,ve,fe;Z(!0),await new Promise(ke=>setTimeout(ke,150));try{if(!document.getElementById("pending-scanner")){console.error("[PendingOrdersPage] Camera container not found"),alert("Camera container not found. Please try again."),Z(!1);return}if(N.current){try{await N.current.stop()}catch{}N.current=null}const Ve=new $2("pending-scanner");N.current=Ve,await Ve.start({facingMode:"environment"},{fps:10,qrbox:{width:250,height:150}},Vt=>{H(Vt),Ve.stop().catch(console.error),$(!1),Z(!1)},()=>{}),$(!0)}catch(ke){console.error("[PendingOrdersPage] Camera error:",ke),Z(!1),$(!1);let Ve="Failed to start camera.";(pe=ke.message)!=null&&pe.includes("Permission denied")||ke.name==="NotAllowedError"?Ve="Camera permission denied. Please allow camera access in your browser settings.":(ve=ke.message)!=null&&ve.includes("not found")||ke.name==="NotFoundError"?Ve="No camera found on this device.":(fe=ke.message)!=null&&fe.includes("insecure")||ke.name==="NotSupportedError"?Ve="Camera access requires HTTPS. Please use a secure connection.":ke.message&&(Ve=ke.message),alert(Ve)}},R=async()=>{if(N.current){try{await N.current.stop()}catch(pe){console.error("[PendingOrdersPage] Error stopping camera:",pe)}N.current=null}$(!1),Z(!1)},ie=e.filter(pe=>{var fe,ke,Ve,Vt,qt,yt;return((fe=pe.orderNumber)==null?void 0:fe.toLowerCase().includes(i.toLowerCase()))||((Ve=(ke=pe.customer)==null?void 0:ke.name)==null?void 0:Ve.toLowerCase().includes(i.toLowerCase()))||((qt=(Vt=pe.customer)==null?void 0:Vt.email)==null?void 0:qt.toLowerCase().includes(i.toLowerCase()))||((yt=pe.businessName)==null?void 0:yt.toLowerCase().includes(i.toLowerCase()))}),te=pe=>{if(!pe)return"N/A";try{return z2(new Date(pe),"MMM d, yyyy HH:mm")}catch{return"N/A"}};return d.jsx(cs,{permissions:["super_admin.manage_all_tenants","super_admin.view_analytics","super_admin.manage_subscriptions"],showError:!1,children:d.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[d.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6",children:[d.jsxs("div",{children:[d.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold text-white flex items-center gap-3",children:[d.jsx(Na,{className:"w-8 h-8 text-amber-400"}),"Pending Orders"]}),d.jsx("p",{className:"text-gray-400 mt-1",children:"Scan items to prepare orders for pickup"})]}),d.jsx("div",{className:"flex items-center gap-3",children:d.jsxs("button",{onClick:D,disabled:r,className:"flex items-center gap-2 px-4 py-2 bg-white/5 border border-white/10 rounded-xl text-gray-300 hover:bg-white/10 transition-colors disabled:opacity-50",children:[d.jsx(Wd,{className:`w-4 h-4 ${r?"animate-spin":""}`}),"Refresh"]})})]}),d.jsx("div",{className:"bg-gradient-to-r from-amber-500/20 to-orange-500/20 border border-amber-500/30 rounded-xl p-6 mb-6",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-gray-400 text-sm",children:"Total Pending Orders"}),d.jsx("p",{className:"text-4xl font-bold text-amber-400",children:e.length})]}),d.jsx(Na,{className:"w-16 h-16 text-amber-400/30"})]})}),d.jsx("div",{className:"bg-[#1a1b3e] border border-[#2d2f5a] rounded-xl p-5 mb-6",children:d.jsxs("div",{className:"relative",children:[d.jsx(Kl,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-500"}),d.jsx("input",{type:"text",value:i,onChange:pe=>l(pe.target.value),placeholder:"Search by order number, customer, business...",className:"w-full pl-10 pr-4 py-2.5 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:border-amber-500/50"})]})}),r?d.jsx("div",{className:"flex items-center justify-center py-16",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-amber-500 border-t-transparent"})}):ie.length===0?d.jsxs("div",{className:"bg-[#1a1b3e] border border-[#2d2f5a] rounded-xl p-12 text-center",children:[d.jsx(Na,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),d.jsx("h3",{className:"text-xl font-semibold text-white mb-2",children:"No Pending Orders"}),d.jsx("p",{className:"text-gray-400",children:"All orders have been processed"})]}):d.jsx("div",{className:"bg-[#1a1b3e] border border-[#2d2f5a] rounded-xl overflow-hidden",children:d.jsx("div",{className:"overflow-x-auto",children:d.jsxs("table",{className:"w-full",children:[d.jsx("thead",{className:"bg-[#0f1029] border-b border-[#2d2f5a]",children:d.jsxs("tr",{children:[d.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Order #"}),d.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Business"}),d.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Customer"}),d.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Items"}),d.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Total"}),d.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Date"}),d.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Actions"})]})}),d.jsx("tbody",{className:"divide-y divide-[#2d2f5a]",children:ie.map(pe=>{var ve,fe,ke,Ve,Vt;return d.jsxs("tr",{className:"hover:bg-white/5 transition-colors",children:[d.jsx("td",{className:"px-6 py-4",children:d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(I1,{className:"w-4 h-4 text-gray-500"}),d.jsx("span",{className:"font-medium text-white",children:pe.orderNumber})]})}),d.jsx("td",{className:"px-6 py-4",children:d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(zi,{className:"w-4 h-4 text-gray-500"}),d.jsx("span",{className:"text-gray-300",children:pe.businessName})]})}),d.jsx("td",{className:"px-6 py-4",children:d.jsxs("div",{children:[d.jsx("p",{className:"text-white font-medium",children:((ve=pe.customer)==null?void 0:ve.name)||"Unknown"}),d.jsx("p",{className:"text-gray-500 text-sm",children:(fe=pe.customer)==null?void 0:fe.email})]})}),d.jsx("td",{className:"px-6 py-4",children:d.jsxs("span",{className:"text-gray-300",children:[((ke=pe.items)==null?void 0:ke.length)||0," items"]})}),d.jsx("td",{className:"px-6 py-4",children:d.jsxs("span",{className:"text-emerald-400 font-medium",children:["$",(((Ve=pe.financials)==null?void 0:Ve.total)||0).toFixed(2)]})}),d.jsx("td",{className:"px-6 py-4",children:d.jsx("span",{className:"text-gray-400 text-sm",children:te((Vt=pe.metadata)==null?void 0:Vt.createdAt)})}),d.jsx("td",{className:"px-6 py-4",children:d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("button",{onClick:()=>{p(pe),_(!0)},className:"p-2 rounded-lg text-gray-400 hover:text-blue-400 hover:bg-blue-500/10 transition-all",title:"View Details",children:d.jsx(Qc,{className:"w-4 h-4"})}),d.jsxs("button",{onClick:()=>{p(pe),L(new Set),H(""),T(!0)},className:"flex items-center gap-2 px-3 py-2 bg-amber-500/20 text-amber-400 border border-amber-500/30 rounded-lg hover:bg-amber-500/30 transition-all",title:"Scan Items",children:[d.jsx(Bu,{className:"w-4 h-4"}),d.jsx("span",{className:"text-sm",children:"Scan"})]})]})})]},pe.id)})})]})})}),E&&h&&d.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/70",children:d.jsxs("div",{className:"bg-[#1a1b3e] border border-[#2d2f5a] rounded-2xl w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[d.jsx("div",{className:"p-6 border-b border-[#2d2f5a]",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[d.jsx(Bu,{className:"w-5 h-5 text-amber-400"}),"Scan Order Items"]}),d.jsxs("p",{className:"text-gray-400 mt-1",children:["Order: ",h.orderNumber]})]}),d.jsx("button",{onClick:()=>{R(),T(!1),L(new Set),Z(!1)},className:"p-2 hover:bg-white/10 rounded-lg transition-colors",children:d.jsx(Ar,{className:"w-5 h-5 text-gray-400"})})]})}),d.jsxs("div",{className:"p-6 space-y-4",children:[d.jsxs("div",{className:"bg-amber-500/10 border border-amber-500/30 rounded-xl p-4",children:[d.jsxs("div",{className:"flex items-center justify-between mb-2",children:[d.jsx("span",{className:"text-amber-400 font-medium",children:"Scan Progress"}),d.jsxs("span",{className:"text-white font-bold",children:[k.size," / ",((je=h.items)==null?void 0:je.length)||0]})]}),d.jsx("div",{className:"w-full h-2 bg-white/10 rounded-full overflow-hidden",children:d.jsx("div",{className:"h-full bg-amber-400 transition-all",style:{width:`${k.size/(((We=h.items)==null?void 0:We.length)||1)*100}%`}})})]}),d.jsx("div",{className:"space-y-2",children:(Ee=h.items)==null?void 0:Ee.map((pe,ve)=>{var fe;return d.jsxs("div",{className:`flex items-center justify-between p-3 rounded-lg ${k.has(ve)?"bg-emerald-500/10 border border-emerald-500/30":"bg-white/5 border border-white/10"}`,children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-white",children:pe.productName||pe.name}),d.jsxs("div",{className:"flex items-center gap-3 text-gray-500 text-sm",children:[pe.size&&d.jsxs("span",{children:["Size: ",pe.size]}),d.jsxs("span",{children:["Qty: ",pe.quantity]}),d.jsxs("span",{children:["$",(fe=pe.price)==null?void 0:fe.toFixed(2)]})]})]}),k.has(ve)?d.jsx(Ur,{className:"w-5 h-5 text-emerald-400"}):d.jsx("span",{className:"text-gray-500 text-sm",children:"Not scanned"})]},ve)})}),d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{className:"flex gap-2",children:[d.jsx("input",{type:"text",value:B,onChange:pe=>H(pe.target.value),onKeyDown:pe=>pe.key==="Enter"&&O(),placeholder:"Enter or scan barcode...",className:"flex-1 px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white focus:outline-none focus:border-amber-500/50"}),d.jsx("button",{onClick:O,disabled:W||!B.trim(),className:"px-4 py-3 bg-amber-500 text-white rounded-xl hover:bg-amber-600 transition-colors disabled:opacity-50",children:d.jsx(Bu,{className:"w-5 h-5"})})]}),d.jsxs("button",{onClick:()=>U||K?R():F(),disabled:K&&!U,className:`w-full flex items-center justify-center gap-2 px-4 py-3 rounded-xl transition-colors ${U?"bg-red-500/20 text-red-400 border border-red-500/30":K?"bg-amber-500/20 text-amber-400 border border-amber-500/30":"bg-white/5 text-gray-300 border border-white/10 hover:bg-white/10"}`,children:[d.jsx(iD,{className:"w-5 h-5"}),U?"Stop Camera":K?"Starting Camera...":"Use Camera"]}),K&&d.jsxs("div",{className:"relative",children:[d.jsx("div",{id:"pending-scanner",className:"w-full rounded-xl overflow-hidden bg-black",style:{minHeight:"250px"}}),!U&&d.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50 rounded-xl",children:d.jsxs("div",{className:"text-center",children:[d.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-amber-400 border-t-transparent mx-auto mb-2"}),d.jsx("p",{className:"text-gray-400 text-sm",children:"Initializing camera..."})]})})]})]}),k.size>=(((qe=h.items)==null?void 0:qe.length)||0)&&d.jsxs("div",{className:"bg-emerald-500/10 border border-emerald-500/30 rounded-xl p-4 text-center",children:[d.jsx(Ur,{className:"w-12 h-12 text-emerald-400 mx-auto mb-2"}),d.jsx("p",{className:"text-emerald-400 font-medium",children:"All items scanned!"}),d.jsx("p",{className:"text-gray-400 text-sm",children:"Order will be moved to Ready for Pickup"})]})]})]})}),y&&h&&d.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/70",children:d.jsxs("div",{className:"bg-[#1a1b3e] border border-[#2d2f5a] rounded-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[d.jsx("div",{className:"p-6 border-b border-[#2d2f5a]",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("h2",{className:"text-xl font-bold text-white",children:"Order Details"}),d.jsx("button",{onClick:()=>_(!1),className:"p-2 hover:bg-white/10 rounded-lg transition-colors",children:d.jsx(Ar,{className:"w-5 h-5 text-gray-400"})})]})}),d.jsxs("div",{className:"p-6 space-y-6",children:[d.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-gray-500 text-sm",children:"Order Number"}),d.jsx("p",{className:"text-white font-medium",children:h.orderNumber})]}),d.jsxs("div",{children:[d.jsx("p",{className:"text-gray-500 text-sm",children:"Business"}),d.jsx("p",{className:"text-white",children:h.businessName})]}),d.jsxs("div",{children:[d.jsx("p",{className:"text-gray-500 text-sm",children:"Customer"}),d.jsx("p",{className:"text-white",children:(et=h.customer)==null?void 0:et.name}),d.jsx("p",{className:"text-gray-400 text-sm",children:(Lt=h.customer)==null?void 0:Lt.email})]}),d.jsxs("div",{children:[d.jsx("p",{className:"text-gray-500 text-sm",children:"Total"}),d.jsxs("p",{className:"text-emerald-400 font-bold text-lg",children:["$",(((Qe=h.financials)==null?void 0:Qe.total)||0).toFixed(2)]})]}),d.jsxs("div",{children:[d.jsx("p",{className:"text-gray-500 text-sm",children:"Date"}),d.jsx("p",{className:"text-white",children:te((rt=h.metadata)==null?void 0:rt.createdAt)})]}),d.jsxs("div",{children:[d.jsx("p",{className:"text-gray-500 text-sm",children:"Status"}),d.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 bg-amber-500/20 text-amber-400 rounded-lg text-sm",children:[d.jsx(Na,{className:"w-4 h-4"}),"Pending"]})]})]}),h.items&&h.items.length>0&&d.jsxs("div",{children:[d.jsxs("p",{className:"text-gray-500 text-sm mb-3",children:["Items (",h.items.length,")"]}),d.jsx("div",{className:"space-y-2",children:h.items.map((pe,ve)=>{var fe;return d.jsxs("div",{className:"flex items-center justify-between p-3 bg-white/5 rounded-lg",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-white",children:pe.productName||pe.name}),pe.size&&d.jsxs("p",{className:"text-gray-500 text-sm",children:["Size: ",pe.size]})]}),d.jsxs("div",{className:"text-right",children:[d.jsxs("p",{className:"text-white",children:["x",pe.quantity]}),d.jsxs("p",{className:"text-gray-400 text-sm",children:["$",(fe=pe.price)==null?void 0:fe.toFixed(2)]})]})]},ve)})})]}),h.shippingAddress&&d.jsxs("div",{children:[d.jsx("p",{className:"text-gray-500 text-sm mb-2",children:"Shipping Address"}),d.jsxs("div",{className:"p-3 bg-white/5 rounded-lg",children:[d.jsx("p",{className:"text-white",children:h.shippingAddress.address}),d.jsx("p",{className:"text-gray-400",children:[h.shippingAddress.city,h.shippingAddress.state,h.shippingAddress.zipCode].filter(Boolean).join(", ")})]})]}),d.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-[#2d2f5a]",children:[d.jsx("button",{onClick:()=>_(!1),className:"px-4 py-2 bg-white/5 text-gray-300 rounded-lg hover:bg-white/10 transition-colors",children:"Close"}),d.jsxs("button",{onClick:()=>{_(!1),L(new Set),H(""),T(!0)},className:"flex items-center gap-2 px-4 py-2 bg-amber-500 text-white rounded-lg hover:bg-amber-600 transition-colors",children:[d.jsx(Bu,{className:"w-4 h-4"}),"Start Scanning"]})]})]})]})})]})})}function mQ(){var W,M,U;const{user:t}=Gs(),[e,n]=q.useState([]),[r,s]=q.useState(!0),[i,l]=q.useState(""),[h,p]=q.useState(null),[y,_]=q.useState(!1),[E,T]=q.useState(!1),k=async()=>{var $,K,Z;s(!0);try{const A=[],C=await Cn(In(at,"businesses"));console.log(`[ReadyForPickupPage] Found ${C.docs.length} total businesses`);for(const N of C.docs){const D=N.id,O=N.data();if((($=O.features)==null?void 0:$.fulfillment)===!0||((K=O.features)==null?void 0:K.fulfillment_service)===!0||((Z=O.features)==null?void 0:Z.fulfillmentService)===!0)try{const R=In(at,"businesses",D,"orders");let ie;try{const te=Ii(R,xc("date","desc"));ie=await Cn(te)}catch(te){console.warn(`[ReadyForPickupPage] OrderBy failed for ${D}, trying without order:`,te),ie=await Cn(R)}ie.docs.forEach(te=>{var Ee,qe;const je=te.data();(((Ee=je.fulfillment)==null?void 0:Ee.status)||je.status||"pending")==="ready_for_pickup"&&A.push({id:te.id,orderId:te.id,orderNumber:je.orderNumber||`#${te.id.slice(0,6)}`,businessId:D,businessName:O.businessName||O.name||"Unknown Business",customer:je.customer||{name:"Unknown",email:"",phone:""},fulfillment:je.fulfillment||{status:"ready_for_pickup"},financials:je.financials||{total:0},metadata:je.metadata||{},items:je.items||[],shippingAddress:je.shippingAddress||((qe=je.shipping)==null?void 0:qe.address)})})}catch(R){console.error(`[ReadyForPickupPage] Error loading orders for business ${D}:`,R)}}console.log(`[ReadyForPickupPage] Total ready_for_pickup orders loaded: ${A.length}`),n(A)}catch(A){console.error("[ReadyForPickupPage] Error loading orders:",A)}finally{s(!1)}};q.useEffect(()=>{k()},[]);const L=async $=>{if(window.confirm(`Move order ${$.orderNumber} to Shipping?`)){T(!0);try{const K=Bn(at,"businesses",$.businessId,"orders",$.id);await ls(K,{"fulfillment.status":"shipped",status:"processing","fulfillment.shippedAt":new Date().toISOString(),"metadata.updatedAt":new Date().toISOString()}),alert(` Order ${$.orderNumber} moved to Shipping!`),await k()}catch(K){console.error("[ReadyForPickupPage] Error updating order:",K),alert(" Failed to update order: "+K.message)}finally{T(!1)}}},B=e.filter($=>{var Z,A,C,N,D,O;return((Z=$.orderNumber)==null?void 0:Z.toLowerCase().includes(i.toLowerCase()))||((C=(A=$.customer)==null?void 0:A.name)==null?void 0:C.toLowerCase().includes(i.toLowerCase()))||((D=(N=$.customer)==null?void 0:N.email)==null?void 0:D.toLowerCase().includes(i.toLowerCase()))||((O=$.businessName)==null?void 0:O.toLowerCase().includes(i.toLowerCase()))}),H=$=>{if(!$)return"N/A";try{return z2(new Date($),"MMM d, yyyy HH:mm")}catch{return"N/A"}};return d.jsx(cs,{permissions:["super_admin.manage_all_tenants","super_admin.view_analytics","super_admin.manage_subscriptions"],showError:!1,children:d.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[d.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6",children:[d.jsxs("div",{children:[d.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold text-white flex items-center gap-3",children:[d.jsx(bi,{className:"w-8 h-8 text-cyan-400"}),"Ready for Pickup"]}),d.jsx("p",{className:"text-gray-400 mt-1",children:"Orders ready to be shipped to customers"})]}),d.jsx("div",{className:"flex items-center gap-3",children:d.jsxs("button",{onClick:k,disabled:r,className:"flex items-center gap-2 px-4 py-2 bg-white/5 border border-white/10 rounded-xl text-gray-300 hover:bg-white/10 transition-colors disabled:opacity-50",children:[d.jsx(Wd,{className:`w-4 h-4 ${r?"animate-spin":""}`}),"Refresh"]})})]}),d.jsx("div",{className:"bg-gradient-to-r from-cyan-500/20 to-blue-500/20 border border-cyan-500/30 rounded-xl p-6 mb-6",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-gray-400 text-sm",children:"Total Orders Ready for Pickup"}),d.jsx("p",{className:"text-4xl font-bold text-cyan-400",children:e.length})]}),d.jsx(bi,{className:"w-16 h-16 text-cyan-400/30"})]})}),d.jsx("div",{className:"bg-[#1a1b3e] border border-[#2d2f5a] rounded-xl p-5 mb-6",children:d.jsxs("div",{className:"relative",children:[d.jsx(Kl,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-500"}),d.jsx("input",{type:"text",value:i,onChange:$=>l($.target.value),placeholder:"Search by order number, customer, business...",className:"w-full pl-10 pr-4 py-2.5 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:border-cyan-500/50"})]})}),r?d.jsx("div",{className:"flex items-center justify-center py-16",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-cyan-500 border-t-transparent"})}):B.length===0?d.jsxs("div",{className:"bg-[#1a1b3e] border border-[#2d2f5a] rounded-xl p-12 text-center",children:[d.jsx(bi,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),d.jsx("h3",{className:"text-xl font-semibold text-white mb-2",children:"No Orders Ready for Pickup"}),d.jsx("p",{className:"text-gray-400",children:"Orders will appear here once all items have been scanned"})]}):d.jsx("div",{className:"bg-[#1a1b3e] border border-[#2d2f5a] rounded-xl overflow-hidden",children:d.jsx("div",{className:"overflow-x-auto",children:d.jsxs("table",{className:"w-full",children:[d.jsx("thead",{className:"bg-[#0f1029] border-b border-[#2d2f5a]",children:d.jsxs("tr",{children:[d.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Order #"}),d.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Business"}),d.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Customer"}),d.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Items"}),d.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Total"}),d.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Date"}),d.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Actions"})]})}),d.jsx("tbody",{className:"divide-y divide-[#2d2f5a]",children:B.map($=>{var K,Z,A,C,N;return d.jsxs("tr",{className:"hover:bg-white/5 transition-colors",children:[d.jsx("td",{className:"px-6 py-4",children:d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(I1,{className:"w-4 h-4 text-gray-500"}),d.jsx("span",{className:"font-medium text-white",children:$.orderNumber})]})}),d.jsx("td",{className:"px-6 py-4",children:d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(zi,{className:"w-4 h-4 text-gray-500"}),d.jsx("span",{className:"text-gray-300",children:$.businessName})]})}),d.jsx("td",{className:"px-6 py-4",children:d.jsxs("div",{children:[d.jsx("p",{className:"text-white font-medium",children:((K=$.customer)==null?void 0:K.name)||"Unknown"}),d.jsx("p",{className:"text-gray-500 text-sm",children:(Z=$.customer)==null?void 0:Z.email})]})}),d.jsx("td",{className:"px-6 py-4",children:d.jsxs("span",{className:"text-gray-300",children:[((A=$.items)==null?void 0:A.length)||0," items"]})}),d.jsx("td",{className:"px-6 py-4",children:d.jsxs("span",{className:"text-emerald-400 font-medium",children:["$",(((C=$.financials)==null?void 0:C.total)||0).toFixed(2)]})}),d.jsx("td",{className:"px-6 py-4",children:d.jsx("span",{className:"text-gray-400 text-sm",children:H((N=$.metadata)==null?void 0:N.createdAt)})}),d.jsx("td",{className:"px-6 py-4",children:d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("button",{onClick:()=>{p($),_(!0)},className:"p-2 rounded-lg text-gray-400 hover:text-blue-400 hover:bg-blue-500/10 transition-all",title:"View Details",children:d.jsx(Qc,{className:"w-4 h-4"})}),d.jsxs("button",{onClick:()=>L($),disabled:E,className:"flex items-center gap-2 px-3 py-2 bg-purple-500/20 text-purple-400 border border-purple-500/30 rounded-lg hover:bg-purple-500/30 transition-all disabled:opacity-50",title:"Move to Shipping",children:[d.jsx(Fi,{className:"w-4 h-4"}),d.jsx("span",{className:"text-sm",children:"Ship"}),d.jsx(sD,{className:"w-3 h-3"})]})]})})]},$.id)})})]})})}),y&&h&&d.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/70",children:d.jsxs("div",{className:"bg-[#1a1b3e] border border-[#2d2f5a] rounded-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[d.jsx("div",{className:"p-6 border-b border-[#2d2f5a]",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("h2",{className:"text-xl font-bold text-white",children:"Order Details"}),d.jsx("button",{onClick:()=>_(!1),className:"p-2 hover:bg-white/10 rounded-lg transition-colors",children:d.jsx(Ar,{className:"w-5 h-5 text-gray-400"})})]})}),d.jsxs("div",{className:"p-6 space-y-6",children:[d.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-gray-500 text-sm",children:"Order Number"}),d.jsx("p",{className:"text-white font-medium",children:h.orderNumber})]}),d.jsxs("div",{children:[d.jsx("p",{className:"text-gray-500 text-sm",children:"Business"}),d.jsx("p",{className:"text-white",children:h.businessName})]}),d.jsxs("div",{children:[d.jsx("p",{className:"text-gray-500 text-sm",children:"Customer"}),d.jsx("p",{className:"text-white",children:(W=h.customer)==null?void 0:W.name}),d.jsx("p",{className:"text-gray-400 text-sm",children:(M=h.customer)==null?void 0:M.email})]}),d.jsxs("div",{children:[d.jsx("p",{className:"text-gray-500 text-sm",children:"Total"}),d.jsxs("p",{className:"text-emerald-400 font-bold text-lg",children:["$",(((U=h.financials)==null?void 0:U.total)||0).toFixed(2)]})]})]}),h.items&&h.items.length>0&&d.jsxs("div",{children:[d.jsxs("p",{className:"text-gray-500 text-sm mb-3",children:["Items (",h.items.length,")"]}),d.jsx("div",{className:"space-y-2",children:h.items.map(($,K)=>{var Z;return d.jsxs("div",{className:"flex items-center justify-between p-3 bg-white/5 rounded-lg",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-white",children:$.productName||$.name}),$.size&&d.jsxs("p",{className:"text-gray-500 text-sm",children:["Size: ",$.size]})]}),d.jsxs("div",{className:"text-right",children:[d.jsxs("p",{className:"text-white",children:["x",$.quantity]}),d.jsxs("p",{className:"text-gray-400 text-sm",children:["$",(Z=$.price)==null?void 0:Z.toFixed(2)]})]})]},K)})})]}),h.shippingAddress&&d.jsxs("div",{children:[d.jsx("p",{className:"text-gray-500 text-sm mb-2",children:"Shipping Address"}),d.jsxs("div",{className:"p-3 bg-white/5 rounded-lg",children:[d.jsx("p",{className:"text-white",children:h.shippingAddress.address}),d.jsx("p",{className:"text-gray-400",children:[h.shippingAddress.city,h.shippingAddress.state,h.shippingAddress.zipCode].filter(Boolean).join(", ")})]})]}),d.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-[#2d2f5a]",children:[d.jsx("button",{onClick:()=>_(!1),className:"px-4 py-2 bg-white/5 text-gray-300 rounded-lg hover:bg-white/10 transition-colors",children:"Close"}),d.jsxs("button",{onClick:()=>{_(!1),L(h)},disabled:E,className:"flex items-center gap-2 px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors disabled:opacity-50",children:[d.jsx(Fi,{className:"w-4 h-4"}),"Move to Shipping"]})]})]})]})})]})})}function pQ(){var Qe,rt,pe,ve,fe,ke,Ve,Vt,qt,yt;const{user:t}=Gs(),[e,n]=q.useState([]),[r,s]=q.useState(!0),[i,l]=q.useState(""),[h,p]=q.useState(null),[y,_]=q.useState(!1),[E,T]=q.useState(!1),[k,L]=q.useState(null),[B,H]=q.useState(!1),[W,M]=q.useState(!1),[U,$]=q.useState(new Set),[K,Z]=q.useState(""),[A,C]=q.useState(!1),[N,D]=q.useState(!1),[O,F]=q.useState(!1),R=q.useRef(null),ie=async()=>{var xe,se,De;s(!0);try{const Oe=[],Ge=await Cn(In(at,"businesses"));console.log(`[ShippingPage] Found ${Ge.docs.length} total businesses`);for(const ht of Ge.docs){const Et=ht.id,st=ht.data();if(((xe=st.features)==null?void 0:xe.fulfillment)===!0||((se=st.features)==null?void 0:se.fulfillment_service)===!0||((De=st.features)==null?void 0:De.fulfillmentService)===!0)try{const ae=In(at,"businesses",Et,"orders");let ft;try{const At=Ii(ae,xc("date","desc"));ft=await Cn(At)}catch(At){console.warn(`[ShippingPage] OrderBy failed for ${Et}, trying without order:`,At),ft=await Cn(ae)}ft.docs.forEach(At=>{var tt,ot;const Ke=At.data();(((tt=Ke.fulfillment)==null?void 0:tt.status)||Ke.status||"pending")==="shipped"&&Oe.push({id:At.id,orderId:At.id,orderNumber:Ke.orderNumber||`#${At.id.slice(0,6)}`,businessId:Et,businessName:st.businessName||st.name||"Unknown Business",customer:Ke.customer||{name:"Unknown",email:"",phone:""},fulfillment:Ke.fulfillment||{status:"shipped"},financials:Ke.financials||{total:0},metadata:Ke.metadata||{},items:Ke.items||[],shippingAddress:Ke.shippingAddress||((ot=Ke.shipping)==null?void 0:ot.address)})})}catch(ae){console.error(`[ShippingPage] Error loading orders for business ${Et}:`,ae)}}console.log(`[ShippingPage] Total shipped orders loaded: ${Oe.length}`),n(Oe)}catch(Oe){console.error("[ShippingPage] Error loading orders:",Oe)}finally{s(!1)}};q.useEffect(()=>{ie()},[]);const te=async xe=>{if(!h)return;if(xe==="returned"){L("returned"),T(!1),M(!0),$(new Set);return}const se=xe==="delivered"?`Mark order ${h.orderNumber} as Delivered?`:`Mark order ${h.orderNumber} as Damaged?`;window.confirm(se)&&await je(xe)},je=async(xe,se)=>{if(h){H(!0);try{const De=Bn(at,"businesses",h.businessId,"orders",h.id);if(await ls(De,{"fulfillment.status":xe,status:xe==="delivered"?"completed":"cancelled",...xe==="delivered"&&{"fulfillment.deliveredAt":new Date().toISOString()},"metadata.updatedAt":new Date().toISOString()}),xe==="returned"){const ht=In(at,"businesses",h.businessId,"scan_log");await Wc(ht,{type:"return",orderId:h.id,orderNumber:h.orderNumber,businessId:h.businessId,businessName:h.businessName,previousStatus:"shipped",newStatus:xe,timestamp:F0(),user:"XDIGIX",userId:"xdigix-fulfillment",adminEmail:(t==null?void 0:t.email)||"Unknown",adminUserId:(t==null?void 0:t.id)||null,notes:se||`Order marked as ${xe}`,source:"shipping_page",scannedItems:Array.from(U)})}const Ge=xe==="delivered"?"Delivered":xe==="returned"?"Returned":"Damaged";alert(` Order ${h.orderNumber} marked as ${Ge}!`),T(!1),M(!1),p(null),await ie()}catch(De){console.error("[ShippingPage] Error updating order:",De),alert(" Failed to update order: "+De.message)}finally{H(!1)}}},We=async()=>{var tt,ot,jt,Kt,ar,Xt,xn,Mt;if(!K.trim()||!h)return;C(!0);const xe=K.trim().toLowerCase(),se=we=>we.toLowerCase().replace(/\s+/g,"").replace(/-/g,""),De=se(xe);let Oe=-1,Ge=null,ht=null;const Et=[];try{const we=In(at,"businesses",h.businessId,"products"),Tt=await Cn(we);for(const Rt of Tt.docs){const wt=Rt.data(),bt=((tt=wt.barcode)==null?void 0:tt.toString().toLowerCase())||"",ce=((ot=wt.mainBarcode)==null?void 0:ot.toString().toLowerCase())||"";let Ie;if(wt.sizeBarcodes&&typeof wt.sizeBarcodes=="object")for(const[Ce,it]of Object.entries(wt.sizeBarcodes)){const He=(it==null?void 0:it.toString().toLowerCase())||"";if(He===xe||se(He)===De){Ie=Ce;break}}if(!Ie&&wt.sizeVariants&&typeof wt.sizeVariants=="object")for(const[Ce,it]of Object.entries(wt.sizeVariants)){const He=((jt=it==null?void 0:it.barcode)==null?void 0:jt.toString().toLowerCase())||"";if(He===xe||se(He)===De){Ie=Ce;break}}(bt===xe||se(bt)===De||ce===xe||se(ce)===De||Ie)&&Et.push({id:Rt.id,data:wt,matchedSize:Ie})}}catch(we){console.warn("[ShippingPage] Error searching products:",we)}for(let we=0;we<(((Kt=h.items)==null?void 0:Kt.length)||0);we++){const Tt=h.items[we];if(U.has(we))continue;const Rt=((ar=Tt.barcode)==null?void 0:ar.toString().toLowerCase())||"",wt=((Xt=Tt.productId)==null?void 0:Xt.toString())||"",bt=Tt.size||"",ce=Rt===xe||se(Rt)===De,Ie=Et.find(be=>{const Ce=wt.toLowerCase().startsWith(be.id.toLowerCase())||wt.toLowerCase()===be.id.toLowerCase();return be.matchedSize&&bt?Ce&&be.matchedSize.toLowerCase()===bt.toLowerCase():Ce});if(ce||Ie){Oe=we,Ge=(Ie==null?void 0:Ie.id)||wt.split("_")[0]||null,ht=(Ie==null?void 0:Ie.matchedSize)||bt||null;break}}if(Oe===-1){alert(` Product not found in this order's items.
Barcode: ${K}`),Z(""),C(!1);return}const st=h.items[Oe],me=st.quantity||1;let ae=null,ft=null;if(Ge)try{const we=Bn(at,"businesses",h.businessId,"products",Ge),Tt=await ri(we);if(Tt.exists()){const wt=Tt.data().stock||{},bt=ht||st.size||"default";typeof wt=="object"&&wt[bt]!==void 0?(ae=wt[bt],ft=ae+me,await ls(we,{[`stock.${bt}`]:ft}),console.log(`[ShippingPage] Return: Updated stock for ${Ge} size ${bt}: ${ae} -> ${ft}`)):typeof wt=="number"&&(ae=wt,ft=ae+me,await ls(we,{stock:ft}),console.log(`[ShippingPage] Return: Updated total stock for ${Ge}: ${ae} -> ${ft}`))}}catch(we){console.error("[ShippingPage] Error updating stock for return:",we)}const At=new Set(U);At.add(Oe),$(At);const Ke=In(at,"businesses",h.businessId,"scan_log");await Wc(Ke,{type:"return",barcode:K,orderId:h.id,orderNumber:h.orderNumber,businessId:h.businessId,businessName:h.businessName,itemIndex:Oe,productId:Ge,productName:st.productName||st.name||"Unknown",size:ht||st.size||null,price:st.price||0,quantity:me,previousStock:ae,newStock:ft,stockUpdated:ae!==null,timestamp:F0(),user:"XDIGIX",userId:"xdigix-fulfillment",adminEmail:(t==null?void 0:t.email)||"Unknown",adminUserId:(t==null?void 0:t.id)||null,notes:`Return scan: Item ${Oe+1} of ${(xn=h.items)==null?void 0:xn.length}`,source:"shipping_page_return"});const dn=ae!==null?`
Stock: ${ae}  ${ft} (+${me})`:"";alert(` Item scanned for return!${dn}

Scanned: ${At.size} / ${(Mt=h.items)==null?void 0:Mt.length} items`),Z(""),C(!1)},Ee=async()=>{var xe,se,De;F(!0),await new Promise(Oe=>setTimeout(Oe,150));try{if(!document.getElementById("return-scanner")){console.error("[ShippingPage] Camera container not found"),alert("Camera container not found. Please try again."),F(!1);return}if(R.current){try{await R.current.stop()}catch{}R.current=null}const Ge=new $2("return-scanner");R.current=Ge,await Ge.start({facingMode:"environment"},{fps:10,qrbox:{width:250,height:150}},ht=>{Z(ht),Ge.stop().catch(console.error),D(!1),F(!1)},()=>{}),D(!0)}catch(Oe){console.error("[ShippingPage] Camera error:",Oe),F(!1),D(!1);let Ge="Failed to start camera.";(xe=Oe.message)!=null&&xe.includes("Permission denied")||Oe.name==="NotAllowedError"?Ge="Camera permission denied. Please allow camera access in your browser settings.":(se=Oe.message)!=null&&se.includes("not found")||Oe.name==="NotFoundError"?Ge="No camera found on this device.":(De=Oe.message)!=null&&De.includes("insecure")||Oe.name==="NotSupportedError"?Ge="Camera access requires HTTPS. Please use a secure connection.":Oe.message&&(Ge=Oe.message),alert(Ge)}},qe=async()=>{if(R.current){try{await R.current.stop()}catch(xe){console.error("[ShippingPage] Error stopping camera:",xe)}R.current=null}D(!1),F(!1)},et=e.filter(xe=>{var De,Oe,Ge,ht,Et,st,me,ae;return((De=xe.orderNumber)==null?void 0:De.toLowerCase().includes(i.toLowerCase()))||((Ge=(Oe=xe.customer)==null?void 0:Oe.name)==null?void 0:Ge.toLowerCase().includes(i.toLowerCase()))||((Et=(ht=xe.customer)==null?void 0:ht.email)==null?void 0:Et.toLowerCase().includes(i.toLowerCase()))||((st=xe.businessName)==null?void 0:st.toLowerCase().includes(i.toLowerCase()))||((ae=(me=xe.fulfillment)==null?void 0:me.trackingNumber)==null?void 0:ae.toLowerCase().includes(i.toLowerCase()))}),Lt=xe=>{if(!xe)return"N/A";try{return z2(new Date(xe),"MMM d, yyyy HH:mm")}catch{return"N/A"}};return d.jsx(cs,{permissions:["super_admin.manage_all_tenants","super_admin.view_analytics","super_admin.manage_subscriptions"],showError:!1,children:d.jsxs("div",{className:"p-4 sm:p-6 lg:p-8",children:[d.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4 mb-6",children:[d.jsxs("div",{children:[d.jsxs("h1",{className:"text-2xl sm:text-3xl font-bold text-white flex items-center gap-3",children:[d.jsx(Fi,{className:"w-8 h-8 text-purple-400"}),"Shipping"]}),d.jsx("p",{className:"text-gray-400 mt-1",children:"Manage orders in transit - mark as delivered, returned, or damaged"})]}),d.jsx("div",{className:"flex items-center gap-3",children:d.jsxs("button",{onClick:ie,disabled:r,className:"flex items-center gap-2 px-4 py-2 bg-white/5 border border-white/10 rounded-xl text-gray-300 hover:bg-white/10 transition-colors disabled:opacity-50",children:[d.jsx(Wd,{className:`w-4 h-4 ${r?"animate-spin":""}`}),"Refresh"]})})]}),d.jsx("div",{className:"bg-gradient-to-r from-purple-500/20 to-indigo-500/20 border border-purple-500/30 rounded-xl p-6 mb-6",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-gray-400 text-sm",children:"Total Orders In Transit"}),d.jsx("p",{className:"text-4xl font-bold text-purple-400",children:e.length})]}),d.jsx(Fi,{className:"w-16 h-16 text-purple-400/30"})]})}),d.jsx("div",{className:"bg-[#1a1b3e] border border-[#2d2f5a] rounded-xl p-5 mb-6",children:d.jsxs("div",{className:"relative",children:[d.jsx(Kl,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-500"}),d.jsx("input",{type:"text",value:i,onChange:xe=>l(xe.target.value),placeholder:"Search by order number, customer, tracking number...",className:"w-full pl-10 pr-4 py-2.5 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:border-purple-500/50"})]})}),r?d.jsx("div",{className:"flex items-center justify-center py-16",children:d.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-4 border-purple-500 border-t-transparent"})}):et.length===0?d.jsxs("div",{className:"bg-[#1a1b3e] border border-[#2d2f5a] rounded-xl p-12 text-center",children:[d.jsx(Fi,{className:"w-16 h-16 text-gray-600 mx-auto mb-4"}),d.jsx("h3",{className:"text-xl font-semibold text-white mb-2",children:"No Orders In Transit"}),d.jsx("p",{className:"text-gray-400",children:"Orders will appear here once they are shipped"})]}):d.jsx("div",{className:"bg-[#1a1b3e] border border-[#2d2f5a] rounded-xl overflow-hidden",children:d.jsx("div",{className:"overflow-x-auto",children:d.jsxs("table",{className:"w-full",children:[d.jsx("thead",{className:"bg-[#0f1029] border-b border-[#2d2f5a]",children:d.jsxs("tr",{children:[d.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Order #"}),d.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Business"}),d.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Customer"}),d.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Tracking"}),d.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Total"}),d.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Shipped"}),d.jsx("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-400 uppercase tracking-wider",children:"Actions"})]})}),d.jsx("tbody",{className:"divide-y divide-[#2d2f5a]",children:et.map(xe=>{var se,De,Oe,Ge,ht;return d.jsxs("tr",{className:"hover:bg-white/5 transition-colors",children:[d.jsx("td",{className:"px-6 py-4",children:d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(I1,{className:"w-4 h-4 text-gray-500"}),d.jsx("span",{className:"font-medium text-white",children:xe.orderNumber})]})}),d.jsx("td",{className:"px-6 py-4",children:d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx(zi,{className:"w-4 h-4 text-gray-500"}),d.jsx("span",{className:"text-gray-300",children:xe.businessName})]})}),d.jsx("td",{className:"px-6 py-4",children:d.jsxs("div",{children:[d.jsx("p",{className:"text-white font-medium",children:((se=xe.customer)==null?void 0:se.name)||"Unknown"}),d.jsx("p",{className:"text-gray-500 text-sm",children:(De=xe.customer)==null?void 0:De.email})]})}),d.jsx("td",{className:"px-6 py-4",children:d.jsx("span",{className:"text-gray-400",children:((Oe=xe.fulfillment)==null?void 0:Oe.trackingNumber)||"No tracking"})}),d.jsx("td",{className:"px-6 py-4",children:d.jsxs("span",{className:"text-emerald-400 font-medium",children:["$",(((Ge=xe.financials)==null?void 0:Ge.total)||0).toFixed(2)]})}),d.jsx("td",{className:"px-6 py-4",children:d.jsx("span",{className:"text-gray-400 text-sm",children:Lt((ht=xe.fulfillment)==null?void 0:ht.shippedAt)})}),d.jsx("td",{className:"px-6 py-4",children:d.jsxs("div",{className:"flex items-center gap-2",children:[d.jsx("button",{onClick:()=>{p(xe),_(!0)},className:"p-2 rounded-lg text-gray-400 hover:text-blue-400 hover:bg-blue-500/10 transition-all",title:"View Details",children:d.jsx(Qc,{className:"w-4 h-4"})}),d.jsxs("button",{onClick:()=>{p(xe),T(!0)},className:"flex items-center gap-1 px-3 py-2 bg-emerald-500/20 text-emerald-400 border border-emerald-500/30 rounded-lg hover:bg-emerald-500/30 transition-all text-sm",title:"Update Status",children:[d.jsx(Ur,{className:"w-4 h-4"}),"Update"]})]})})]},xe.id)})})]})})}),E&&h&&d.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/70",children:d.jsxs("div",{className:"bg-[#1a1b3e] border border-[#2d2f5a] rounded-2xl w-full max-w-md",children:[d.jsxs("div",{className:"p-6 border-b border-[#2d2f5a]",children:[d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("h2",{className:"text-xl font-bold text-white",children:"Update Order Status"}),d.jsx("button",{onClick:()=>T(!1),className:"p-2 hover:bg-white/10 rounded-lg transition-colors",children:d.jsx(Ar,{className:"w-5 h-5 text-gray-400"})})]}),d.jsxs("p",{className:"text-gray-400 mt-2",children:["Order: ",h.orderNumber]})]}),d.jsxs("div",{className:"p-6 space-y-3",children:[d.jsxs("button",{onClick:()=>te("delivered"),disabled:B,className:"w-full flex items-center gap-3 p-4 bg-emerald-500/10 border border-emerald-500/30 rounded-xl hover:bg-emerald-500/20 transition-all disabled:opacity-50",children:[d.jsx(Ur,{className:"w-6 h-6 text-emerald-400"}),d.jsxs("div",{className:"text-left",children:[d.jsx("p",{className:"text-white font-medium",children:"Mark as Delivered"}),d.jsx("p",{className:"text-gray-400 text-sm",children:"Order was successfully delivered to customer"})]})]}),d.jsxs("button",{onClick:()=>te("returned"),disabled:B,className:"w-full flex items-center gap-3 p-4 bg-orange-500/10 border border-orange-500/30 rounded-xl hover:bg-orange-500/20 transition-all disabled:opacity-50",children:[d.jsx(AT,{className:"w-6 h-6 text-orange-400"}),d.jsxs("div",{className:"text-left",children:[d.jsx("p",{className:"text-white font-medium",children:"Mark as Returned"}),d.jsx("p",{className:"text-gray-400 text-sm",children:"Customer returned the order - requires scanning"})]})]}),d.jsxs("button",{onClick:()=>te("damaged"),disabled:B,className:"w-full flex items-center gap-3 p-4 bg-rose-500/10 border border-rose-500/30 rounded-xl hover:bg-rose-500/20 transition-all disabled:opacity-50",children:[d.jsx(oD,{className:"w-6 h-6 text-rose-400"}),d.jsxs("div",{className:"text-left",children:[d.jsx("p",{className:"text-white font-medium",children:"Mark as Damaged"}),d.jsx("p",{className:"text-gray-400 text-sm",children:"Order was damaged/stolen during transit"})]})]})]})]})}),W&&h&&d.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/70",children:d.jsxs("div",{className:"bg-[#1a1b3e] border border-[#2d2f5a] rounded-2xl w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[d.jsx("div",{className:"p-6 border-b border-[#2d2f5a]",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("div",{children:[d.jsxs("h2",{className:"text-xl font-bold text-white flex items-center gap-2",children:[d.jsx(AT,{className:"w-5 h-5 text-orange-400"}),"Return Scan Required"]}),d.jsxs("p",{className:"text-gray-400 mt-1",children:["Scan ",((Qe=h.items)==null?void 0:Qe.length)||0," items to process return"]})]}),d.jsx("button",{onClick:()=>{qe(),M(!1),F(!1)},className:"p-2 hover:bg-white/10 rounded-lg transition-colors",children:d.jsx(Ar,{className:"w-5 h-5 text-gray-400"})})]})}),d.jsxs("div",{className:"p-6 space-y-4",children:[d.jsxs("div",{className:"bg-orange-500/10 border border-orange-500/30 rounded-xl p-4",children:[d.jsxs("div",{className:"flex items-center justify-between mb-2",children:[d.jsx("span",{className:"text-orange-400 font-medium",children:"Scan Progress"}),d.jsxs("span",{className:"text-white font-bold",children:[U.size," / ",((rt=h.items)==null?void 0:rt.length)||0]})]}),d.jsx("div",{className:"w-full h-2 bg-white/10 rounded-full overflow-hidden",children:d.jsx("div",{className:"h-full bg-orange-400 transition-all",style:{width:`${U.size/(((pe=h.items)==null?void 0:pe.length)||1)*100}%`}})})]}),d.jsx("div",{className:"space-y-2",children:(ve=h.items)==null?void 0:ve.map((xe,se)=>d.jsxs("div",{className:`flex items-center justify-between p-3 rounded-lg ${U.has(se)?"bg-emerald-500/10 border border-emerald-500/30":"bg-white/5 border border-white/10"}`,children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-white",children:xe.productName||xe.name}),xe.size&&d.jsxs("p",{className:"text-gray-500 text-sm",children:["Size: ",xe.size]})]}),U.has(se)?d.jsx(Ur,{className:"w-5 h-5 text-emerald-400"}):d.jsx("span",{className:"text-gray-500 text-sm",children:"Not scanned"})]},se))}),d.jsxs("div",{className:"space-y-3",children:[d.jsxs("div",{className:"flex gap-2",children:[d.jsx("input",{type:"text",value:K,onChange:xe=>Z(xe.target.value),onKeyDown:xe=>xe.key==="Enter"&&We(),placeholder:"Enter or scan barcode...",className:"flex-1 px-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white focus:outline-none focus:border-orange-500/50"}),d.jsx("button",{onClick:We,disabled:A||!K.trim(),className:"px-4 py-3 bg-orange-500 text-white rounded-xl hover:bg-orange-600 transition-colors disabled:opacity-50",children:d.jsx(Bu,{className:"w-5 h-5"})})]}),d.jsxs("button",{onClick:()=>N||O?qe():Ee(),disabled:O&&!N,className:`w-full flex items-center justify-center gap-2 px-4 py-3 rounded-xl transition-colors ${N?"bg-red-500/20 text-red-400 border border-red-500/30":O?"bg-orange-500/20 text-orange-400 border border-orange-500/30":"bg-white/5 text-gray-300 border border-white/10 hover:bg-white/10"}`,children:[d.jsx(iD,{className:"w-5 h-5"}),N?"Stop Camera":O?"Starting Camera...":"Use Camera"]}),O&&d.jsxs("div",{className:"relative",children:[d.jsx("div",{id:"return-scanner",className:"w-full rounded-xl overflow-hidden bg-black",style:{minHeight:"250px"}}),!N&&d.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50 rounded-xl",children:d.jsxs("div",{className:"text-center",children:[d.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-2 border-orange-400 border-t-transparent mx-auto mb-2"}),d.jsx("p",{className:"text-gray-400 text-sm",children:"Initializing camera..."})]})})]})]}),U.size>=(((fe=h.items)==null?void 0:fe.length)||0)&&d.jsxs("button",{onClick:()=>{var xe;return je("returned",`All ${(xe=h.items)==null?void 0:xe.length} items scanned and returned`)},disabled:B,className:"w-full flex items-center justify-center gap-2 px-4 py-3 bg-orange-500 text-white rounded-xl hover:bg-orange-600 transition-colors disabled:opacity-50",children:[d.jsx(Ur,{className:"w-5 h-5"}),"Complete Return"]})]})]})}),y&&h&&d.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/70",children:d.jsxs("div",{className:"bg-[#1a1b3e] border border-[#2d2f5a] rounded-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[d.jsx("div",{className:"p-6 border-b border-[#2d2f5a]",children:d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsx("h2",{className:"text-xl font-bold text-white",children:"Order Details"}),d.jsx("button",{onClick:()=>_(!1),className:"p-2 hover:bg-white/10 rounded-lg transition-colors",children:d.jsx(Ar,{className:"w-5 h-5 text-gray-400"})})]})}),d.jsxs("div",{className:"p-6 space-y-6",children:[d.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-gray-500 text-sm",children:"Order Number"}),d.jsx("p",{className:"text-white font-medium",children:h.orderNumber})]}),d.jsxs("div",{children:[d.jsx("p",{className:"text-gray-500 text-sm",children:"Business"}),d.jsx("p",{className:"text-white",children:h.businessName})]}),d.jsxs("div",{children:[d.jsx("p",{className:"text-gray-500 text-sm",children:"Customer"}),d.jsx("p",{className:"text-white",children:(ke=h.customer)==null?void 0:ke.name}),d.jsx("p",{className:"text-gray-400 text-sm",children:(Ve=h.customer)==null?void 0:Ve.email})]}),d.jsxs("div",{children:[d.jsx("p",{className:"text-gray-500 text-sm",children:"Total"}),d.jsxs("p",{className:"text-emerald-400 font-bold text-lg",children:["$",(((Vt=h.financials)==null?void 0:Vt.total)||0).toFixed(2)]})]}),d.jsxs("div",{children:[d.jsx("p",{className:"text-gray-500 text-sm",children:"Tracking Number"}),d.jsx("p",{className:"text-white",children:((qt=h.fulfillment)==null?void 0:qt.trackingNumber)||"N/A"})]}),d.jsxs("div",{children:[d.jsx("p",{className:"text-gray-500 text-sm",children:"Shipped At"}),d.jsx("p",{className:"text-white",children:Lt((yt=h.fulfillment)==null?void 0:yt.shippedAt)})]})]}),h.items&&h.items.length>0&&d.jsxs("div",{children:[d.jsxs("p",{className:"text-gray-500 text-sm mb-3",children:["Items (",h.items.length,")"]}),d.jsx("div",{className:"space-y-2",children:h.items.map((xe,se)=>{var De;return d.jsxs("div",{className:"flex items-center justify-between p-3 bg-white/5 rounded-lg",children:[d.jsxs("div",{children:[d.jsx("p",{className:"text-white",children:xe.productName||xe.name}),xe.size&&d.jsxs("p",{className:"text-gray-500 text-sm",children:["Size: ",xe.size]})]}),d.jsxs("div",{className:"text-right",children:[d.jsxs("p",{className:"text-white",children:["x",xe.quantity]}),d.jsxs("p",{className:"text-gray-400 text-sm",children:["$",(De=xe.price)==null?void 0:De.toFixed(2)]})]})]},se)})})]}),d.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-[#2d2f5a]",children:[d.jsx("button",{onClick:()=>_(!1),className:"px-4 py-2 bg-white/5 text-gray-300 rounded-lg hover:bg-white/10 transition-colors",children:"Close"}),d.jsxs("button",{onClick:()=>{_(!1),T(!0)},className:"flex items-center gap-2 px-4 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors",children:[d.jsx(Ur,{className:"w-4 h-4"}),"Update Status"]})]})]})]})})]})})}const gQ=1,ky=3,yQ=()=>{const{user:t,loading:e}=fm(),n=Vo(),[r,s]=q.useState(""),[i,l]=q.useState(""),[h,p]=q.useState(!1),[y,_]=q.useState(!1),[E,T]=q.useState("idle"),[k,L]=q.useState({}),B=q.useRef(null),[H,W]=q.useState(!1),[M,U]=q.useState(""),[$,K]=q.useState(!1),[Z,A]=q.useState(!1),[C,N]=q.useState(null);q.useEffect(()=>()=>{B.current&&clearInterval(B.current)},[]);const D=pe=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(pe),O=()=>{const pe={},ve=r.trim();return ve?D(ve)||(pe.email="Please enter a valid email address"):pe.email="Email is required",i||(pe.password="Password is required"),L(pe),Object.keys(pe).length===0},F=async pe=>{const fe=new TextEncoder().encode(pe),ke=await crypto.subtle.digest("SHA-256",fe);return Array.from(new Uint8Array(ke)).map(Vt=>Vt.toString(16).padStart(2,"0")).join("")},R=async()=>{const pe=document.createElement("canvas"),ve=pe.getContext("2d");ve==null||ve.setTransform(1,0,0,1,0,0),ve==null||ve.clearRect(0,0,pe.width,pe.height),ve==null||ve.setTransform(1,0,0,1,0,0),ve&&(ve.textBaseline="top",ve.font="14px Arial",ve.fillText("Device Fingerprint",2,2));const fe={userAgent:navigator.userAgent,language:navigator.language,platform:navigator.platform,screenResolution:`${window.screen.width}x${window.screen.height}`,colorDepth:window.screen.colorDepth,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone,hardwareConcurrency:navigator.hardwareConcurrency,deviceMemory:navigator.deviceMemory||"unknown",canvasFingerprint:await F(pe.toDataURL()),touchSupport:"ontouchstart"in window,plugins:Array.from(navigator.plugins||[]).map(ke=>ke.name).join(",")};return F(JSON.stringify(fe))},ie=async(pe,ve)=>{try{const fe=Bn(at,"users",pe,"trustedDevices",ve);return(await ri(fe)).exists()}catch(fe){return console.error("Error checking trusted device:",fe),!1}},te=async(pe,ve,fe)=>{try{const ke=Bn(at,"users",pe,"trustedDevices",ve);await _w(ke,{deviceInfo:fe,firstSeen:new Date,lastSeen:new Date,trusted:!0,loginCount:1}),console.log(" Device saved as trusted")}catch(ke){console.error("Error saving trusted device:",ke)}},je=async(pe,ve,fe,ke)=>{try{const Ve=In(at,"suspiciousActivity");await Wc(Ve,{userId:pe,email:ve,deviceFingerprint:fe,activityType:ke,timestamp:new Date,userAgent:navigator.userAgent,platform:navigator.platform,location:"pending"}),console.log(" Suspicious activity logged")}catch(Ve){console.error("Error logging suspicious activity:",Ve)}},We=async pe=>{var ve,fe,ke;try{const Ve=Bn(at,"activeSessions",pe),Vt=await ri(Ve);if(!Vt.exists())return 0;const qt=Vt.data(),yt=qt.lastActivity,xe=((ve=yt==null?void 0:yt.toDate)==null?void 0:ve.call(yt))??(typeof yt=="string"?new Date(yt):new Date),se=new Date(Date.now()-5*60*1e3);return xe>se?(console.log("Active session found:",{device:(ke=(fe=qt.deviceFingerprint)==null?void 0:fe.substring)==null?void 0:ke.call(fe,0,16),lastActivity:xe.toISOString()}),1):0}catch(Ve){return console.error("Error checking concurrent sessions:",Ve),0}},Ee=async pe=>{try{const ve=In(at,"users",pe,"trustedDevices");return(await Cn(ve)).size}catch(ve){return console.error("Error counting trusted devices:",ve),0}},qe=async(pe,ve)=>{try{const fe=Bn(at,"activeSessions",pe),ke=Math.random().toString(36);await _w(fe,{userId:pe,deviceFingerprint:ve,lastActivity:new Date,createdAt:new Date,userAgent:navigator.userAgent,platform:navigator.platform,sessionId:ke}),localStorage.setItem("sessionId",ke),B.current=setInterval(async()=>{try{const Ve=await ri(fe);if(!Ve.exists()||Ve.data().deviceFingerprint!==ve){console.error(" SESSION TERMINATED - Another device logged in!"),B.current&&clearInterval(B.current),await Ip(ao),alert(` SESSION TERMINATED

Your session was ended because someone logged into this account from another device.

Only ONE device can be logged in at a time.`),n("/login",{replace:!0});return}await ls(fe,{lastActivity:new Date})}catch(Ve){console.error("Error updating session heartbeat:",Ve)}},3e4)}catch(fe){console.error("Error creating active session:",fe)}},et=async(pe,ve)=>{try{if(!("geolocation"in navigator)){console.warn(" Geolocation not supported by browser");return}const fe=await new Promise((Vt,qt)=>{navigator.geolocation.getCurrentPosition(Vt,qt,{enableHighAccuracy:!0,timeout:5e3,maximumAge:0})}),ke={latitude:fe.coords.latitude,longitude:fe.coords.longitude,accuracy:fe.coords.accuracy,timestamp:new Date().toISOString(),userAgent:navigator.userAgent,platform:navigator.platform},Ve=In(at,"loginLocations");await Wc(Ve,{userId:pe,email:ve,location:ke,loginTime:new Date}),console.log(" Location saved to Firestore")}catch(fe){console.warn(" Location access denied or failed:",fe.message)}},Lt=pe=>{let ve="Invalid email or password";switch(pe.code){case"auth/user-not-found":ve="No account found with this email";break;case"auth/wrong-password":ve="Incorrect password";break;case"auth/invalid-email":ve="Invalid email format";break;case"auth/user-disabled":ve="This account has been disabled";break;case"auth/too-many-requests":ve="Too many failed attempts. Please try again later";break;case"auth/network-request-failed":ve="Network error. Please check your connection";break;case"auth/invalid-credential":ve="Invalid email or password";break;default:ve=pe.message||ve;break}L(fe=>({...fe,password:ve}))},Qe=async pe=>{if(pe.preventDefault(),!O())return;const ve=r.trim();console.log(" Login attempt:",{email:ve,rememberMe:y}),T("loading"),L({});try{const ke=(await Wj(ao,ve,i)).user,Ve=await R(),Vt=await ie(ke.uid,Ve);if(Vt)console.log(" Trusted device recognized");else{console.warn(" NEW/UNTRUSTED DEVICE DETECTED!"),await je(ke.uid,ke.email??ve,Ve,"new_device_login");const xe={userAgent:navigator.userAgent,platform:navigator.platform,language:navigator.language,screenResolution:`${window.screen.width}x${window.screen.height}`,timezone:Intl.DateTimeFormat().resolvedOptions().timeZone};await te(ke.uid,Ve,xe)}const qt=await We(ke.uid),yt=await Ee(ke.uid);if(qt>=gQ){console.error(" ACCOUNT SHARING DETECTED! Multiple active sessions."),await je(ke.uid,ke.email??ve,Ve,"concurrent_session_blocked"),await Ip(ao),T("idle"),L(xe=>({...xe,password:"Account sharing detected. This account is currently active on another device. Please logout from other devices."})),alert(` ACCOUNT SHARING DETECTED!

This account is currently in use on another device.

Each business account can only be used on ONE device at a time.

Please:
1. Logout from other devices, OR
2. Use the Staff Invitation feature to create accounts for your team members.

Contact support if you believe this is an error.`);return}if(!Vt&&yt>=ky){console.error(` DEVICE LIMIT EXCEEDED! ${yt} devices registered.`),await je(ke.uid,ke.email??ve,Ve,"device_limit_exceeded"),await Ip(ao),T("idle"),L(xe=>({...xe,password:`Device limit exceeded. This account is registered on ${yt} devices (maximum: ${ky}).`})),alert(` DEVICE LIMIT EXCEEDED!

This account is registered on ${yt} devices (maximum: ${ky}).

This indicates possible account sharing, which violates our Terms of Service.

Please:
1. Remove old devices from Settings > Security, OR
2. Use Staff Invitations to create individual accounts for team members.

Your account may be suspended if sharing continues.`);return}await qe(ke.uid,Ve),et(ke.uid,ke.email??ve),T("success"),setTimeout(()=>{n("/",{replace:!0})},1e3)}catch(fe){console.error(" Login error:",fe),T("idle"),fe instanceof $a?Lt(fe):L(ke=>({...ke,password:"Login failed. Please try again."}))}},rt=async pe=>{pe.preventDefault(),A(!0),N(null);try{await $j(ao,M.trim()),K(!0)}catch(ve){console.error("Password reset error:",ve);let fe="Failed to send reset email. Please try again.";ve instanceof $a&&(ve.code==="auth/user-not-found"?fe="No account found with this email.":ve.code==="auth/invalid-email"&&(fe="Please enter a valid email address.")),N(fe)}finally{A(!1)}};return e?d.jsx(Kw,{message:"Checking authentication..."}):t?d.jsx(wf,{to:"/",replace:!0}):d.jsxs("div",{className:"min-h-screen flex items-center justify-center p-4 bg-[#0a0b1a] relative overflow-hidden",children:[d.jsx("div",{className:"absolute inset-0 overflow-hidden",children:d.jsxs("div",{className:"absolute -top-1/2 -left-1/2 w-[200%] h-[200%] animate-float",children:[d.jsx("div",{className:"absolute top-1/4 left-1/4 w-96 h-96 bg-amber-500/10 rounded-full blur-3xl"}),d.jsx("div",{className:"absolute bottom-1/4 right-1/4 w-80 h-80 bg-purple-500/10 rounded-full blur-3xl"}),d.jsx("div",{className:"absolute top-1/2 left-1/2 w-72 h-72 bg-blue-500/5 rounded-full blur-3xl"})]})}),d.jsx("div",{className:"absolute inset-0 bg-[linear-gradient(rgba(255,255,255,0.02)_1px,transparent_1px),linear-gradient(90deg,rgba(255,255,255,0.02)_1px,transparent_1px)] bg-[size:50px_50px]"}),d.jsxs("div",{className:"relative z-10 w-full max-w-md",children:[d.jsxs("div",{className:"bg-[#1a1b3e]/80 backdrop-blur-xl border border-white/10 rounded-3xl shadow-2xl overflow-hidden",children:[d.jsxs("div",{className:"px-8 pt-10 pb-6 text-center bg-gradient-to-b from-amber-500/5 to-transparent",children:[d.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-amber-400 to-amber-600 rounded-2xl mx-auto mb-6 flex items-center justify-center shadow-lg shadow-amber-500/30",children:d.jsx("span",{className:"text-[#0a0b1a] text-2xl font-black",children:"X"})}),d.jsx("h1",{className:"text-2xl font-bold text-white mb-2",children:"Welcome Back"}),d.jsx("p",{className:"text-gray-400",children:"Sign in to XDIGIX Admin Panel"})]}),d.jsxs("div",{className:"px-8 pb-10",children:[E==="idle"&&d.jsxs("form",{onSubmit:Qe,className:"space-y-5",children:[d.jsxs("div",{children:[d.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-300 mb-2",children:"Email Address"}),d.jsxs("div",{className:"relative",children:[d.jsx(Sd,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-500"}),d.jsx("input",{id:"email",type:"email",className:`w-full pl-12 pr-4 py-3.5 bg-white/5 border rounded-xl text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-amber-500/50 transition-all ${k.email?"border-red-500":"border-white/10"}`,placeholder:"admin@xdigix.com",value:r,onChange:pe=>{s(pe.target.value),k.email&&L(ve=>({...ve,email:void 0}))}})]}),k.email&&d.jsx("p",{className:"mt-2 text-sm text-red-400",children:k.email})]}),d.jsxs("div",{children:[d.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-300 mb-2",children:"Password"}),d.jsxs("div",{className:"relative",children:[d.jsx(ag,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-500"}),d.jsx("input",{id:"password",type:h?"text":"password",className:`w-full pl-12 pr-12 py-3.5 bg-white/5 border rounded-xl text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-amber-500/50 transition-all ${k.password?"border-red-500":"border-white/10"}`,placeholder:"",value:i,onChange:pe=>{l(pe.target.value),k.password&&L(ve=>({...ve,password:void 0}))}}),d.jsx("button",{type:"button",className:"absolute right-4 top-1/2 -translate-y-1/2 text-gray-500 hover:text-gray-300 transition-colors",onClick:()=>p(!h),children:h?d.jsx(aD,{className:"w-5 h-5"}):d.jsx(Qc,{className:"w-5 h-5"})})]}),k.password&&d.jsx("p",{className:"mt-2 text-sm text-red-400",children:k.password})]}),d.jsxs("div",{className:"flex items-center justify-between",children:[d.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[d.jsx("input",{type:"checkbox",checked:y,onChange:pe=>_(pe.target.checked),className:"w-4 h-4 rounded border-white/20 bg-white/5 text-amber-500 focus:ring-amber-500/50"}),d.jsx("span",{className:"text-sm text-gray-400",children:"Remember me"})]}),d.jsx("button",{type:"button",onClick:()=>{W(!0),U(r)},className:"text-sm text-amber-400 hover:text-amber-300 font-medium transition-colors",children:"Forgot password?"})]}),d.jsx("button",{type:"submit",className:"w-full py-3.5 bg-gradient-to-r from-amber-400 to-amber-500 text-[#0a0b1a] font-semibold rounded-xl hover:from-amber-300 hover:to-amber-400 transition-all duration-300 shadow-lg shadow-amber-500/25 hover:shadow-amber-500/40",children:"Sign In"})]}),E==="loading"&&d.jsxs("div",{className:"py-12 text-center",children:[d.jsx("div",{className:"w-12 h-12 border-3 border-white/20 border-t-amber-400 rounded-full animate-spin mx-auto mb-4"}),d.jsx("p",{className:"text-gray-400",children:"Signing you in..."})]}),E==="success"&&d.jsxs("div",{className:"py-12 text-center",children:[d.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-emerald-400 to-emerald-600 rounded-full flex items-center justify-center mx-auto mb-4 animate-fade-in",children:d.jsx(Ur,{className:"w-8 h-8 text-white"})}),d.jsx("h3",{className:"text-xl font-semibold text-white mb-2",children:"Welcome back!"}),d.jsx("p",{className:"text-gray-400",children:"Redirecting to dashboard..."})]})]})]}),d.jsxs("p",{className:"text-center text-gray-500 text-sm mt-8",children:[" ",new Date().getFullYear()," XDIGIX. All rights reserved."]})]}),H&&d.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[d.jsx("div",{className:"absolute inset-0 bg-black/70 backdrop-blur-sm",onClick:()=>{W(!1),K(!1),N(null)}}),d.jsxs("div",{className:"relative bg-[#1a1b3e] border border-white/10 rounded-2xl p-8 max-w-md w-full shadow-2xl animate-fade-in",children:[d.jsx("button",{onClick:()=>{W(!1),K(!1),N(null)},className:"absolute top-4 right-4 text-gray-400 hover:text-white transition-colors",children:d.jsx(Ar,{className:"w-6 h-6"})}),$?d.jsxs("div",{className:"text-center py-4",children:[d.jsx("div",{className:"w-16 h-16 bg-emerald-500/20 rounded-full flex items-center justify-center mx-auto mb-4",children:d.jsx(Ur,{className:"w-8 h-8 text-emerald-400"})}),d.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Check Your Email"}),d.jsxs("p",{className:"text-gray-400",children:["We've sent a password reset link to ",d.jsx("span",{className:"text-white font-medium",children:M})]})]}):d.jsxs(d.Fragment,{children:[d.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"Reset Password"}),d.jsx("p",{className:"text-gray-400 mb-6",children:"Enter your email address and we'll send you a link to reset your password."}),d.jsxs("form",{onSubmit:rt,children:[d.jsxs("div",{className:"mb-4",children:[d.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Email Address"}),d.jsxs("div",{className:"relative",children:[d.jsx(Sd,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-500"}),d.jsx("input",{type:"email",value:M,onChange:pe=>U(pe.target.value),className:"w-full pl-12 pr-4 py-3 bg-white/5 border border-white/10 rounded-xl text-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-amber-500/50",placeholder:"admin@xdigix.com",required:!0})]})]}),C&&d.jsx("p",{className:"text-red-400 text-sm mb-4",children:C}),d.jsx("button",{type:"submit",disabled:Z,className:"w-full py-3 bg-gradient-to-r from-amber-400 to-amber-500 text-[#0a0b1a] font-semibold rounded-xl hover:from-amber-300 hover:to-amber-400 transition-all duration-300 disabled:opacity-50",children:Z?"Sending...":"Send Reset Link"})]})]})]})]})]})},KT=()=>{const{user:t}=Gs(),{user:e,logout:n}=fm(),r=Vo(),s=!t,i=async()=>{try{await n(),r("/login")}catch(l){console.error("Error signing out:",l),r("/login")}};return s?d.jsxs("div",{className:"min-h-screen bg-[#0a0b1a] flex items-center justify-center px-6 relative",children:[d.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[d.jsx("div",{className:"absolute top-1/4 left-1/4 w-96 h-96 bg-blue-500/5 rounded-full blur-3xl"}),d.jsx("div",{className:"absolute bottom-1/4 right-1/4 w-80 h-80 bg-amber-500/5 rounded-full blur-3xl"})]}),d.jsxs("div",{className:"relative z-10 max-w-2xl w-full bg-[#1a1b3e]/80 backdrop-blur-xl border border-white/10 rounded-2xl p-8 md:p-10 space-y-6",children:[d.jsxs("div",{className:"text-center",children:[d.jsx("div",{className:"mx-auto w-16 h-16 rounded-2xl bg-blue-500/20 text-blue-400 flex items-center justify-center mb-4",children:d.jsx($f,{className:"w-8 h-8"})}),d.jsx("h1",{className:"text-2xl font-bold text-white mb-2",children:"Setup Required"}),d.jsx("p",{className:"text-gray-400",children:"You need to initialize the RBAC system and create your super admin user."})]}),d.jsxs("div",{className:"bg-blue-500/10 border border-blue-500/20 rounded-xl p-5",children:[d.jsx("h2",{className:"font-semibold text-blue-400 mb-3",children:"Quick Setup Steps:"}),d.jsxs("ol",{className:"list-decimal list-inside space-y-2 text-sm text-blue-300/80",children:[d.jsx("li",{children:"Open browser console (F12 or Cmd+Option+I)"}),d.jsxs("li",{children:["Run the RBAC initialization script from ",d.jsx("code",{className:"bg-blue-500/20 px-1.5 py-0.5 rounded text-blue-300",children:"sys/BROWSER_CONSOLE_SETUP.md"})]}),d.jsx("li",{children:"Create your super admin user"}),d.jsx("li",{children:"Refresh this page"})]})]}),e&&d.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-xl p-5",children:[d.jsx("h3",{className:"font-semibold text-white mb-3 text-sm",children:"Your Firebase User:"}),d.jsxs("div",{className:"text-sm text-gray-400 space-y-2",children:[d.jsxs("p",{children:[d.jsx("span",{className:"text-gray-500",children:"UID:"})," ",d.jsx("span",{className:"font-mono text-xs text-gray-300",children:e.uid})]}),d.jsxs("p",{children:[d.jsx("span",{className:"text-gray-500",children:"Email:"})," ",d.jsx("span",{className:"text-gray-300",children:e.email})]})]})]}),d.jsx("div",{className:"bg-amber-500/10 border border-amber-500/20 rounded-xl p-4",children:d.jsxs("p",{className:"text-sm text-amber-400",children:[d.jsx("strong",{children:"Note:"})," Check ",d.jsx("code",{className:"bg-amber-500/20 px-1.5 py-0.5 rounded",children:"sys/BROWSER_CONSOLE_SETUP.md"})," for detailed setup instructions."]})}),d.jsxs("button",{onClick:()=>window.location.reload(),className:"w-full flex items-center justify-center gap-2 py-3 bg-gradient-to-r from-amber-400 to-amber-500 text-[#0a0b1a] font-semibold rounded-xl hover:from-amber-300 hover:to-amber-400 transition-all",children:[d.jsx(Wd,{className:"w-5 h-5"}),"Refresh After Setup"]})]})]}):d.jsxs("div",{className:"min-h-screen bg-[#0a0b1a] flex items-center justify-center px-6 relative",children:[d.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[d.jsx("div",{className:"absolute top-1/4 left-1/4 w-96 h-96 bg-red-500/5 rounded-full blur-3xl"}),d.jsx("div",{className:"absolute bottom-1/4 right-1/4 w-80 h-80 bg-purple-500/5 rounded-full blur-3xl"})]}),d.jsxs("div",{className:"relative z-10 max-w-md w-full bg-[#1a1b3e]/80 backdrop-blur-xl border border-white/10 rounded-2xl p-8 text-center space-y-6",children:[d.jsx("div",{className:"mx-auto w-20 h-20 rounded-2xl bg-red-500/20 text-red-400 flex items-center justify-center",children:d.jsx(vK,{className:"w-10 h-10"})}),d.jsxs("div",{children:[d.jsx("h1",{className:"text-2xl font-bold text-white mb-2",children:"Access Restricted"}),d.jsx("p",{className:"text-gray-400",children:"You don't have permission to access this content."})]}),t&&d.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-xl p-4 text-left",children:[d.jsx("h3",{className:"font-semibold text-white mb-3 text-sm",children:"Your Account:"}),d.jsxs("div",{className:"space-y-2 text-sm",children:[d.jsxs("p",{className:"flex items-center justify-between",children:[d.jsx("span",{className:"text-gray-500",children:"Email:"}),d.jsx("span",{className:"font-mono text-xs text-gray-300",children:t.email})]}),d.jsxs("p",{className:"flex items-center justify-between",children:[d.jsx("span",{className:"text-gray-500",children:"Type:"}),d.jsx("span",{className:"px-2 py-0.5 bg-blue-500/20 text-blue-400 rounded text-xs font-medium",children:t.type})]}),d.jsxs("p",{className:"flex items-center justify-between",children:[d.jsx("span",{className:"text-gray-500",children:"Status:"}),d.jsx("span",{className:`px-2 py-0.5 rounded text-xs font-medium ${t.status==="active"?"bg-emerald-500/20 text-emerald-400":"bg-red-500/20 text-red-400"}`,children:t.status})]})]})]}),d.jsxs("div",{className:"space-y-4 pt-2",children:[d.jsxs("a",{href:"mailto:support@xdigix.com",className:"flex items-center justify-center gap-2 py-3 bg-white/5 border border-white/10 rounded-xl text-gray-300 hover:bg-white/10 transition-all",children:[d.jsx(Sd,{className:"w-5 h-5"}),"Contact Support"]}),d.jsxs("button",{onClick:i,className:"w-full flex items-center justify-center gap-2 py-3 bg-gradient-to-r from-amber-400 to-amber-500 text-[#0a0b1a] font-semibold rounded-xl hover:from-amber-300 hover:to-amber-400 transition-all",children:[d.jsx(yK,{className:"w-5 h-5"}),"Sign Out & Sign In Again"]})]})]})]})},xQ=()=>{const[t]=jM(),e=Vo(),n=t.get("email")||"",r=t.get("invite")||"";t.get("type");const[s,i]=q.useState(""),[l,h]=q.useState(""),[p,y]=q.useState(!1),[_,E]=q.useState(!0),[T,k]=q.useState(!1),[L,B]=q.useState(""),[H,W]=q.useState(""),[M,U]=q.useState(""),[$,K]=q.useState(null),[Z,A]=q.useState({level:0,text:"",color:""});q.useEffect(()=>{C()},[n,r]);const C=async()=>{if(E(!0),!n||!r){B("Invalid invitation link. Missing required parameters."),E(!1);return}try{const R=Bn(at,"superAdminInvites",r),ie=await ri(R);if(!ie.exists()){B("Invitation not found. It may have been cancelled or expired."),E(!1);return}const te=ie.data();if(te.status!=="pending"){B("This invitation has already been used or has expired."),E(!1);return}if(te.email.toLowerCase()!==n.toLowerCase()){B("Email mismatch. Please use the correct invitation link."),E(!1);return}if(te.expiresAt&&new Date(te.expiresAt)<new Date){B("This invitation has expired. Please request a new invitation."),E(!1);return}K(te)}catch(R){console.error("Error validating invitation:",R),B("Failed to validate invitation. Please try again.")}finally{E(!1)}},N=R=>{let ie=0;const te=[];R.length>=8?ie++:te.push("at least 8 characters"),/[A-Z]/.test(R)?ie++:te.push("uppercase letter"),/[a-z]/.test(R)?ie++:te.push("lowercase letter"),/[0-9]/.test(R)?ie++:te.push("number"),/[^A-Za-z0-9]/.test(R)?ie++:te.push("special character"),ie<=2?A({level:ie,text:`Weak. Add: ${te.slice(0,2).join(", ")}`,color:"bg-red-500"}):ie<=3?A({level:ie,text:`Medium. Add: ${te.slice(0,1).join(", ")}`,color:"bg-amber-500"}):A({level:ie,text:"Strong password!",color:"bg-emerald-500"})},D=R=>{const ie=R.target.value;i(ie),W(""),ie.length>0&&N(ie)},O=()=>{let R=!0;return W(""),U(""),s.length<8&&(W("Password must be at least 8 characters long"),R=!1),s!==l&&(U("Passwords do not match"),R=!1),R},F=async R=>{if(R.preventDefault(),!!O()){y(!0),B("");try{console.log(" Creating Firebase Auth user for:",n);const te=(await zj(ao,n,s)).user;console.log(" Firebase Auth user created:",te.uid),await _w(Bn(at,"users",te.uid),{uid:te.uid,email:n.toLowerCase(),name:($==null?void 0:$.name)||n.split("@")[0],tenant_id:null,role_id:($==null?void 0:$.role_id)||null,type:"super_admin",status:"active",created_at:new Date().toISOString(),updated_at:new Date().toISOString(),setupCompleted:!0}),console.log(" User document created"),await ls(Bn(at,"superAdminInvites",r),{status:"accepted",acceptedAt:new Date().toISOString(),acceptedBy:te.uid}),console.log(" Invitation marked as accepted"),k(!0),setTimeout(()=>{e(`/login?email=${encodeURIComponent(n)}&setup=complete`)},2e3)}catch(ie){console.error("Setup error:",ie);let te="Failed to create account";ie.code==="auth/email-already-in-use"?te="An account with this email already exists. Please try logging in instead.":ie.code==="auth/weak-password"?te="Password is too weak. Please choose a stronger password.":ie.code==="auth/invalid-email"?te="Invalid email address.":ie.message&&(te=ie.message),B(te)}finally{y(!1)}}};return _?d.jsx("div",{className:"min-h-screen bg-[#0a0b1a] flex items-center justify-center p-5",children:d.jsxs("div",{className:"bg-[#1a1b3e] border border-white/10 rounded-2xl p-10 max-w-md w-full text-center",children:[d.jsx(Zh,{className:"w-12 h-12 text-amber-400 animate-spin mx-auto mb-4"}),d.jsx("h2",{className:"text-xl font-semibold text-white mb-2",children:"Validating Invitation"}),d.jsx("p",{className:"text-gray-400",children:"Please wait while we verify your invitation..."})]})}):L&&!$?d.jsx("div",{className:"min-h-screen bg-[#0a0b1a] flex items-center justify-center p-5",children:d.jsxs("div",{className:"bg-[#1a1b3e] border border-white/10 rounded-2xl p-10 max-w-md w-full text-center",children:[d.jsx("div",{className:"w-16 h-16 bg-red-500/10 rounded-full flex items-center justify-center mx-auto mb-4",children:d.jsx(Ui,{className:"w-8 h-8 text-red-400"})}),d.jsx("h1",{className:"text-2xl font-bold text-white mb-2",children:"Invalid Invitation"}),d.jsx("p",{className:"text-gray-400 mb-6",children:L}),d.jsx("button",{onClick:()=>e("/login"),className:"bg-gradient-to-r from-amber-400 to-amber-500 text-[#0a0b1a] px-6 py-3 rounded-xl font-semibold hover:from-amber-300 hover:to-amber-400 transition",children:"Go to Login"})]})}):d.jsx("div",{className:"min-h-screen bg-[#0a0b1a] flex items-center justify-center p-5",children:d.jsxs("div",{className:"bg-[#1a1b3e] border border-white/10 rounded-2xl p-8 max-w-md w-full relative overflow-hidden",children:[d.jsx("div",{className:"absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-amber-400 to-amber-500"}),d.jsxs("div",{className:"text-center mb-8",children:[d.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-amber-400 to-amber-500 rounded-xl flex items-center justify-center mx-auto mb-4 shadow-lg shadow-amber-500/20",children:d.jsx(lg,{className:"w-8 h-8 text-[#0a0b1a]"})}),d.jsx("h1",{className:"text-2xl font-bold text-white mb-2",children:"Setup Your Account"}),d.jsx("p",{className:"text-gray-400",children:"Create a secure password to access the admin panel"})]}),T?d.jsxs("div",{className:"bg-emerald-500/10 border border-emerald-500/20 text-emerald-400 p-4 rounded-xl text-center mb-6 flex items-center justify-center gap-2",children:[d.jsx(Ur,{className:"w-6 h-6"}),d.jsx("span",{children:"Account created successfully! Redirecting to login..."})]}):d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"bg-white/5 border border-white/10 rounded-xl p-5 mb-6",children:[d.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[d.jsx("div",{className:"p-2 rounded-lg bg-amber-500/10",children:d.jsx(Sd,{className:"w-4 h-4 text-amber-400"})}),d.jsxs("div",{children:[d.jsx("span",{className:"text-xs text-gray-500 block",children:"Email"}),d.jsx("span",{className:"text-sm font-medium text-white",children:n})]})]}),d.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[d.jsx("div",{className:"p-2 rounded-lg bg-purple-500/10",children:d.jsx(B2,{className:"w-4 h-4 text-purple-400"})}),d.jsxs("div",{children:[d.jsx("span",{className:"text-xs text-gray-500 block",children:"Name"}),d.jsx("span",{className:"text-sm font-medium text-white",children:($==null?void 0:$.name)||"Staff Member"})]})]}),d.jsxs("div",{className:"flex items-center gap-3",children:[d.jsx("div",{className:"p-2 rounded-lg bg-blue-500/10",children:d.jsx(ig,{className:"w-4 h-4 text-blue-400"})}),d.jsxs("div",{children:[d.jsx("span",{className:"text-xs text-gray-500 block",children:"Access Level"}),d.jsx("span",{className:"px-2 py-0.5 bg-amber-500/20 text-amber-400 text-xs font-medium rounded-full",children:"Super Admin"})]})]})]}),L&&d.jsxs("div",{className:"bg-red-500/10 border border-red-500/20 text-red-400 p-4 rounded-xl mb-6 flex items-center gap-2",children:[d.jsx(Ui,{className:"w-5 h-5 shrink-0"}),d.jsx("span",{children:L})]}),d.jsxs("form",{onSubmit:F,children:[d.jsxs("div",{className:"mb-5",children:[d.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:[d.jsx(ag,{className:"w-4 h-4 inline mr-2"}),"Create Password *"]}),d.jsx("input",{type:"password",value:s,onChange:D,className:`w-full px-4 py-3 bg-white/5 border rounded-xl text-white placeholder-gray-500 focus:outline-none focus:border-amber-500/50 transition ${H?"border-red-500/50":"border-white/10"}`,placeholder:"Enter a strong password",required:!0,autoFocus:!0}),s.length>0&&d.jsxs("div",{className:"mt-2",children:[d.jsx("div",{className:"h-1 bg-white/10 rounded-full overflow-hidden",children:d.jsx("div",{className:`h-full transition-all ${Z.color}`,style:{width:`${Z.level*20}%`}})}),d.jsx("p",{className:`text-xs mt-1 ${Z.level<=2?"text-red-400":Z.level<=3?"text-amber-400":"text-emerald-400"}`,children:Z.text})]}),H&&d.jsx("p",{className:"text-red-400 text-sm mt-2",children:H})]}),d.jsxs("div",{className:"mb-6",children:[d.jsxs("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:[d.jsx(ag,{className:"w-4 h-4 inline mr-2"}),"Confirm Password *"]}),d.jsx("input",{type:"password",value:l,onChange:R=>{h(R.target.value),U("")},className:`w-full px-4 py-3 bg-white/5 border rounded-xl text-white placeholder-gray-500 focus:outline-none focus:border-amber-500/50 transition ${M?"border-red-500/50":"border-white/10"}`,placeholder:"Confirm your password",required:!0}),M&&d.jsx("p",{className:"text-red-400 text-sm mt-2",children:M})]}),d.jsx("button",{type:"submit",disabled:p,className:"w-full bg-gradient-to-r from-amber-400 to-amber-500 text-[#0a0b1a] py-4 rounded-xl font-semibold text-base hover:from-amber-300 hover:to-amber-400 transition disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 shadow-lg shadow-amber-500/20",children:p?d.jsxs(d.Fragment,{children:[d.jsx(Zh,{className:"w-5 h-5 animate-spin"}),d.jsx("span",{children:"Creating account..."})]}):d.jsxs(d.Fragment,{children:[d.jsx(Ur,{className:"w-5 h-5"}),d.jsx("span",{children:"Create Account & Continue"})]})})]}),d.jsx("div",{className:"text-center mt-8 text-gray-500 text-sm",children:d.jsxs("p",{children:["Already have an account?"," ",d.jsx("button",{onClick:()=>e("/login"),className:"text-amber-400 hover:underline font-medium",children:"Sign in here"})]})})]})]})})},wQ=_M([{path:"/",element:d.jsx(TK,{}),children:[{index:!0,element:d.jsx(CK,{})},{path:"clients",element:d.jsx(SK,{})},{path:"staff",element:d.jsx(RK,{})},{path:"subscriptions",element:d.jsx(PK,{})},{path:"analytics",element:d.jsx(kK,{})},{path:"roles",element:d.jsx(DK,{})},{path:"roles-permissions",element:d.jsx(OK,{})},{path:"plan-permissions",element:d.jsx(MK,{})},{path:"client-staff-permissions",element:d.jsx(LK,{})},{path:"fulfillment",element:d.jsx(oX,{})},{path:"pending-orders",element:d.jsx(fQ,{})},{path:"ready-for-pickup",element:d.jsx(mQ,{})},{path:"shipping",element:d.jsx(pQ,{})},{path:"*",element:d.jsx(wf,{to:"/",replace:!0})}],errorElement:d.jsx(KT,{})},{path:"/login",element:d.jsx(yQ,{})},{path:"/setup-password",element:d.jsx(xQ,{})},{path:"/no-access",element:d.jsx(KT,{})},{path:"*",element:d.jsx(wf,{to:"/",replace:!0})}],{basename:"/admin"}),_Q=new u8({defaultOptions:{queries:{retry:1,refetchOnWindowFocus:!1}}});Dy.createRoot(document.getElementById("root")).render(d.jsx(mC.StrictMode,{children:d.jsx(cK,{children:d.jsx(h8,{client:_Q,children:d.jsx(lK,{children:d.jsx(qB,{children:d.jsx(aK,{children:d.jsx(SM,{router:wQ})})})})})})}));
